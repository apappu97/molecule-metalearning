wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200807_194512-387sco3m
wandb: Syncing run CHEMBL1738019
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/387sco3m
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1738019
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1738019',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpemmjhomc/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]507it [00:00, 5068.22it/s]1293it [00:00, 5672.56it/s]2270it [00:00, 6487.95it/s]3257it [00:00, 7229.82it/s]4247it [00:00, 7865.98it/s]5246it [00:00, 8400.59it/s]6247it [00:00, 8825.16it/s]7232it [00:00, 9109.47it/s]8217it [00:00, 9318.38it/s]9206it [00:01, 9481.61it/s]10278it [00:01, 9821.84it/s]11367it [00:01, 10118.26it/s]12461it [00:01, 10348.93it/s]13559it [00:01, 10529.74it/s]14642it [00:01, 10616.56it/s]15725it [00:01, 10676.93it/s]16813it [00:01, 10736.34it/s]17916it [00:01, 10819.73it/s]19003it [00:01, 10833.63it/s]20088it [00:02, 10817.49it/s]21180it [00:02, 10846.06it/s]22267it [00:02, 10852.92it/s]23355it [00:02, 10859.53it/s]24447it [00:02, 10876.54it/s]25545it [00:02, 10904.80it/s]26637it [00:02, 10906.42it/s]27736it [00:02, 10929.44it/s]28830it [00:02, 10928.21it/s]29923it [00:02, 10901.47it/s]31014it [00:03, 10888.28it/s]32103it [00:03, 10884.50it/s]33199it [00:03, 10904.80it/s]34290it [00:03, 10899.30it/s]35393it [00:03, 10937.59it/s]36498it [00:03, 10968.40it/s]37595it [00:03, 10955.65it/s]38696it [00:03, 10971.00it/s]39798it [00:03, 10983.80it/s]40902it [00:03, 10997.66it/s]42002it [00:04, 10978.89it/s]43100it [00:04, 10963.81it/s]44197it [00:04, 10950.75it/s]45296it [00:04, 10961.09it/s]46398it [00:04, 10977.69it/s]47502it [00:04, 10994.05it/s]48602it [00:04, 10934.53it/s]49696it [00:04, 10921.54it/s]50789it [00:04, 10828.49it/s]51873it [00:04, 10702.60it/s]52959it [00:05, 10747.93it/s]54040it [00:05, 10765.49it/s]55124it [00:05, 10787.30it/s]56213it [00:05, 10816.41it/s]57314it [00:05, 10870.94it/s]58416it [00:05, 10913.09it/s]59519it [00:05, 10947.11it/s]60621it [00:05, 10967.78it/s]61724it [00:05, 10986.28it/s]61865it [00:05, 10612.64it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 1638.82it/s]100% 165/165 [00:00<00:00, 1635.53it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 344823.20it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5446.63it/s]
Total scaffolds = 117 | train scaffolds = 91 | val scaffolds = 15 | test scaffolds = 11
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.61538462]), array([13])), (array([0.88888889]), array([9])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  5.21it/s][A100% 3/3 [00:00<00:00, 10.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 58.39it/s]
Validation prc-auc = 0.714040
  3% 1/30 [00:00<00:10,  2.90it/s]Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 99.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 321.80it/s]
Validation prc-auc = 0.663444
Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 314.42it/s]
Validation prc-auc = 0.714955
 10% 3/30 [00:00<00:06,  3.89it/s]Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.5305e-03, PNorm = 26.0226, GNorm = 1.2990, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 100.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.36it/s]
Validation prc-auc = 0.714955
Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 311.77it/s]
Validation prc-auc = 0.714955
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 90.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.49it/s]
Validation prc-auc = 0.714955
 20% 6/30 [00:00<00:04,  5.24it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.68it/s]
Validation prc-auc = 0.759827
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.9125e-04, PNorm = 26.0727, GNorm = 0.2442, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 100.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.98it/s]
Validation prc-auc = 0.759827
 27% 8/30 [00:00<00:03,  6.69it/s]Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.70it/s]
Validation prc-auc = 0.759827
Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.27it/s]
Validation prc-auc = 0.759827
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.38it/s]
Validation prc-auc = 0.759827
 37% 11/30 [00:00<00:02,  8.71it/s]Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.5314e-04, PNorm = 26.0981, GNorm = 0.3101, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 102.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.57it/s]
Validation prc-auc = 0.759827
Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 314.27it/s]
Validation prc-auc = 0.759827
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.57it/s]
Validation prc-auc = 0.759827
 47% 14/30 [00:00<00:01, 11.05it/s]Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 310.00it/s]
Validation prc-auc = 0.759827
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.2839e-04, PNorm = 26.1146, GNorm = 0.1513, lr_0 = 1.7066e-04

 67% 2/3 [00:00<00:00, 18.06it/s][A100% 3/3 [00:00<00:00, 25.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.13it/s]
Validation prc-auc = 0.727776
Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.97it/s]
Validation prc-auc = 0.727776
 57% 17/30 [00:01<00:01, 12.14it/s]Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.88it/s]
Validation prc-auc = 0.727776
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.4510e-04, PNorm = 26.1227, GNorm = 0.1814, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 103.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.18it/s]
Validation prc-auc = 0.727776
Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.34it/s]
Validation prc-auc = 0.727776
 67% 20/30 [00:01<00:00, 14.75it/s]Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.25it/s]
Validation prc-auc = 0.727776
Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.75it/s]
Validation prc-auc = 0.727776
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.1221e-04, PNorm = 26.1280, GNorm = 0.2756, lr_0 = 1.0000e-04
Loss = 1.0050e-03, PNorm = 26.1286, GNorm = 0.3667, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 99.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.09it/s]
Validation prc-auc = 0.727776
 77% 23/30 [00:01<00:00, 17.33it/s]Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.61it/s]
Validation prc-auc = 0.727776
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.88it/s]
Validation prc-auc = 0.727776
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.59it/s]
Validation prc-auc = 0.727776
 87% 26/30 [00:01<00:00, 19.84it/s]Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.7755e-04, PNorm = 26.1331, GNorm = 0.3164, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 102.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.45it/s]
Validation prc-auc = 0.727776
Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.25it/s]
Validation prc-auc = 0.727776
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.22it/s]
Validation prc-auc = 0.727776
 97% 29/30 [00:01<00:00, 22.02it/s]Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.57it/s]
Validation prc-auc = 0.727776
100% 30/30 [00:01<00:00, 20.05it/s]
Model 0 best validation prc-auc = 0.759827 on epoch 6
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 48.45it/s]
Model 0 test prc-auc = 0.953725
Ensemble test prc-auc = 0.953725
Fold 1
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1738019
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1738019',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpemmjhomc/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1070it [00:00, 10696.31it/s]2150it [00:00, 10725.82it/s]3237it [00:00, 10765.61it/s]4321it [00:00, 10786.98it/s]5418it [00:00, 10839.51it/s]6511it [00:00, 10865.93it/s]7586it [00:00, 10829.29it/s]8654it [00:00, 10781.92it/s]9731it [00:00, 10778.08it/s]10806it [00:01, 10766.78it/s]11902it [00:01, 10823.59it/s]12985it [00:01, 10825.03it/s]14086it [00:01, 10878.24it/s]15186it [00:01, 10912.90it/s]16282it [00:01, 10924.80it/s]17378it [00:01, 10932.87it/s]18474it [00:01, 10940.05it/s]19567it [00:01, 10935.46it/s]20670it [00:01, 10963.25it/s]21772it [00:02, 10977.98it/s]22874it [00:02, 10987.62it/s]23973it [00:02, 10961.01it/s]25075it [00:02, 10976.58it/s]26176it [00:02, 10985.84it/s]27277it [00:02, 10992.56it/s]28381it [00:02, 11005.10it/s]29484it [00:02, 11011.51it/s]30586it [00:02, 10905.05it/s]31691it [00:02, 10945.95it/s]32793it [00:03, 10965.69it/s]33891it [00:03, 10969.83it/s]34989it [00:03, 10953.19it/s]36087it [00:03, 10959.83it/s]37192it [00:03, 10984.89it/s]38293it [00:03, 10992.00it/s]39393it [00:03, 10993.76it/s]40501it [00:03, 11017.49it/s]41603it [00:03, 10995.60it/s]42703it [00:03, 10952.62it/s]43801it [00:04, 10958.28it/s]44909it [00:04, 10992.84it/s]46011it [00:04, 10999.70it/s]47117it [00:04, 11016.09it/s]48224it [00:04, 11031.26it/s]49328it [00:04, 11014.93it/s]50430it [00:04, 10994.62it/s]51531it [00:04, 10998.61it/s]52631it [00:04, 9837.07it/s] 53638it [00:04, 8947.96it/s]54609it [00:05, 9163.18it/s]55594it [00:05, 9357.37it/s]56586it [00:05, 9516.39it/s]57588it [00:05, 9661.66it/s]58581it [00:05, 9740.38it/s]59562it [00:05, 9663.35it/s]60534it [00:05, 9418.88it/s]61566it [00:05, 9672.16it/s]61865it [00:05, 10619.22it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 1672.37it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 395915.42it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5199.36it/s]
Total scaffolds = 117 | train scaffolds = 90 | val scaffolds = 10 | test scaffolds = 17
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([3])), (array([1.]), array([1])), (array([0.]), array([3])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 91.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 337.19it/s]
Validation prc-auc = 0.717932
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 339.24it/s]
Validation prc-auc = 0.759598
  7% 2/30 [00:00<00:02, 13.92it/s]Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 342.76it/s]
Validation prc-auc = 0.801265
Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.1239e-03, PNorm = 26.0291, GNorm = 0.8842, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 98.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 328.53it/s]
Validation prc-auc = 0.801265
 13% 4/30 [00:00<00:01, 15.16it/s]Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 333.15it/s]
Validation prc-auc = 0.812574
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 328.32it/s]
Validation prc-auc = 0.812574
 20% 6/30 [00:00<00:01, 16.22it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.46it/s]
Validation prc-auc = 0.812574
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.2620e-03, PNorm = 26.0915, GNorm = 0.5361, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 101.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.80it/s]
Validation prc-auc = 0.812574
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.43it/s]
Validation prc-auc = 0.812574
 30% 9/30 [00:00<00:01, 18.77it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.17it/s]
Validation prc-auc = 0.812574
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.93it/s]
Validation prc-auc = 0.812574
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 4.5531e-04, PNorm = 26.1149, GNorm = 0.1921, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 101.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.25it/s]
Validation prc-auc = 0.812574
 40% 12/30 [00:00<00:00, 21.10it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 82.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 330.68it/s]
Validation prc-auc = 0.812574
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.62it/s]
Validation prc-auc = 0.812574
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.62it/s]
Validation prc-auc = 0.812574
 50% 15/30 [00:00<00:00, 22.73it/s]Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.6281e-04, PNorm = 26.1277, GNorm = 0.1926, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 101.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 328.81it/s]
Validation prc-auc = 0.812574
Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 329.30it/s]
Validation prc-auc = 0.812574
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.01it/s]
Validation prc-auc = 0.812574
 60% 18/30 [00:00<00:00, 24.46it/s]Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.5301e-04, PNorm = 26.1340, GNorm = 0.5494, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 102.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 334.53it/s]
Validation prc-auc = 0.812574
Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 333.01it/s]
Validation prc-auc = 0.812574
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.46it/s]
Validation prc-auc = 0.812574
 70% 21/30 [00:00<00:00, 25.83it/s]Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.80it/s]
Validation prc-auc = 0.812574
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.8059e-04, PNorm = 26.1382, GNorm = 0.1489, lr_0 = 1.0000e-04
Loss = 2.7098e-04, PNorm = 26.1386, GNorm = 0.1069, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 98.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 330.60it/s]
Validation prc-auc = 0.812574
Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 330.31it/s]
Validation prc-auc = 0.812574
 80% 24/30 [00:00<00:00, 26.80it/s]Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 333.68it/s]
Validation prc-auc = 0.812574
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.14it/s]
Validation prc-auc = 0.812574
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.1598e-04, PNorm = 26.1431, GNorm = 0.3548, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 101.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.33it/s]
Validation prc-auc = 0.812574
 90% 27/30 [00:01<00:00, 27.61it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 332.46it/s]
Validation prc-auc = 0.812574
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 317.70it/s]
Validation prc-auc = 0.812574
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 331.54it/s]
Validation prc-auc = 0.812574
100% 30/30 [00:01<00:00, 28.21it/s]100% 30/30 [00:01<00:00, 25.69it/s]
Model 0 best validation prc-auc = 0.812574 on epoch 4
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 264.94it/s]
Model 0 test prc-auc = 0.592929
Ensemble test prc-auc = 0.592929
Fold 2
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1738019
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1738019',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpemmjhomc/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]527it [00:00, 5266.66it/s]1322it [00:00, 5859.54it/s]2304it [00:00, 6665.62it/s]3287it [00:00, 7376.56it/s]4274it [00:00, 7980.81it/s]5284it [00:00, 8515.72it/s]6288it [00:00, 8921.46it/s]7279it [00:00, 9195.39it/s]8272it [00:00, 9402.14it/s]9351it [00:01, 9779.42it/s]10457it [00:01, 10129.18it/s]11557it [00:01, 10373.14it/s]12658it [00:01, 10554.23it/s]13752it [00:01, 10665.94it/s]14854it [00:01, 10767.99it/s]15950it [00:01, 10823.34it/s]17056it [00:01, 10891.39it/s]18156it [00:01, 10921.50it/s]19263it [00:01, 10963.66it/s]20361it [00:02, 10960.46it/s]21463it [00:02, 10976.66it/s]22562it [00:02, 10824.97it/s]23654it [00:02, 10852.75it/s]24752it [00:02, 10889.49it/s]25848it [00:02, 10909.55it/s]26940it [00:02, 10862.96it/s]28046it [00:02, 10921.27it/s]29139it [00:02, 10920.10it/s]30238it [00:02, 10938.86it/s]31349it [00:03, 10987.48it/s]32450it [00:03, 10991.46it/s]33554it [00:03, 11004.28it/s]34655it [00:03, 11001.16it/s]35756it [00:03, 10988.73it/s]36858it [00:03, 10997.85it/s]37962it [00:03, 11010.29it/s]39070it [00:03, 11029.04it/s]40179it [00:03, 11045.38it/s]41288it [00:03, 11058.05it/s]42395it [00:04, 11058.76it/s]43501it [00:04, 10956.81it/s]44598it [00:04, 10960.62it/s]45703it [00:04, 10985.57it/s]46811it [00:04, 11010.79it/s]47913it [00:04, 11011.93it/s]49015it [00:04, 10961.55it/s]50112it [00:04, 10944.79it/s]51213it [00:04, 10963.69it/s]52317it [00:04, 10985.01it/s]53416it [00:05, 10982.01it/s]54515it [00:05, 10944.09it/s]55610it [00:05, 10686.62it/s]56681it [00:05, 10511.03it/s]57734it [00:05, 10411.98it/s]58839it [00:05, 10593.12it/s]59941it [00:05, 10716.91it/s]61046it [00:05, 10813.75it/s]61865it [00:05, 10652.40it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 1671.65it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 399803.67it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5286.74it/s]
Total scaffolds = 117 | train scaffolds = 90 | val scaffolds = 14 | test scaffolds = 13
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([1.]), array([1])), (array([0.8]), array([5])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 98.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 314.72it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:220: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 323.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 319.47it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.3292e-03, PNorm = 26.0140, GNorm = 0.8020, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 58.87it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 333.49it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 13% 4/30 [00:00<00:01, 25.30it/s]Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 65.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 335.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 322.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 323.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 23% 7/30 [00:00<00:00, 25.60it/s]Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.0856e-03, PNorm = 26.0656, GNorm = 0.3941, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 105.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 325.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A
100% 3/3 [00:00<00:00, 21.98it/s][A100% 3/3 [00:00<00:00, 21.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.25it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 30% 9/30 [00:00<00:01, 18.67it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 313.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 320.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 9.0710e-04, PNorm = 26.0914, GNorm = 0.3472, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 103.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 315.48it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 321.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 43% 13/30 [00:00<00:00, 21.10it/s]Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 320.03it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 315.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.7136e-04, PNorm = 26.1060, GNorm = 0.1803, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 104.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 319.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 321.70it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 57% 17/30 [00:00<00:00, 23.26it/s]Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 316.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.4571e-04, PNorm = 26.1118, GNorm = 0.3735, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 103.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 321.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 316.17it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 321.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 70% 21/30 [00:00<00:00, 25.06it/s]Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 319.18it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.6068e-04, PNorm = 26.1162, GNorm = 0.3259, lr_0 = 1.0000e-04
Loss = 6.8713e-04, PNorm = 26.1167, GNorm = 0.2292, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 100.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 317.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 320.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 320.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 83% 25/30 [00:00<00:00, 26.44it/s]Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 317.89it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.0331e-04, PNorm = 26.1227, GNorm = 0.2671, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 104.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 316.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 316.50it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 319.81it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 97% 29/30 [00:01<00:00, 27.56it/s]Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.96it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
100% 30/30 [00:01<00:00, 26.08it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 269.57it/s]
Model 0 test prc-auc = 0.585117
Ensemble test prc-auc = 0.585117
Fold 3
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1738019
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1738019',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpemmjhomc/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1034it [00:00, 10337.30it/s]2081it [00:00, 10374.62it/s]3127it [00:00, 10397.89it/s]4173it [00:00, 10416.01it/s]5216it [00:00, 10419.83it/s]6265it [00:00, 10439.50it/s]7317it [00:00, 10461.63it/s]8360it [00:00, 10450.34it/s]9414it [00:00, 10477.05it/s]10471it [00:01, 10503.06it/s]11522it [00:01, 10505.04it/s]12569it [00:01, 10493.63it/s]13617it [00:01, 10488.61it/s]14664it [00:01, 10482.01it/s]15717it [00:01, 10495.58it/s]16770it [00:01, 10504.20it/s]17828it [00:01, 10526.80it/s]18881it [00:01, 10524.55it/s]19935it [00:01, 10527.12it/s]20993it [00:02, 10542.68it/s]22053it [00:02, 10558.81it/s]23111it [00:02, 10564.28it/s]24168it [00:02, 10553.11it/s]25224it [00:02, 10531.16it/s]26277it [00:02, 10520.94it/s]27329it [00:02, 10474.29it/s]28381it [00:02, 10487.66it/s]29430it [00:02, 10481.83it/s]30483it [00:02, 10495.01it/s]31536it [00:03, 10502.93it/s]32593it [00:03, 10521.03it/s]33651it [00:03, 10537.36it/s]34709it [00:03, 10547.88it/s]35770it [00:03, 10564.14it/s]36827it [00:03, 10527.00it/s]37880it [00:03, 10503.96it/s]38935it [00:03, 10517.44it/s]39987it [00:03, 10500.69it/s]41041it [00:03, 10510.85it/s]42093it [00:04, 10512.31it/s]43148it [00:04, 10521.12it/s]44205it [00:04, 10535.46it/s]45259it [00:04, 10535.24it/s]46313it [00:04, 10525.70it/s]47366it [00:04, 10513.36it/s]48418it [00:04, 10492.87it/s]49468it [00:04, 10468.57it/s]50515it [00:04, 10395.24it/s]51560it [00:04, 10408.92it/s]52601it [00:05, 10388.61it/s]53640it [00:05, 10355.25it/s]54676it [00:05, 10326.08it/s]55709it [00:05, 10278.42it/s]56737it [00:05, 10271.28it/s]57767it [00:05, 10278.94it/s]58800it [00:05, 10291.52it/s]59837it [00:05, 10313.77it/s]60869it [00:05, 10309.39it/s]61865it [00:05, 10463.55it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 1645.78it/s]100% 165/165 [00:00<00:00, 1642.80it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 382988.47it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5140.50it/s]
Total scaffolds = 117 | train scaffolds = 95 | val scaffolds = 10 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 83.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 304.55it/s]
Validation prc-auc = 0.352300
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 314.84it/s]
Validation prc-auc = 0.558475
  7% 2/30 [00:00<00:02, 13.58it/s]Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 317.80it/s]
Validation prc-auc = 0.572020
Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 3.0408e-03, PNorm = 26.0172, GNorm = 0.9265, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 102.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.93it/s]
Validation prc-auc = 0.589895
 13% 4/30 [00:00<00:01, 13.79it/s]Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.68it/s]
Validation prc-auc = 0.611976
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.06it/s]
Validation prc-auc = 0.611976
 20% 6/30 [00:00<00:01, 15.06it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.46it/s]
Validation prc-auc = 0.622180
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.2252e-03, PNorm = 26.0717, GNorm = 0.4548, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 101.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.66it/s]
Validation prc-auc = 0.562656
 27% 8/30 [00:00<00:01, 16.10it/s]Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.38it/s]
Validation prc-auc = 0.576601
Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.96it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.57it/s]
Validation prc-auc = 0.562656
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 311.06it/s]
Validation prc-auc = 0.548370
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 9.1740e-04, PNorm = 26.1016, GNorm = 0.4501, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 104.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.26it/s]
Validation prc-auc = 0.548370
 40% 12/30 [00:00<00:00, 18.71it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.37it/s]
Validation prc-auc = 0.548370
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.78it/s]
Validation prc-auc = 0.548370
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.06it/s]
Validation prc-auc = 0.548370
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 2.7041e-04, PNorm = 26.1201, GNorm = 0.1319, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 104.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.77it/s]
Validation prc-auc = 0.548370
 53% 16/30 [00:00<00:00, 21.11it/s]Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.70it/s]
Validation prc-auc = 0.548370
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.75it/s]
Validation prc-auc = 0.548370
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.4627e-04, PNorm = 26.1275, GNorm = 0.3324, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 104.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.53it/s]
Validation prc-auc = 0.548370
 63% 19/30 [00:00<00:00, 23.16it/s]Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.86it/s]
Validation prc-auc = 0.548370
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.88it/s]
Validation prc-auc = 0.548370
Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.65it/s]
Validation prc-auc = 0.548370
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 4.7302e-04, PNorm = 26.1310, GNorm = 0.2095, lr_0 = 1.0000e-04
Loss = 6.7211e-04, PNorm = 26.1314, GNorm = 0.2085, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 102.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.87it/s]
Validation prc-auc = 0.548370
 77% 23/30 [00:00<00:00, 24.86it/s]Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 309.15it/s]
Validation prc-auc = 0.548370
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.02it/s]
Validation prc-auc = 0.548370
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.75it/s]
Validation prc-auc = 0.548370
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.8073e-04, PNorm = 26.1363, GNorm = 0.2174, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 104.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.98it/s]
Validation prc-auc = 0.548370
 90% 27/30 [00:01<00:00, 26.25it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 80.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 274.75it/s]
Validation prc-auc = 0.548370
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.89it/s]
Validation prc-auc = 0.548370
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 308.72it/s]
Validation prc-auc = 0.548370
100% 30/30 [00:01<00:00, 26.52it/s]100% 30/30 [00:01<00:00, 24.23it/s]
Model 0 best validation prc-auc = 0.622180 on epoch 6
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 235.05it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:258: RuntimeWarning: Mean of empty slice
  avg_test_score = np.nanmean(test_scores)
Model 0 test prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:282: RuntimeWarning: Mean of empty slice
  avg_ensemble_test_score = np.nanmean(ensemble_scores)
Ensemble test prc-auc = nan
Fold 4
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1738019
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1738019',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpemmjhomc/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1051it [00:00, 10506.80it/s]2120it [00:00, 10558.02it/s]3187it [00:00, 10589.24it/s]4247it [00:00, 10591.55it/s]5326it [00:00, 10649.89it/s]6413it [00:00, 10714.60it/s]7501it [00:00, 10761.14it/s]8581it [00:00, 10772.63it/s]9661it [00:00, 10779.93it/s]10746it [00:01, 10800.55it/s]11825it [00:01, 10794.45it/s]12910it [00:01, 10810.11it/s]13997it [00:01, 10827.64it/s]15086it [00:01, 10844.21it/s]16168it [00:01, 10836.69it/s]17247it [00:01, 10813.87it/s]18325it [00:01, 10799.78it/s]19403it [00:01, 10771.68it/s]20480it [00:01, 10768.97it/s]21565it [00:02, 10792.67it/s]22648it [00:02, 10801.77it/s]23728it [00:02, 10794.79it/s]24808it [00:02, 10778.79it/s]25904it [00:02, 10830.26it/s]26993it [00:02, 10848.10it/s]28087it [00:02, 10874.43it/s]29179it [00:02, 10885.35it/s]30268it [00:02, 10880.61it/s]31366it [00:02, 10908.96it/s]32457it [00:03, 10852.70it/s]33549it [00:03, 10871.61it/s]34639it [00:03, 10877.52it/s]35728it [00:03, 10880.33it/s]36817it [00:03, 10695.95it/s]37905it [00:03, 10749.78it/s]38997it [00:03, 10799.75it/s]40094it [00:03, 10847.57it/s]41194it [00:03, 10891.28it/s]42286it [00:03, 10897.96it/s]43377it [00:04, 10900.73it/s]44470it [00:04, 10907.16it/s]45561it [00:04, 10816.84it/s]46643it [00:04, 10807.28it/s]47724it [00:04, 10734.75it/s]48798it [00:04, 10682.64it/s]49888it [00:04, 10745.75it/s]50973it [00:04, 10775.30it/s]52060it [00:04, 10801.41it/s]53141it [00:04, 10795.50it/s]54221it [00:05, 10725.28it/s]55294it [00:05, 10704.33it/s]56365it [00:05, 10704.53it/s]57448it [00:05, 10739.74it/s]58523it [00:05, 10670.04it/s]59614it [00:05, 10738.17it/s]60708it [00:05, 10797.88it/s]61800it [00:05, 10832.27it/s]61865it [00:05, 10795.76it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 1637.66it/s]100% 165/165 [00:00<00:00, 1634.09it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 384477.87it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5164.86it/s]
Total scaffolds = 117 | train scaffolds = 91 | val scaffolds = 14 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([3])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 93.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.44it/s]
Validation prc-auc = 0.620753
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 298.89it/s]
Validation prc-auc = 0.603364
  7% 2/30 [00:00<00:01, 18.62it/s]Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 291.45it/s]
Validation prc-auc = 0.687780
Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 2.5638e-03, PNorm = 26.0284, GNorm = 0.6061, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 103.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 281.72it/s]
Validation prc-auc = 0.702174
 13% 4/30 [00:00<00:01, 17.16it/s]Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 289.78it/s]
Validation prc-auc = 0.702174
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  4.85it/s][A100% 3/3 [00:00<00:00, 13.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 269.89it/s]
Validation prc-auc = 0.715052
 20% 6/30 [00:00<00:02, 11.58it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 279.64it/s]
Validation prc-auc = 0.698819
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.7246e-04, PNorm = 26.0863, GNorm = 0.3336, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 103.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 281.29it/s]
Validation prc-auc = 0.694571
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 280.65it/s]
Validation prc-auc = 0.694571
 30% 9/30 [00:00<00:01, 14.15it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.26it/s]
Validation prc-auc = 0.681692
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.22it/s]
Validation prc-auc = 0.667298
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.7912e-04, PNorm = 26.1151, GNorm = 0.2827, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 104.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 281.33it/s]
Validation prc-auc = 0.652147
 40% 12/30 [00:00<00:01, 16.79it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 285.77it/s]
Validation prc-auc = 0.652147
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.44it/s]
Validation prc-auc = 0.652147
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.99it/s]
Validation prc-auc = 0.652147
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.3218e-03, PNorm = 26.1289, GNorm = 0.4307, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 105.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.83it/s]
Validation prc-auc = 0.652147
 53% 16/30 [00:00<00:00, 19.34it/s]Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.10it/s]
Validation prc-auc = 0.652147
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 281.74it/s]
Validation prc-auc = 0.652147
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.6028e-04, PNorm = 26.1346, GNorm = 0.2983, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 105.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.61it/s]
Validation prc-auc = 0.652147
 63% 19/30 [00:00<00:00, 21.63it/s]Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.48it/s]
Validation prc-auc = 0.652147
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.53it/s]
Validation prc-auc = 0.652147
Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 285.04it/s]
Validation prc-auc = 0.652147
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 4.3315e-04, PNorm = 26.1393, GNorm = 0.1663, lr_0 = 1.0000e-04
Loss = 8.4946e-04, PNorm = 26.1397, GNorm = 0.2821, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 102.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 286.77it/s]
Validation prc-auc = 0.652147
 77% 23/30 [00:01<00:00, 23.56it/s]Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.92it/s]
Validation prc-auc = 0.652147
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.16it/s]
Validation prc-auc = 0.652147
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 286.83it/s]
Validation prc-auc = 0.652147
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 9.4281e-04, PNorm = 26.1451, GNorm = 0.2619, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 105.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 288.63it/s]
Validation prc-auc = 0.652147
 90% 27/30 [00:01<00:00, 25.18it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.03it/s]
Validation prc-auc = 0.652147
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.84it/s]
Validation prc-auc = 0.652147
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 281.61it/s]
Validation prc-auc = 0.652147
100% 30/30 [00:01<00:00, 22.17it/s]
Model 0 best validation prc-auc = 0.715052 on epoch 5
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 294.94it/s]
Model 0 test prc-auc = 0.791045
Ensemble test prc-auc = 0.791045
5-fold cross validation
Seed 0 ==> test prc-auc = 0.953725
Seed 1 ==> test prc-auc = 0.592929
Seed 2 ==> test prc-auc = 0.585117
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/cross_validate.py:38: RuntimeWarning: Mean of empty slice
  info(f'Seed {init_seed + fold_num} ==> test {args.metric} = {np.nanmean(scores):.6f}')
Seed 3 ==> test prc-auc = nan
Seed 4 ==> test prc-auc = 0.791045
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/cross_validate.py:45: RuntimeWarning: Mean of empty slice
  avg_scores = np.nanmean(all_scores, axis=1)  # average score for each model across tasks
Overall test prc-auc = 0.730704 +/- 0.152935
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/utils.py:38: RuntimeWarning: Mean of empty slice
  avg_scores = np.nanmean(all_scores, axis=1)

wandb: Waiting for W&B process to finish, PID 8483
wandb: Program ended successfully.
wandb: Run summary:
wandb:          _timestamp 1596825954.3845778
wandb:   test_prc-auc_mean 0.7307041793526586
wandb:               _step 0
wandb:    test_prc-auc_std 0.15293545569326816
wandb:            _runtime 42.99751162528992
wandb: Syncing 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: \ 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: | 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced CHEMBL1738019: https://app.wandb.ai/apappu97/molecule-metalearning/runs/387sco3m
