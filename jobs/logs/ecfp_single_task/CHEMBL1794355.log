wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200807_194842-a7a4qn6w
wandb: Syncing run CHEMBL1794355
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/a7a4qn6w
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794355 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1794355
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1794355',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp9r5ayv_p/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794355'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]507it [00:00, 5068.52it/s]1310it [00:00, 5697.88it/s]2318it [00:00, 6551.22it/s]3309it [00:00, 7291.75it/s]4318it [00:00, 7952.98it/s]5329it [00:00, 8495.06it/s]6339it [00:00, 8919.69it/s]7344it [00:00, 9230.71it/s]8352it [00:00, 9468.41it/s]9404it [00:01, 9759.77it/s]10512it [00:01, 10119.26it/s]11629it [00:01, 10411.98it/s]12745it [00:01, 10623.10it/s]13864it [00:01, 10786.55it/s]14980it [00:01, 10894.79it/s]16093it [00:01, 10963.78it/s]17215it [00:01, 11036.80it/s]18339it [00:01, 11095.01it/s]19450it [00:01, 11021.42it/s]20554it [00:02, 11023.33it/s]21658it [00:02, 10983.29it/s]22781it [00:02, 11054.28it/s]23900it [00:02, 11093.79it/s]25010it [00:02, 11061.46it/s]26128it [00:02, 11094.26it/s]27246it [00:02, 11117.44it/s]28358it [00:02, 11107.42it/s]29469it [00:02, 11107.16it/s]30587it [00:02, 11126.67it/s]31704it [00:03, 11136.89it/s]32824it [00:03, 11152.84it/s]33945it [00:03, 11169.05it/s]35062it [00:03, 11148.65it/s]36181it [00:03, 11158.93it/s]37297it [00:03, 10975.18it/s]38406it [00:03, 11008.23it/s]39526it [00:03, 11062.91it/s]40644it [00:03, 11095.25it/s]41760it [00:03, 11113.58it/s]42879it [00:04, 11135.81it/s]43995it [00:04, 11142.57it/s]45110it [00:04, 11107.02it/s]46221it [00:04, 11084.26it/s]47330it [00:04, 11072.44it/s]48438it [00:04, 10993.56it/s]49538it [00:04, 10937.13it/s]50640it [00:04, 10961.74it/s]51737it [00:04, 10956.21it/s]52833it [00:04, 10915.15it/s]53925it [00:05, 10908.29it/s]55016it [00:05, 10908.48it/s]56107it [00:05, 10888.46it/s]57213it [00:05, 10937.00it/s]58319it [00:05, 10972.44it/s]59425it [00:05, 10996.10it/s]60525it [00:05, 10991.36it/s]61625it [00:05, 10851.99it/s]61865it [00:05, 10760.85it/s]
  0% 0/304 [00:00<?, ?it/s] 51% 155/304 [00:00<00:00, 1540.47it/s]100% 304/304 [00:00<00:00, 1560.00it/s]
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 422768.04it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 4778.28it/s]
Total scaffolds = 251 | train scaffolds = 198 | val scaffolds = 28 | test scaffolds = 25
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1794355 0: 5.26%, 1: 94.74%
Total size = 304 | train size = 243 | val size = 30 | test size = 31
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A
 20% 1/5 [00:00<00:00,  4.98it/s][A
 60% 3/5 [00:00<00:00,  6.29it/s][A
100% 5/5 [00:00<00:00,  7.82it/s][A100% 5/5 [00:00<00:00, 11.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 28.63it/s]
Validation prc-auc = 0.998831
  3% 1/30 [00:00<00:15,  1.93it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.14it/s]
Validation prc-auc = 0.998831
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.6529e-03, PNorm = 26.1090, GNorm = 0.8453, lr_0 = 9.2106e-04

 20% 1/5 [00:00<00:00,  4.78it/s][A100% 5/5 [00:00<00:00, 19.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.82it/s]
Validation prc-auc = 0.998831
 10% 3/30 [00:00<00:11,  2.43it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.50it/s]
Validation prc-auc = 0.996366
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9765e-04, PNorm = 26.3590, GNorm = 0.1647, lr_0 = 7.4989e-04
100% 5/5 [00:00<00:00, 92.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.36it/s]
Validation prc-auc = 0.995064
 17% 5/30 [00:00<00:07,  3.26it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.73it/s]
Validation prc-auc = 0.993712
Epoch 6

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.9544e-04, PNorm = 26.4477, GNorm = 0.3299, lr_0 = 6.1054e-04
100% 5/5 [00:00<00:00, 85.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.57it/s]
Validation prc-auc = 0.993712
 23% 7/30 [00:01<00:05,  4.28it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.09it/s]
Validation prc-auc = 0.993712
Epoch 8

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.4910e-04, PNorm = 26.4782, GNorm = 0.1462, lr_0 = 4.8697e-04
100% 5/5 [00:00<00:00, 92.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.49it/s]
Validation prc-auc = 0.993712
 30% 9/30 [00:01<00:03,  5.49it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.65it/s]
Validation prc-auc = 0.993712
Epoch 10

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.2316e-04, PNorm = 26.4899, GNorm = 0.2430, lr_0 = 3.9647e-04
100% 5/5 [00:00<00:00, 92.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.21it/s]
Validation prc-auc = 0.993712
 37% 11/30 [00:01<00:02,  6.85it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.22it/s]
Validation prc-auc = 0.993712
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.5871e-05, PNorm = 26.4961, GNorm = 0.0765, lr_0 = 3.2280e-04
100% 5/5 [00:00<00:00, 92.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.36it/s]
Validation prc-auc = 0.993712
 43% 13/30 [00:01<00:02,  8.28it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.08it/s]
Validation prc-auc = 0.993712
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.7313e-05, PNorm = 26.5029, GNorm = 0.0874, lr_0 = 2.6281e-04
100% 5/5 [00:00<00:00, 92.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.36it/s]
Validation prc-auc = 0.993712
 50% 15/30 [00:01<00:01,  9.71it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.44it/s]
Validation prc-auc = 0.993712
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.2510e-05, PNorm = 26.5079, GNorm = 0.0572, lr_0 = 2.0962e-04
100% 5/5 [00:00<00:00, 92.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.13it/s]
Validation prc-auc = 0.993712
 57% 17/30 [00:01<00:01, 11.04it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.56it/s]
Validation prc-auc = 0.993712
Epoch 18

  0% 0/5 [00:00<?, ?it/s][ALoss = 9.3885e-05, PNorm = 26.5102, GNorm = 0.0357, lr_0 = 1.7066e-04
100% 5/5 [00:00<00:00, 92.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.72it/s]
Validation prc-auc = 0.993712
 63% 19/30 [00:01<00:00, 12.21it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.45it/s]
Validation prc-auc = 0.993712
Epoch 20

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.2081e-05, PNorm = 26.5131, GNorm = 0.0360, lr_0 = 1.3895e-04
100% 5/5 [00:00<00:00, 92.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.26it/s]
Validation prc-auc = 0.993712
 70% 21/30 [00:01<00:00, 13.20it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.02it/s]
Validation prc-auc = 0.993712
Epoch 22

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.6339e-05, PNorm = 26.5166, GNorm = 0.1162, lr_0 = 1.1083e-04
100% 5/5 [00:00<00:00, 92.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.72it/s]
Validation prc-auc = 0.993712
 77% 23/30 [00:02<00:00, 13.98it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.95it/s]
Validation prc-auc = 0.993712
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.1165e-04, PNorm = 26.5191, GNorm = 0.0739, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.86it/s]
Validation prc-auc = 0.993712
 83% 25/30 [00:02<00:00, 14.63it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.07it/s]
Validation prc-auc = 0.993712
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.2103e-05, PNorm = 26.5215, GNorm = 0.0600, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.78it/s]
Validation prc-auc = 0.993712
 90% 27/30 [00:02<00:00, 15.12it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 88.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.08it/s]
Validation prc-auc = 0.993712
Epoch 28

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.7335e-05, PNorm = 26.5243, GNorm = 0.0407, lr_0 = 1.0000e-04
Loss = 6.7064e-05, PNorm = 26.5245, GNorm = 0.0433, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 91.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.19it/s]
Validation prc-auc = 0.993712
 97% 29/30 [00:02<00:00, 15.30it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][A
 40% 2/5 [00:00<00:00, 19.14it/s][A100% 5/5 [00:00<00:00, 36.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.68it/s]
Validation prc-auc = 0.993712
100% 30/30 [00:02<00:00, 11.56it/s]
Model 0 best validation prc-auc = 0.998831 on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 30.10it/s]
Model 0 test prc-auc = 0.957497
Ensemble test prc-auc = 0.957497
Fold 1
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794355 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1794355
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1794355',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp9r5ayv_p/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794355'],
 'task_names': ['CHEMBL1794355'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 243,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1072it [00:00, 10711.51it/s]2143it [00:00, 10710.28it/s]3212it [00:00, 10702.07it/s]4279it [00:00, 10691.48it/s]5354it [00:00, 10707.87it/s]6427it [00:00, 10712.29it/s]7502it [00:00, 10722.28it/s]8575it [00:00, 10723.58it/s]9656it [00:00, 10747.20it/s]10741it [00:01, 10777.07it/s]11828it [00:01, 10801.75it/s]12905it [00:01, 10789.30it/s]13986it [00:01, 10794.83it/s]15070it [00:01, 10807.82it/s]16151it [00:01, 10805.97it/s]17227it [00:01, 10782.83it/s]18309it [00:01, 10793.19it/s]19395it [00:01, 10812.24it/s]20482it [00:01, 10828.95it/s]21564it [00:02, 10710.47it/s]22647it [00:02, 10744.98it/s]23734it [00:02, 10781.72it/s]24814it [00:02, 10784.67it/s]25898it [00:02, 10799.34it/s]26978it [00:02, 10770.84it/s]28070it [00:02, 10814.86it/s]29164it [00:02, 10851.47it/s]30257it [00:02, 10873.08it/s]31345it [00:02, 10850.91it/s]32431it [00:03, 10722.55it/s]33525it [00:03, 10784.95it/s]34604it [00:03, 10613.23it/s]35695it [00:03, 10699.79it/s]36790it [00:03, 10773.14it/s]37873it [00:03, 10787.99it/s]38978it [00:03, 10864.56it/s]40077it [00:03, 10899.89it/s]41181it [00:03, 10941.22it/s]42276it [00:03, 10895.45it/s]43367it [00:04, 10899.30it/s]44466it [00:04, 10923.61it/s]45559it [00:04, 10906.50it/s]46654it [00:04, 10917.95it/s]47748it [00:04, 10921.63it/s]48843it [00:04, 10928.63it/s]49940it [00:04, 10940.43it/s]51035it [00:04, 10910.80it/s]52128it [00:04, 10915.99it/s]53220it [00:04, 10896.23it/s]54310it [00:05, 10854.30it/s]55396it [00:05, 10792.86it/s]56481it [00:05, 10807.56it/s]57578it [00:05, 10853.53it/s]58685it [00:05, 10916.12it/s]59781it [00:05, 10926.77it/s]60878it [00:05, 10938.07it/s]61865it [00:05, 10827.60it/s]
  0% 0/304 [00:00<?, ?it/s] 22% 68/304 [00:00<00:00, 675.70it/s] 60% 181/304 [00:00<00:00, 767.20it/s]100% 304/304 [00:00<00:00, 1058.76it/s]
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 358971.96it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 4328.35it/s]
Total scaffolds = 251 | train scaffolds = 199 | val scaffolds = 25 | test scaffolds = 27
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1794355 0: 5.26%, 1: 94.74%
Total size = 304 | train size = 243 | val size = 30 | test size = 31
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 79.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.31it/s]
Validation prc-auc = 0.962091
  3% 1/30 [00:00<00:03,  9.04it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 88.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.62it/s]
Validation prc-auc = 0.905920
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 3.3768e-03, PNorm = 26.1204, GNorm = 1.6974, lr_0 = 9.2106e-04
100% 5/5 [00:00<00:00, 86.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.63it/s]
Validation prc-auc = 0.905920
 10% 3/30 [00:00<00:02, 10.30it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.18it/s]
Validation prc-auc = 0.905920
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.8610e-04, PNorm = 26.3986, GNorm = 0.1756, lr_0 = 7.4989e-04
100% 5/5 [00:00<00:00, 86.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.50it/s]
Validation prc-auc = 0.920288
 17% 5/30 [00:00<00:02, 11.41it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 88.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.43it/s]
Validation prc-auc = 0.920288
Epoch 6

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0968e-04, PNorm = 26.4889, GNorm = 0.2198, lr_0 = 6.1054e-04
100% 5/5 [00:00<00:00, 87.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.71it/s]
Validation prc-auc = 0.920288
 23% 7/30 [00:00<00:01, 12.34it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 90.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.63it/s]
Validation prc-auc = 0.920288
Epoch 8

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.3384e-04, PNorm = 26.5223, GNorm = 0.1732, lr_0 = 4.8697e-04
100% 5/5 [00:00<00:00, 92.90it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.05it/s]
Validation prc-auc = 0.920288
 30% 9/30 [00:00<00:01, 13.23it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.37it/s]
Validation prc-auc = 0.920288
Epoch 10

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.3748e-04, PNorm = 26.5317, GNorm = 0.4256, lr_0 = 3.9647e-04
100% 5/5 [00:00<00:00, 87.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.89it/s]
Validation prc-auc = 0.920288
 37% 11/30 [00:00<00:01, 13.90it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 96.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.60it/s]
Validation prc-auc = 0.920288
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.6970e-04, PNorm = 26.5370, GNorm = 0.2282, lr_0 = 3.2280e-04
100% 5/5 [00:00<00:00, 89.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.38it/s]
Validation prc-auc = 0.920288
 43% 13/30 [00:00<00:01, 14.47it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.32it/s]
Validation prc-auc = 0.920288
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 4.6281e-05, PNorm = 26.5417, GNorm = 0.0306, lr_0 = 2.6281e-04
100% 5/5 [00:00<00:00, 93.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.10it/s]
Validation prc-auc = 0.920288
 50% 15/30 [00:01<00:01, 14.99it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.54it/s]
Validation prc-auc = 0.920288
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.2043e-05, PNorm = 26.5459, GNorm = 0.0577, lr_0 = 2.0962e-04
100% 5/5 [00:00<00:00, 93.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.58it/s]
Validation prc-auc = 0.920288
 57% 17/30 [00:01<00:00, 15.40it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 96.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.16it/s]
Validation prc-auc = 0.920288
Epoch 18

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.1740e-05, PNorm = 26.5497, GNorm = 0.0457, lr_0 = 1.7066e-04
100% 5/5 [00:00<00:00, 94.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.24it/s]
Validation prc-auc = 0.920288
 63% 19/30 [00:01<00:00, 15.73it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 96.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.79it/s]
Validation prc-auc = 0.920288
Epoch 20

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.8755e-05, PNorm = 26.5531, GNorm = 0.0619, lr_0 = 1.3895e-04
100% 5/5 [00:00<00:00, 89.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.90it/s]
Validation prc-auc = 0.920288
 70% 21/30 [00:01<00:00, 15.84it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 96.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.90it/s]
Validation prc-auc = 0.920288
Epoch 22

  0% 0/5 [00:00<?, ?it/s][A
 60% 3/5 [00:00<00:00, 19.37it/s][ALoss = 1.3863e-04, PNorm = 26.5558, GNorm = 0.0360, lr_0 = 1.1083e-04
100% 5/5 [00:00<00:00, 28.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.86it/s]
Validation prc-auc = 0.920288
 77% 23/30 [00:01<00:00, 12.33it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.42it/s]
Validation prc-auc = 0.920288
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.5427e-05, PNorm = 26.5582, GNorm = 0.1775, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.59it/s]
Validation prc-auc = 0.920288
 83% 25/30 [00:01<00:00, 13.20it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.71it/s]
Validation prc-auc = 0.920288
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.8614e-05, PNorm = 26.5598, GNorm = 0.0502, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.98it/s]
Validation prc-auc = 0.920288
 90% 27/30 [00:01<00:00, 14.03it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.71it/s]
Validation prc-auc = 0.920288
Epoch 28

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.6011e-04, PNorm = 26.5614, GNorm = 0.3312, lr_0 = 1.0000e-04
Loss = 6.2301e-05, PNorm = 26.5615, GNorm = 0.0371, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 91.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.59it/s]
Validation prc-auc = 0.920288
 97% 29/30 [00:01<00:00, 14.63it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.16it/s]
Validation prc-auc = 0.920288
100% 30/30 [00:02<00:00, 14.64it/s]
Model 0 best validation prc-auc = 0.962091 on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 134.86it/s]
Model 0 test prc-auc = 0.991467
Ensemble test prc-auc = 0.991467
Fold 2
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794355 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1794355
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1794355',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp9r5ayv_p/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794355'],
 'task_names': ['CHEMBL1794355'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 243,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1058it [00:00, 10577.59it/s]2125it [00:00, 10602.25it/s]3180it [00:00, 10585.78it/s]4238it [00:00, 10581.99it/s]5302it [00:00, 10598.00it/s]6373it [00:00, 10630.17it/s]7438it [00:00, 10633.63it/s]8499it [00:00, 10625.16it/s]9573it [00:00, 10656.86it/s]10629it [00:01, 10627.24it/s]11701it [00:01, 10654.44it/s]12772it [00:01, 10670.72it/s]13837it [00:01, 10664.05it/s]14900it [00:01, 10650.99it/s]15969it [00:01, 10660.80it/s]17044it [00:01, 10686.17it/s]18110it [00:01, 10677.20it/s]19183it [00:01, 10691.55it/s]20254it [00:01, 10697.01it/s]21323it [00:02, 10678.69it/s]22391it [00:02, 10661.91it/s]23457it [00:02, 10601.32it/s]24518it [00:02, 10602.00it/s]25578it [00:02, 10580.41it/s]26642it [00:02, 10597.15it/s]27706it [00:02, 10607.61it/s]28774it [00:02, 10626.39it/s]29845it [00:02, 10651.14it/s]30912it [00:02, 10653.95it/s]31978it [00:03, 10587.42it/s]33039it [00:03, 10594.17it/s]34101it [00:03, 10599.57it/s]35162it [00:03, 10551.75it/s]36218it [00:03, 10548.92it/s]37273it [00:03, 10547.81it/s]38337it [00:03, 10573.64it/s]39404it [00:03, 10602.34it/s]40467it [00:03, 10608.39it/s]41528it [00:03, 10481.93it/s]42585it [00:04, 10505.82it/s]43647it [00:04, 10538.96it/s]44702it [00:04, 10485.09it/s]45758it [00:04, 10505.59it/s]46822it [00:04, 10543.93it/s]47877it [00:04, 10489.35it/s]48939it [00:04, 10527.72it/s]49992it [00:04, 10376.02it/s]51052it [00:04, 10441.79it/s]52112it [00:04, 10487.69it/s]53162it [00:05, 10385.37it/s]54209it [00:05, 10410.13it/s]55254it [00:05, 10419.13it/s]56297it [00:05, 10354.36it/s]57368it [00:05, 10458.52it/s]58437it [00:05, 10525.43it/s]59503it [00:05, 10563.87it/s]60560it [00:05, 10460.21it/s]61607it [00:05, 10453.88it/s]61865it [00:05, 10563.67it/s]
  0% 0/304 [00:00<?, ?it/s] 47% 143/304 [00:00<00:00, 1427.57it/s] 98% 299/304 [00:00<00:00, 1464.03it/s]100% 304/304 [00:00<00:00, 1491.06it/s]
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 360087.10it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 4446.54it/s]
Total scaffolds = 251 | train scaffolds = 198 | val scaffolds = 23 | test scaffolds = 30
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1794355 0: 5.26%, 1: 94.74%
Total size = 304 | train size = 243 | val size = 30 | test size = 31
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 70.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.64it/s]
Validation prc-auc = 0.836585
  3% 1/30 [00:00<00:03,  8.52it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 91.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.07it/s]
Validation prc-auc = 0.811192
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 3.1678e-03, PNorm = 26.1152, GNorm = 1.2589, lr_0 = 9.2106e-04
100% 5/5 [00:00<00:00, 91.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.58it/s]
Validation prc-auc = 0.791195
 10% 3/30 [00:00<00:02,  9.91it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.18it/s]
Validation prc-auc = 0.791195
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 9.3102e-04, PNorm = 26.3892, GNorm = 0.7127, lr_0 = 7.4989e-04
100% 5/5 [00:00<00:00, 91.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.11it/s]
Validation prc-auc = 0.796901
 17% 5/30 [00:00<00:02, 11.19it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.98it/s]
Validation prc-auc = 0.794083
Epoch 6

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.5203e-04, PNorm = 26.4883, GNorm = 0.2372, lr_0 = 6.1054e-04
100% 5/5 [00:00<00:00, 91.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.59it/s]
Validation prc-auc = 0.796901
 23% 7/30 [00:00<00:01, 12.31it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.66it/s]
Validation prc-auc = 0.794083
Epoch 8

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.3980e-04, PNorm = 26.5271, GNorm = 0.2355, lr_0 = 4.8697e-04
100% 5/5 [00:00<00:00, 91.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.95it/s]
Validation prc-auc = 0.793325
 30% 9/30 [00:00<00:01, 13.24it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.73it/s]
Validation prc-auc = 0.793325
Epoch 10

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.4919e-05, PNorm = 26.5407, GNorm = 0.0638, lr_0 = 3.9647e-04
100% 5/5 [00:00<00:00, 91.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.52it/s]
Validation prc-auc = 0.793325
 37% 11/30 [00:00<00:01, 13.99it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.10it/s]
Validation prc-auc = 0.793325
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.7888e-04, PNorm = 26.5492, GNorm = 0.0345, lr_0 = 3.2280e-04
100% 5/5 [00:00<00:00, 82.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.51it/s]
Validation prc-auc = 0.793325
 43% 13/30 [00:00<00:01, 14.38it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.37it/s]
Validation prc-auc = 0.793325
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.0368e-04, PNorm = 26.5543, GNorm = 0.0928, lr_0 = 2.6281e-04
100% 5/5 [00:00<00:00, 92.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.53it/s]
Validation prc-auc = 0.793325
 50% 15/30 [00:00<00:01, 14.86it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.45it/s]
Validation prc-auc = 0.793325
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.8831e-05, PNorm = 26.5584, GNorm = 0.1158, lr_0 = 2.0962e-04
100% 5/5 [00:00<00:00, 91.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.57it/s]
Validation prc-auc = 0.793325
 57% 17/30 [00:01<00:00, 15.22it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.93it/s]
Validation prc-auc = 0.793325
Epoch 18

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.5727e-05, PNorm = 26.5609, GNorm = 0.0304, lr_0 = 1.7066e-04
100% 5/5 [00:00<00:00, 92.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.26it/s]
Validation prc-auc = 0.793325
 63% 19/30 [00:01<00:00, 15.48it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][A
 20% 1/5 [00:00<00:00,  4.95it/s][A100% 5/5 [00:00<00:00, 20.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.94it/s]
Validation prc-auc = 0.795472
Epoch 20

  0% 0/5 [00:00<?, ?it/s][ALoss = 3.6121e-04, PNorm = 26.5627, GNorm = 0.6846, lr_0 = 1.3895e-04
100% 5/5 [00:00<00:00, 90.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.12it/s]
Validation prc-auc = 0.795472
 70% 21/30 [00:01<00:00, 10.75it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.62it/s]
Validation prc-auc = 0.795472
Epoch 22

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.1887e-05, PNorm = 26.5636, GNorm = 0.0438, lr_0 = 1.1083e-04
100% 5/5 [00:00<00:00, 88.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.88it/s]
Validation prc-auc = 0.795472
 77% 23/30 [00:01<00:00, 11.88it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.89it/s]
Validation prc-auc = 0.795472
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 4.7565e-05, PNorm = 26.5649, GNorm = 0.0418, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 90.44it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.29it/s]
Validation prc-auc = 0.795472
 83% 25/30 [00:01<00:00, 12.85it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.33it/s]
Validation prc-auc = 0.795472
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.5152e-05, PNorm = 26.5664, GNorm = 0.0385, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 88.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.79it/s]
Validation prc-auc = 0.795472
 90% 27/30 [00:01<00:00, 13.60it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.36it/s]
Validation prc-auc = 0.795472
Epoch 28

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.4640e-05, PNorm = 26.5672, GNorm = 0.1754, lr_0 = 1.0000e-04
Loss = 7.9539e-05, PNorm = 26.5672, GNorm = 0.0652, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 89.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.43it/s]
Validation prc-auc = 0.795472
 97% 29/30 [00:02<00:00, 14.19it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.46it/s]
Validation prc-auc = 0.795472
100% 30/30 [00:02<00:00, 14.08it/s]
Model 0 best validation prc-auc = 0.836585 on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 131.18it/s]
Model 0 test prc-auc = 0.984350
Ensemble test prc-auc = 0.984350
Fold 3
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794355 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1794355
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1794355',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp9r5ayv_p/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794355'],
 'task_names': ['CHEMBL1794355'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 243,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1037it [00:00, 10367.49it/s]2100it [00:00, 10444.15it/s]3135it [00:00, 10415.66it/s]4182it [00:00, 10431.62it/s]5239it [00:00, 10471.32it/s]6288it [00:00, 10475.37it/s]7311it [00:00, 10399.10it/s]8335it [00:00, 10348.24it/s]9352it [00:00, 10293.09it/s]10380it [00:01, 10287.79it/s]11407it [00:01, 10280.19it/s]12422it [00:01, 10239.31it/s]13452it [00:01, 10256.84it/s]14472it [00:01, 10238.32it/s]15502it [00:01, 10256.56it/s]16531it [00:01, 10264.31it/s]17560it [00:01, 10271.15it/s]18595it [00:01, 10294.39it/s]19634it [00:01, 10322.47it/s]20679it [00:02, 10358.36it/s]21718it [00:02, 10366.12it/s]22755it [00:02, 10365.77it/s]23792it [00:02, 10306.71it/s]24837it [00:02, 10347.46it/s]25885it [00:02, 10386.19it/s]26924it [00:02, 10349.40it/s]27973it [00:02, 10389.01it/s]29020it [00:02, 10411.17it/s]30062it [00:02, 10379.87it/s]31101it [00:03, 10381.45it/s]32140it [00:03, 10382.16it/s]33179it [00:03, 10267.57it/s]34207it [00:03, 10251.57it/s]35233it [00:03, 10237.03it/s]36257it [00:03, 10228.87it/s]37280it [00:03, 10218.76it/s]38302it [00:03, 10069.01it/s]39333it [00:03, 10137.41it/s]40358it [00:03, 10168.36it/s]41382it [00:04, 10188.52it/s]42402it [00:04, 10154.21it/s]43434it [00:04, 10201.51it/s]44472it [00:04, 10252.16it/s]45511it [00:04, 10290.92it/s]46541it [00:04, 10210.66it/s]47563it [00:04, 10200.26it/s]48592it [00:04, 10224.80it/s]49616it [00:04, 10227.89it/s]50639it [00:04, 10225.49it/s]51662it [00:05, 10223.74it/s]52685it [00:05, 10144.37it/s]53700it [00:05, 10124.22it/s]54713it [00:05, 9928.52it/s] 55721it [00:05, 9971.26it/s]56734it [00:05, 10016.45it/s]57753it [00:05, 10067.85it/s]58777it [00:05, 10116.20it/s]59799it [00:05, 10144.70it/s]60816it [00:05, 10149.78it/s]61832it [00:06, 10139.98it/s]61865it [00:06, 10249.43it/s]
  0% 0/304 [00:00<?, ?it/s] 47% 142/304 [00:00<00:00, 1418.31it/s] 98% 299/304 [00:00<00:00, 1459.92it/s]100% 304/304 [00:00<00:00, 1492.26it/s]
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 347524.78it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 4646.80it/s]
Total scaffolds = 251 | train scaffolds = 197 | val scaffolds = 27 | test scaffolds = 27
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.5]), array([2])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1794355 0: 5.26%, 1: 94.74%
Total size = 304 | train size = 243 | val size = 30 | test size = 31
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 51.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 96.71it/s]
Validation prc-auc = 0.958179
  3% 1/30 [00:00<00:04,  6.81it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.68it/s]
Validation prc-auc = 0.927900
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.8325e-03, PNorm = 26.1143, GNorm = 1.4790, lr_0 = 9.2106e-04
100% 5/5 [00:00<00:00, 92.87it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.46it/s]
Validation prc-auc = 0.901395
 10% 3/30 [00:00<00:03,  8.26it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.23it/s]
Validation prc-auc = 0.896109
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.5380e-04, PNorm = 26.3904, GNorm = 0.1190, lr_0 = 7.4989e-04
100% 5/5 [00:00<00:00, 93.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.94it/s]
Validation prc-auc = 0.894656
 17% 5/30 [00:00<00:02,  9.70it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.76it/s]
Validation prc-auc = 0.894656
Epoch 6

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.4015e-04, PNorm = 26.4942, GNorm = 0.1603, lr_0 = 6.1054e-04
100% 5/5 [00:00<00:00, 93.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.16it/s]
Validation prc-auc = 0.894656
 23% 7/30 [00:00<00:02, 11.05it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.60it/s]
Validation prc-auc = 0.894656
Epoch 8

  0% 0/5 [00:00<?, ?it/s][ALoss = 3.2992e-04, PNorm = 26.5255, GNorm = 0.6068, lr_0 = 4.8697e-04
100% 5/5 [00:00<00:00, 93.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.35it/s]
Validation prc-auc = 0.894656
 30% 9/30 [00:00<00:01, 12.24it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.68it/s]
Validation prc-auc = 0.891561
Epoch 10

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.4444e-04, PNorm = 26.5373, GNorm = 0.0897, lr_0 = 3.9647e-04
100% 5/5 [00:00<00:00, 93.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.48it/s]
Validation prc-auc = 0.891561
 37% 11/30 [00:00<00:01, 13.24it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.69it/s]
Validation prc-auc = 0.891561
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.2191e-04, PNorm = 26.5443, GNorm = 0.0290, lr_0 = 3.2280e-04

 80% 4/5 [00:00<00:00, 17.24it/s][A100% 5/5 [00:00<00:00, 20.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.83it/s]
Validation prc-auc = 0.891561
 43% 13/30 [00:01<00:01, 10.04it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.10it/s]
Validation prc-auc = 0.891561
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.0421e-05, PNorm = 26.5495, GNorm = 0.0721, lr_0 = 2.6281e-04
100% 5/5 [00:00<00:00, 91.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.76it/s]
Validation prc-auc = 0.891561
 50% 15/30 [00:01<00:01, 11.30it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.54it/s]
Validation prc-auc = 0.891561
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.5217e-05, PNorm = 26.5561, GNorm = 0.0586, lr_0 = 2.0962e-04
100% 5/5 [00:00<00:00, 91.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.34it/s]
Validation prc-auc = 0.891561
 57% 17/30 [00:01<00:01, 12.41it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.08it/s]
Validation prc-auc = 0.891561
Epoch 18

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.9121e-05, PNorm = 26.5600, GNorm = 0.0553, lr_0 = 1.7066e-04
100% 5/5 [00:00<00:00, 91.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.60it/s]
Validation prc-auc = 0.891561
 63% 19/30 [00:01<00:00, 13.33it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.62it/s]
Validation prc-auc = 0.891561
Epoch 20

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.5208e-05, PNorm = 26.5624, GNorm = 0.1278, lr_0 = 1.3895e-04
100% 5/5 [00:00<00:00, 91.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.80it/s]
Validation prc-auc = 0.891561
 70% 21/30 [00:01<00:00, 14.05it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.90it/s]
Validation prc-auc = 0.891561
Epoch 22

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.1351e-04, PNorm = 26.5641, GNorm = 0.2637, lr_0 = 1.1083e-04
100% 5/5 [00:00<00:00, 91.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.98it/s]
Validation prc-auc = 0.891561
 77% 23/30 [00:01<00:00, 14.61it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.10it/s]
Validation prc-auc = 0.891561
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 4.3255e-05, PNorm = 26.5669, GNorm = 0.0213, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 91.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.58it/s]
Validation prc-auc = 0.891561
 83% 25/30 [00:01<00:00, 14.92it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.26it/s]
Validation prc-auc = 0.891561
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.2062e-04, PNorm = 26.5691, GNorm = 0.5208, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 91.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.20it/s]
Validation prc-auc = 0.891561
 90% 27/30 [00:01<00:00, 15.25it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.01it/s]
Validation prc-auc = 0.891561
Epoch 28

  0% 0/5 [00:00<?, ?it/s][ALoss = 6.9562e-05, PNorm = 26.5702, GNorm = 0.0543, lr_0 = 1.0000e-04
Loss = 1.1717e-04, PNorm = 26.5704, GNorm = 0.1098, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 90.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.76it/s]
Validation prc-auc = 0.891561
 97% 29/30 [00:02<00:00, 15.47it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 93.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.49it/s]
Validation prc-auc = 0.891561
100% 30/30 [00:02<00:00, 14.08it/s]
Model 0 best validation prc-auc = 0.958179 on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 154.20it/s]
Model 0 test prc-auc = 0.805293
Ensemble test prc-auc = 0.805293
Fold 4
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794355 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1794355
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1794355',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp9r5ayv_p/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794355'],
 'task_names': ['CHEMBL1794355'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 243,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]572it [00:00, 5713.13it/s]1404it [00:00, 6304.94it/s]2449it [00:00, 7156.03it/s]3510it [00:00, 7930.22it/s]4571it [00:00, 8579.24it/s]5635it [00:00, 9107.91it/s]6699it [00:00, 9517.77it/s]7764it [00:00, 9830.52it/s]8821it [00:00, 10039.82it/s]9886it [00:01, 10214.06it/s]10926it [00:01, 10267.06it/s]11992it [00:01, 10379.14it/s]13052it [00:01, 10442.79it/s]14108it [00:01, 10476.45it/s]15166it [00:01, 10505.56it/s]16217it [00:01, 10502.79it/s]17272it [00:01, 10515.18it/s]18327it [00:01, 10522.96it/s]19380it [00:01, 10506.46it/s]20432it [00:02, 10510.12it/s]21484it [00:02, 10504.11it/s]22547it [00:02, 10541.37it/s]23606it [00:02, 10553.91it/s]24662it [00:02, 9460.62it/s] 25630it [00:02, 8469.51it/s]26554it [00:02, 8686.69it/s]27501it [00:02, 8905.48it/s]28446it [00:02, 9060.46it/s]29392it [00:02, 9176.63it/s]30340it [00:03, 9264.05it/s]31288it [00:03, 9325.89it/s]32226it [00:03, 9297.72it/s]33180it [00:03, 9366.64it/s]34203it [00:03, 9609.16it/s]35253it [00:03, 9858.96it/s]36299it [00:03, 10029.29it/s]37336it [00:03, 10128.52it/s]38380it [00:03, 10219.66it/s]39427it [00:03, 10291.56it/s]40458it [00:04, 10280.19it/s]41492it [00:04, 10297.38it/s]42544it [00:04, 10362.60it/s]43595it [00:04, 10405.62it/s]44637it [00:04, 10374.98it/s]45675it [00:04, 10346.81it/s]46730it [00:04, 10405.25it/s]47771it [00:04, 10387.54it/s]48818it [00:04, 10411.75it/s]49866it [00:04, 10430.79it/s]50914it [00:05, 10442.84it/s]51961it [00:05, 10449.03it/s]53006it [00:05, 10436.91it/s]54050it [00:05, 10361.45it/s]55087it [00:05, 10308.55it/s]56119it [00:05, 10278.57it/s]57156it [00:05, 10305.82it/s]58193it [00:05, 10323.07it/s]59226it [00:05, 10286.31it/s]60264it [00:05, 10311.50it/s]61296it [00:06, 10293.02it/s]61865it [00:06, 10055.64it/s]
  0% 0/304 [00:00<?, ?it/s] 50% 151/304 [00:00<00:00, 1506.50it/s]100% 304/304 [00:00<00:00, 1548.48it/s]
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 377798.05it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/304 [00:00<?, ?it/s]100% 304/304 [00:00<00:00, 4701.60it/s]
Total scaffolds = 251 | train scaffolds = 198 | val scaffolds = 25 | test scaffolds = 28
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([0.66666667]), array([3])), (array([1.]), array([4])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1794355 0: 5.26%, 1: 94.74%
Total size = 304 | train size = 243 | val size = 30 | test size = 31
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 77.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.95it/s]
Validation prc-auc = 0.966409
  3% 1/30 [00:00<00:03,  9.11it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.49it/s]
Validation prc-auc = 0.947939
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 3.7857e-03, PNorm = 26.1124, GNorm = 1.9787, lr_0 = 9.2106e-04
100% 5/5 [00:00<00:00, 89.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 172.57it/s]
Validation prc-auc = 0.946021
 10% 3/30 [00:00<00:02, 10.43it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 91.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 173.00it/s]
Validation prc-auc = 0.949132
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.4835e-04, PNorm = 26.3796, GNorm = 0.3892, lr_0 = 7.4989e-04
100% 5/5 [00:00<00:00, 88.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 172.81it/s]
Validation prc-auc = 0.949132
 17% 5/30 [00:00<00:02, 11.63it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 91.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 173.02it/s]
Validation prc-auc = 0.947106
Epoch 6

  0% 0/5 [00:00<?, ?it/s][ALoss = 4.6690e-04, PNorm = 26.4739, GNorm = 0.5508, lr_0 = 6.1054e-04
100% 5/5 [00:00<00:00, 89.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.60it/s]
Validation prc-auc = 0.947106
 23% 7/30 [00:00<00:01, 12.64it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][A
100% 5/5 [00:00<00:00, 30.29it/s][A100% 5/5 [00:00<00:00, 30.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.83it/s]
Validation prc-auc = 0.947106
Epoch 8

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.5466e-04, PNorm = 26.5074, GNorm = 0.2649, lr_0 = 4.8697e-04
100% 5/5 [00:00<00:00, 87.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.30it/s]
Validation prc-auc = 0.947106
 30% 9/30 [00:00<00:01, 10.98it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.62it/s]
Validation prc-auc = 0.947106
Epoch 10

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.1748e-04, PNorm = 26.5208, GNorm = 0.0963, lr_0 = 3.9647e-04
100% 5/5 [00:00<00:00, 87.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.98it/s]
Validation prc-auc = 0.949132
 37% 11/30 [00:00<00:01, 12.05it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.66it/s]
Validation prc-auc = 0.949132
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.0255e-04, PNorm = 26.5310, GNorm = 0.0888, lr_0 = 3.2280e-04
100% 5/5 [00:00<00:00, 87.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.74it/s]
Validation prc-auc = 0.949132
 43% 13/30 [00:00<00:01, 12.93it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.62it/s]
Validation prc-auc = 0.949132
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.7790e-04, PNorm = 26.5360, GNorm = 0.2243, lr_0 = 2.6281e-04
100% 5/5 [00:00<00:00, 87.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.24it/s]
Validation prc-auc = 0.951994
 50% 15/30 [00:01<00:01, 13.64it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.57it/s]
Validation prc-auc = 0.951994
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.7375e-05, PNorm = 26.5393, GNorm = 0.0392, lr_0 = 2.0962e-04
100% 5/5 [00:00<00:00, 87.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.62it/s]
Validation prc-auc = 0.951994
 57% 17/30 [00:01<00:00, 14.18it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 75.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.49it/s]
Validation prc-auc = 0.951994
Epoch 18

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.8042e-04, PNorm = 26.5426, GNorm = 0.3629, lr_0 = 1.7066e-04
100% 5/5 [00:00<00:00, 87.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.59it/s]
Validation prc-auc = 0.951994
 63% 19/30 [00:01<00:00, 14.26it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.64it/s]
Validation prc-auc = 0.951994
Epoch 20

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.0603e-05, PNorm = 26.5449, GNorm = 0.0345, lr_0 = 1.3895e-04
100% 5/5 [00:00<00:00, 87.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.39it/s]
Validation prc-auc = 0.951994
 70% 21/30 [00:01<00:00, 14.65it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.90it/s]
Validation prc-auc = 0.951994
Epoch 22

  0% 0/5 [00:00<?, ?it/s][ALoss = 8.5173e-05, PNorm = 26.5478, GNorm = 0.1906, lr_0 = 1.1083e-04
100% 5/5 [00:00<00:00, 87.96it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 169.04it/s]
Validation prc-auc = 0.951994
 77% 23/30 [00:01<00:00, 14.93it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 87.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.69it/s]
Validation prc-auc = 0.951994
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 7.4603e-05, PNorm = 26.5497, GNorm = 0.1257, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 86.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.55it/s]
Validation prc-auc = 0.951994
 83% 25/30 [00:01<00:00, 15.04it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.82it/s]
Validation prc-auc = 0.951994
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 5.3291e-05, PNorm = 26.5518, GNorm = 0.1072, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 87.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.59it/s]
Validation prc-auc = 0.949132
 90% 27/30 [00:01<00:00, 15.23it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.03it/s]
Validation prc-auc = 0.949132
Epoch 28

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.2543e-04, PNorm = 26.5525, GNorm = 0.0420, lr_0 = 1.0000e-04
Loss = 6.2718e-05, PNorm = 26.5525, GNorm = 0.0565, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 86.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.62it/s]
Validation prc-auc = 0.949132
 97% 29/30 [00:02<00:00, 15.32it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 89.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.53it/s]
Validation prc-auc = 0.949132
100% 30/30 [00:02<00:00, 14.40it/s]
Model 0 best validation prc-auc = 0.966409 on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 141.72it/s]
Model 0 test prc-auc = 0.937011
Ensemble test prc-auc = 0.937011
5-fold cross validation
Seed 0 ==> test prc-auc = 0.957497
Seed 1 ==> test prc-auc = 0.991467
Seed 2 ==> test prc-auc = 0.984350
Seed 3 ==> test prc-auc = 0.805293
Seed 4 ==> test prc-auc = 0.937011
Overall test prc-auc = 0.935124 +/- 0.067761

wandb: Waiting for W&B process to finish, PID 9247
wandb: Program ended successfully.
wandb: Run summary:
wandb:               _step 0
wandb:          _timestamp 1596826169.9287193
wandb:    test_prc-auc_std 0.06776127168601769
wandb:   test_prc-auc_mean 0.9351236173505946
wandb:            _runtime 48.54497480392456
wandb: Syncing 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: \ 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: | 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb: / 0.06MB of 0.06MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced CHEMBL1794355: https://app.wandb.ai/apappu97/molecule-metalearning/runs/a7a4qn6w
