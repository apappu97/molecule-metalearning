wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200807_221401-3jerebsc
wandb: Syncing run CHEMBL1963934
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/3jerebsc
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --seeds 0 4 5 6 12 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963934 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1963934
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1963934',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp6dl2d18_/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'seeds': [0, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963934'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]487it [00:00, 4863.93it/s]1257it [00:00, 5466.91it/s]2248it [00:00, 6315.71it/s]3250it [00:00, 7102.92it/s]4249it [00:00, 7777.11it/s]5250it [00:00, 8333.51it/s]6224it [00:00, 8710.77it/s]7218it [00:00, 9044.17it/s]8185it [00:00, 9221.83it/s]9208it [00:01, 9501.55it/s]10255it [00:01, 9771.63it/s]11365it [00:01, 10134.02it/s]12422it [00:01, 10258.99it/s]13531it [00:01, 10492.96it/s]14586it [00:01, 10490.43it/s]15684it [00:01, 10631.52it/s]16751it [00:01, 10599.00it/s]17857it [00:01, 10731.24it/s]18933it [00:01, 10660.08it/s]20037it [00:02, 10770.05it/s]21116it [00:02, 10692.92it/s]22219it [00:02, 10790.75it/s]23300it [00:02, 10726.21it/s]24410it [00:02, 10835.07it/s]25495it [00:02, 10800.70it/s]26576it [00:02, 10794.94it/s]27666it [00:02, 10826.22it/s]28749it [00:02, 10753.84it/s]29833it [00:02, 10777.51it/s]30927it [00:03, 10823.92it/s]32010it [00:03, 10686.69it/s]33103it [00:03, 10756.47it/s]34213it [00:03, 10856.15it/s]35307it [00:03, 10879.43it/s]36396it [00:03, 10827.65it/s]37502it [00:03, 10894.55it/s]38592it [00:03, 10831.20it/s]39701it [00:03, 10906.19it/s]40792it [00:03, 10794.82it/s]41890it [00:04, 10849.58it/s]42991it [00:04, 10894.93it/s]44096it [00:04, 10939.09it/s]45191it [00:04, 10740.87it/s]46292it [00:04, 10817.28it/s]47391it [00:04, 10865.66it/s]48479it [00:04, 10829.15it/s]49577it [00:04, 10873.25it/s]50686it [00:04, 10934.79it/s]51791it [00:04, 10966.56it/s]52888it [00:05, 8843.36it/s] 53839it [00:05, 9017.14it/s]54824it [00:05, 9248.80it/s]55802it [00:05, 9399.54it/s]56767it [00:05, 9391.18it/s]57742it [00:05, 9494.68it/s]58738it [00:05, 9629.34it/s]59739it [00:05, 9738.28it/s]60754it [00:05, 9856.51it/s]61849it [00:06, 10159.47it/s]61865it [00:06, 10276.56it/s]
  0% 0/165 [00:00<?, ?it/s] 94% 155/165 [00:00<00:00, 1539.98it/s]100% 165/165 [00:00<00:00, 1543.87it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 290537.43it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 4936.97it/s]
Total scaffolds = 134 | train scaffolds = 111 | val scaffolds = 9 | test scaffolds = 14
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([3])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963934 0: 3.64%, 1: 96.36%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  4.90it/s][A100% 3/3 [00:00<00:00, 10.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 58.16it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:220: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
  3% 1/30 [00:00<00:09,  3.17it/s]Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 94.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.7403e-04, PNorm = 26.1132, GNorm = 0.2980, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 99.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 13% 4/30 [00:00<00:06,  4.33it/s]Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.42it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.86it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.43it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 23% 7/30 [00:00<00:03,  5.82it/s]Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.9750e-04, PNorm = 26.2476, GNorm = 0.0926, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 99.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  5.31it/s][A100% 3/3 [00:00<00:00, 14.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 30% 9/30 [00:00<00:03,  6.37it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.1122e-05, PNorm = 26.2890, GNorm = 0.0306, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 100.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 40% 12/30 [00:00<00:02,  8.32it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.77it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.1988e-05, PNorm = 26.3033, GNorm = 0.0499, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 101.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.21it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 53% 16/30 [00:01<00:01, 10.62it/s]Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.25it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 92.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 277.03it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.6806e-05, PNorm = 26.3086, GNorm = 0.0768, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 98.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.29it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 63% 19/30 [00:01<00:00, 13.06it/s]Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.74it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.58it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 6.5611e-05, PNorm = 26.3120, GNorm = 0.0396, lr_0 = 1.0000e-04
Loss = 7.9993e-05, PNorm = 26.3123, GNorm = 0.0410, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 97.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.21it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 77% 23/30 [00:01<00:00, 15.70it/s]Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.66it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.31it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.6503e-05, PNorm = 26.3156, GNorm = 0.0742, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 100.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.80it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 90% 27/30 [00:01<00:00, 18.33it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 89.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 255.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 97.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.01it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 301.10it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
100% 30/30 [00:01<00:00, 20.44it/s]100% 30/30 [00:01<00:00, 20.22it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 46.87it/s]
Model 0 test prc-auc = 0.968633
Ensemble test prc-auc = 0.968633
Fold 1
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --seeds 0 4 5 6 12 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963934 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1963934
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1963934',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp6dl2d18_/fold_1',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [0, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963934'],
 'task_names': ['CHEMBL1963934'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]853it [00:00, 8524.58it/s]1949it [00:00, 9131.94it/s]3054it [00:00, 9633.38it/s]4152it [00:00, 9999.87it/s]5257it [00:00, 10292.50it/s]6364it [00:00, 10512.78it/s]7466it [00:00, 10659.91it/s]8571it [00:00, 10771.94it/s]9680it [00:00, 10864.83it/s]10796it [00:01, 10949.39it/s]11915it [00:01, 11019.77it/s]13032it [00:01, 11063.27it/s]14141it [00:01, 11068.89it/s]15248it [00:01, 11068.20it/s]16358it [00:01, 11075.97it/s]17471it [00:01, 11090.54it/s]18582it [00:01, 11095.86it/s]19699it [00:01, 11115.06it/s]20810it [00:01, 11094.66it/s]21921it [00:02, 11097.38it/s]23038it [00:02, 11117.18it/s]24150it [00:02, 11107.95it/s]25261it [00:02, 11093.17it/s]26378it [00:02, 11113.51it/s]27490it [00:02, 11112.78it/s]28602it [00:02, 11101.09it/s]29716it [00:02, 11111.78it/s]30828it [00:02, 10974.68it/s]31941it [00:02, 11017.94it/s]33048it [00:03, 11033.37it/s]34152it [00:03, 11007.11it/s]35253it [00:03, 10972.29it/s]36358it [00:03, 10994.09it/s]37470it [00:03, 11030.43it/s]38586it [00:03, 11067.72it/s]39696it [00:03, 11075.86it/s]40813it [00:03, 11103.22it/s]41927it [00:03, 11113.63it/s]43042it [00:03, 11123.70it/s]44165it [00:04, 11155.13it/s]45287it [00:04, 11172.33it/s]46405it [00:04, 11167.12it/s]47522it [00:04, 11136.45it/s]48636it [00:04, 11108.30it/s]49749it [00:04, 11111.96it/s]50861it [00:04, 11106.58it/s]51979it [00:04, 11127.98it/s]53096it [00:04, 11137.97it/s]54210it [00:04, 11092.27it/s]55320it [00:05, 11056.88it/s]56426it [00:05, 11045.11it/s]57540it [00:05, 11071.79it/s]58658it [00:05, 11101.17it/s]59778it [00:05, 11130.60it/s]60896it [00:05, 11143.17it/s]61865it [00:05, 11042.79it/s]
  0% 0/165 [00:00<?, ?it/s] 98% 162/165 [00:00<00:00, 1618.60it/s]100% 165/165 [00:00<00:00, 1615.41it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 382776.64it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 4735.11it/s]
Total scaffolds = 134 | train scaffolds = 109 | val scaffolds = 10 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([3])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963934 0: 3.64%, 1: 96.36%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 87.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 270.20it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:220: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 280.20it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 10% 3/30 [00:00<00:00, 27.68it/s]Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.0211e-03, PNorm = 26.1150, GNorm = 0.9702, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 99.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 277.07it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 281.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 20% 6/30 [00:00<00:00, 28.01it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 279.01it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.1090e-04, PNorm = 26.2446, GNorm = 0.0600, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 100.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 285.02it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.05it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 30% 9/30 [00:00<00:00, 28.30it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.05it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 287.46it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.7983e-05, PNorm = 26.2833, GNorm = 0.0633, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 99.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 288.63it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 40% 12/30 [00:00<00:00, 28.48it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 288.72it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 290.02it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 50% 15/30 [00:00<00:00, 28.70it/s]Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.7436e-05, PNorm = 26.2937, GNorm = 0.0341, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 99.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.84it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 282.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 84.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 287.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 60% 18/30 [00:00<00:00, 28.23it/s]Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.8763e-05, PNorm = 26.2975, GNorm = 0.0724, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 100.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 288.92it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 286.42it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.44it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 70% 21/30 [00:00<00:00, 28.45it/s]Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 22

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  7.23it/s][ALoss = 8.5450e-05, PNorm = 26.3002, GNorm = 0.0641, lr_0 = 1.0000e-04
Loss = 1.0607e-04, PNorm = 26.3005, GNorm = 0.0659, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 18.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.73it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 80% 24/30 [00:00<00:00, 20.77it/s]Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 289.20it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 286.54it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.6385e-05, PNorm = 26.3029, GNorm = 0.0580, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 94.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 285.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 90% 27/30 [00:01<00:00, 22.60it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 285.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 286.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
100% 30/30 [00:01<00:00, 24.15it/s]100% 30/30 [00:01<00:00, 25.39it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 245.90it/s]
Model 0 test prc-auc = 0.972768
Ensemble test prc-auc = 0.972768
Fold 2
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --seeds 0 4 5 6 12 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963934 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1963934
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1963934',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp6dl2d18_/fold_2',
 'save_smiles_splits': False,
 'seed': 5,
 'seeds': [0, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963934'],
 'task_names': ['CHEMBL1963934'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1035it [00:00, 10341.43it/s]2087it [00:00, 10392.58it/s]3135it [00:00, 10417.91it/s]4190it [00:00, 10454.59it/s]5245it [00:00, 10481.70it/s]6291it [00:00, 10473.49it/s]7350it [00:00, 10507.27it/s]8406it [00:00, 10520.10it/s]9471it [00:00, 10556.20it/s]10535it [00:01, 10579.11it/s]11586it [00:01, 10557.11it/s]12647it [00:01, 10572.36it/s]13711it [00:01, 10590.97it/s]14774it [00:01, 10600.06it/s]15828it [00:01, 10579.98it/s]16887it [00:01, 10581.62it/s]17942it [00:01, 10550.25it/s]18998it [00:01, 10551.21it/s]20058it [00:01, 10563.36it/s]21117it [00:02, 10570.21it/s]22176it [00:02, 10575.43it/s]23237it [00:02, 10583.91it/s]24295it [00:02, 10578.52it/s]25353it [00:02, 10562.03it/s]26410it [00:02, 10562.12it/s]27467it [00:02, 10550.13it/s]28527it [00:02, 10563.55it/s]29584it [00:02, 10562.82it/s]30642it [00:02, 10567.75it/s]31702it [00:03, 10574.93it/s]32760it [00:03, 10572.85it/s]33820it [00:03, 10580.75it/s]34879it [00:03, 10554.95it/s]35935it [00:03, 10540.21it/s]36990it [00:03, 10536.16it/s]38044it [00:03, 10531.93it/s]39098it [00:03, 10518.08it/s]40151it [00:03, 10520.62it/s]41204it [00:03, 10521.13it/s]42260it [00:04, 10530.05it/s]43314it [00:04, 10530.28it/s]44369it [00:04, 10535.19it/s]45423it [00:04, 10511.05it/s]46475it [00:04, 10452.22it/s]47526it [00:04, 10467.53it/s]48573it [00:04, 10461.42it/s]49622it [00:04, 10469.66it/s]50674it [00:04, 10483.61it/s]51727it [00:04, 10497.45it/s]52777it [00:05, 10466.94it/s]53824it [00:05, 10419.34it/s]54867it [00:05, 10375.43it/s]55905it [00:05, 10352.48it/s]56951it [00:05, 10382.23it/s]57992it [00:05, 10389.15it/s]59045it [00:05, 10430.17it/s]60101it [00:05, 10467.87it/s]61160it [00:05, 10502.05it/s]61865it [00:05, 10518.74it/s]
  0% 0/165 [00:00<?, ?it/s] 94% 155/165 [00:00<00:00, 1547.05it/s]100% 165/165 [00:00<00:00, 1549.50it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 337097.01it/s]
Number of tasks = 1
Splitting data with seed 5
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 4521.79it/s]
Total scaffolds = 134 | train scaffolds = 104 | val scaffolds = 15 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963934 0: 3.64%, 1: 96.36%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 90.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 274.69it/s]
Validation prc-auc = 0.782122
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.09it/s]
Validation prc-auc = 0.782122
  7% 2/30 [00:00<00:01, 18.44it/s]Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 291.39it/s]
Validation prc-auc = 0.782122
Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.1184e-03, PNorm = 26.1262, GNorm = 1.5286, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 99.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 283.04it/s]
Validation prc-auc = 0.782122
Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 289.34it/s]
Validation prc-auc = 0.787346
 17% 5/30 [00:00<00:01, 19.24it/s]Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 287.66it/s]
Validation prc-auc = 0.787346
Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 286.26it/s]
Validation prc-auc = 0.787346
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.3451e-04, PNorm = 26.2741, GNorm = 0.1499, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 99.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 288.86it/s]
Validation prc-auc = 0.787346
 27% 8/30 [00:00<00:01, 21.33it/s]Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 289.94it/s]
Validation prc-auc = 0.787346
Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 289.62it/s]
Validation prc-auc = 0.787346
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 284.55it/s]
Validation prc-auc = 0.787346
 37% 11/30 [00:00<00:00, 23.16it/s]Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.1682e-05, PNorm = 26.3203, GNorm = 0.0288, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 99.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 288.31it/s]
Validation prc-auc = 0.787346
Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 285.52it/s]
Validation prc-auc = 0.787346
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 290.46it/s]
Validation prc-auc = 0.787346
 47% 14/30 [00:00<00:00, 24.57it/s]Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 287.79it/s]
Validation prc-auc = 0.787346
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.4705e-05, PNorm = 26.3357, GNorm = 0.0356, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 99.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 291.78it/s]
Validation prc-auc = 0.787346
Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 290.81it/s]
Validation prc-auc = 0.787346
 57% 17/30 [00:00<00:00, 25.71it/s]Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 291.86it/s]
Validation prc-auc = 0.787346
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.4021e-05, PNorm = 26.3410, GNorm = 0.0747, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 100.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.12it/s]
Validation prc-auc = 0.787346
Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 293.41it/s]
Validation prc-auc = 0.787346
 67% 20/30 [00:00<00:00, 26.63it/s]Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 292.10it/s]
Validation prc-auc = 0.787346
Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.52it/s]
Validation prc-auc = 0.787346
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 4.8154e-05, PNorm = 26.3440, GNorm = 0.0293, lr_0 = 1.0000e-04
Loss = 9.6283e-05, PNorm = 26.3442, GNorm = 0.0434, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 97.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 292.78it/s]
Validation prc-auc = 0.787346
 77% 23/30 [00:00<00:00, 27.23it/s]Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 291.84it/s]
Validation prc-auc = 0.787346
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.05it/s]
Validation prc-auc = 0.787346
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 293.99it/s]
Validation prc-auc = 0.787346
 87% 26/30 [00:00<00:00, 27.83it/s]Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.2578e-05, PNorm = 26.3471, GNorm = 0.0327, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 100.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.32it/s]
Validation prc-auc = 0.787346
Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 297.57it/s]
Validation prc-auc = 0.787346
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.08it/s]
Validation prc-auc = 0.787346
 97% 29/30 [00:01<00:00, 28.22it/s]Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 71.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.94it/s]
Validation prc-auc = 0.787346
100% 30/30 [00:01<00:00, 26.65it/s]
Model 0 best validation prc-auc = 0.787346 on epoch 4
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 242.49it/s]
Model 0 test prc-auc = 0.978213
Ensemble test prc-auc = 0.978213
Fold 3
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --seeds 0 4 5 6 12 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963934 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1963934
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1963934',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp6dl2d18_/fold_3',
 'save_smiles_splits': False,
 'seed': 6,
 'seeds': [0, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963934'],
 'task_names': ['CHEMBL1963934'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1092it [00:00, 10916.47it/s]2192it [00:00, 10940.15it/s]3290it [00:00, 10949.38it/s]4391it [00:00, 10965.54it/s]5492it [00:00, 10978.25it/s]6599it [00:00, 11003.67it/s]7700it [00:00, 11004.95it/s]8796it [00:00, 10989.47it/s]9891it [00:00, 10977.55it/s]10999it [00:01, 11005.84it/s]12107it [00:01, 11027.74it/s]13216it [00:01, 11044.44it/s]14325it [00:01, 11055.35it/s]15432it [00:01, 11058.89it/s]16533it [00:01, 11042.61it/s]17633it [00:01, 11020.37it/s]18732it [00:01, 10992.41it/s]19831it [00:01, 10989.42it/s]20929it [00:01, 10933.99it/s]22033it [00:02, 10964.72it/s]23138it [00:02, 10987.48it/s]24251it [00:02, 11027.05it/s]25363it [00:02, 11051.94it/s]26470it [00:02, 11055.35it/s]27576it [00:02, 11037.17it/s]28684it [00:02, 11047.40it/s]29789it [00:02, 10969.55it/s]30894it [00:02, 10991.99it/s]31996it [00:02, 10998.24it/s]33096it [00:03, 10995.11it/s]34200it [00:03, 11008.41it/s]35301it [00:03, 10969.47it/s]36411it [00:03, 11004.58it/s]37512it [00:03, 10747.35it/s]38619it [00:03, 10840.18it/s]39724it [00:03, 10902.01it/s]40816it [00:03, 10898.19it/s]41907it [00:03, 10900.02it/s]43012it [00:03, 10942.93it/s]44117it [00:04, 10972.25it/s]45215it [00:04, 10970.53it/s]46314it [00:04, 10974.15it/s]47412it [00:04, 10968.59it/s]48509it [00:04, 10894.09it/s]49599it [00:04, 10875.43it/s]50687it [00:04, 10862.68it/s]51775it [00:04, 10865.24it/s]52862it [00:04, 10849.37it/s]53947it [00:04, 10819.90it/s]55030it [00:05, 10818.99it/s]56112it [00:05, 10815.34it/s]57202it [00:05, 10840.43it/s]58305it [00:05, 10894.82it/s]59395it [00:05, 10778.94it/s]60504it [00:05, 10869.18it/s]61614it [00:05, 10937.19it/s]61865it [00:05, 10951.60it/s]
  0% 0/165 [00:00<?, ?it/s] 98% 162/165 [00:00<00:00, 1610.90it/s]100% 165/165 [00:00<00:00, 1608.16it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 407573.71it/s]
Number of tasks = 1
Splitting data with seed 6
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 4831.91it/s]
Total scaffolds = 134 | train scaffolds = 111 | val scaffolds = 9 | test scaffolds = 14
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963934 0: 3.64%, 1: 96.36%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 77.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.25it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:220: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 99.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 311.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 100.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 297.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 10% 3/30 [00:00<00:01, 26.50it/s]Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 9.3778e-04, PNorm = 26.1228, GNorm = 1.0982, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 97.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 297.70it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 297.60it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 304.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 20% 6/30 [00:00<00:00, 27.08it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 304.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.1373e-04, PNorm = 26.2661, GNorm = 0.0820, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 98.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 30% 9/30 [00:00<00:00, 27.56it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 300.37it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 298.89it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.1031e-05, PNorm = 26.3110, GNorm = 0.0332, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 99.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 40% 12/30 [00:00<00:00, 27.92it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 310.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 302.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 299.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 50% 15/30 [00:00<00:00, 28.27it/s]Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.2625e-05, PNorm = 26.3264, GNorm = 0.0360, lr_0 = 1.7066e-04

100% 3/3 [00:00<00:00, 18.34it/s][A100% 3/3 [00:00<00:00, 18.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 274.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 98.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 60% 18/30 [00:00<00:00, 20.48it/s]Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.1755e-04, PNorm = 26.3319, GNorm = 0.0470, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 96.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 100.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 100.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.75it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 70% 21/30 [00:00<00:00, 22.29it/s]Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 100.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.21it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 4.7583e-05, PNorm = 26.3353, GNorm = 0.0268, lr_0 = 1.0000e-04
Loss = 1.0667e-04, PNorm = 26.3356, GNorm = 0.0525, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 94.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 293.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 80% 24/30 [00:00<00:00, 23.72it/s]Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.92it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.54it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 5.9090e-05, PNorm = 26.3387, GNorm = 0.0435, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 83.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 219.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 90% 27/30 [00:01<00:00, 24.58it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 78.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 294.56it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 94.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 295.73it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 296.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
100% 30/30 [00:01<00:00, 25.03it/s]100% 30/30 [00:01<00:00, 24.76it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 199.82it/s]
Model 0 test prc-auc = 0.918501
Ensemble test prc-auc = 0.918501
Fold 4
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --seeds 0 4 5 6 12 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963934 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1963934
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1963934',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmp6dl2d18_/fold_4',
 'save_smiles_splits': False,
 'seed': 12,
 'seeds': [0, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963934'],
 'task_names': ['CHEMBL1963934'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]484it [00:00, 4834.83it/s]1215it [00:00, 5380.91it/s]2154it [00:00, 6171.04it/s]3106it [00:00, 6898.24it/s]4062it [00:00, 7525.49it/s]5014it [00:00, 8030.16it/s]5969it [00:00, 8430.92it/s]6920it [00:00, 8727.31it/s]7876it [00:00, 8959.98it/s]8899it [00:01, 9305.05it/s]9971it [00:01, 9686.99it/s]11044it [00:01, 9975.75it/s]12118it [00:01, 10190.83it/s]13193it [00:01, 10350.90it/s]14266it [00:01, 10460.39it/s]15326it [00:01, 10499.01it/s]16398it [00:01, 10562.05it/s]17466it [00:01, 10596.31it/s]18535it [00:01, 10624.16it/s]19604it [00:02, 10641.55it/s]20670it [00:02, 10645.13it/s]21736it [00:02, 10647.50it/s]22802it [00:02, 10646.51it/s]23867it [00:02, 10636.92it/s]24934it [00:02, 10643.98it/s]25999it [00:02, 10581.26it/s]27061it [00:02, 10590.77it/s]28129it [00:02, 10617.06it/s]29194it [00:02, 10625.46it/s]30257it [00:03, 10621.41it/s]31320it [00:03, 10618.44it/s]32383it [00:03, 10621.36it/s]33447it [00:03, 10626.40it/s]34510it [00:03, 10621.84it/s]35573it [00:03, 10598.86it/s]36635it [00:03, 10602.75it/s]37696it [00:03, 10602.70it/s]38761it [00:03, 10614.69it/s]39827it [00:03, 10628.16it/s]40890it [00:04, 10590.78it/s]41953it [00:04, 10600.78it/s]43014it [00:04, 10595.85it/s]44074it [00:04, 10581.79it/s]45133it [00:04, 10582.40it/s]46192it [00:04, 10578.58it/s]47257it [00:04, 10599.49it/s]48320it [00:04, 10607.74it/s]49383it [00:04, 10611.91it/s]50445it [00:04, 10614.13it/s]51510it [00:05, 10623.50it/s]52573it [00:05, 10621.73it/s]53636it [00:05, 10586.81it/s]54695it [00:05, 10549.01it/s]55750it [00:05, 10489.17it/s]56807it [00:05, 10511.80it/s]57873it [00:05, 10554.32it/s]58941it [00:05, 10589.83it/s]60010it [00:05, 10618.51it/s]61079it [00:05, 10638.22it/s]61865it [00:05, 10333.84it/s]
  0% 0/165 [00:00<?, ?it/s] 95% 156/165 [00:00<00:00, 1553.23it/s]100% 165/165 [00:00<00:00, 1553.43it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 392324.35it/s]
Number of tasks = 1
Splitting data with seed 12
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 4508.12it/s]
Total scaffolds = 134 | train scaffolds = 108 | val scaffolds = 12 | test scaffolds = 14
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([6]))]
Class sizes
CHEMBL1963934 0: 3.64%, 1: 96.36%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 76.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 273.71it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:220: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 1

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 304.60it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 2

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 10% 3/30 [00:00<00:01, 26.91it/s]Epoch 3

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.4887e-04, PNorm = 26.1116, GNorm = 0.2455, lr_0 = 6.9069e-04
100% 3/3 [00:00<00:00, 100.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.85it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 4

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 5

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 20% 6/30 [00:00<00:00, 27.72it/s]Epoch 6

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 7

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.3664e-04, PNorm = 26.2456, GNorm = 0.0523, lr_0 = 4.3940e-04
100% 3/3 [00:00<00:00, 101.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 8

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 83.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 30% 9/30 [00:00<00:00, 27.81it/s]Epoch 9

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 10

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 11

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.1398e-05, PNorm = 26.2871, GNorm = 0.0488, lr_0 = 2.7953e-04
100% 3/3 [00:00<00:00, 100.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 40% 12/30 [00:00<00:00, 28.40it/s]Epoch 12

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 13

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.80it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 14

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.18it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 15

  0% 0/3 [00:00<?, ?it/s][ALoss = 7.7382e-05, PNorm = 26.3006, GNorm = 0.0550, lr_0 = 1.7066e-04
100% 3/3 [00:00<00:00, 100.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 53% 16/30 [00:00<00:00, 28.85it/s]Epoch 16

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 96.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 296.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 17

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.23it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 18

  0% 0/3 [00:00<?, ?it/s][ALoss = 9.2695e-05, PNorm = 26.3054, GNorm = 0.0546, lr_0 = 1.0857e-04
100% 3/3 [00:00<00:00, 100.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 305.15it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 63% 19/30 [00:00<00:00, 28.90it/s]Epoch 19

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.01it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 20

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 21

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 22

  0% 0/3 [00:00<?, ?it/s][ALoss = 1.1535e-04, PNorm = 26.3083, GNorm = 0.0437, lr_0 = 1.0000e-04
Loss = 1.0500e-04, PNorm = 26.3085, GNorm = 0.0500, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 97.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 274.48it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 77% 23/30 [00:00<00:00, 29.15it/s]Epoch 23

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 24

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 306.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 25

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 307.25it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 26

  0% 0/3 [00:00<?, ?it/s][ALoss = 8.2571e-05, PNorm = 26.3110, GNorm = 0.0750, lr_0 = 1.0000e-04
100% 3/3 [00:00<00:00, 93.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 171.51it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 90% 27/30 [00:00<00:00, 29.09it/s]Epoch 27

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 64.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 303.56it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 28

  0% 0/3 [00:00<?, ?it/s][A
 67% 2/3 [00:00<00:00,  8.43it/s][A100% 3/3 [00:00<00:00, 12.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 297.68it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 29

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 304.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
100% 30/30 [00:01<00:00, 17.38it/s]100% 30/30 [00:01<00:00, 23.73it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 190.36it/s]
Model 0 test prc-auc = 0.947687
Ensemble test prc-auc = 0.947687
5-fold cross validation
Seed 0 ==> test prc-auc = 0.968633
Seed 1 ==> test prc-auc = 0.972768
Seed 2 ==> test prc-auc = 0.978213
Seed 3 ==> test prc-auc = 0.918501
Seed 4 ==> test prc-auc = 0.947687
Overall test prc-auc = 0.957160 +/- 0.021921

wandb: Waiting for W&B process to finish, PID 24420
wandb: Program ended successfully.
wandb: Run summary:
wandb:               _step 0
wandb:   test_prc-auc_mean 0.9571602201127897
wandb:    test_prc-auc_std 0.021921209708330357
wandb:          _timestamp 1596834882.7575731
wandb:            _runtime 44.01118516921997
wandb: Syncing 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: \ 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: | 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced CHEMBL1963934: https://app.wandb.ai/apappu97/molecule-metalearning/runs/3jerebsc
