wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200807_194318-hoppf7xq
wandb: Syncing run CHEMBL1614202
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/hoppf7xq
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614202 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1614202
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1614202',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpho_499x4/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614202'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]504it [00:00, 5033.86it/s]1292it [00:00, 5644.33it/s]2283it [00:00, 6481.05it/s]3280it [00:00, 7240.43it/s]4289it [00:00, 7909.07it/s]5305it [00:00, 8472.16it/s]6324it [00:00, 8922.83it/s]7321it [00:00, 9212.56it/s]8329it [00:00, 9455.21it/s]9333it [00:01, 9622.74it/s]10416it [00:01, 9954.55it/s]11533it [00:01, 10289.02it/s]12634it [00:01, 10494.06it/s]13751it [00:01, 10686.54it/s]14874it [00:01, 10841.42it/s]15987it [00:01, 10923.88it/s]17097it [00:01, 10974.22it/s]18213it [00:01, 11026.73it/s]19327it [00:01, 11057.99it/s]20443it [00:02, 11087.79it/s]21562it [00:02, 11115.69it/s]22684it [00:02, 11144.42it/s]23813it [00:02, 11185.61it/s]24944it [00:02, 11222.36it/s]26075it [00:02, 11246.76it/s]27200it [00:02, 11233.81it/s]28324it [00:02, 11230.09it/s]29452it [00:02, 11243.87it/s]30582it [00:02, 11259.73it/s]31709it [00:03, 11256.77it/s]32835it [00:03, 11240.98it/s]33962it [00:03, 11248.67it/s]35087it [00:03, 11179.78it/s]36215it [00:03, 11206.95it/s]37336it [00:03, 11199.02it/s]38456it [00:03, 11155.75it/s]39572it [00:03, 11128.24it/s]40685it [00:03, 11092.34it/s]41795it [00:03, 11026.14it/s]42917it [00:04, 11080.78it/s]44043it [00:04, 11131.50it/s]45163it [00:04, 11150.97it/s]46279it [00:04, 11019.69it/s]47396it [00:04, 11063.37it/s]48503it [00:04, 11057.12it/s]49609it [00:04, 11056.58it/s]50715it [00:04, 11031.12it/s]51819it [00:04, 11022.98it/s]52922it [00:04, 11004.67it/s]54024it [00:05, 11009.18it/s]55128it [00:05, 11016.02it/s]56235it [00:05, 11030.72it/s]57355it [00:05, 11078.23it/s]58476it [00:05, 11115.36it/s]59597it [00:05, 11141.34it/s]60712it [00:05, 10866.07it/s]61801it [00:05, 10843.04it/s]61865it [00:05, 10791.58it/s]
  0% 0/314 [00:00<?, ?it/s] 52% 163/314 [00:00<00:00, 1620.09it/s]100% 314/314 [00:00<00:00, 1602.62it/s]
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 436385.51it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 4814.17it/s]
Total scaffolds = 147 | train scaffolds = 125 | val scaffolds = 5 | test scaffolds = 17
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.94444444]), array([18])), (array([1.]), array([25])), (array([1.]), array([1])), (array([0.5]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.66666667]), array([6])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614202 0: 7.32%, 1: 92.68%
Total size = 314 | train size = 251 | val size = 31 | test size = 32
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A
 17% 1/6 [00:00<00:00,  5.22it/s][A
 50% 3/6 [00:00<00:00,  6.57it/s][A
 83% 5/6 [00:00<00:00,  7.95it/s][A100% 6/6 [00:00<00:00, 13.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 30.76it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/train/run_training.py:220: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
  3% 1/30 [00:00<00:13,  2.10it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 6.1979e-03, PNorm = 26.0288, GNorm = 2.9149, lr_0 = 9.6764e-04
Loss = 2.4215e-02, PNorm = 26.0561, GNorm = 1.3036, lr_0 = 9.5186e-04
100% 6/6 [00:00<00:00, 96.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 10.18it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
  7% 2/30 [00:00<00:10,  2.62it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 102.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.89it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6221e-03, PNorm = 26.2640, GNorm = 0.6363, lr_0 = 7.9433e-04
Loss = 3.6922e-02, PNorm = 26.2756, GNorm = 2.6227, lr_0 = 7.8137e-04
100% 6/6 [00:00<00:00, 101.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.80it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 13% 4/30 [00:00<00:07,  3.48it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.9870e-04, PNorm = 26.3400, GNorm = 0.4514, lr_0 = 6.5206e-04
Loss = 3.3868e-03, PNorm = 26.3427, GNorm = 0.1026, lr_0 = 6.4142e-04
100% 6/6 [00:00<00:00, 100.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 20% 6/30 [00:00<00:05,  4.53it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.1607e-04, PNorm = 26.3633, GNorm = 0.2096, lr_0 = 5.3527e-04
Loss = 1.4662e-04, PNorm = 26.3651, GNorm = 0.0087, lr_0 = 5.2654e-04
100% 6/6 [00:00<00:00, 100.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.45it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 27% 8/30 [00:01<00:03,  5.73it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7454e-04, PNorm = 26.3828, GNorm = 0.1067, lr_0 = 4.3940e-04
Loss = 2.8491e-05, PNorm = 26.3840, GNorm = 0.0020, lr_0 = 4.3223e-04
100% 6/6 [00:00<00:00, 100.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.13it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 33% 10/30 [00:01<00:02,  7.03it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.23it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 11

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.3656e-04, PNorm = 26.3889, GNorm = 0.2092, lr_0 = 3.6070e-04
Loss = 1.0858e-02, PNorm = 26.3895, GNorm = 0.3021, lr_0 = 3.5481e-04
100% 6/6 [00:00<00:00, 100.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 40% 12/30 [00:01<00:02,  8.38it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 13

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.2854e-04, PNorm = 26.3935, GNorm = 0.4919, lr_0 = 2.9609e-04
Loss = 2.0802e-03, PNorm = 26.3938, GNorm = 0.1053, lr_0 = 2.9126e-04
100% 6/6 [00:00<00:00, 98.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 47% 14/30 [00:01<00:01,  9.67it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 15

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.5214e-04, PNorm = 26.3988, GNorm = 0.0861, lr_0 = 2.4306e-04
Loss = 2.0107e-03, PNorm = 26.3990, GNorm = 0.1460, lr_0 = 2.3910e-04
100% 6/6 [00:00<00:00, 101.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 53% 16/30 [00:01<00:01, 10.84it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9641e-04, PNorm = 26.4024, GNorm = 0.4923, lr_0 = 1.9953e-04
Loss = 4.3789e-03, PNorm = 26.4029, GNorm = 0.1353, lr_0 = 1.9627e-04
100% 6/6 [00:00<00:00, 100.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 60% 18/30 [00:01<00:01, 11.87it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9279e-04, PNorm = 26.4052, GNorm = 0.0609, lr_0 = 1.6379e-04
Loss = 2.8959e-02, PNorm = 26.4053, GNorm = 0.9684, lr_0 = 1.6112e-04
100% 6/6 [00:00<00:00, 101.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 67% 20/30 [00:01<00:00, 12.71it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.72it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.3757e-04, PNorm = 26.4068, GNorm = 0.2020, lr_0 = 1.3445e-04
Loss = 1.3649e-04, PNorm = 26.4068, GNorm = 0.0072, lr_0 = 1.3226e-04
100% 6/6 [00:00<00:00, 99.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 73% 22/30 [00:01<00:00, 13.35it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.7477e-04, PNorm = 26.4076, GNorm = 0.3821, lr_0 = 1.1037e-04
Loss = 1.8239e-05, PNorm = 26.4076, GNorm = 0.0013, lr_0 = 1.0857e-04
100% 6/6 [00:00<00:00, 96.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.04it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 80% 24/30 [00:02<00:00, 13.76it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 101.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.79it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.7526e-04, PNorm = 26.4073, GNorm = 0.0541, lr_0 = 1.0000e-04
Loss = 1.2528e-04, PNorm = 26.4074, GNorm = 0.0081, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 143.03it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 87% 26/30 [00:02<00:00, 14.08it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][A
 83% 5/6 [00:00<00:00, 33.90it/s][A100% 6/6 [00:00<00:00, 40.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9922e-04, PNorm = 26.4095, GNorm = 0.2902, lr_0 = 1.0000e-04
Loss = 4.5909e-04, PNorm = 26.4097, GNorm = 0.0338, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.01it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
 93% 28/30 [00:02<00:00, 11.81it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
Epoch 29

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5611e-04, PNorm = 26.4131, GNorm = 0.2682, lr_0 = 1.0000e-04
Loss = 1.3996e-03, PNorm = 26.4135, GNorm = 0.0519, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
WARNING:root:NaN or Inf found in input tensor.
100% 30/30 [00:02<00:00, 12.65it/s]100% 30/30 [00:02<00:00, 11.56it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 27.72it/s]
Model 0 test prc-auc = 0.879535
Ensemble test prc-auc = 0.879535
Fold 1
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614202 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1614202
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1614202',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpho_499x4/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614202'],
 'task_names': ['CHEMBL1614202'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 251,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]687it [00:00, 6863.12it/s]1663it [00:00, 7532.31it/s]2772it [00:00, 8333.83it/s]3872it [00:00, 8987.20it/s]4946it [00:00, 9448.16it/s]6060it [00:00, 9898.60it/s]7168it [00:00, 10224.71it/s]8275it [00:00, 10463.52it/s]9378it [00:00, 10625.40it/s]10483it [00:01, 10748.26it/s]11586it [00:01, 10831.21it/s]12699it [00:01, 10919.14it/s]13805it [00:01, 10958.59it/s]14898it [00:01, 10864.09it/s]16007it [00:01, 10930.75it/s]17102it [00:01, 10934.23it/s]18195it [00:01, 10914.32it/s]19297it [00:01, 10945.16it/s]20397it [00:01, 10959.59it/s]21497it [00:02, 10970.71it/s]22594it [00:02, 10884.44it/s]23695it [00:02, 10918.93it/s]24795it [00:02, 10940.25it/s]25893it [00:02, 10949.01it/s]26992it [00:02, 10961.11it/s]28089it [00:02, 10942.42it/s]29185it [00:02, 10947.60it/s]30288it [00:02, 10970.35it/s]31386it [00:02, 10951.14it/s]32482it [00:03, 10883.97it/s]33576it [00:03, 10900.01it/s]34678it [00:03, 10934.98it/s]35776it [00:03, 10947.21it/s]36887it [00:03, 10992.99it/s]37987it [00:03, 10902.11it/s]39104it [00:03, 10980.94it/s]40222it [00:03, 11038.44it/s]41331it [00:03, 11051.43it/s]42449it [00:03, 11088.59it/s]43566it [00:04, 11112.25it/s]44684it [00:04, 11131.37it/s]45801it [00:04, 11141.41it/s]46925it [00:04, 11168.89it/s]48046it [00:04, 11179.02it/s]49172it [00:04, 11203.11it/s]50294it [00:04, 11205.61it/s]51415it [00:04, 11185.17it/s]52534it [00:04, 11180.92it/s]53653it [00:04, 11146.38it/s]54768it [00:05, 11090.98it/s]55878it [00:05, 11059.46it/s]56989it [00:05, 11071.97it/s]58107it [00:05, 11104.12it/s]59225it [00:05, 11123.94it/s]60338it [00:05, 11120.96it/s]61451it [00:05, 11096.85it/s]61865it [00:05, 10936.08it/s]
  0% 0/314 [00:00<?, ?it/s] 22% 69/314 [00:00<00:00, 689.34it/s] 58% 181/314 [00:00<00:00, 778.06it/s]100% 314/314 [00:00<00:00, 1063.11it/s]
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 345490.94it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 4328.30it/s]
Total scaffolds = 147 | train scaffolds = 109 | val scaffolds = 22 | test scaffolds = 16
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([25])), (array([0.94444444]), array([18])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([13])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614202 0: 7.32%, 1: 92.68%
Total size = 314 | train size = 251 | val size = 31 | test size = 32
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 90.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 143.30it/s]
Validation prc-auc = 0.961451
  3% 1/30 [00:00<00:03,  8.79it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 6.7261e-03, PNorm = 26.0264, GNorm = 2.8214, lr_0 = 9.6764e-04
Loss = 2.4287e-02, PNorm = 26.0553, GNorm = 0.4971, lr_0 = 9.5186e-04
100% 6/6 [00:00<00:00, 90.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 140.27it/s]
Validation prc-auc = 0.936788
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 93.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 140.72it/s]
Validation prc-auc = 0.938662
 10% 3/30 [00:00<00:02,  9.80it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6674e-03, PNorm = 26.2751, GNorm = 1.3354, lr_0 = 7.9433e-04
Loss = 6.9892e-04, PNorm = 26.2847, GNorm = 0.0196, lr_0 = 7.8137e-04
100% 6/6 [00:00<00:00, 92.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 142.17it/s]
Validation prc-auc = 0.933689
Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 88.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 133.09it/s]
Validation prc-auc = 0.926795
 17% 5/30 [00:00<00:02, 10.62it/s]Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 9.1835e-04, PNorm = 26.3320, GNorm = 0.4248, lr_0 = 6.5206e-04
Loss = 5.5989e-04, PNorm = 26.3338, GNorm = 0.0277, lr_0 = 6.4142e-04
100% 6/6 [00:00<00:00, 91.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 142.56it/s]
Validation prc-auc = 0.925906
Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 90.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.35it/s]
Validation prc-auc = 0.925906
 23% 7/30 [00:00<00:02, 11.29it/s]Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.2869e-04, PNorm = 26.3592, GNorm = 0.0646, lr_0 = 5.3527e-04
Loss = 5.4964e-04, PNorm = 26.3611, GNorm = 0.0201, lr_0 = 5.2654e-04
100% 6/6 [00:00<00:00, 98.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.42it/s]
Validation prc-auc = 0.925906
Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.65it/s]
Validation prc-auc = 0.925906
 30% 9/30 [00:00<00:01, 12.14it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.1501e-04, PNorm = 26.3731, GNorm = 0.3567, lr_0 = 4.3940e-04
Loss = 3.6129e-03, PNorm = 26.3736, GNorm = 0.0861, lr_0 = 4.3223e-04
100% 6/6 [00:00<00:00, 100.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.91it/s]
Validation prc-auc = 0.925906
Epoch 10

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.45it/s]
Validation prc-auc = 0.924272
 37% 11/30 [00:00<00:01, 12.83it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.3802e-04, PNorm = 26.3746, GNorm = 1.1320, lr_0 = 3.6070e-04
Loss = 1.7845e-03, PNorm = 26.3746, GNorm = 0.0389, lr_0 = 3.5481e-04
100% 6/6 [00:00<00:00, 100.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.33it/s]
Validation prc-auc = 0.924272
Epoch 12

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.08it/s]
Validation prc-auc = 0.924272
 43% 13/30 [00:00<00:01, 13.39it/s]Epoch 13

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7022e-04, PNorm = 26.3756, GNorm = 0.3070, lr_0 = 2.9609e-04
Loss = 2.8630e-04, PNorm = 26.3759, GNorm = 0.0107, lr_0 = 2.9126e-04
100% 6/6 [00:00<00:00, 100.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.32it/s]
Validation prc-auc = 0.924272
Epoch 14

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.55it/s]
Validation prc-auc = 0.924272
 50% 15/30 [00:01<00:01, 13.80it/s]Epoch 15

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4776e-04, PNorm = 26.3779, GNorm = 0.1828, lr_0 = 2.4306e-04
Loss = 4.9650e-02, PNorm = 26.3777, GNorm = 2.3017, lr_0 = 2.3910e-04
100% 6/6 [00:00<00:00, 100.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.29it/s]
Validation prc-auc = 0.924272
Epoch 16

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.73it/s]
Validation prc-auc = 0.924272
 57% 17/30 [00:01<00:00, 14.08it/s]Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.1607e-04, PNorm = 26.3794, GNorm = 0.3500, lr_0 = 1.9953e-04
Loss = 8.2254e-06, PNorm = 26.3795, GNorm = 0.0006, lr_0 = 1.9627e-04
100% 6/6 [00:00<00:00, 99.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.49it/s]
Validation prc-auc = 0.924272
Epoch 18

  0% 0/6 [00:00<?, ?it/s][A
 67% 4/6 [00:00<00:00, 22.96it/s][A100% 6/6 [00:00<00:00, 31.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.14it/s]
Validation prc-auc = 0.921160
 63% 19/30 [00:01<00:00, 11.15it/s]Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3296e-04, PNorm = 26.3829, GNorm = 0.0383, lr_0 = 1.6379e-04
Loss = 1.0883e-04, PNorm = 26.3833, GNorm = 0.0070, lr_0 = 1.6112e-04
100% 6/6 [00:00<00:00, 79.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.89it/s]
Validation prc-auc = 0.921160
Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 102.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.29it/s]
Validation prc-auc = 0.916040
 70% 21/30 [00:01<00:00, 11.71it/s]Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0062e-04, PNorm = 26.3875, GNorm = 0.3875, lr_0 = 1.3445e-04
Loss = 1.0584e-03, PNorm = 26.3878, GNorm = 0.0399, lr_0 = 1.3226e-04
100% 6/6 [00:00<00:00, 98.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.49it/s]
Validation prc-auc = 0.919449
Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 102.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.45it/s]
Validation prc-auc = 0.919449
 77% 23/30 [00:01<00:00, 12.45it/s]Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5230e-04, PNorm = 26.3908, GNorm = 0.1931, lr_0 = 1.1037e-04
Loss = 2.5055e-03, PNorm = 26.3911, GNorm = 0.0882, lr_0 = 1.0857e-04
100% 6/6 [00:00<00:00, 98.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.70it/s]
Validation prc-auc = 0.919449
Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 84.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 149.43it/s]
Validation prc-auc = 0.919449
 83% 25/30 [00:01<00:00, 12.72it/s]Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.7486e-04, PNorm = 26.3950, GNorm = 0.0554, lr_0 = 1.0000e-04
Loss = 1.0359e-04, PNorm = 26.3953, GNorm = 0.0051, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 99.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.44it/s]
Validation prc-auc = 0.924272
Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.23it/s]
Validation prc-auc = 0.924272
 90% 27/30 [00:02<00:00, 13.27it/s]Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5275e-04, PNorm = 26.3995, GNorm = 0.4316, lr_0 = 1.0000e-04
Loss = 1.0170e-02, PNorm = 26.4000, GNorm = 0.2735, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.41it/s]
Validation prc-auc = 0.924272
Epoch 28

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 102.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.56it/s]
Validation prc-auc = 0.924272
 97% 29/30 [00:02<00:00, 13.65it/s]Epoch 29

  0% 0/6 [00:00<?, ?it/s][ALoss = 9.1286e-05, PNorm = 26.4034, GNorm = 0.0706, lr_0 = 1.0000e-04
Loss = 2.0497e-03, PNorm = 26.4037, GNorm = 0.0591, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 99.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.68it/s]
Validation prc-auc = 0.924272
100% 30/30 [00:02<00:00, 13.12it/s]
Model 0 best validation prc-auc = 0.961451 on epoch 0
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 151.94it/s]
Model 0 test prc-auc = 0.983179
Ensemble test prc-auc = 0.983179
Fold 2
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614202 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1614202
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1614202',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpho_499x4/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614202'],
 'task_names': ['CHEMBL1614202'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 251,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1048it [00:00, 10470.45it/s]2119it [00:00, 10540.58it/s]3181it [00:00, 10563.37it/s]4250it [00:00, 10598.61it/s]5333it [00:00, 10666.09it/s]6406it [00:00, 10684.75it/s]7470it [00:00, 10670.78it/s]8535it [00:00, 10664.16it/s]9607it [00:00, 10679.92it/s]10684it [00:01, 10704.97it/s]11758it [00:01, 10712.42it/s]12822it [00:01, 10687.87it/s]13894it [00:01, 10695.47it/s]14961it [00:01, 10685.93it/s]16030it [00:01, 10686.43it/s]17101it [00:01, 10692.37it/s]18174it [00:01, 10702.45it/s]19242it [00:01, 10662.29it/s]20314it [00:01, 10677.31it/s]21381it [00:02, 10664.93it/s]22447it [00:02, 10648.19it/s]23519it [00:02, 10669.54it/s]24588it [00:02, 10675.04it/s]25662it [00:02, 10691.58it/s]26731it [00:02, 10628.75it/s]27795it [00:02, 10630.25it/s]28858it [00:02, 10586.29it/s]29917it [00:02, 10479.95it/s]30968it [00:02, 10486.03it/s]32052it [00:03, 10587.50it/s]33122it [00:03, 10620.74it/s]34185it [00:03, 10583.08it/s]35265it [00:03, 10645.67it/s]36345it [00:03, 10690.01it/s]37415it [00:03, 10601.84it/s]38476it [00:03, 10574.37it/s]39555it [00:03, 10635.52it/s]40635it [00:03, 10682.00it/s]41710it [00:03, 10701.90it/s]42781it [00:04, 10654.81it/s]43864it [00:04, 10706.47it/s]44945it [00:04, 10735.62it/s]46019it [00:04, 10703.41it/s]47094it [00:04, 10715.13it/s]48167it [00:04, 10718.66it/s]49244it [00:04, 10731.16it/s]50321it [00:04, 10742.47it/s]51397it [00:04, 10745.07it/s]52479it [00:04, 10764.61it/s]53556it [00:05, 10748.28it/s]54631it [00:05, 10720.01it/s]55704it [00:05, 10704.01it/s]56782it [00:05, 10725.46it/s]57868it [00:05, 10762.70it/s]58945it [00:05, 10739.88it/s]60020it [00:05, 10622.43it/s]61098it [00:05, 10666.49it/s]61865it [00:05, 10671.87it/s]
  0% 0/314 [00:00<?, ?it/s] 49% 153/314 [00:00<00:00, 1528.59it/s] 99% 310/314 [00:00<00:00, 1540.63it/s]100% 314/314 [00:00<00:00, 1550.19it/s]
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 403867.36it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 4915.71it/s]
Total scaffolds = 147 | train scaffolds = 116 | val scaffolds = 16 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([25])), (array([0.94444444]), array([18])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([11])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614202 0: 7.32%, 1: 92.68%
Total size = 314 | train size = 251 | val size = 31 | test size = 32
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 94.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 128.32it/s]
Validation prc-auc = 0.813017
  3% 1/30 [00:00<00:03,  9.17it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 6.1011e-03, PNorm = 26.0183, GNorm = 2.3358, lr_0 = 9.6764e-04
Loss = 1.0235e-02, PNorm = 26.0442, GNorm = 0.3671, lr_0 = 9.5186e-04
100% 6/6 [00:00<00:00, 100.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 137.85it/s]
Validation prc-auc = 0.864365
  7% 2/30 [00:00<00:03,  9.30it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.64it/s]
Validation prc-auc = 0.864157
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 8.4904e-04, PNorm = 26.2690, GNorm = 0.4500, lr_0 = 7.9433e-04
Loss = 2.4206e-02, PNorm = 26.2827, GNorm = 1.4319, lr_0 = 7.8137e-04
100% 6/6 [00:00<00:00, 101.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.18it/s]
Validation prc-auc = 0.861435
 13% 4/30 [00:00<00:02, 10.46it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 137.18it/s]
Validation prc-auc = 0.857787
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.7756e-04, PNorm = 26.3694, GNorm = 0.0558, lr_0 = 6.5206e-04
Loss = 2.1825e-04, PNorm = 26.3738, GNorm = 0.0163, lr_0 = 6.4142e-04
100% 6/6 [00:00<00:00, 101.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.10it/s]
Validation prc-auc = 0.828941
 20% 6/30 [00:00<00:02, 11.48it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.69it/s]
Validation prc-auc = 0.827326
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.8862e-04, PNorm = 26.3986, GNorm = 0.0957, lr_0 = 5.3527e-04
Loss = 9.7996e-03, PNorm = 26.4001, GNorm = 0.3768, lr_0 = 5.2654e-04
100% 6/6 [00:00<00:00, 101.44it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.38it/s]
Validation prc-auc = 0.825641
 27% 8/30 [00:00<00:01, 12.31it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.57it/s]
Validation prc-auc = 0.825641
Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4718e-04, PNorm = 26.4121, GNorm = 0.2035, lr_0 = 4.3940e-04
Loss = 5.3106e-04, PNorm = 26.4128, GNorm = 0.0226, lr_0 = 4.3223e-04
100% 6/6 [00:00<00:00, 101.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.99it/s]
Validation prc-auc = 0.825641
 33% 10/30 [00:00<00:01, 12.97it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 137.93it/s]
Validation prc-auc = 0.825641
Epoch 11

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1656e-04, PNorm = 26.4040, GNorm = 0.0407, lr_0 = 3.6070e-04
Loss = 2.0500e-03, PNorm = 26.4031, GNorm = 0.0884, lr_0 = 3.5481e-04
100% 6/6 [00:00<00:00, 101.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 56.69it/s]
Validation prc-auc = 0.825641
 40% 12/30 [00:00<00:01, 13.20it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][A
 83% 5/6 [00:00<00:00, 29.48it/s][A100% 6/6 [00:00<00:00, 34.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 130.66it/s]
Validation prc-auc = 0.825641
Epoch 13

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7290e-04, PNorm = 26.4024, GNorm = 0.0330, lr_0 = 2.9609e-04
Loss = 3.0227e-04, PNorm = 26.4028, GNorm = 0.0098, lr_0 = 2.9126e-04
100% 6/6 [00:00<00:00, 99.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.48it/s]
Validation prc-auc = 0.825641
 47% 14/30 [00:01<00:01, 11.03it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.71it/s]
Validation prc-auc = 0.825641
Epoch 15

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.2823e-04, PNorm = 26.4091, GNorm = 0.0351, lr_0 = 2.4306e-04
Loss = 1.2144e-03, PNorm = 26.4096, GNorm = 0.0325, lr_0 = 2.3910e-04
100% 6/6 [00:00<00:00, 100.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.03it/s]
Validation prc-auc = 0.825641
 53% 16/30 [00:01<00:01, 11.91it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 133.95it/s]
Validation prc-auc = 0.825641
Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.1957e-04, PNorm = 26.4157, GNorm = 0.1518, lr_0 = 1.9953e-04
Loss = 1.0185e-02, PNorm = 26.4165, GNorm = 0.3603, lr_0 = 1.9627e-04
100% 6/6 [00:00<00:00, 100.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.23it/s]
Validation prc-auc = 0.825641
 60% 18/30 [00:01<00:00, 12.62it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.86it/s]
Validation prc-auc = 0.825641
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 9.7346e-05, PNorm = 26.4235, GNorm = 0.0352, lr_0 = 1.6379e-04
Loss = 1.2698e-03, PNorm = 26.4240, GNorm = 0.0563, lr_0 = 1.6112e-04
100% 6/6 [00:00<00:00, 100.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.96it/s]
Validation prc-auc = 0.825641
 67% 20/30 [00:01<00:00, 13.17it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.38it/s]
Validation prc-auc = 0.825641
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.1755e-04, PNorm = 26.4264, GNorm = 0.3098, lr_0 = 1.3445e-04
Loss = 3.3164e-03, PNorm = 26.4266, GNorm = 0.0982, lr_0 = 1.3226e-04
100% 6/6 [00:00<00:00, 100.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.64it/s]
Validation prc-auc = 0.825641
 73% 22/30 [00:01<00:00, 13.59it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.01it/s]
Validation prc-auc = 0.825641
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7208e-04, PNorm = 26.4285, GNorm = 0.0488, lr_0 = 1.1037e-04
Loss = 4.9692e-03, PNorm = 26.4287, GNorm = 0.2683, lr_0 = 1.0857e-04
100% 6/6 [00:00<00:00, 100.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.28it/s]
Validation prc-auc = 0.825641
 80% 24/30 [00:01<00:00, 13.91it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.50it/s]
Validation prc-auc = 0.825641
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5664e-04, PNorm = 26.4304, GNorm = 0.1864, lr_0 = 1.0000e-04
Loss = 7.7099e-04, PNorm = 26.4306, GNorm = 0.0236, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.52it/s]
Validation prc-auc = 0.825641
 87% 26/30 [00:01<00:00, 14.14it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.28it/s]
Validation prc-auc = 0.825641
Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8564e-04, PNorm = 26.4328, GNorm = 0.0697, lr_0 = 1.0000e-04
Loss = 1.1736e-03, PNorm = 26.4330, GNorm = 0.0461, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.25it/s]
Validation prc-auc = 0.825641
 93% 28/30 [00:02<00:00, 14.30it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 104.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.00it/s]
Validation prc-auc = 0.825641
Epoch 29

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3382e-04, PNorm = 26.4357, GNorm = 0.1491, lr_0 = 1.0000e-04
Loss = 1.3982e-03, PNorm = 26.4360, GNorm = 0.0444, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.30it/s]
Validation prc-auc = 0.825641
100% 30/30 [00:02<00:00, 14.41it/s]100% 30/30 [00:02<00:00, 13.39it/s]
Model 0 best validation prc-auc = 0.864365 on epoch 1
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 159.12it/s]
Model 0 test prc-auc = 0.854927
Ensemble test prc-auc = 0.854927
Fold 3
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614202 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1614202
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1614202',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpho_499x4/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614202'],
 'task_names': ['CHEMBL1614202'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 251,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1054it [00:00, 10532.93it/s]2126it [00:00, 10586.78it/s]3185it [00:00, 10587.61it/s]4239it [00:00, 10572.20it/s]5301it [00:00, 10585.91it/s]6368it [00:00, 10610.49it/s]7423it [00:00, 10591.95it/s]8480it [00:00, 10584.67it/s]9544it [00:00, 10599.77it/s]10613it [00:01, 10626.41it/s]11677it [00:01, 10627.90it/s]12740it [00:01, 10626.46it/s]13804it [00:01, 10627.48it/s]14873it [00:01, 10643.74it/s]15945it [00:01, 10665.24it/s]17014it [00:01, 10670.84it/s]18084it [00:01, 10676.57it/s]19150it [00:01, 10475.60it/s]20223it [00:01, 10549.54it/s]21294it [00:02, 10595.13it/s]22359it [00:02, 10611.50it/s]23429it [00:02, 10635.50it/s]24493it [00:02, 10594.14it/s]25566it [00:02, 10634.48it/s]26639it [00:02, 10662.46it/s]27711it [00:02, 10677.12it/s]28779it [00:02, 10669.92it/s]29847it [00:02, 10633.95it/s]30920it [00:02, 10660.05it/s]31993it [00:03, 10678.05it/s]33061it [00:03, 10652.00it/s]34134it [00:03, 10674.81it/s]35205it [00:03, 10683.76it/s]36274it [00:03, 10489.09it/s]37333it [00:03, 10519.03it/s]38405it [00:03, 10575.77it/s]39474it [00:03, 10607.87it/s]40547it [00:03, 10642.85it/s]41612it [00:03, 10582.39it/s]42671it [00:04, 10547.08it/s]43750it [00:04, 10616.01it/s]44823it [00:04, 10649.13it/s]45896it [00:04, 10671.88it/s]46964it [00:04, 10657.91it/s]48031it [00:04, 10659.46it/s]49100it [00:04, 10667.11it/s]50167it [00:04, 10666.94it/s]51237it [00:04, 10675.74it/s]52308it [00:04, 10684.89it/s]53377it [00:05, 10673.78it/s]54445it [00:05, 10652.82it/s]55511it [00:05, 10620.43it/s]56584it [00:05, 10650.96it/s]57668it [00:05, 10706.61it/s]58753it [00:05, 10747.65it/s]59828it [00:05, 10722.44it/s]60901it [00:05, 10710.80it/s]61865it [00:05, 10636.95it/s]
  0% 0/314 [00:00<?, ?it/s] 49% 154/314 [00:00<00:00, 1534.98it/s] 99% 310/314 [00:00<00:00, 1540.74it/s]100% 314/314 [00:00<00:00, 1545.21it/s]
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 393137.75it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 4716.36it/s]
Total scaffolds = 147 | train scaffolds = 102 | val scaffolds = 18 | test scaffolds = 27
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([25])), (array([0.94444444]), array([18])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([12])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614202 0: 7.32%, 1: 92.68%
Total size = 314 | train size = 251 | val size = 31 | test size = 32
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 85.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.67it/s]
Validation prc-auc = 0.849799
  3% 1/30 [00:00<00:03,  8.71it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 5.7467e-03, PNorm = 26.0128, GNorm = 2.5992, lr_0 = 9.6764e-04
Loss = 1.0420e+00, PNorm = 26.0290, GNorm = 31.2384, lr_0 = 9.5186e-04
100% 6/6 [00:00<00:00, 95.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.89it/s]
Validation prc-auc = 0.843926
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.28it/s]
Validation prc-auc = 0.834740
 10% 3/30 [00:00<00:02,  9.86it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 7.4389e-04, PNorm = 26.1897, GNorm = 0.6456, lr_0 = 7.9433e-04
Loss = 1.5101e-02, PNorm = 26.2001, GNorm = 0.4970, lr_0 = 7.8137e-04
100% 6/6 [00:00<00:00, 95.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 94.04it/s]
Validation prc-auc = 0.866736
 13% 4/30 [00:00<00:02,  9.58it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.58it/s]
Validation prc-auc = 0.863687
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.8080e-04, PNorm = 26.2737, GNorm = 0.1258, lr_0 = 6.5206e-04
Loss = 9.3646e-03, PNorm = 26.2780, GNorm = 0.3592, lr_0 = 6.4142e-04
100% 6/6 [00:00<00:00, 95.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.35it/s]
Validation prc-auc = 0.856714
 20% 6/30 [00:00<00:02, 10.62it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A
 83% 5/6 [00:00<00:00, 29.19it/s][A100% 6/6 [00:00<00:00, 34.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 149.63it/s]
Validation prc-auc = 0.856714
 23% 7/30 [00:00<00:02,  8.28it/s]Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9649e-04, PNorm = 26.3164, GNorm = 0.0824, lr_0 = 5.3527e-04
Loss = 9.8002e-04, PNorm = 26.3189, GNorm = 0.0376, lr_0 = 5.2654e-04
100% 6/6 [00:00<00:00, 93.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.09it/s]
Validation prc-auc = 0.856714
Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.24it/s]
Validation prc-auc = 0.860364
 30% 9/30 [00:00<00:02,  9.44it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.6094e-04, PNorm = 26.3404, GNorm = 0.0748, lr_0 = 4.3940e-04
Loss = 1.9550e-05, PNorm = 26.3417, GNorm = 0.0014, lr_0 = 4.3223e-04
100% 6/6 [00:00<00:00, 94.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.31it/s]
Validation prc-auc = 0.860364
Epoch 10

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.48it/s]
Validation prc-auc = 0.860364
 37% 11/30 [00:00<00:01, 10.48it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8820e-04, PNorm = 26.3544, GNorm = 0.0808, lr_0 = 3.6070e-04
Loss = 2.9860e-03, PNorm = 26.3556, GNorm = 0.0769, lr_0 = 3.5481e-04
100% 6/6 [00:00<00:00, 94.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.76it/s]
Validation prc-auc = 0.860364
Epoch 12

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.71it/s]
Validation prc-auc = 0.860364
 43% 13/30 [00:01<00:01, 11.36it/s]Epoch 13

  0% 0/6 [00:00<?, ?it/s][ALoss = 9.7401e-05, PNorm = 26.3663, GNorm = 0.0515, lr_0 = 2.9609e-04
Loss = 1.9361e-03, PNorm = 26.3671, GNorm = 0.0575, lr_0 = 2.9126e-04
100% 6/6 [00:00<00:00, 94.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.96it/s]
Validation prc-auc = 0.860364
Epoch 14

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.00it/s]
Validation prc-auc = 0.860364
 50% 15/30 [00:01<00:01, 12.07it/s]Epoch 15

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.7429e-04, PNorm = 26.3727, GNorm = 0.0390, lr_0 = 2.4306e-04
Loss = 5.7392e-03, PNorm = 26.3730, GNorm = 0.1791, lr_0 = 2.3910e-04
100% 6/6 [00:00<00:00, 94.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.82it/s]
Validation prc-auc = 0.859163
Epoch 16

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.01it/s]
Validation prc-auc = 0.859163
 57% 17/30 [00:01<00:01, 12.62it/s]Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6312e-04, PNorm = 26.3776, GNorm = 0.0424, lr_0 = 1.9953e-04
Loss = 7.2548e-03, PNorm = 26.3782, GNorm = 0.3584, lr_0 = 1.9627e-04
100% 6/6 [00:00<00:00, 94.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.80it/s]
Validation prc-auc = 0.859163
Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.83it/s]
Validation prc-auc = 0.859163
 63% 19/30 [00:01<00:00, 13.02it/s]Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8380e-04, PNorm = 26.3840, GNorm = 0.0512, lr_0 = 1.6379e-04
Loss = 5.2200e-04, PNorm = 26.3844, GNorm = 0.0200, lr_0 = 1.6112e-04
100% 6/6 [00:00<00:00, 94.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.43it/s]
Validation prc-auc = 0.859163
Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.68it/s]
Validation prc-auc = 0.859163
 70% 21/30 [00:01<00:00, 13.33it/s]Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.4011e-04, PNorm = 26.3890, GNorm = 0.8595, lr_0 = 1.3445e-04
Loss = 5.3764e-03, PNorm = 26.3894, GNorm = 0.1971, lr_0 = 1.3226e-04
100% 6/6 [00:00<00:00, 93.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.75it/s]
Validation prc-auc = 0.859163
Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.14it/s]
Validation prc-auc = 0.859163
 77% 23/30 [00:01<00:00, 13.54it/s]Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.1994e-04, PNorm = 26.3924, GNorm = 0.1328, lr_0 = 1.1037e-04
Loss = 1.6702e-03, PNorm = 26.3926, GNorm = 0.0485, lr_0 = 1.0857e-04
100% 6/6 [00:00<00:00, 94.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.40it/s]
Validation prc-auc = 0.859163
Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.60it/s]
Validation prc-auc = 0.859163
 83% 25/30 [00:01<00:00, 13.71it/s]Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4717e-04, PNorm = 26.3952, GNorm = 0.0387, lr_0 = 1.0000e-04
Loss = 1.2839e-03, PNorm = 26.3954, GNorm = 0.0643, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 94.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.89it/s]
Validation prc-auc = 0.859163
Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.44it/s]
Validation prc-auc = 0.859163
 90% 27/30 [00:02<00:00, 13.83it/s]Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 7.1237e-05, PNorm = 26.3986, GNorm = 0.0976, lr_0 = 1.0000e-04
Loss = 3.6315e-03, PNorm = 26.3989, GNorm = 0.1062, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 94.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.78it/s]
Validation prc-auc = 0.859163
Epoch 28

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.89it/s]
Validation prc-auc = 0.862486
 97% 29/30 [00:02<00:00, 13.92it/s]Epoch 29

  0% 0/6 [00:00<?, ?it/s][ALoss = 9.7759e-05, PNorm = 26.4027, GNorm = 0.1456, lr_0 = 1.0000e-04
Loss = 4.3926e-03, PNorm = 26.4030, GNorm = 0.1404, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 94.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.22it/s]
Validation prc-auc = 0.862486
100% 30/30 [00:02<00:00, 12.92it/s]
Model 0 best validation prc-auc = 0.866736 on epoch 3
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 147.97it/s]
Model 0 test prc-auc = 0.766654
Ensemble test prc-auc = 0.766654
Fold 4
Command line
python /home/apappu/thesis/molecule-metalearning/chemprop/train.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614202 --dataset_type classification --metric prc-auc --split_type scaffold_balanced --features_only --features_generator morgan --dropout 0.2 --ffn_hidden_size 400 --num_folds 5 --epochs 30 --num_workers 0 --results_save_dir results/ecfp_single_task_on_test_tasks/ --experiment_name CHEMBL1614202
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chembl_assay_metadata_pickle_path': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'CHEMBL1614202',
 'features_generator': ['morgan'],
 'features_only': True,
 'features_path': None,
 'features_size': 2048,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'meta_split_sizes_BF': (10, 10),
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/ecfp_single_task_on_test_tasks/',
 'save_dir': '/tmp/2323266.1.gpu.q/tmpho_499x4/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614202'],
 'task_names': ['CHEMBL1614202'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 251,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]646it [00:00, 6454.04it/s]1542it [00:00, 7043.97it/s]2579it [00:00, 7793.53it/s]3630it [00:00, 8447.05it/s]4700it [00:00, 9016.31it/s]5773it [00:00, 9469.90it/s]6840it [00:00, 9799.96it/s]7908it [00:00, 10048.06it/s]8970it [00:00, 10211.63it/s]10034it [00:01, 10333.76it/s]11100it [00:01, 10427.37it/s]12167it [00:01, 10496.61it/s]13237it [00:01, 10555.20it/s]14308it [00:01, 10599.44it/s]15381it [00:01, 10635.50it/s]16453it [00:01, 10660.55it/s]17524it [00:01, 10673.54it/s]18593it [00:01, 10676.76it/s]19661it [00:01, 10673.30it/s]20732it [00:02, 10683.82it/s]21803it [00:02, 10689.96it/s]22872it [00:02, 10674.13it/s]23945it [00:02, 10690.09it/s]25019it [00:02, 10703.41it/s]26090it [00:02, 10694.74it/s]27160it [00:02, 10680.16it/s]28229it [00:02, 10665.45it/s]29299it [00:02, 10673.12it/s]30367it [00:02, 10673.22it/s]31437it [00:03, 10679.53it/s]32506it [00:03, 10680.02it/s]33575it [00:03, 10645.36it/s]34644it [00:03, 10656.71it/s]35711it [00:03, 10658.58it/s]36781it [00:03, 10670.00it/s]37849it [00:03, 10644.31it/s]38914it [00:03, 10630.48it/s]39984it [00:03, 10649.45it/s]41050it [00:03, 10651.75it/s]42117it [00:04, 10656.12it/s]43190it [00:04, 10676.68it/s]44258it [00:04, 10671.93it/s]45326it [00:04, 10632.58it/s]46390it [00:04, 10549.89it/s]47462it [00:04, 10598.19it/s]48531it [00:04, 10625.45it/s]49602it [00:04, 10648.41it/s]50667it [00:04, 10502.37it/s]51718it [00:04, 10401.44it/s]52759it [00:05, 10334.24it/s]53808it [00:05, 10377.90it/s]54863it [00:05, 10426.91it/s]55921it [00:05, 10471.10it/s]56989it [00:05, 10531.94it/s]58062it [00:05, 10588.42it/s]59134it [00:05, 10627.23it/s]60203it [00:05, 10645.51it/s]61272it [00:05, 10658.24it/s]61865it [00:05, 10525.70it/s]
  0% 0/314 [00:00<?, ?it/s] 49% 155/314 [00:00<00:00, 1543.10it/s] 99% 310/314 [00:00<00:00, 1544.03it/s]100% 314/314 [00:00<00:00, 1544.89it/s]
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 395142.95it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/314 [00:00<?, ?it/s]100% 314/314 [00:00<00:00, 4774.19it/s]
Total scaffolds = 147 | train scaffolds = 111 | val scaffolds = 25 | test scaffolds = 11
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([25])), (array([0.94444444]), array([18])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([6])), (array([1.]), array([3])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614202 0: 7.32%, 1: 92.68%
Total size = 314 | train size = 251 | val size = 31 | test size = 32
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder()
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=2048, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 820,001
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 143.56it/s]
Validation prc-auc = 0.906499
  3% 1/30 [00:00<00:03,  9.03it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][A
 33% 2/6 [00:00<00:00, 15.03it/s][ALoss = 5.8741e-03, PNorm = 25.9979, GNorm = 2.0808, lr_0 = 9.6764e-04
Loss = 6.6356e-02, PNorm = 26.0200, GNorm = 1.3585, lr_0 = 9.5186e-04
100% 6/6 [00:00<00:00, 34.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.81it/s]
Validation prc-auc = 0.918892
  7% 2/30 [00:00<00:03,  7.01it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.57it/s]
Validation prc-auc = 0.918430
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.0583e-03, PNorm = 26.2080, GNorm = 0.7545, lr_0 = 7.9433e-04
Loss = 1.0440e-03, PNorm = 26.2189, GNorm = 0.0545, lr_0 = 7.8137e-04
100% 6/6 [00:00<00:00, 95.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.75it/s]
Validation prc-auc = 0.914312
 13% 4/30 [00:00<00:03,  8.28it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.45it/s]
Validation prc-auc = 0.916385
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 5.3519e-04, PNorm = 26.2906, GNorm = 0.2685, lr_0 = 6.5206e-04
Loss = 5.6798e-01, PNorm = 26.2896, GNorm = 13.9476, lr_0 = 6.4142e-04
100% 6/6 [00:00<00:00, 96.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.73it/s]
Validation prc-auc = 0.916385
 20% 6/30 [00:00<00:02,  9.48it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.82it/s]
Validation prc-auc = 0.922707
 23% 7/30 [00:00<00:02,  9.50it/s]Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 9.1212e-04, PNorm = 26.2955, GNorm = 0.2075, lr_0 = 5.3527e-04
Loss = 2.1277e-04, PNorm = 26.2965, GNorm = 0.0172, lr_0 = 5.2654e-04
100% 6/6 [00:00<00:00, 94.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.42it/s]
Validation prc-auc = 0.930589
 27% 8/30 [00:00<00:02,  9.44it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 149.76it/s]
Validation prc-auc = 0.934659
 30% 9/30 [00:00<00:02,  9.46it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.6271e-04, PNorm = 26.3114, GNorm = 0.8238, lr_0 = 4.3940e-04
Loss = 1.2953e-03, PNorm = 26.3130, GNorm = 0.0489, lr_0 = 4.3223e-04
100% 6/6 [00:00<00:00, 94.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.12it/s]
Validation prc-auc = 0.934659
Epoch 10

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.68it/s]
Validation prc-auc = 0.928384
 37% 11/30 [00:01<00:01, 10.52it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][ALoss = 7.4850e-04, PNorm = 26.3285, GNorm = 0.1237, lr_0 = 3.6070e-04
Loss = 3.1776e-04, PNorm = 26.3296, GNorm = 0.0278, lr_0 = 3.5481e-04
100% 6/6 [00:00<00:00, 96.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.78it/s]
Validation prc-auc = 0.928384
Epoch 12

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 149.86it/s]
Validation prc-auc = 0.928384
 43% 13/30 [00:01<00:01, 11.44it/s]Epoch 13

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8808e-04, PNorm = 26.3419, GNorm = 0.2420, lr_0 = 2.9609e-04
Loss = 7.2715e-05, PNorm = 26.3428, GNorm = 0.0049, lr_0 = 2.9126e-04
100% 6/6 [00:00<00:00, 95.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.76it/s]
Validation prc-auc = 0.928384
Epoch 14

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.92it/s]
Validation prc-auc = 0.925970
 50% 15/30 [00:01<00:01, 12.18it/s]Epoch 15

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.4096e-04, PNorm = 26.3516, GNorm = 0.6298, lr_0 = 2.4306e-04
Loss = 2.6978e-03, PNorm = 26.3520, GNorm = 0.1288, lr_0 = 2.3910e-04
100% 6/6 [00:00<00:00, 95.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.87it/s]
Validation prc-auc = 0.925970
Epoch 16

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.04it/s]
Validation prc-auc = 0.925970
 57% 17/30 [00:01<00:01, 12.76it/s]Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9937e-04, PNorm = 26.3578, GNorm = 0.0465, lr_0 = 1.9953e-04
Loss = 3.1460e-03, PNorm = 26.3584, GNorm = 0.0963, lr_0 = 1.9627e-04
100% 6/6 [00:00<00:00, 96.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.48it/s]
Validation prc-auc = 0.925970
Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 90.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.67it/s]
Validation prc-auc = 0.925970
 63% 19/30 [00:01<00:00, 13.04it/s]Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1984e-04, PNorm = 26.3654, GNorm = 0.3223, lr_0 = 1.6379e-04
Loss = 9.6612e-03, PNorm = 26.3660, GNorm = 0.5463, lr_0 = 1.6112e-04
100% 6/6 [00:00<00:00, 92.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.88it/s]
Validation prc-auc = 0.925970
Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.85it/s]
Validation prc-auc = 0.925970
 70% 21/30 [00:01<00:00, 13.34it/s]Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6818e-04, PNorm = 26.3725, GNorm = 0.1589, lr_0 = 1.3445e-04
Loss = 4.9445e-03, PNorm = 26.3730, GNorm = 0.1108, lr_0 = 1.3226e-04
100% 6/6 [00:00<00:00, 95.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.54it/s]
Validation prc-auc = 0.925970
Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.53it/s]
Validation prc-auc = 0.922707
 77% 23/30 [00:01<00:00, 13.62it/s]Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7324e-04, PNorm = 26.3785, GNorm = 0.2604, lr_0 = 1.1037e-04
Loss = 3.2706e-04, PNorm = 26.3788, GNorm = 0.0263, lr_0 = 1.0857e-04
100% 6/6 [00:00<00:00, 96.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.62it/s]
Validation prc-auc = 0.922707
Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.05it/s]
Validation prc-auc = 0.922707
 83% 25/30 [00:02<00:00, 13.83it/s]Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 4.8658e-04, PNorm = 26.3809, GNorm = 0.0651, lr_0 = 1.0000e-04

 83% 5/6 [00:00<00:00, 36.26it/s][ALoss = 1.2482e-02, PNorm = 26.3811, GNorm = 0.2540, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 42.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.87it/s]
Validation prc-auc = 0.928043
Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.80it/s]
Validation prc-auc = 0.928043
 90% 27/30 [00:02<00:00, 12.00it/s]Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 3.6710e-04, PNorm = 26.3820, GNorm = 0.6212, lr_0 = 1.0000e-04
Loss = 5.2030e-03, PNorm = 26.3820, GNorm = 0.1381, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 95.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.53it/s]
Validation prc-auc = 0.928043
Epoch 28

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.41it/s]
Validation prc-auc = 0.932662
 97% 29/30 [00:02<00:00, 12.59it/s]Epoch 29

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3802e-04, PNorm = 26.3833, GNorm = 0.0573, lr_0 = 1.0000e-04
Loss = 9.7359e-04, PNorm = 26.3835, GNorm = 0.0453, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 95.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 149.50it/s]
Validation prc-auc = 0.932662
100% 30/30 [00:02<00:00, 12.10it/s]
Model 0 best validation prc-auc = 0.934659 on epoch 8
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 136.45it/s]
Model 0 test prc-auc = 0.998976
Ensemble test prc-auc = 0.998976
5-fold cross validation
Seed 0 ==> test prc-auc = 0.879535
Seed 1 ==> test prc-auc = 0.983179
Seed 2 ==> test prc-auc = 0.854927
Seed 3 ==> test prc-auc = 0.766654
Seed 4 ==> test prc-auc = 0.998976
Overall test prc-auc = 0.896654 +/- 0.085896

wandb: Waiting for W&B process to finish, PID 8098
wandb: Program ended successfully.
wandb: Run summary:
wandb:    test_prc-auc_std 0.08589578380995921
wandb:          _timestamp 1596825845.9090352
wandb:               _step 0
wandb:   test_prc-auc_mean 0.8966542532646775
wandb:            _runtime 48.90639400482178
wandb: Syncing 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: \ 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb: | 0.07MB of 0.07MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced CHEMBL1614202: https://app.wandb.ai/apappu97/molecule-metalearning/runs/hoppf7xq
