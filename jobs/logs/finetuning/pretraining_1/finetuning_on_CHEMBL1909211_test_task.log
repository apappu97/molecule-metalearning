wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200808_201812-et3eq19z
wandb: Syncing run finetuning_finetuning_on_CHEMBL1909211_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/et3eq19z
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909211 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1909211_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909211_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpf_w5lkdk/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909211'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]422it [00:00, 4216.06it/s]951it [00:00, 4488.95it/s]1717it [00:00, 5125.40it/s]2686it [00:00, 5967.91it/s]3635it [00:00, 6715.04it/s]4595it [00:00, 7379.28it/s]5584it [00:00, 7987.00it/s]6580it [00:00, 8491.54it/s]7536it [00:00, 8784.30it/s]8500it [00:01, 9024.08it/s]9547it [00:01, 9412.24it/s]10653it [00:01, 9851.00it/s]11749it [00:01, 10157.84it/s]12853it [00:01, 10407.07it/s]13959it [00:01, 10594.54it/s]15065it [00:01, 10727.95it/s]16171it [00:01, 10824.71it/s]17259it [00:01, 10811.67it/s]18363it [00:01, 10876.52it/s]19476it [00:02, 10949.74it/s]20573it [00:02, 10850.30it/s]21662it [00:02, 10861.36it/s]22764it [00:02, 10907.31it/s]23871it [00:02, 10953.92it/s]24981it [00:02, 10995.21it/s]26090it [00:02, 11021.42it/s]27202it [00:02, 11049.98it/s]28310it [00:02, 11058.94it/s]29417it [00:02, 11060.80it/s]30527it [00:03, 11072.14it/s]31637it [00:03, 11078.10it/s]32745it [00:03, 10915.56it/s]33838it [00:03, 10643.96it/s]34945it [00:03, 10766.64it/s]36052it [00:03, 10853.64it/s]37160it [00:03, 10917.84it/s]38270it [00:03, 10970.11it/s]39383it [00:03, 11016.34it/s]40497it [00:03, 11050.52it/s]41610it [00:04, 11072.57it/s]42718it [00:04, 11066.78it/s]43825it [00:04, 11066.14it/s]44932it [00:04, 11060.83it/s]46040it [00:04, 11064.59it/s]47147it [00:04, 11050.61it/s]48253it [00:04, 11017.30it/s]49366it [00:04, 11049.81it/s]50478it [00:04, 11069.57it/s]51590it [00:04, 11081.78it/s]52699it [00:05, 11046.65it/s]53804it [00:05, 10997.40it/s]54904it [00:05, 10817.04it/s]55987it [00:05, 10604.82it/s]57087it [00:05, 10719.11it/s]58193it [00:05, 10818.51it/s]59306it [00:05, 10909.49it/s]60422it [00:05, 10981.62it/s]61538it [00:05, 11032.30it/s]61865it [00:05, 10545.06it/s]
Number of examples remaining: 839
  0% 0/839 [00:00<?, ?it/s]100% 839/839 [00:00<00:00, 40985.57it/s]
  0% 0/839 [00:00<?, ?it/s] 73% 611/839 [00:00<00:00, 6101.95it/s]100% 839/839 [00:00<00:00, 5340.61it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/839 [00:00<?, ?it/s] 65% 547/839 [00:00<00:00, 5462.72it/s]100% 837/839 [00:00<00:00, 4307.23it/s]100% 839/839 [00:00<00:00, 4168.98it/s]
Total scaffolds = 491 | train scaffolds = 366 | val scaffolds = 68 | test scaffolds = 57
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.05102041]), array([98])), (array([0.]), array([55])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909211 0: 88.80%, 1: 11.20%
Total size = 839 | train size = 671 | val size = 83 | test size = 85
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][A
  5% 1/21 [00:00<00:03,  5.19it/s][A
 19% 4/21 [00:00<00:02,  6.78it/s][A
 33% 7/21 [00:00<00:01,  8.75it/s][ALoss = 2.3411e-02, PNorm = 69.3011, GNorm = 1.6119, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:01, 10.85it/s][A
 57% 12/21 [00:00<00:00, 10.99it/s][A
 71% 15/21 [00:00<00:00, 12.95it/s][A
 86% 18/21 [00:00<00:00, 15.18it/s][ALoss = 2.2085e-02, PNorm = 69.3011, GNorm = 1.6949, lr_0 = 1.0000e-04
Loss = 2.2616e-02, PNorm = 69.3011, GNorm = 1.9468, lr_0 = 1.0000e-04

100% 21/21 [00:01<00:00, 17.33it/s][A100% 21/21 [00:01<00:00, 19.14it/s]

  0% 0/3 [00:00<?, ?it/s][A
100% 3/3 [00:00<00:00, 26.88it/s][A100% 3/3 [00:00<00:00, 26.85it/s]
Validation prc-auc = 0.061351
  3% 1/30 [00:01<00:36,  1.25s/it]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.1622e-02, PNorm = 69.3011, GNorm = 1.5877, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.94it/s][ALoss = 2.1626e-02, PNorm = 69.3011, GNorm = 1.6494, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.25it/s][A100% 21/21 [00:00<00:00, 100.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.51it/s]
Validation prc-auc = 0.062966
  7% 2/30 [00:02<00:36,  1.30s/it]Epoch 2

  0% 0/21 [00:00<?, ?it/s][A
 33% 7/21 [00:00<00:00, 65.91it/s][ALoss = 2.0876e-02, PNorm = 69.3011, GNorm = 1.4219, lr_0 = 1.0000e-04

 76% 16/21 [00:00<00:00, 71.13it/s][ALoss = 2.0075e-02, PNorm = 69.3011, GNorm = 1.4833, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 78.33it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.78it/s]
Validation prc-auc = 0.064299
 10% 3/30 [00:02<00:27,  1.01s/it]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9934e-02, PNorm = 69.3011, GNorm = 1.5081, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 91.61it/s][ALoss = 1.9271e-02, PNorm = 69.3011, GNorm = 1.6369, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 90.55it/s][A100% 21/21 [00:00<00:00, 90.03it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.70it/s]
Validation prc-auc = 0.069261
 13% 4/30 [00:03<00:20,  1.26it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9488e-02, PNorm = 69.3011, GNorm = 1.1499, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 78.15it/s][ALoss = 1.8205e-02, PNorm = 69.3012, GNorm = 1.8578, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 80.61it/s][A100% 21/21 [00:00<00:00, 84.68it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.56it/s]
Validation prc-auc = 0.074029
 17% 5/30 [00:03<00:16,  1.54it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7748e-02, PNorm = 69.3012, GNorm = 1.1647, lr_0 = 1.0000e-04

 29% 6/21 [00:00<00:00, 55.44it/s][A
 62% 13/21 [00:00<00:00, 44.72it/s][ALoss = 1.7851e-02, PNorm = 69.3012, GNorm = 1.2417, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 50.57it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.16it/s]
Validation prc-auc = 0.084515
 20% 6/30 [00:04<00:14,  1.67it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7119e-02, PNorm = 69.3012, GNorm = 1.2562, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.18it/s][ALoss = 1.7143e-02, PNorm = 69.3012, GNorm = 1.1410, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.34it/s][A100% 21/21 [00:00<00:00, 98.42it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.36it/s]
Validation prc-auc = 0.096217
 23% 7/30 [00:04<00:11,  1.99it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7842e-02, PNorm = 69.3013, GNorm = 1.0154, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.75it/s][ALoss = 1.5933e-02, PNorm = 69.3013, GNorm = 1.0300, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.64it/s][A100% 21/21 [00:00<00:00, 99.23it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.95it/s]
Validation prc-auc = 0.113121
 27% 8/30 [00:04<00:09,  2.30it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6438e-02, PNorm = 69.3013, GNorm = 1.1769, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 88.89it/s][ALoss = 1.5750e-02, PNorm = 69.3014, GNorm = 1.0703, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 93.11it/s][A100% 21/21 [00:00<00:00, 97.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 136.45it/s]
Validation prc-auc = 0.124266
 30% 9/30 [00:04<00:08,  2.59it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4673e-02, PNorm = 69.3014, GNorm = 1.1637, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.27it/s][ALoss = 1.5139e-02, PNorm = 69.3014, GNorm = 0.8888, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 103.32it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.40it/s]
Validation prc-auc = 0.147274
 33% 10/30 [00:05<00:07,  2.85it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5520e-02, PNorm = 69.3015, GNorm = 0.8455, lr_0 = 1.0000e-04
Loss = 1.4633e-02, PNorm = 69.3015, GNorm = 1.1235, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.23it/s][ALoss = 1.5032e-02, PNorm = 69.3015, GNorm = 0.9258, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.18it/s][A100% 21/21 [00:00<00:00, 99.51it/s] 

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.39it/s]
Validation prc-auc = 0.182855
 37% 11/30 [00:05<00:06,  3.04it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4704e-02, PNorm = 69.3016, GNorm = 1.1083, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.77it/s][ALoss = 1.4174e-02, PNorm = 69.3016, GNorm = 0.8182, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.32it/s][A100% 21/21 [00:00<00:00, 99.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.28it/s]
Validation prc-auc = 0.226668
 40% 12/30 [00:05<00:05,  3.20it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4029e-02, PNorm = 69.3016, GNorm = 0.9318, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.93it/s][ALoss = 1.4217e-02, PNorm = 69.3017, GNorm = 0.9814, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 101.74it/s][A100% 21/21 [00:00<00:00, 103.05it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 136.97it/s]
Validation prc-auc = 0.240764
 43% 13/30 [00:05<00:05,  3.35it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4572e-02, PNorm = 69.3017, GNorm = 0.8951, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.09it/s][ALoss = 1.2896e-02, PNorm = 69.3017, GNorm = 0.6355, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.41it/s]
Validation prc-auc = 0.257805
 47% 14/30 [00:06<00:04,  3.49it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3112e-02, PNorm = 69.3018, GNorm = 0.7475, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.96it/s][ALoss = 1.3271e-02, PNorm = 69.3018, GNorm = 0.6291, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.69it/s][A100% 21/21 [00:00<00:00, 100.16it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.16it/s]
Validation prc-auc = 0.271980
 50% 15/30 [00:06<00:04,  3.49it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3555e-02, PNorm = 69.3018, GNorm = 0.8546, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.87it/s][ALoss = 1.2998e-02, PNorm = 69.3019, GNorm = 0.7779, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.82it/s][A100% 21/21 [00:00<00:00, 100.25it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.74it/s]
Validation prc-auc = 0.309884
 53% 16/30 [00:06<00:03,  3.54it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2700e-02, PNorm = 69.3019, GNorm = 0.8219, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.97it/s][ALoss = 1.2483e-02, PNorm = 69.3020, GNorm = 0.7926, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.44it/s][A100% 21/21 [00:00<00:00, 96.14it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.52it/s]
Validation prc-auc = 0.347472
 57% 17/30 [00:07<00:03,  3.50it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3772e-02, PNorm = 69.3020, GNorm = 0.6398, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.78it/s][ALoss = 1.2507e-02, PNorm = 69.3020, GNorm = 0.7494, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 102.21it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.44it/s]
Validation prc-auc = 0.366224
 60% 18/30 [00:07<00:03,  3.56it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2397e-02, PNorm = 69.3021, GNorm = 0.6589, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.70it/s][ALoss = 1.2293e-02, PNorm = 69.3021, GNorm = 0.6191, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.43it/s][A100% 21/21 [00:00<00:00, 100.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.37it/s]
Validation prc-auc = 0.412677
 63% 19/30 [00:07<00:03,  3.59it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2180e-02, PNorm = 69.3022, GNorm = 0.6349, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.39it/s][ALoss = 1.2027e-02, PNorm = 69.3022, GNorm = 0.5936, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.14it/s][A100% 21/21 [00:00<00:00, 99.05it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.36it/s]
Validation prc-auc = 0.539351
 67% 20/30 [00:07<00:02,  3.60it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0380e-02, PNorm = 69.3022, GNorm = 0.7099, lr_0 = 1.0000e-04
Loss = 1.2431e-02, PNorm = 69.3023, GNorm = 0.6316, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.55it/s][A
 86% 18/21 [00:00<00:00, 89.09it/s] [ALoss = 1.1525e-02, PNorm = 69.3023, GNorm = 0.5647, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 75.31it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 87.99it/s]
Validation prc-auc = 0.549969
 70% 21/30 [00:08<00:02,  3.31it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][A
 43% 9/21 [00:00<00:00, 87.11it/s][ALoss = 1.1694e-02, PNorm = 69.3024, GNorm = 0.5972, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 89.35it/s][ALoss = 1.1047e-02, PNorm = 69.3024, GNorm = 0.5911, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 90.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.16it/s]
Validation prc-auc = 0.570403
 73% 22/30 [00:08<00:02,  3.32it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1712e-02, PNorm = 69.3025, GNorm = 0.5434, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.19it/s][ALoss = 1.1232e-02, PNorm = 69.3025, GNorm = 0.5576, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 95.11it/s][A100% 21/21 [00:00<00:00, 94.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.71it/s]
Validation prc-auc = 0.658643
 77% 23/30 [00:08<00:02,  3.36it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1219e-02, PNorm = 69.3025, GNorm = 0.5959, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.34it/s][ALoss = 1.0883e-02, PNorm = 69.3026, GNorm = 0.5502, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 93.04it/s][A100% 21/21 [00:00<00:00, 92.73it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 120.58it/s]
Validation prc-auc = 0.701871
 80% 24/30 [00:09<00:01,  3.38it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.5238e-03, PNorm = 69.3026, GNorm = 0.5781, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 36.94it/s][ALoss = 1.2050e-02, PNorm = 69.3027, GNorm = 0.5539, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 44.95it/s][A100% 21/21 [00:00<00:00, 53.42it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 88.77it/s]
Validation prc-auc = 0.716156
 83% 25/30 [00:09<00:01,  2.88it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1177e-02, PNorm = 69.3027, GNorm = 0.4986, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 104.70it/s][ALoss = 1.0648e-02, PNorm = 69.3028, GNorm = 0.6161, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.85it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 134.65it/s]
Validation prc-auc = 0.730102
 87% 26/30 [00:09<00:01,  3.12it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.9581e-03, PNorm = 69.3028, GNorm = 0.4303, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.12it/s][ALoss = 1.0768e-02, PNorm = 69.3029, GNorm = 0.4672, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.16it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 132.58it/s]
Validation prc-auc = 0.786139
 90% 27/30 [00:10<00:00,  3.31it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.5078e-03, PNorm = 69.3029, GNorm = 0.5297, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.28it/s][ALoss = 1.1414e-02, PNorm = 69.3030, GNorm = 0.4426, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.50it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 133.73it/s]
Validation prc-auc = 0.786139
 93% 28/30 [00:10<00:00,  3.54it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1667e-02, PNorm = 69.3030, GNorm = 0.4717, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.65it/s][ALoss = 1.0700e-02, PNorm = 69.3030, GNorm = 0.4534, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.23it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 134.41it/s]
Validation prc-auc = 0.890306
 97% 29/30 [00:10<00:00,  3.62it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0956e-02, PNorm = 69.3031, GNorm = 0.6230, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.00it/s][ALoss = 1.0530e-02, PNorm = 69.3031, GNorm = 0.4713, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.46it/s][A100% 21/21 [00:00<00:00, 102.10it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.24it/s]
Validation prc-auc = 0.916497
100% 30/30 [00:10<00:00,  3.65it/s]100% 30/30 [00:10<00:00,  2.75it/s]
Model 0 best validation prc-auc = 0.916497 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s] 67% 2/3 [00:00<00:00, 19.05it/s]100% 3/3 [00:00<00:00, 22.29it/s]
Model 0 test prc-auc = 0.620569
Ensemble test prc-auc = 0.620569
Fold 1
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909211 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1909211_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909211_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpf_w5lkdk/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909211'],
 'task_names': ['CHEMBL1909211'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 671,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]474it [00:00, 4737.40it/s]1221it [00:00, 5320.58it/s]2171it [00:00, 6097.81it/s]3132it [00:00, 6847.85it/s]4100it [00:00, 7505.43it/s]5090it [00:00, 8092.41it/s]6087it [00:00, 8576.98it/s]7082it [00:00, 8946.98it/s]8074it [00:00, 9217.03it/s]9017it [00:01, 9277.20it/s]10025it [00:01, 9502.42it/s]11099it [00:01, 9840.58it/s]12200it [00:01, 10162.23it/s]13301it [00:01, 10401.58it/s]14399it [00:01, 10568.03it/s]15497it [00:01, 10686.00it/s]16585it [00:01, 10742.95it/s]17697it [00:01, 10853.20it/s]18813it [00:01, 10941.21it/s]19928it [00:02, 11002.02it/s]21032it [00:02, 11013.30it/s]22135it [00:02, 10982.00it/s]23240it [00:02, 11000.19it/s]24349it [00:02, 11024.44it/s]25452it [00:02, 11025.37it/s]26558it [00:02, 11033.39it/s]27662it [00:02, 11010.32it/s]28775it [00:02, 11045.55it/s]29887it [00:02, 11065.48it/s]30994it [00:03, 11052.93it/s]32100it [00:03, 11049.99it/s]33206it [00:03, 11022.88it/s]34309it [00:03, 11007.16it/s]35410it [00:03, 10998.43it/s]36510it [00:03, 10993.27it/s]37610it [00:03, 10990.72it/s]38710it [00:03, 10930.28it/s]39804it [00:03, 10839.21it/s]40889it [00:03, 10770.14it/s]41998it [00:04, 10863.65it/s]43100it [00:04, 10908.07it/s]44211it [00:04, 10966.66it/s]45317it [00:04, 10991.75it/s]46426it [00:04, 11019.92it/s]47532it [00:04, 11028.63it/s]48635it [00:04, 11008.85it/s]49736it [00:04, 9015.07it/s] 50697it [00:04, 9156.78it/s]51695it [00:04, 9388.36it/s]52691it [00:05, 9551.89it/s]53669it [00:05, 9607.10it/s]54646it [00:05, 9642.91it/s]55622it [00:05, 9666.23it/s]56597it [00:05, 9685.00it/s]57604it [00:05, 9795.38it/s]58697it [00:05, 10109.52it/s]59790it [00:05, 10340.98it/s]60887it [00:05, 10521.79it/s]61865it [00:05, 10339.37it/s]
Number of examples remaining: 839
  0% 0/839 [00:00<?, ?it/s]100% 839/839 [00:00<00:00, 189347.38it/s]
  0% 0/839 [00:00<?, ?it/s] 70% 589/839 [00:00<00:00, 5878.64it/s]100% 839/839 [00:00<00:00, 5231.11it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/839 [00:00<?, ?it/s] 65% 549/839 [00:00<00:00, 5485.73it/s]100% 837/839 [00:00<00:00, 4290.05it/s]100% 839/839 [00:00<00:00, 4154.73it/s]
Total scaffolds = 491 | train scaffolds = 390 | val scaffolds = 48 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.05102041]), array([98])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909211 0: 88.80%, 1: 11.20%
Total size = 839 | train size = 671 | val size = 83 | test size = 85
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][A
 43% 9/21 [00:00<00:00, 86.35it/s][ALoss = 2.3066e-02, PNorm = 69.3011, GNorm = 2.1056, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 88.38it/s][ALoss = 2.2921e-02, PNorm = 69.3011, GNorm = 1.1773, lr_0 = 1.0000e-04
Loss = 2.3414e-02, PNorm = 69.3011, GNorm = 2.5126, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 90.37it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.79it/s]
Validation prc-auc = 0.029529
  3% 1/30 [00:00<00:08,  3.38it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.2175e-02, PNorm = 69.3011, GNorm = 1.4748, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.68it/s][ALoss = 2.1423e-02, PNorm = 69.3011, GNorm = 1.3316, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.12it/s][A100% 21/21 [00:00<00:00, 97.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 132.90it/s]
Validation prc-auc = 0.030184
  7% 2/30 [00:00<00:08,  3.44it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0869e-02, PNorm = 69.3011, GNorm = 1.4450, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.60it/s][ALoss = 2.0411e-02, PNorm = 69.3011, GNorm = 1.7743, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.16it/s][A100% 21/21 [00:00<00:00, 96.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 132.83it/s]
Validation prc-auc = 0.030980
 10% 3/30 [00:00<00:07,  3.48it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9749e-02, PNorm = 69.3011, GNorm = 1.1301, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.50it/s][ALoss = 1.9338e-02, PNorm = 69.3011, GNorm = 1.4903, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.54it/s][A100% 21/21 [00:00<00:00, 99.05it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.32it/s]
Validation prc-auc = 0.032016
 13% 4/30 [00:01<00:07,  3.53it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8877e-02, PNorm = 69.3011, GNorm = 1.9291, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.76it/s][ALoss = 1.8321e-02, PNorm = 69.3012, GNorm = 1.4697, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.87it/s][A100% 21/21 [00:00<00:00, 103.25it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 145.49it/s]
Validation prc-auc = 0.033235
 17% 5/30 [00:01<00:06,  3.61it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7884e-02, PNorm = 69.3012, GNorm = 1.3338, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 110.59it/s][ALoss = 1.7799e-02, PNorm = 69.3012, GNorm = 1.0603, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 110.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 148.71it/s]
Validation prc-auc = 0.035102
 20% 6/30 [00:01<00:06,  3.51it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7187e-02, PNorm = 69.3012, GNorm = 1.3760, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 92.34it/s][ALoss = 1.6787e-02, PNorm = 69.3013, GNorm = 1.1866, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 96.69it/s][A100% 21/21 [00:00<00:00, 100.15it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 148.37it/s]
Validation prc-auc = 0.037178
 23% 7/30 [00:01<00:06,  3.58it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6811e-02, PNorm = 69.3013, GNorm = 1.1957, lr_0 = 1.0000e-04

 29% 6/21 [00:00<00:00, 26.62it/s][ALoss = 1.6426e-02, PNorm = 69.3013, GNorm = 1.1362, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 34.28it/s][A100% 21/21 [00:00<00:00, 57.17it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.10it/s]
Validation prc-auc = 0.038784
 27% 8/30 [00:02<00:07,  3.09it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6692e-02, PNorm = 69.3013, GNorm = 0.9476, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 93.32it/s][ALoss = 1.6093e-02, PNorm = 69.3014, GNorm = 0.9311, lr_0 = 1.0000e-04

 76% 16/21 [00:00<00:00, 77.20it/s][A100% 21/21 [00:00<00:00, 70.93it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 133.62it/s]
Validation prc-auc = 0.043400
 30% 9/30 [00:02<00:07,  2.99it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5906e-02, PNorm = 69.3014, GNorm = 1.3269, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 93.71it/s][ALoss = 1.5895e-02, PNorm = 69.3014, GNorm = 0.8572, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 94.41it/s][A100% 21/21 [00:00<00:00, 95.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.35it/s]
Validation prc-auc = 0.049124
 33% 10/30 [00:03<00:06,  3.13it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3096e-02, PNorm = 69.3015, GNorm = 1.3614, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.27it/s][ALoss = 1.5157e-02, PNorm = 69.3015, GNorm = 0.9875, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.99it/s][ALoss = 1.4713e-02, PNorm = 69.3015, GNorm = 1.0381, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 97.30it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.42it/s]
Validation prc-auc = 0.054168
 37% 11/30 [00:03<00:05,  3.25it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4885e-02, PNorm = 69.3016, GNorm = 0.8044, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.93it/s][ALoss = 1.4393e-02, PNorm = 69.3016, GNorm = 1.0806, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.78it/s][A100% 21/21 [00:00<00:00, 97.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.78it/s]
Validation prc-auc = 0.064765
 40% 12/30 [00:03<00:05,  3.36it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3776e-02, PNorm = 69.3016, GNorm = 0.9957, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.96it/s][ALoss = 1.4436e-02, PNorm = 69.3017, GNorm = 0.9152, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 104.55it/s][A100% 21/21 [00:00<00:00, 103.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 143.79it/s]
Validation prc-auc = 0.067058
 43% 13/30 [00:03<00:04,  3.48it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4041e-02, PNorm = 69.3017, GNorm = 0.6288, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.72it/s][ALoss = 1.3426e-02, PNorm = 69.3017, GNorm = 0.9830, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 145.12it/s]
Validation prc-auc = 0.076163
 47% 14/30 [00:04<00:04,  3.59it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3559e-02, PNorm = 69.3018, GNorm = 0.8994, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.15it/s][ALoss = 1.3552e-02, PNorm = 69.3018, GNorm = 0.6149, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.35it/s]
Validation prc-auc = 0.078919
 50% 15/30 [00:04<00:04,  3.67it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3678e-02, PNorm = 69.3018, GNorm = 0.8106, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 108.47it/s][ALoss = 1.2892e-02, PNorm = 69.3019, GNorm = 0.7772, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.03it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.10it/s]
Validation prc-auc = 0.095150
 53% 16/30 [00:04<00:03,  3.74it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3785e-02, PNorm = 69.3019, GNorm = 0.6692, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.90it/s][ALoss = 1.2246e-02, PNorm = 69.3020, GNorm = 0.9363, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 104.44it/s][A100% 21/21 [00:00<00:00, 102.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 143.89it/s]
Validation prc-auc = 0.121095
 57% 17/30 [00:04<00:03,  3.75it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1914e-02, PNorm = 69.3020, GNorm = 0.6707, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.20it/s][ALoss = 1.2782e-02, PNorm = 69.3020, GNorm = 0.5434, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 109.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.34it/s]
Validation prc-auc = 0.124874
 60% 18/30 [00:05<00:03,  3.36it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4287e-02, PNorm = 69.3021, GNorm = 0.8629, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 85.31it/s][ALoss = 1.1901e-02, PNorm = 69.3021, GNorm = 0.7683, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 88.43it/s][A100% 21/21 [00:00<00:00, 91.76it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.04it/s]
Validation prc-auc = 0.326564
 63% 19/30 [00:05<00:03,  3.14it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2397e-02, PNorm = 69.3022, GNorm = 0.7907, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 75.19it/s][ALoss = 1.2392e-02, PNorm = 69.3022, GNorm = 0.5929, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 78.56it/s][A100% 21/21 [00:00<00:00, 83.35it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 128.70it/s]
Validation prc-auc = 0.333749
 67% 20/30 [00:05<00:03,  3.14it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3379e-02, PNorm = 69.3023, GNorm = 0.5835, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.10it/s][ALoss = 1.2434e-02, PNorm = 69.3023, GNorm = 0.5347, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.07it/s][ALoss = 1.1244e-02, PNorm = 69.3023, GNorm = 0.8028, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 90.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.33it/s]
Validation prc-auc = 0.341424
 70% 21/30 [00:06<00:02,  3.21it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1147e-02, PNorm = 69.3024, GNorm = 0.5807, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.84it/s][ALoss = 1.2222e-02, PNorm = 69.3024, GNorm = 0.6317, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.91it/s][A100% 21/21 [00:00<00:00, 98.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 130.90it/s]
Validation prc-auc = 0.355639
 73% 22/30 [00:06<00:02,  3.32it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2033e-02, PNorm = 69.3025, GNorm = 0.6505, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.71it/s][ALoss = 1.1075e-02, PNorm = 69.3025, GNorm = 0.5450, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.24it/s][A100% 21/21 [00:00<00:00, 95.73it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.52it/s]
Validation prc-auc = 0.360370
 77% 23/30 [00:06<00:02,  3.38it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1721e-02, PNorm = 69.3026, GNorm = 0.4984, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.77it/s][ALoss = 1.1285e-02, PNorm = 69.3026, GNorm = 0.7241, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 95.22it/s][A100% 21/21 [00:00<00:00, 94.94it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.25it/s]
Validation prc-auc = 0.399152
 80% 24/30 [00:07<00:01,  3.42it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1543e-02, PNorm = 69.3026, GNorm = 0.4939, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.01it/s][ALoss = 1.1146e-02, PNorm = 69.3027, GNorm = 0.4434, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 95.02it/s][A100% 21/21 [00:00<00:00, 95.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 91.59it/s]
Validation prc-auc = 0.400559
 83% 25/30 [00:07<00:01,  3.41it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0588e-02, PNorm = 69.3027, GNorm = 0.4916, lr_0 = 1.0000e-04

 29% 6/21 [00:00<00:00, 25.08it/s][ALoss = 1.0622e-02, PNorm = 69.3028, GNorm = 0.4603, lr_0 = 1.0000e-04

 76% 16/21 [00:00<00:00, 32.22it/s][A100% 21/21 [00:00<00:00, 53.45it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.91it/s]
Validation prc-auc = 0.445494
 87% 26/30 [00:07<00:01,  2.92it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0510e-02, PNorm = 69.3028, GNorm = 0.5092, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 93.26it/s][ALoss = 1.0098e-02, PNorm = 69.3029, GNorm = 0.5206, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 94.22it/s][A100% 21/21 [00:00<00:00, 95.38it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.72it/s]
Validation prc-auc = 0.451973
 90% 27/30 [00:08<00:00,  3.07it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0554e-02, PNorm = 69.3029, GNorm = 0.5429, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.20it/s][ALoss = 1.1513e-02, PNorm = 69.3030, GNorm = 0.4823, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.81it/s][A100% 21/21 [00:00<00:00, 101.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.20it/s]
Validation prc-auc = 0.559192
 93% 28/30 [00:08<00:00,  3.25it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.2784e-03, PNorm = 69.3030, GNorm = 0.4481, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.93it/s][ALoss = 1.1256e-02, PNorm = 69.3030, GNorm = 0.3821, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.26it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 147.31it/s]
Validation prc-auc = 0.563670
 97% 29/30 [00:08<00:00,  3.40it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0123e-02, PNorm = 69.3031, GNorm = 0.4715, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.81it/s][ALoss = 1.0663e-02, PNorm = 69.3031, GNorm = 0.4733, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 101.59it/s][A100% 21/21 [00:00<00:00, 103.69it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 144.06it/s]
Validation prc-auc = 0.564033
100% 30/30 [00:08<00:00,  3.52it/s]100% 30/30 [00:08<00:00,  3.37it/s]
Model 0 best validation prc-auc = 0.564033 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 131.54it/s]
Model 0 test prc-auc = 0.818756
Ensemble test prc-auc = 0.818756
Fold 2
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909211 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1909211_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909211_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpf_w5lkdk/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909211'],
 'task_names': ['CHEMBL1909211'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 671,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]562it [00:00, 5617.77it/s]1368it [00:00, 6178.51it/s]2280it [00:00, 6839.31it/s]3203it [00:00, 7414.67it/s]4139it [00:00, 7906.96it/s]5087it [00:00, 8319.10it/s]6047it [00:00, 8665.05it/s]6989it [00:00, 8878.17it/s]7898it [00:00, 8940.44it/s]8802it [00:01, 8969.82it/s]9768it [00:01, 9165.60it/s]10833it [00:01, 9564.43it/s]11905it [00:01, 9881.67it/s]12967it [00:01, 10090.39it/s]14044it [00:01, 10283.29it/s]15121it [00:01, 10424.45it/s]16201it [00:01, 10534.09it/s]17279it [00:01, 10604.65it/s]18360it [00:01, 10662.73it/s]19441it [00:02, 10705.13it/s]20520it [00:02, 10729.27it/s]21594it [00:02, 10539.14it/s]22658it [00:02, 10567.28it/s]23738it [00:02, 10635.70it/s]24819it [00:02, 10687.25it/s]25898it [00:02, 10716.12it/s]26979it [00:02, 10742.22it/s]28062it [00:02, 10767.89it/s]29147it [00:02, 10791.63it/s]30232it [00:03, 10809.07it/s]31317it [00:03, 10821.20it/s]32401it [00:03, 10826.10it/s]33484it [00:03, 10824.56it/s]34568it [00:03, 10828.06it/s]35652it [00:03, 10829.74it/s]36736it [00:03, 10830.21it/s]37820it [00:03, 10830.42it/s]38906it [00:03, 10837.80it/s]39990it [00:03, 10824.42it/s]41073it [00:04, 10812.78it/s]42155it [00:04, 10629.53it/s]43219it [00:04, 10361.50it/s]44297it [00:04, 10482.70it/s]45347it [00:04, 10376.64it/s]46425it [00:04, 10492.12it/s]47500it [00:04, 10568.11it/s]48580it [00:04, 10635.73it/s]49645it [00:04, 10631.71it/s]50729it [00:04, 10691.47it/s]51813it [00:05, 10735.53it/s]52893it [00:05, 10754.18it/s]53969it [00:05, 10711.01it/s]55041it [00:05, 10646.96it/s]56106it [00:05, 10610.49it/s]57172it [00:05, 10624.65it/s]58251it [00:05, 10673.27it/s]59331it [00:05, 10709.29it/s]60412it [00:05, 10738.89it/s]61494it [00:05, 10760.60it/s]61865it [00:05, 10368.35it/s]
Number of examples remaining: 839
  0% 0/839 [00:00<?, ?it/s]100% 839/839 [00:00<00:00, 55865.46it/s]
  0% 0/839 [00:00<?, ?it/s] 74% 621/839 [00:00<00:00, 6207.28it/s]100% 839/839 [00:00<00:00, 5415.15it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/839 [00:00<?, ?it/s] 67% 560/839 [00:00<00:00, 5597.02it/s]100% 839/839 [00:00<00:00, 4236.21it/s]
Total scaffolds = 491 | train scaffolds = 386 | val scaffolds = 58 | test scaffolds = 47
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.05102041]), array([98])), (array([0.]), array([1])), (array([0.]), array([4])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2]))]
Class sizes
CHEMBL1909211 0: 88.80%, 1: 11.20%
Total size = 839 | train size = 671 | val size = 83 | test size = 85
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.3186e-02, PNorm = 69.3011, GNorm = 2.0186, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.44it/s][ALoss = 2.2787e-02, PNorm = 69.3011, GNorm = 1.8047, lr_0 = 1.0000e-04
Loss = 2.2225e-02, PNorm = 69.3011, GNorm = 2.0199, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.91it/s][A100% 21/21 [00:00<00:00, 100.59it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.69it/s]
Validation prc-auc = 0.066514
  3% 1/30 [00:00<00:07,  3.69it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.1812e-02, PNorm = 69.3011, GNorm = 2.3188, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.72it/s][ALoss = 2.1634e-02, PNorm = 69.3011, GNorm = 1.8083, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.68it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 130.30it/s]
Validation prc-auc = 0.068454
  7% 2/30 [00:00<00:07,  3.76it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0730e-02, PNorm = 69.3011, GNorm = 1.4838, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 108.65it/s][ALoss = 2.0291e-02, PNorm = 69.3011, GNorm = 1.3752, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.87it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.37it/s]
Validation prc-auc = 0.069991
 10% 3/30 [00:00<00:07,  3.78it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9668e-02, PNorm = 69.3011, GNorm = 1.1713, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.46it/s][ALoss = 1.9345e-02, PNorm = 69.3011, GNorm = 1.1846, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.41it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 130.07it/s]
Validation prc-auc = 0.071977
 13% 4/30 [00:01<00:06,  3.83it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9087e-02, PNorm = 69.3011, GNorm = 1.2645, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.48it/s][ALoss = 1.8465e-02, PNorm = 69.3012, GNorm = 1.5259, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.74it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 127.27it/s]
Validation prc-auc = 0.075082
 17% 5/30 [00:01<00:06,  3.82it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8166e-02, PNorm = 69.3012, GNorm = 1.7748, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 75.71it/s][ALoss = 1.7409e-02, PNorm = 69.3012, GNorm = 1.2868, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 81.18it/s][A100% 21/21 [00:00<00:00, 88.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.52it/s]
Validation prc-auc = 0.080118
 20% 6/30 [00:01<00:06,  3.65it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7821e-02, PNorm = 69.3012, GNorm = 1.2816, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.67it/s][ALoss = 1.6810e-02, PNorm = 69.3013, GNorm = 1.6772, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 100.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.63it/s]
Validation prc-auc = 0.085213
 23% 7/30 [00:01<00:06,  3.63it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6925e-02, PNorm = 69.3013, GNorm = 0.9275, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.68it/s][ALoss = 1.5640e-02, PNorm = 69.3013, GNorm = 1.5092, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 101.26it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.53it/s]
Validation prc-auc = 0.089644
 27% 8/30 [00:02<00:06,  3.64it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6830e-02, PNorm = 69.3013, GNorm = 1.4992, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 88.88it/s][ALoss = 1.6210e-02, PNorm = 69.3014, GNorm = 1.0481, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.83it/s][A100% 21/21 [00:00<00:00, 96.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.96it/s]
Validation prc-auc = 0.093760
 30% 9/30 [00:02<00:05,  3.59it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5387e-02, PNorm = 69.3014, GNorm = 1.0857, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 92.61it/s][ALoss = 1.5563e-02, PNorm = 69.3014, GNorm = 0.8126, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 90.93it/s][A100% 21/21 [00:00<00:00, 90.57it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.56it/s]
Validation prc-auc = 0.101925
 33% 10/30 [00:02<00:05,  3.50it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5252e-02, PNorm = 69.3015, GNorm = 0.9153, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 87.36it/s][ALoss = 1.4724e-02, PNorm = 69.3015, GNorm = 0.7846, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 88.59it/s][ALoss = 1.4774e-02, PNorm = 69.3015, GNorm = 1.0412, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 89.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.17it/s]
Validation prc-auc = 0.114519
 37% 11/30 [00:03<00:05,  3.44it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][A
 38% 8/21 [00:00<00:00, 27.82it/s][ALoss = 1.4135e-02, PNorm = 69.3016, GNorm = 0.8835, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 35.47it/s][ALoss = 1.4551e-02, PNorm = 69.3016, GNorm = 0.8307, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 50.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.16it/s]
Validation prc-auc = 0.126771
 40% 12/30 [00:03<00:06,  2.87it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4048e-02, PNorm = 69.3016, GNorm = 0.7217, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.25it/s][ALoss = 1.3679e-02, PNorm = 69.3017, GNorm = 0.7284, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.78it/s][A100% 21/21 [00:00<00:00, 95.82it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.94it/s]
Validation prc-auc = 0.138959
 43% 13/30 [00:03<00:05,  3.04it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3409e-02, PNorm = 69.3017, GNorm = 0.8201, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.72it/s][ALoss = 1.3708e-02, PNorm = 69.3018, GNorm = 0.8959, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 103.93it/s][A100% 21/21 [00:00<00:00, 102.83it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.82it/s]
Validation prc-auc = 0.149869
 47% 14/30 [00:04<00:05,  3.19it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2731e-02, PNorm = 69.3018, GNorm = 0.9396, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.73it/s][ALoss = 1.3928e-02, PNorm = 69.3018, GNorm = 0.6140, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.28it/s][A100% 21/21 [00:00<00:00, 96.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.70it/s]
Validation prc-auc = 0.158422
 50% 15/30 [00:05<00:09,  1.58it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3545e-02, PNorm = 69.3019, GNorm = 0.6527, lr_0 = 1.0000e-04

 33% 7/21 [00:00<00:00, 69.10it/s][ALoss = 1.2478e-02, PNorm = 69.3019, GNorm = 0.6616, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 75.67it/s][A100% 21/21 [00:00<00:00, 85.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.64it/s]
Validation prc-auc = 0.170513
 53% 16/30 [00:05<00:07,  1.86it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2558e-02, PNorm = 69.3020, GNorm = 0.6945, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.19it/s][ALoss = 1.2570e-02, PNorm = 69.3020, GNorm = 0.6199, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 94.74it/s][A100% 21/21 [00:00<00:00, 94.15it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.48it/s]
Validation prc-auc = 0.182625
 57% 17/30 [00:06<00:06,  2.16it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2517e-02, PNorm = 69.3020, GNorm = 0.7432, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.18it/s][ALoss = 1.2525e-02, PNorm = 69.3021, GNorm = 0.5943, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 100.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.18it/s]
Validation prc-auc = 0.201195
 60% 18/30 [00:06<00:04,  2.45it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1587e-02, PNorm = 69.3021, GNorm = 0.7047, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.13it/s][ALoss = 1.2596e-02, PNorm = 69.3022, GNorm = 0.6391, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 99.34it/s][A100% 21/21 [00:00<00:00, 99.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.48it/s]
Validation prc-auc = 0.227522
 63% 19/30 [00:06<00:04,  2.71it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1194e-02, PNorm = 69.3022, GNorm = 0.6237, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.82it/s][ALoss = 1.2368e-02, PNorm = 69.3022, GNorm = 0.5199, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.01it/s][A100% 21/21 [00:00<00:00, 97.83it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.65it/s]
Validation prc-auc = 0.245060
 67% 20/30 [00:06<00:03,  2.92it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2760e-02, PNorm = 69.3023, GNorm = 0.5625, lr_0 = 1.0000e-04
Loss = 1.1321e-02, PNorm = 69.3023, GNorm = 0.5512, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.28it/s][A
 95% 20/21 [00:00<00:00, 96.05it/s] [ALoss = 1.1957e-02, PNorm = 69.3024, GNorm = 0.6603, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 92.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.97it/s]
Validation prc-auc = 0.264943
 70% 21/30 [00:07<00:02,  3.06it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1662e-02, PNorm = 69.3024, GNorm = 0.6461, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.48it/s][ALoss = 1.1217e-02, PNorm = 69.3025, GNorm = 0.6162, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 110.08it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.72it/s]
Validation prc-auc = 0.302406
 73% 22/30 [00:07<00:02,  3.27it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1747e-02, PNorm = 69.3025, GNorm = 0.5404, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.72it/s][ALoss = 1.0549e-02, PNorm = 69.3025, GNorm = 0.6421, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.84it/s][A100% 21/21 [00:00<00:00, 100.25it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.54it/s]
Validation prc-auc = 0.319319
 77% 23/30 [00:07<00:02,  3.36it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1419e-02, PNorm = 69.3026, GNorm = 0.5641, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.94it/s][ALoss = 1.0471e-02, PNorm = 69.3026, GNorm = 0.5638, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 99.09it/s][A100% 21/21 [00:00<00:00, 98.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.51it/s]
Validation prc-auc = 0.336240
 80% 24/30 [00:08<00:01,  3.42it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0573e-02, PNorm = 69.3027, GNorm = 0.5492, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 102.76it/s][ALoss = 1.1070e-02, PNorm = 69.3027, GNorm = 0.5004, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 91.63it/s]
Validation prc-auc = 0.350904
 83% 25/30 [00:08<00:01,  3.50it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0572e-02, PNorm = 69.3028, GNorm = 0.5481, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 109.84it/s][ALoss = 1.0477e-02, PNorm = 69.3028, GNorm = 0.6352, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 110.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.26it/s]
Validation prc-auc = 0.369651
 87% 26/30 [00:08<00:01,  3.61it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.9751e-03, PNorm = 69.3029, GNorm = 0.6112, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.71it/s][ALoss = 1.0872e-02, PNorm = 69.3029, GNorm = 0.5713, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 100.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.25it/s]
Validation prc-auc = 0.379951
 90% 27/30 [00:08<00:00,  3.62it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1891e-02, PNorm = 69.3029, GNorm = 0.5271, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.11it/s][ALoss = 1.0099e-02, PNorm = 69.3030, GNorm = 0.4669, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.19it/s][A100% 21/21 [00:00<00:00, 99.92it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.88it/s]
Validation prc-auc = 0.408660
 93% 28/30 [00:09<00:00,  3.61it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0434e-02, PNorm = 69.3030, GNorm = 0.4396, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.53it/s][ALoss = 1.0409e-02, PNorm = 69.3031, GNorm = 0.5198, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 99.65it/s][A100% 21/21 [00:00<00:00, 100.39it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 128.32it/s]
Validation prc-auc = 0.529492
 97% 29/30 [00:09<00:00,  3.64it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.5789e-03, PNorm = 69.3031, GNorm = 0.4642, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.93it/s][ALoss = 1.0735e-02, PNorm = 69.3032, GNorm = 0.4660, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.64it/s]

  0% 0/3 [00:00<?, ?it/s][A
100% 3/3 [00:00<00:00, 20.98it/s][A100% 3/3 [00:00<00:00, 20.96it/s]
Validation prc-auc = 0.610662
100% 30/30 [00:09<00:00,  3.26it/s]100% 30/30 [00:09<00:00,  3.08it/s]
Model 0 best validation prc-auc = 0.610662 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 131.63it/s]
Model 0 test prc-auc = 0.588927
Ensemble test prc-auc = 0.588927
Fold 3
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909211 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1909211_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909211_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpf_w5lkdk/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909211'],
 'task_names': ['CHEMBL1909211'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 671,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]902it [00:00, 9019.92it/s]1836it [00:00, 9111.86it/s]2739it [00:00, 9086.05it/s]3663it [00:00, 9130.73it/s]4601it [00:00, 9201.61it/s]5541it [00:00, 9258.89it/s]6492it [00:00, 9332.59it/s]7455it [00:00, 9417.66it/s]8420it [00:00, 9485.58it/s]9478it [00:01, 9787.64it/s]10545it [00:01, 10036.12it/s]11609it [00:01, 10209.76it/s]12675it [00:01, 10338.75it/s]13741it [00:01, 10432.51it/s]14805it [00:01, 10493.51it/s]15870it [00:01, 10537.28it/s]16928it [00:01, 10548.67it/s]17982it [00:01, 10535.58it/s]19059it [00:01, 10603.89it/s]20136it [00:02, 10651.48it/s]21201it [00:02, 10647.87it/s]22268it [00:02, 10652.20it/s]23345it [00:02, 10685.12it/s]24423it [00:02, 10711.36it/s]25499it [00:02, 10724.16it/s]26576it [00:02, 10736.43it/s]27652it [00:02, 10742.33it/s]28733it [00:02, 10759.67it/s]29813it [00:02, 10770.52it/s]30891it [00:03, 10770.31it/s]31969it [00:03, 10769.66it/s]33046it [00:03, 10651.30it/s]34112it [00:03, 10549.53it/s]35168it [00:03, 10476.95it/s]36247it [00:03, 10567.38it/s]37322it [00:03, 10619.38it/s]38394it [00:03, 10646.92it/s]39470it [00:03, 10679.69it/s]40547it [00:03, 10706.03it/s]41618it [00:04, 10703.67it/s]42692it [00:04, 10712.76it/s]43764it [00:04, 10703.31it/s]44837it [00:04, 10710.60it/s]45909it [00:04, 10695.19it/s]46980it [00:04, 10696.68it/s]48051it [00:04, 10700.45it/s]49127it [00:04, 10717.19it/s]50202it [00:04, 10724.93it/s]51275it [00:04, 10714.81it/s]52347it [00:05, 10715.53it/s]53419it [00:05, 10675.74it/s]54487it [00:05, 10553.20it/s]55543it [00:05, 10292.21it/s]56574it [00:05, 10242.18it/s]57600it [00:05, 10184.10it/s]58674it [00:05, 10342.55it/s]59757it [00:05, 10481.90it/s]60835it [00:05, 10566.92it/s]61865it [00:05, 10438.82it/s]
Number of examples remaining: 839
  0% 0/839 [00:00<?, ?it/s]100% 839/839 [00:00<00:00, 367829.11it/s]
  0% 0/839 [00:00<?, ?it/s] 73% 615/839 [00:00<00:00, 6141.53it/s]100% 839/839 [00:00<00:00, 5366.00it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/839 [00:00<?, ?it/s] 66% 554/839 [00:00<00:00, 5538.54it/s]100% 839/839 [00:00<00:00, 4243.32it/s]
Total scaffolds = 491 | train scaffolds = 353 | val scaffolds = 70 | test scaffolds = 68
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.05102041]), array([98])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([3])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.5]), array([2]))]
Class sizes
CHEMBL1909211 0: 88.80%, 1: 11.20%
Total size = 839 | train size = 671 | val size = 83 | test size = 85
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.3316e-02, PNorm = 69.3011, GNorm = 1.4922, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.35it/s][ALoss = 2.2554e-02, PNorm = 69.3011, GNorm = 1.7366, lr_0 = 1.0000e-04
Loss = 2.3465e-02, PNorm = 69.3011, GNorm = 1.5449, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.45it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.86it/s]
Validation prc-auc = 0.081185
  3% 1/30 [00:00<00:07,  3.64it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.1787e-02, PNorm = 69.3011, GNorm = 1.8235, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 88.96it/s][ALoss = 2.1444e-02, PNorm = 69.3011, GNorm = 2.0464, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 90.05it/s][A100% 21/21 [00:00<00:00, 90.56it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.93it/s]
Validation prc-auc = 0.085290
  7% 2/30 [00:00<00:07,  3.53it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0555e-02, PNorm = 69.3011, GNorm = 1.2061, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 88.61it/s][ALoss = 2.0186e-02, PNorm = 69.3011, GNorm = 1.0429, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 89.21it/s][A100% 21/21 [00:00<00:00, 90.19it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.83it/s]
Validation prc-auc = 0.087871
 10% 3/30 [00:00<00:07,  3.46it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9448e-02, PNorm = 69.3011, GNorm = 1.6203, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 89.36it/s][ALoss = 1.9486e-02, PNorm = 69.3011, GNorm = 0.9999, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 89.83it/s][A100% 21/21 [00:00<00:00, 91.15it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.57it/s]
Validation prc-auc = 0.093191
 13% 4/30 [00:01<00:07,  3.44it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8762e-02, PNorm = 69.3011, GNorm = 1.5291, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 91.91it/s][ALoss = 1.8241e-02, PNorm = 69.3012, GNorm = 1.2597, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 94.71it/s][A100% 21/21 [00:00<00:00, 96.84it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.46it/s]
Validation prc-auc = 0.097470
 17% 5/30 [00:01<00:07,  3.47it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8332e-02, PNorm = 69.3012, GNorm = 1.0783, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 81.04it/s][ALoss = 1.7617e-02, PNorm = 69.3012, GNorm = 1.0435, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 85.29it/s][A100% 21/21 [00:00<00:00, 89.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.95it/s]
Validation prc-auc = 0.102249
 20% 6/30 [00:01<00:07,  3.43it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7660e-02, PNorm = 69.3012, GNorm = 1.0835, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.75it/s][ALoss = 1.6745e-02, PNorm = 69.3012, GNorm = 1.5568, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.18it/s][A100% 21/21 [00:00<00:00, 99.77it/s] 

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.14it/s]
Validation prc-auc = 0.112867
 23% 7/30 [00:02<00:06,  3.48it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6357e-02, PNorm = 69.3013, GNorm = 1.2183, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.43it/s][ALoss = 1.6227e-02, PNorm = 69.3013, GNorm = 1.2031, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 100.81it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.55it/s]
Validation prc-auc = 0.118910
 27% 8/30 [00:02<00:06,  3.52it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6719e-02, PNorm = 69.3013, GNorm = 1.0568, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.63it/s][ALoss = 1.5242e-02, PNorm = 69.3014, GNorm = 1.0883, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.56it/s][A100% 21/21 [00:00<00:00, 99.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.59it/s]
Validation prc-auc = 0.129131
 30% 9/30 [00:02<00:05,  3.56it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4560e-02, PNorm = 69.3014, GNorm = 0.7902, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.77it/s][ALoss = 1.5640e-02, PNorm = 69.3014, GNorm = 0.8300, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 102.76it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.65it/s]
Validation prc-auc = 0.140117
 33% 10/30 [00:02<00:05,  3.59it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5244e-02, PNorm = 69.3015, GNorm = 1.1070, lr_0 = 1.0000e-04
Loss = 1.4598e-02, PNorm = 69.3015, GNorm = 1.0474, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.57it/s][ALoss = 1.4973e-02, PNorm = 69.3015, GNorm = 0.8629, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 100.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.77it/s]
Validation prc-auc = 0.150631
 37% 11/30 [00:03<00:05,  3.60it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4550e-02, PNorm = 69.3015, GNorm = 0.9486, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.20it/s][ALoss = 1.4094e-02, PNorm = 69.3016, GNorm = 0.8262, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.82it/s][A100% 21/21 [00:00<00:00, 100.52it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.65it/s]
Validation prc-auc = 0.167665
 40% 12/30 [00:03<00:04,  3.60it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][A
 29% 6/21 [00:00<00:00, 55.12it/s][ALoss = 1.3886e-02, PNorm = 69.3016, GNorm = 0.8410, lr_0 = 1.0000e-04

 62% 13/21 [00:00<00:00, 58.32it/s][ALoss = 1.3962e-02, PNorm = 69.3017, GNorm = 0.7592, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 72.23it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.82it/s]
Validation prc-auc = 0.182175
 43% 13/30 [00:03<00:05,  3.31it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4169e-02, PNorm = 69.3017, GNorm = 0.7227, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.14it/s][ALoss = 1.3409e-02, PNorm = 69.3017, GNorm = 0.7702, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 101.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.92it/s]
Validation prc-auc = 0.199000
 47% 14/30 [00:04<00:04,  3.41it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4308e-02, PNorm = 69.3018, GNorm = 0.6281, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.24it/s][ALoss = 1.2745e-02, PNorm = 69.3018, GNorm = 0.8887, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.69it/s][A100% 21/21 [00:00<00:00, 99.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.87it/s]
Validation prc-auc = 0.233993
 50% 15/30 [00:04<00:04,  3.46it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3955e-02, PNorm = 69.3018, GNorm = 0.6987, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.00it/s][ALoss = 1.2243e-02, PNorm = 69.3019, GNorm = 0.7499, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.70it/s][A100% 21/21 [00:00<00:00, 100.15it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.08it/s]
Validation prc-auc = 0.271350
 53% 16/30 [00:04<00:03,  3.50it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2840e-02, PNorm = 69.3019, GNorm = 0.7385, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.83it/s][ALoss = 1.2441e-02, PNorm = 69.3020, GNorm = 0.8804, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 101.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 127.99it/s]
Validation prc-auc = 0.296552
 57% 17/30 [00:04<00:03,  3.56it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2164e-02, PNorm = 69.3020, GNorm = 0.7269, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 115.14it/s][ALoss = 1.3008e-02, PNorm = 69.3020, GNorm = 0.7611, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 50.72it/s] [A100% 21/21 [00:00<00:00, 56.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.73it/s]
Validation prc-auc = 0.321865
 60% 18/30 [00:05<00:03,  3.04it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1324e-02, PNorm = 69.3021, GNorm = 0.7673, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.78it/s][ALoss = 1.2253e-02, PNorm = 69.3021, GNorm = 0.6749, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.38it/s][A100% 21/21 [00:00<00:00, 98.74it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.39it/s]
Validation prc-auc = 0.360070
 63% 19/30 [00:05<00:03,  3.18it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2417e-02, PNorm = 69.3022, GNorm = 0.6498, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 93.61it/s][ALoss = 1.1721e-02, PNorm = 69.3022, GNorm = 0.6065, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 95.81it/s][A100% 21/21 [00:00<00:00, 97.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.08it/s]
Validation prc-auc = 0.375493
 67% 20/30 [00:05<00:03,  3.27it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1329e-02, PNorm = 69.3022, GNorm = 0.7086, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.89it/s][ALoss = 1.1695e-02, PNorm = 69.3023, GNorm = 0.8167, lr_0 = 1.0000e-04
Loss = 1.1800e-02, PNorm = 69.3023, GNorm = 0.5483, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.75it/s][A100% 21/21 [00:00<00:00, 99.35it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.24it/s]
Validation prc-auc = 0.386450
 70% 21/30 [00:06<00:02,  3.35it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1055e-02, PNorm = 69.3024, GNorm = 0.6801, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.17it/s][ALoss = 1.2221e-02, PNorm = 69.3024, GNorm = 0.5209, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.71it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.43it/s]
Validation prc-auc = 0.414495
 73% 22/30 [00:06<00:02,  3.44it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0933e-02, PNorm = 69.3025, GNorm = 0.5512, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 88.54it/s][ALoss = 1.1385e-02, PNorm = 69.3025, GNorm = 0.7132, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 88.96it/s][A100% 21/21 [00:00<00:00, 89.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 98.52it/s]
Validation prc-auc = 0.532248
 77% 23/30 [00:06<00:02,  3.38it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1196e-02, PNorm = 69.3025, GNorm = 0.5650, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 82.05it/s][ALoss = 1.1009e-02, PNorm = 69.3026, GNorm = 0.5428, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 83.51it/s][A100% 21/21 [00:00<00:00, 85.21it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.95it/s]
Validation prc-auc = 0.565850
 80% 24/30 [00:07<00:01,  3.30it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0876e-02, PNorm = 69.3026, GNorm = 0.4753, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 92.74it/s][ALoss = 1.1090e-02, PNorm = 69.3027, GNorm = 0.5260, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 94.03it/s][A100% 21/21 [00:00<00:00, 95.14it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 84.52it/s]
Validation prc-auc = 0.597391
 83% 25/30 [00:07<00:01,  3.31it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1637e-02, PNorm = 69.3027, GNorm = 0.5185, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.88it/s][ALoss = 1.0600e-02, PNorm = 69.3028, GNorm = 0.5337, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 101.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.15it/s]
Validation prc-auc = 0.627847
 87% 26/30 [00:07<00:01,  3.40it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0932e-02, PNorm = 69.3028, GNorm = 0.5800, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.25it/s][ALoss = 1.0624e-02, PNorm = 69.3028, GNorm = 0.5144, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 96.79it/s][A100% 21/21 [00:00<00:00, 97.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.57it/s]
Validation prc-auc = 0.648084
 90% 27/30 [00:08<00:01,  2.17it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.9872e-03, PNorm = 69.3029, GNorm = 0.5421, lr_0 = 1.0000e-04

 33% 7/21 [00:00<00:00, 68.06it/s][ALoss = 1.0229e-02, PNorm = 69.3029, GNorm = 0.5821, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 74.46it/s][A100% 21/21 [00:00<00:00, 84.71it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.35it/s]
Validation prc-auc = 0.670640
 93% 28/30 [00:08<00:00,  2.39it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1434e-02, PNorm = 69.3030, GNorm = 0.7044, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.42it/s][ALoss = 1.0302e-02, PNorm = 69.3030, GNorm = 0.5271, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.56it/s][A100% 21/21 [00:00<00:00, 96.60it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.71it/s]
Validation prc-auc = 0.715050
 97% 29/30 [00:09<00:00,  2.63it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0545e-02, PNorm = 69.3031, GNorm = 0.6208, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 89.04it/s][ALoss = 1.0189e-02, PNorm = 69.3031, GNorm = 0.5560, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.70it/s][A100% 21/21 [00:00<00:00, 96.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.15it/s]
Validation prc-auc = 0.758793
100% 30/30 [00:09<00:00,  2.84it/s]100% 30/30 [00:09<00:00,  3.20it/s]
Model 0 best validation prc-auc = 0.758793 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 108.57it/s]
Model 0 test prc-auc = 0.766129
Ensemble test prc-auc = 0.766129
Fold 4
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909211 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1909211_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909211_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpf_w5lkdk/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909211'],
 'task_names': ['CHEMBL1909211'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 671,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]661it [00:00, 6605.66it/s]1544it [00:00, 7145.02it/s]2447it [00:00, 7620.07it/s]3360it [00:00, 8015.90it/s]4286it [00:00, 8352.03it/s]5221it [00:00, 8625.82it/s]6154it [00:00, 8825.04it/s]7090it [00:00, 8978.14it/s]8029it [00:00, 9095.90it/s]8925it [00:01, 9053.67it/s]9913it [00:01, 9286.18it/s]10972it [00:01, 9640.84it/s]12013it [00:01, 9857.43it/s]13005it [00:01, 9874.81it/s]14062it [00:01, 10072.07it/s]15117it [00:01, 10210.75it/s]16173it [00:01, 10311.11it/s]17228it [00:01, 10380.50it/s]18293it [00:01, 10457.58it/s]19358it [00:02, 10513.67it/s]20410it [00:02, 10364.22it/s]21452it [00:02, 10378.17it/s]22509it [00:02, 10434.59it/s]23570it [00:02, 10484.49it/s]24633it [00:02, 10525.68it/s]25696it [00:02, 10553.89it/s]26758it [00:02, 10572.41it/s]27822it [00:02, 10589.54it/s]28887it [00:02, 10606.18it/s]29952it [00:03, 10617.66it/s]31019it [00:03, 10631.29it/s]32087it [00:03, 10643.13it/s]33152it [00:03, 10639.72it/s]34219it [00:03, 10647.11it/s]35285it [00:03, 10650.07it/s]36352it [00:03, 10652.88it/s]37418it [00:03, 10653.38it/s]38484it [00:03, 10652.57it/s]39550it [00:03, 10653.16it/s]40616it [00:04, 10649.88it/s]41681it [00:04, 10617.51it/s]42746it [00:04, 10625.36it/s]43811it [00:04, 10631.45it/s]44876it [00:04, 10634.58it/s]45940it [00:04, 10627.61it/s]47003it [00:04, 10624.80it/s]48066it [00:04, 10621.82it/s]49129it [00:04, 10624.01it/s]50192it [00:04, 10621.67it/s]51262it [00:05, 10644.33it/s]52327it [00:05, 10403.36it/s]53377it [00:05, 10429.26it/s]54424it [00:05, 10438.84it/s]55472it [00:05, 10450.97it/s]56525it [00:05, 10472.47it/s]57591it [00:05, 10527.75it/s]58662it [00:05, 10579.52it/s]59737it [00:05, 10627.14it/s]60811it [00:05, 10658.73it/s]61865it [00:06, 10283.56it/s]
Number of examples remaining: 839
  0% 0/839 [00:00<?, ?it/s]100% 839/839 [00:00<00:00, 297491.00it/s]
  0% 0/839 [00:00<?, ?it/s] 74% 625/839 [00:00<00:00, 6221.54it/s]100% 839/839 [00:00<00:00, 5515.71it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/839 [00:00<?, ?it/s] 67% 562/839 [00:00<00:00, 5614.54it/s]100% 839/839 [00:00<00:00, 4270.52it/s]
Total scaffolds = 491 | train scaffolds = 370 | val scaffolds = 63 | test scaffolds = 58
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.05102041]), array([98])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909211 0: 88.80%, 1: 11.20%
Total size = 839 | train size = 671 | val size = 83 | test size = 85
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.3456e-02, PNorm = 69.3011, GNorm = 1.8903, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.21it/s][ALoss = 2.2424e-02, PNorm = 69.3011, GNorm = 1.4548, lr_0 = 1.0000e-04
Loss = 2.3582e-02, PNorm = 69.3011, GNorm = 2.0017, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.83it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 133.24it/s]
Validation prc-auc = 0.036795
  3% 1/30 [00:00<00:07,  3.82it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.2000e-02, PNorm = 69.3011, GNorm = 1.4159, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.08it/s][ALoss = 2.1170e-02, PNorm = 69.3011, GNorm = 1.6722, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.36it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 134.20it/s]
Validation prc-auc = 0.038406
  7% 2/30 [00:00<00:07,  3.88it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0894e-02, PNorm = 69.3011, GNorm = 1.8349, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.03it/s][ALoss = 2.0229e-02, PNorm = 69.3011, GNorm = 1.3901, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.09it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 133.88it/s]
Validation prc-auc = 0.039246
 10% 3/30 [00:00<00:06,  3.92it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9997e-02, PNorm = 69.3011, GNorm = 1.1494, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.94it/s][ALoss = 1.9725e-02, PNorm = 69.3011, GNorm = 1.5070, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.04it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 134.41it/s]
Validation prc-auc = 0.039485
 13% 4/30 [00:01<00:06,  3.92it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9072e-02, PNorm = 69.3011, GNorm = 1.5849, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.39it/s][ALoss = 1.8360e-02, PNorm = 69.3012, GNorm = 1.5314, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.29it/s]
Validation prc-auc = 0.040197
 17% 5/30 [00:01<00:06,  3.90it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8308e-02, PNorm = 69.3012, GNorm = 1.3290, lr_0 = 1.0000e-04

 33% 7/21 [00:00<00:00, 69.40it/s][ALoss = 1.7374e-02, PNorm = 69.3012, GNorm = 1.6665, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 74.65it/s][A100% 21/21 [00:00<00:00, 46.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.71it/s]
Validation prc-auc = 0.042729
 20% 6/30 [00:01<00:08,  2.99it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7887e-02, PNorm = 69.3012, GNorm = 1.2978, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.64it/s][ALoss = 1.7012e-02, PNorm = 69.3012, GNorm = 1.3996, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.48it/s][A100% 21/21 [00:00<00:00, 98.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.09it/s]
Validation prc-auc = 0.045393
 23% 7/30 [00:02<00:07,  3.14it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6363e-02, PNorm = 69.3013, GNorm = 1.1008, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.04it/s][ALoss = 1.6565e-02, PNorm = 69.3013, GNorm = 1.0138, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.96it/s][A100% 21/21 [00:00<00:00, 98.15it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.49it/s]
Validation prc-auc = 0.048593
 27% 8/30 [00:02<00:06,  3.25it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6306e-02, PNorm = 69.3013, GNorm = 1.1308, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 89.93it/s][ALoss = 1.5563e-02, PNorm = 69.3014, GNorm = 1.0696, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 94.69it/s][A100% 21/21 [00:00<00:00, 98.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 128.61it/s]
Validation prc-auc = 0.052619
 30% 9/30 [00:02<00:06,  3.35it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5236e-02, PNorm = 69.3014, GNorm = 1.0418, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.68it/s][ALoss = 1.5525e-02, PNorm = 69.3014, GNorm = 0.9379, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 103.38it/s][A100% 21/21 [00:00<00:00, 101.98it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.22it/s]
Validation prc-auc = 0.054565
 33% 10/30 [00:02<00:05,  3.43it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8951e-02, PNorm = 69.3014, GNorm = 0.9469, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.41it/s][ALoss = 1.5304e-02, PNorm = 69.3015, GNorm = 0.9523, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 99.26it/s][ALoss = 1.4277e-02, PNorm = 69.3015, GNorm = 0.9437, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 99.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.76it/s]
Validation prc-auc = 0.059652
 37% 11/30 [00:03<00:05,  3.35it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4441e-02, PNorm = 69.3015, GNorm = 1.0188, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.43it/s][ALoss = 1.4230e-02, PNorm = 69.3016, GNorm = 0.8798, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.15it/s][A100% 21/21 [00:00<00:00, 98.56it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.25it/s]
Validation prc-auc = 0.064207
 40% 12/30 [00:03<00:05,  3.41it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4423e-02, PNorm = 69.3016, GNorm = 0.8112, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.90it/s][ALoss = 1.3465e-02, PNorm = 69.3017, GNorm = 0.8092, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.65it/s][A100% 21/21 [00:00<00:00, 97.28it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.04it/s]
Validation prc-auc = 0.071236
 43% 13/30 [00:03<00:04,  3.45it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3844e-02, PNorm = 69.3017, GNorm = 0.6675, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 108.56it/s][ALoss = 1.3864e-02, PNorm = 69.3017, GNorm = 1.1793, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.01it/s]
Validation prc-auc = 0.083380
 47% 14/30 [00:04<00:04,  3.54it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2614e-02, PNorm = 69.3018, GNorm = 0.8375, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.05it/s][ALoss = 1.4140e-02, PNorm = 69.3018, GNorm = 0.7175, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.21it/s][A100% 21/21 [00:00<00:00, 98.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.80it/s]
Validation prc-auc = 0.090379
 50% 15/30 [00:04<00:04,  3.54it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3052e-02, PNorm = 69.3018, GNorm = 0.7093, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.96it/s][ALoss = 1.3168e-02, PNorm = 69.3019, GNorm = 0.8263, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.39it/s][A100% 21/21 [00:00<00:00, 98.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.41it/s]
Validation prc-auc = 0.110069
 53% 16/30 [00:04<00:03,  3.55it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3625e-02, PNorm = 69.3019, GNorm = 0.9413, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 102.15it/s][ALoss = 1.2519e-02, PNorm = 69.3020, GNorm = 0.8951, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 101.74it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 128.95it/s]
Validation prc-auc = 0.117365
 57% 17/30 [00:04<00:03,  3.59it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2688e-02, PNorm = 69.3020, GNorm = 0.7086, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.90it/s][ALoss = 1.1860e-02, PNorm = 69.3020, GNorm = 0.7199, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 104.40it/s][A100% 21/21 [00:00<00:00, 101.32it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.42it/s]
Validation prc-auc = 0.132017
 60% 18/30 [00:05<00:03,  3.60it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2262e-02, PNorm = 69.3021, GNorm = 0.5573, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 90.85it/s][ALoss = 1.2113e-02, PNorm = 69.3021, GNorm = 0.6905, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 89.84it/s][A100% 21/21 [00:00<00:00, 89.35it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.73it/s]
Validation prc-auc = 0.211342
 63% 19/30 [00:05<00:03,  3.49it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1428e-02, PNorm = 69.3022, GNorm = 0.6422, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 87.91it/s][ALoss = 1.1938e-02, PNorm = 69.3022, GNorm = 0.5205, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 88.00it/s][A100% 21/21 [00:00<00:00, 88.34it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.00it/s]
Validation prc-auc = 0.217410
 67% 20/30 [00:05<00:02,  3.42it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3975e-02, PNorm = 69.3022, GNorm = 0.6585, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.62it/s][ALoss = 1.1915e-02, PNorm = 69.3023, GNorm = 0.6794, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.12it/s][ALoss = 1.1567e-02, PNorm = 69.3023, GNorm = 0.6051, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 94.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.36it/s]
Validation prc-auc = 0.263811
 70% 21/30 [00:06<00:02,  3.42it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1008e-02, PNorm = 69.3024, GNorm = 0.6811, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.44it/s][ALoss = 1.2459e-02, PNorm = 69.3024, GNorm = 0.5630, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 101.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.50it/s]
Validation prc-auc = 0.270295
 73% 22/30 [00:06<00:02,  3.48it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1048e-02, PNorm = 69.3025, GNorm = 0.5171, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.73it/s][ALoss = 1.1877e-02, PNorm = 69.3025, GNorm = 0.6734, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.29it/s][A100% 21/21 [00:00<00:00, 98.16it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.38it/s]
Validation prc-auc = 0.273733
 77% 23/30 [00:06<00:01,  3.50it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0751e-02, PNorm = 69.3025, GNorm = 0.6076, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.95it/s][ALoss = 1.1325e-02, PNorm = 69.3026, GNorm = 0.6170, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.84it/s][A100% 21/21 [00:00<00:00, 96.52it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.69it/s]
Validation prc-auc = 0.293005
 80% 24/30 [00:06<00:01,  3.50it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0463e-02, PNorm = 69.3026, GNorm = 0.6217, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.13it/s][ALoss = 1.0872e-02, PNorm = 69.3027, GNorm = 0.6368, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 101.37it/s][A100% 21/21 [00:00<00:00, 103.84it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 92.91it/s]
Validation prc-auc = 0.318308
 83% 25/30 [00:07<00:01,  3.51it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0883e-02, PNorm = 69.3027, GNorm = 0.5632, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 110.69it/s][ALoss = 1.1038e-02, PNorm = 69.3028, GNorm = 0.5449, lr_0 = 1.0000e-04

 76% 16/21 [00:00<00:00, 54.65it/s] [A100% 21/21 [00:00<00:00, 57.99it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 83.22it/s]
Validation prc-auc = 0.350847
 87% 26/30 [00:07<00:01,  2.98it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1932e-02, PNorm = 69.3028, GNorm = 0.5371, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 89.40it/s][ALoss = 1.0056e-02, PNorm = 69.3029, GNorm = 0.4642, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.74it/s][A100% 21/21 [00:00<00:00, 96.12it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.15it/s]
Validation prc-auc = 0.361760
 90% 27/30 [00:07<00:00,  3.12it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0609e-02, PNorm = 69.3029, GNorm = 0.5206, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.05it/s][ALoss = 1.0543e-02, PNorm = 69.3030, GNorm = 0.4669, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.08it/s][A100% 21/21 [00:00<00:00, 98.85it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.21it/s]
Validation prc-auc = 0.342712
 93% 28/30 [00:08<00:00,  3.36it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.6067e-03, PNorm = 69.3030, GNorm = 0.4815, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.04it/s][ALoss = 1.0589e-02, PNorm = 69.3031, GNorm = 0.4340, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.23it/s][A100% 21/21 [00:00<00:00, 97.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.64it/s]
Validation prc-auc = 0.342712
 97% 29/30 [00:08<00:00,  3.51it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0319e-02, PNorm = 69.3031, GNorm = 0.5074, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 89.11it/s][ALoss = 9.6644e-03, PNorm = 69.3032, GNorm = 0.5722, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.77it/s][A100% 21/21 [00:00<00:00, 96.30it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.95it/s]
Validation prc-auc = 0.342712
100% 30/30 [00:08<00:00,  3.62it/s]100% 30/30 [00:08<00:00,  3.46it/s]
Model 0 best validation prc-auc = 0.361760 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 123.00it/s]
Model 0 test prc-auc = 0.524416
Ensemble test prc-auc = 0.524416
5-fold cross validation
Seed 0 ==> test prc-auc = 0.620569
Seed 1 ==> test prc-auc = 0.818756
Seed 2 ==> test prc-auc = 0.588927
Seed 3 ==> test prc-auc = 0.766129
Seed 4 ==> test prc-auc = 0.524416
Overall test prc-auc = 0.663759 +/- 0.110802

wandb: Waiting for W&B process to finish, PID 481
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                               _runtime 86.402104139328
wandb:                                                  _step 154
wandb:                                             _timestamp 1596914377.7126017
wandb:                                     validation_prc-auc 0.3427123992877418
wandb:                                           test_prc-auc 0.5244160129086599
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.20MB of 0.20MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL1909211_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/et3eq19z
