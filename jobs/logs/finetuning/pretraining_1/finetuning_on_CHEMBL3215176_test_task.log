wandb: Currently logged in as: apappu97 (use `wandb login --relogin` to force relogin)
wandb: Tracking run with wandb version 0.10.1
wandb: Run data is saved locally in wandb/run-20200917_125943-3daqu3xc
wandb: Syncing run finetuning_finetuning_on_CHEMBL3215176_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/3daqu3xc
wandb: Run `wandb off` to turn off syncing.
Fold 0
Command line
python chemprop/finetune.py --seeds 1 2 4 5 6 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpxaru89bt/fold_0',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': [1, 2, 4, 5, 6],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]927it [00:00, 9265.50it/s]1853it [00:00, 9262.48it/s]2770it [00:00, 9234.28it/s]3690it [00:00, 9222.05it/s]4560it [00:00, 9056.23it/s]5482it [00:00, 9103.08it/s]6410it [00:00, 9152.72it/s]7324it [00:00, 9146.08it/s]8186it [00:00, 8849.53it/s]9112it [00:01, 8968.40it/s]10034it [00:01, 9042.21it/s]10979it [00:01, 9160.04it/s]11910it [00:01, 9203.23it/s]12859it [00:01, 9286.31it/s]13798it [00:01, 9314.90it/s]14736it [00:01, 9333.21it/s]15672it [00:01, 9340.12it/s]16605it [00:01, 9322.75it/s]17549it [00:01, 9357.56it/s]18486it [00:02, 9359.98it/s]19425it [00:02, 9366.69it/s]20368it [00:02, 9383.93it/s]21307it [00:02, 9330.07it/s]22248it [00:02, 9352.06it/s]23184it [00:02, 9344.48it/s]24119it [00:02, 9308.96it/s]25050it [00:02, 9269.31it/s]25978it [00:02, 9269.86it/s]26924it [00:02, 9324.49it/s]27868it [00:03, 9357.50it/s]28804it [00:03, 9340.78it/s]29747it [00:03, 9365.30it/s]30684it [00:03, 9326.08it/s]31617it [00:03, 9294.78it/s]32561it [00:03, 9335.40it/s]33501it [00:03, 9354.61it/s]34443it [00:03, 9372.33it/s]35381it [00:03, 9353.79it/s]36321it [00:03, 9366.59it/s]37258it [00:04, 9363.35it/s]38195it [00:04, 9271.25it/s]39123it [00:04, 9272.37it/s]40051it [00:04, 9251.61it/s]40977it [00:04, 9230.87it/s]41913it [00:04, 9266.85it/s]42849it [00:04, 9292.57it/s]43796it [00:04, 9342.64it/s]44731it [00:04, 9316.72it/s]45676it [00:04, 9355.53it/s]46620it [00:05, 9380.59it/s]47559it [00:05, 9268.68it/s]48491it [00:05, 9283.83it/s]49420it [00:05, 9262.61it/s]50347it [00:05, 9141.90it/s]51280it [00:05, 9194.72it/s]52216it [00:05, 9243.30it/s]53141it [00:05, 9226.01it/s]54064it [00:05, 9202.99it/s]54985it [00:05, 9098.99it/s]55908it [00:06, 9137.00it/s]56852it [00:06, 9224.79it/s]57775it [00:06, 9013.96it/s]58678it [00:06, 8970.13it/s]59627it [00:06, 9118.04it/s]60563it [00:06, 9188.77it/s]61499it [00:06, 9239.28it/s]61865it [00:06, 9251.03it/s]
Number of examples remaining: 157
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 68601.49it/s]
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 3583.31it/s]
Number of tasks = 1
Splitting data with seed 1
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 3865.56it/s]
Total scaffolds = 131 | train scaffolds = 104 | val scaffolds = 14 | test scaffolds = 13
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([2]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.32it/s][A
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  6.86it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 44.37it/s]
Validation prc-auc = 0.072024
  3%|‚ñé         | 1/30 [00:00<00:11,  2.51it/s]Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.44it/s]
Validation prc-auc = 0.072024
Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1332e-02, PNorm = 69.3011, GNorm = 1.4299, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.08it/s]
Validation prc-auc = 0.075778
 10%|‚ñà         | 3/30 [00:00<00:08,  3.29it/s]Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.35it/s]
Validation prc-auc = 0.075778
Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 139.36it/s]
Validation prc-auc = 0.074176
 17%|‚ñà‚ñã        | 5/30 [00:00<00:05,  4.33it/s]Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0921e-02, PNorm = 69.3011, GNorm = 1.4594, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.11it/s]
Validation prc-auc = 0.074176
Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.22it/s]
Validation prc-auc = 0.074176
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:04,  5.55it/s]Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0565e-02, PNorm = 69.3011, GNorm = 0.9559, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 59.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 132.61it/s]
Validation prc-auc = 0.074176
Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.36it/s]
Validation prc-auc = 0.074176
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:03,  6.81it/s]Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.76it/s]
Validation prc-auc = 0.074176
Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0075e-02, PNorm = 69.3011, GNorm = 1.3878, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 157.27it/s]
Validation prc-auc = 0.074176
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:01<00:02,  8.22it/s]Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.59it/s]
Validation prc-auc = 0.074176
Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9981e-02, PNorm = 69.3011, GNorm = 1.0643, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.30it/s]
Validation prc-auc = 0.074176
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:01,  9.64it/s]Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 134.48it/s]
Validation prc-auc = 0.074176
Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.27it/s]
Validation prc-auc = 0.074176
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01, 10.99it/s]Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9137e-02, PNorm = 69.3011, GNorm = 1.0881, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.71it/s]
Validation prc-auc = 0.074176
Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.91it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.78it/s]
Validation prc-auc = 0.074176
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:01, 10.95it/s]Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9232e-02, PNorm = 69.3011, GNorm = 0.8204, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.48it/s]
Validation prc-auc = 0.074176
Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.32it/s]
Validation prc-auc = 0.074176
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 12.11it/s]Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.58it/s]
Validation prc-auc = 0.074176
Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8289e-02, PNorm = 69.3012, GNorm = 1.1380, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.88it/s]
Validation prc-auc = 0.074176
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 13.08it/s]Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.61it/s]
Validation prc-auc = 0.074176
Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.63it/s]
Validation prc-auc = 0.074176
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 13.86it/s]Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8097e-02, PNorm = 69.3012, GNorm = 1.0554, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.89it/s]
Validation prc-auc = 0.074176
Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.33it/s]
Validation prc-auc = 0.074176
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:01<00:00, 14.54it/s]Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7840e-02, PNorm = 69.3012, GNorm = 1.0420, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 63.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.56it/s]
Validation prc-auc = 0.074176
Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.74it/s]
Validation prc-auc = 0.074176
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:02<00:00, 14.71it/s]Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.46it/s]
Validation prc-auc = 0.074176
Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7958e-02, PNorm = 69.3012, GNorm = 0.7718, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.62it/s]
Validation prc-auc = 0.074176
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:02<00:00, 15.13it/s]Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.93it/s]
Validation prc-auc = 0.074176
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 12.97it/s]
Model 0 best validation prc-auc = 0.075778 on epoch 2
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 43.38it/s]
Model 0 test prc-auc = 0.075778
Ensemble test prc-auc = 0.075778
Fold 1
Command line
python chemprop/finetune.py --seeds 1 2 4 5 6 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpxaru89bt/fold_1',
 'save_smiles_splits': False,
 'seed': 2,
 'seeds': [1, 2, 4, 5, 6],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]916it [00:00, 9156.86it/s]1831it [00:00, 9154.09it/s]2752it [00:00, 9167.94it/s]3664it [00:00, 9151.80it/s]4544it [00:00, 9041.39it/s]5470it [00:00, 9103.84it/s]6412it [00:00, 9195.09it/s]7344it [00:00, 9231.94it/s]8269it [00:00, 9235.00it/s]9184it [00:01, 9207.40it/s]10122it [00:01, 9255.88it/s]11056it [00:01, 9279.30it/s]11992it [00:01, 9302.96it/s]12914it [00:01, 9209.60it/s]13830it [00:01, 9180.40it/s]14765it [00:01, 9228.80it/s]15688it [00:01, 9227.15it/s]16617it [00:01, 9245.00it/s]17541it [00:01, 9223.13it/s]18463it [00:02, 9143.72it/s]19392it [00:02, 9185.49it/s]20319it [00:02, 9210.36it/s]21246it [00:02, 9226.65it/s]22169it [00:02, 9198.71it/s]23089it [00:02, 9172.53it/s]24016it [00:02, 9200.52it/s]24954it [00:02, 9253.28it/s]25883it [00:02, 9263.08it/s]26810it [00:02, 9227.72it/s]27733it [00:03, 9147.62it/s]28652it [00:03, 9160.10it/s]29579it [00:03, 9190.19it/s]30499it [00:03, 9096.80it/s]31409it [00:03, 9094.55it/s]32319it [00:03, 8968.22it/s]33236it [00:03, 9025.28it/s]34139it [00:03, 9014.12it/s]35069it [00:03, 9097.69it/s]35980it [00:03, 9072.28it/s]36888it [00:04, 9017.47it/s]37822it [00:04, 9110.19it/s]38748it [00:04, 9152.80it/s]39686it [00:04, 9218.22it/s]40615it [00:04, 9238.34it/s]41540it [00:04, 9219.96it/s]42465it [00:04, 9226.47it/s]43388it [00:04, 9202.57it/s]44309it [00:04, 9057.08it/s]45216it [00:04, 9039.17it/s]46121it [00:05, 8997.77it/s]47046it [00:05, 9069.38it/s]47982it [00:05, 9152.19it/s]48898it [00:05, 8816.70it/s]49825it [00:05, 8945.70it/s]50736it [00:05, 8992.03it/s]51641it [00:05, 9007.24it/s]52558it [00:05, 9052.67it/s]53481it [00:05, 9104.10it/s]54393it [00:05, 9017.19it/s]55296it [00:06, 8922.30it/s]56194it [00:06, 8938.92it/s]57130it [00:06, 9060.53it/s]58074it [00:06, 9169.99it/s]58996it [00:06, 9181.94it/s]59915it [00:06, 8937.83it/s]60851it [00:06, 9057.99it/s]61780it [00:06, 9125.23it/s]61865it [00:06, 9129.84it/s]
Number of examples remaining: 157
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 273238.89it/s]
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 4238.72it/s]
Number of tasks = 1
Splitting data with seed 2
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 3727.00it/s]
Total scaffolds = 131 | train scaffolds = 103 | val scaffolds = 14 | test scaffolds = 14
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.66666667]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.15it/s]
Warning: Found a task with targets all 0s or all 1s
/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7%|‚ñã         | 2/30 [00:00<00:01, 15.89it/s]Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1492e-02, PNorm = 69.3011, GNorm = 1.0652, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 158.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.63it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13%|‚ñà‚ñé        | 4/30 [00:00<00:01, 15.96it/s]Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.12it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1374e-02, PNorm = 69.3011, GNorm = 1.1048, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.89it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20%|‚ñà‚ñà        | 6/30 [00:00<00:01, 15.96it/s]Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 159.01it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0705e-02, PNorm = 69.3011, GNorm = 1.1742, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 15.99it/s]Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 16.10it/s]Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0303e-02, PNorm = 69.3011, GNorm = 1.2229, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.10it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.58it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:00<00:01, 16.13it/s]Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0351e-02, PNorm = 69.3011, GNorm = 1.0674, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 157.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 158.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:00<00:00, 16.19it/s]Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9813e-02, PNorm = 69.3011, GNorm = 1.0222, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:00<00:00, 16.03it/s]Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.15it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9632e-02, PNorm = 69.3011, GNorm = 0.8494, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:00, 15.91it/s]Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.47it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 16.03it/s]Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8674e-02, PNorm = 69.3011, GNorm = 1.2100, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.77it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 16.02it/s]Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7763e-02, PNorm = 69.3012, GNorm = 1.1935, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:01<00:00, 15.88it/s]Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 158.46it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7824e-02, PNorm = 69.3012, GNorm = 1.1141, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.25it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:01<00:00, 15.88it/s]Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.06it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:01<00:00, 16.04it/s]Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8152e-02, PNorm = 69.3012, GNorm = 0.9644, lr_0 = 1.0000e-04

 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.60it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 31.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 158.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 159.42it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 13.62it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 15.41it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 117.38it/s]
Model 0 test prc-auc = 0.083333
Ensemble test prc-auc = 0.083333
Fold 2
Command line
python chemprop/finetune.py --seeds 1 2 4 5 6 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpxaru89bt/fold_2',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [1, 2, 4, 5, 6],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]870it [00:00, 8698.29it/s]1691it [00:00, 8543.41it/s]2451it [00:00, 8234.82it/s]3337it [00:00, 8412.41it/s]4237it [00:00, 8579.57it/s]5131it [00:00, 8683.33it/s]6023it [00:00, 8751.80it/s]6907it [00:00, 8775.21it/s]7796it [00:00, 8809.23it/s]8675it [00:01, 8803.45it/s]9565it [00:01, 8829.19it/s]10469it [00:01, 8890.92it/s]11347it [00:01, 8841.16it/s]12238it [00:01, 8861.20it/s]13121it [00:01, 8850.87it/s]14019it [00:01, 8889.10it/s]14915it [00:01, 8907.83it/s]15804it [00:01, 8651.29it/s]16670it [00:01, 8393.19it/s]17547it [00:02, 8500.67it/s]18431it [00:02, 8598.03it/s]19325it [00:02, 8697.60it/s]20221it [00:02, 8772.20it/s]21110it [00:02, 8804.70it/s]22004it [00:02, 8843.74it/s]22889it [00:02, 8566.66it/s]23748it [00:02, 8514.03it/s]24618it [00:02, 8566.11it/s]25500it [00:02, 8637.93it/s]26384it [00:03, 8696.78it/s]27285it [00:03, 8786.80it/s]28165it [00:03, 8735.53it/s]29063it [00:03, 8805.92it/s]29945it [00:03, 8806.24it/s]30838it [00:03, 8841.87it/s]31723it [00:03, 8839.71it/s]32611it [00:03, 8850.54it/s]33497it [00:03, 8824.12it/s]34390it [00:03, 8853.47it/s]35294it [00:04, 8908.48it/s]36193it [00:04, 8932.25it/s]37093it [00:04, 8951.33it/s]37989it [00:04, 8931.59it/s]38883it [00:04, 8897.05it/s]39774it [00:04, 8897.82it/s]40679it [00:04, 8940.01it/s]41574it [00:04, 8921.27it/s]42467it [00:04, 8891.78it/s]43357it [00:04, 8870.05it/s]44245it [00:05, 8612.24it/s]45108it [00:05, 8587.28it/s]45997it [00:05, 8675.70it/s]46887it [00:05, 8739.06it/s]47762it [00:05, 8678.64it/s]48660it [00:05, 8764.89it/s]49552it [00:05, 8809.66it/s]50434it [00:05, 8714.91it/s]51336it [00:05, 8804.10it/s]52218it [00:05, 8793.99it/s]53116it [00:06, 8846.42it/s]54002it [00:06, 8764.13it/s]54886it [00:06, 8779.23it/s]55765it [00:06, 8674.48it/s]56633it [00:06, 8672.66it/s]57524it [00:06, 8742.44it/s]58417it [00:06, 8797.87it/s]59314it [00:06, 8845.81it/s]60204it [00:06, 8860.34it/s]61099it [00:06, 8885.51it/s]61865it [00:07, 8767.43it/s]
Number of examples remaining: 157
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 310030.95it/s]
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 4212.15it/s]
Number of tasks = 1
Splitting data with seed 4
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 3719.07it/s]
Total scaffolds = 131 | train scaffolds = 104 | val scaffolds = 15 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 69.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 171.66it/s]
Validation prc-auc = 0.166667
  3%|‚ñé         | 1/30 [00:00<00:03,  9.27it/s]Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 163.92it/s]
Validation prc-auc = 0.166667
Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1380e-02, PNorm = 69.3011, GNorm = 1.2047, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 160.95it/s]
Validation prc-auc = 0.166667
 10%|‚ñà         | 3/30 [00:00<00:02, 10.55it/s]Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 165.97it/s]
Validation prc-auc = 0.166667
Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 169.76it/s]
Validation prc-auc = 0.166667
 17%|‚ñà‚ñã        | 5/30 [00:00<00:02, 11.78it/s]Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0655e-02, PNorm = 69.3011, GNorm = 1.2456, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 157.43it/s]
Validation prc-auc = 0.125000
Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 162.02it/s]
Validation prc-auc = 0.125000
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:01, 12.71it/s]Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0355e-02, PNorm = 69.3011, GNorm = 1.4753, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 162.60it/s]
Validation prc-auc = 0.125000
Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 165.55it/s]
Validation prc-auc = 0.100000
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:01, 13.47it/s]Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.31it/s]
Validation prc-auc = 0.100000
Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0437e-02, PNorm = 69.3011, GNorm = 1.3457, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.65it/s]
Validation prc-auc = 0.083333
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:00<00:01, 14.10it/s]Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 169.42it/s]
Validation prc-auc = 0.083333
Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0462e-02, PNorm = 69.3011, GNorm = 0.7099, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 170.30it/s]
Validation prc-auc = 0.071429
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:00<00:01, 14.64it/s]Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 159.61it/s]
Validation prc-auc = 0.062500
Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 159.46it/s]
Validation prc-auc = 0.050000
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:00<00:00, 15.08it/s]Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9540e-02, PNorm = 69.3011, GNorm = 1.1629, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 171.67it/s]
Validation prc-auc = 0.045455
Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 161.00it/s]
Validation prc-auc = 0.045455
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:00, 15.35it/s]Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9502e-02, PNorm = 69.3011, GNorm = 1.1181, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.97it/s]
Validation prc-auc = 0.041667
Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 167.26it/s]
Validation prc-auc = 0.041667
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 15.49it/s]Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 170.03it/s]
Validation prc-auc = 0.041667
Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8514e-02, PNorm = 69.3011, GNorm = 0.7479, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 164.07it/s]
Validation prc-auc = 0.041667
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 15.63it/s]Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 163.44it/s]
Validation prc-auc = 0.041667
Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 159.90it/s]
Validation prc-auc = 0.041667
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 15.81it/s]Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8242e-02, PNorm = 69.3012, GNorm = 0.8934, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.79it/s]
Validation prc-auc = 0.041667
Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 158.54it/s]
Validation prc-auc = 0.041667
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:01<00:00, 15.86it/s]Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7966e-02, PNorm = 69.3012, GNorm = 0.8635, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 167.89it/s]
Validation prc-auc = 0.041667
Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 163.74it/s]
Validation prc-auc = 0.041667
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:01<00:00, 15.82it/s]Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 69.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.55it/s]
Validation prc-auc = 0.038462
Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7077e-02, PNorm = 69.3012, GNorm = 1.2698, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 167.81it/s]
Validation prc-auc = 0.038462
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:01<00:00, 15.65it/s]Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.78it/s]
Validation prc-auc = 0.038462
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 15.51it/s]
Model 0 best validation prc-auc = 0.166667 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.18it/s]
Model 0 test prc-auc = 1.000000
Ensemble test prc-auc = 1.000000
Fold 3
Command line
python chemprop/finetune.py --seeds 1 2 4 5 6 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpxaru89bt/fold_3',
 'save_smiles_splits': False,
 'seed': 5,
 'seeds': [1, 2, 4, 5, 6],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]881it [00:00, 8800.59it/s]1801it [00:00, 8914.70it/s]2717it [00:00, 8986.32it/s]3655it [00:00, 9100.84it/s]4536it [00:00, 9009.80it/s]5336it [00:00, 8680.98it/s]6258it [00:00, 8834.11it/s]7185it [00:00, 8957.88it/s]8110it [00:00, 9041.44it/s]8981it [00:01, 8809.71it/s]9904it [00:01, 8929.93it/s]10832it [00:01, 9030.45it/s]11758it [00:01, 9097.71it/s]12684it [00:01, 9144.95it/s]13612it [00:01, 9184.86it/s]14538it [00:01, 9206.06it/s]15466it [00:01, 9225.69it/s]16392it [00:01, 9235.16it/s]17326it [00:01, 9266.15it/s]18252it [00:02, 9249.95it/s]19177it [00:02, 9203.50it/s]20101it [00:02, 9212.62it/s]21023it [00:02, 9108.81it/s]21950it [00:02, 9155.59it/s]22866it [00:02, 9101.15it/s]23784it [00:02, 9122.21it/s]24702it [00:02, 9138.29it/s]25634it [00:02, 9189.97it/s]26554it [00:02, 9108.47it/s]27466it [00:03, 9110.35it/s]28378it [00:03, 9050.65it/s]29284it [00:03, 9034.02it/s]30216it [00:03, 9117.50it/s]31135it [00:03, 9138.25it/s]32050it [00:03, 9089.87it/s]32970it [00:03, 9121.60it/s]33884it [00:03, 9126.89it/s]34817it [00:03, 9186.44it/s]35736it [00:03, 9184.68it/s]36655it [00:04, 9167.49it/s]37573it [00:04, 9168.35it/s]38490it [00:04, 9109.84it/s]39402it [00:04, 8936.30it/s]40297it [00:04, 8931.13it/s]41201it [00:04, 8961.19it/s]42127it [00:04, 9046.75it/s]43050it [00:04, 9098.62it/s]43976it [00:04, 9144.71it/s]44891it [00:04, 9084.78it/s]45800it [00:05, 9081.43it/s]46723it [00:05, 9124.07it/s]47636it [00:05, 9109.58it/s]48558it [00:05, 9142.35it/s]49476it [00:05, 9151.39it/s]50392it [00:05, 9089.65it/s]51302it [00:05, 8759.63it/s]52184it [00:05, 8774.49it/s]53064it [00:05, 8570.66it/s]53955it [00:05, 8667.91it/s]54832it [00:06, 8696.15it/s]55726it [00:06, 8765.63it/s]56640it [00:06, 8873.53it/s]57550it [00:06, 8939.54it/s]58465it [00:06, 8999.22it/s]59366it [00:06, 8996.78it/s]60267it [00:06, 8950.25it/s]61184it [00:06, 9012.39it/s]61865it [00:06, 9050.66it/s]
Number of examples remaining: 157
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 328595.67it/s]
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 4172.99it/s]
Number of tasks = 1
Splitting data with seed 5
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 3730.40it/s]
Total scaffolds = 131 | train scaffolds = 102 | val scaffolds = 14 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 66.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.87it/s]
Validation prc-auc = 0.062500
  3%|‚ñé         | 1/30 [00:00<00:03,  8.89it/s]Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.09it/s]
Validation prc-auc = 0.062500
Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1323e-02, PNorm = 69.3011, GNorm = 1.2825, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.35it/s]
Validation prc-auc = 0.062500
 10%|‚ñà         | 3/30 [00:00<00:02, 10.28it/s]Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.86it/s]
Validation prc-auc = 0.062500
Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 149.53it/s]
Validation prc-auc = 0.062500
 17%|‚ñà‚ñã        | 5/30 [00:00<00:02, 11.57it/s]Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0547e-02, PNorm = 69.3011, GNorm = 1.4416, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.82it/s]
Validation prc-auc = 0.062500
Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.09it/s]
Validation prc-auc = 0.062500
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:01, 12.61it/s]Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0304e-02, PNorm = 69.3011, GNorm = 1.2404, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.28it/s]
Validation prc-auc = 0.062500
Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 79.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 157.46it/s]
Validation prc-auc = 0.062500
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:01, 13.51it/s]Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.27it/s]
Validation prc-auc = 0.062500
Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0856e-02, PNorm = 69.3011, GNorm = 0.8678, lr_0 = 1.0000e-04

 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.55it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 29.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 149.09it/s]
Validation prc-auc = 0.062500
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:00<00:01, 12.11it/s]Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 149.41it/s]
Validation prc-auc = 0.062500
Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0260e-02, PNorm = 69.3011, GNorm = 1.1744, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.79it/s]
Validation prc-auc = 0.062500
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:00<00:01, 13.03it/s]Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.27it/s]
Validation prc-auc = 0.062500
Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.68it/s]
Validation prc-auc = 0.055556
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01, 13.86it/s]Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9023e-02, PNorm = 69.3011, GNorm = 1.1357, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.26it/s]
Validation prc-auc = 0.055556
Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.79it/s]
Validation prc-auc = 0.055556
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:00, 14.40it/s]Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9251e-02, PNorm = 69.3011, GNorm = 1.2107, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.13it/s]
Validation prc-auc = 0.055556
Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.00it/s]
Validation prc-auc = 0.050000
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 14.83it/s]Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.49it/s]
Validation prc-auc = 0.050000
Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8219e-02, PNorm = 69.3011, GNorm = 1.2837, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.15it/s]
Validation prc-auc = 0.045455
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 15.14it/s]Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.56it/s]
Validation prc-auc = 0.041667
Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.85it/s]
Validation prc-auc = 0.041667
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 15.48it/s]Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8112e-02, PNorm = 69.3012, GNorm = 1.0791, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.67it/s]
Validation prc-auc = 0.041667
Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.50it/s]
Validation prc-auc = 0.041667
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:01<00:00, 15.68it/s]Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7240e-02, PNorm = 69.3012, GNorm = 1.1155, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.94it/s]
Validation prc-auc = 0.041667
Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 78.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.05it/s]
Validation prc-auc = 0.041667
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:01<00:00, 15.71it/s]Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.08it/s]
Validation prc-auc = 0.041667
Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7689e-02, PNorm = 69.3012, GNorm = 0.9413, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.17it/s]
Validation prc-auc = 0.041667
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:01<00:00, 15.76it/s]Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.83it/s]
Validation prc-auc = 0.041667
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 15.01it/s]
Model 0 best validation prc-auc = 0.062500 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 116.99it/s]
Model 0 test prc-auc = 0.287500
Ensemble test prc-auc = 0.287500
Fold 4
Command line
python chemprop/finetune.py --seeds 1 2 4 5 6 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpxaru89bt/fold_4',
 'save_smiles_splits': False,
 'seed': 6,
 'seeds': [1, 2, 4, 5, 6],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]883it [00:00, 8821.97it/s]1756it [00:00, 8791.57it/s]2655it [00:00, 8850.04it/s]3533it [00:00, 8827.55it/s]4412it [00:00, 8815.35it/s]5319it [00:00, 8890.19it/s]6206it [00:00, 8882.71it/s]7119it [00:00, 8953.03it/s]8003it [00:00, 8916.56it/s]8910it [00:01, 8959.86it/s]9814it [00:01, 8982.51it/s]10695it [00:01, 8809.34it/s]11565it [00:01, 8737.69it/s]12460it [00:01, 8798.39it/s]13356it [00:01, 8844.58it/s]14259it [00:01, 8896.70it/s]15147it [00:01, 8880.22it/s]16049it [00:01, 8918.96it/s]16952it [00:01, 8949.82it/s]17847it [00:02, 8787.61it/s]18753it [00:02, 8867.17it/s]19644it [00:02, 8877.60it/s]20548it [00:02, 8923.38it/s]21458it [00:02, 8973.12it/s]22359it [00:02, 8982.76it/s]23261it [00:02, 8981.81it/s]24160it [00:02, 8873.52it/s]25055it [00:02, 8894.37it/s]25952it [00:02, 8916.43it/s]26854it [00:03, 8946.29it/s]27756it [00:03, 8965.83it/s]28653it [00:03, 8922.39it/s]29551it [00:03, 8937.34it/s]30462it [00:03, 8986.98it/s]31361it [00:03, 8950.16it/s]32257it [00:03, 8941.03it/s]33152it [00:03, 8853.82it/s]34050it [00:03, 8890.62it/s]34941it [00:03, 8895.30it/s]35831it [00:04, 8884.62it/s]36725it [00:04, 8900.68it/s]37616it [00:04, 8795.24it/s]38508it [00:04, 8830.69it/s]39392it [00:04, 8829.42it/s]40296it [00:04, 8890.28it/s]41186it [00:04, 8892.14it/s]42076it [00:04, 8873.78it/s]42971it [00:04, 8893.82it/s]43861it [00:04, 8891.70it/s]44757it [00:05, 8910.61it/s]45649it [00:05, 8539.48it/s]46507it [00:05, 8361.63it/s]47347it [00:05, 8254.64it/s]48233it [00:05, 8427.09it/s]49127it [00:05, 8572.82it/s]50018it [00:05, 8668.93it/s]50887it [00:05, 8620.28it/s]51757it [00:05, 8643.56it/s]52655it [00:05, 8740.16it/s]53540it [00:06, 8770.24it/s]54418it [00:06, 8702.52it/s]55289it [00:06, 8527.82it/s]56171it [00:06, 8611.85it/s]57069it [00:06, 8718.33it/s]57959it [00:06, 8769.46it/s]58853it [00:06, 8817.42it/s]59736it [00:06, 8765.20it/s]60625it [00:06, 8800.54it/s]61524it [00:06, 8853.41it/s]61865it [00:07, 8821.66it/s]
Number of examples remaining: 157
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 280932.48it/s]
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 4268.64it/s]
Number of tasks = 1
Splitting data with seed 6
  0%|          | 0/157 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 157/157 [00:00<00:00, 3750.87it/s]
Total scaffolds = 131 | train scaffolds = 107 | val scaffolds = 11 | test scaffolds = 13
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.93it/s]
Validation prc-auc = 0.250000
  3%|‚ñé         | 1/30 [00:00<00:03,  9.48it/s]Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.03it/s]
Validation prc-auc = 0.250000
Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1481e-02, PNorm = 69.3011, GNorm = 1.3662, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.10it/s]
Validation prc-auc = 0.250000
 10%|‚ñà         | 3/30 [00:00<00:02, 10.77it/s]Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.91it/s]
Validation prc-auc = 0.250000
Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 68.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.08it/s]
Validation prc-auc = 0.250000
 17%|‚ñà‚ñã        | 5/30 [00:00<00:02, 11.86it/s]Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0880e-02, PNorm = 69.3011, GNorm = 1.3438, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 151.28it/s]
Validation prc-auc = 0.250000
Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.00it/s]
Validation prc-auc = 0.250000
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:01, 12.81it/s]Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0155e-02, PNorm = 69.3011, GNorm = 1.5219, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 70.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.37it/s]
Validation prc-auc = 0.250000
Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.35it/s]
Validation prc-auc = 0.250000
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:01, 13.48it/s]Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.51it/s]
Validation prc-auc = 0.250000
Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9272e-02, PNorm = 69.3011, GNorm = 1.2724, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.73it/s]
Validation prc-auc = 0.250000
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:00<00:01, 14.08it/s]Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.43it/s]
Validation prc-auc = 0.250000
Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9879e-02, PNorm = 69.3011, GNorm = 1.4447, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.05it/s]
Validation prc-auc = 0.166667
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:00<00:01, 14.61it/s]Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.56it/s]
Validation prc-auc = 0.166667
Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.54it/s]
Validation prc-auc = 0.166667
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:00<00:01, 14.98it/s]Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8695e-02, PNorm = 69.3011, GNorm = 1.3200, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 65.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.01it/s]
Validation prc-auc = 0.166667
Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.21it/s]
Validation prc-auc = 0.166667
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:00, 14.99it/s]Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9011e-02, PNorm = 69.3011, GNorm = 1.3357, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 74.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 154.29it/s]
Validation prc-auc = 0.166667
Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 155.10it/s]
Validation prc-auc = 0.166667
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 15.29it/s]Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.18it/s]
Validation prc-auc = 0.166667
Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8303e-02, PNorm = 69.3011, GNorm = 1.1511, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 72.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.83it/s]
Validation prc-auc = 0.166667
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 15.40it/s]Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.66it/s]
Validation prc-auc = 0.166667
Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 76.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 153.35it/s]
Validation prc-auc = 0.166667
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 15.66it/s]Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8112e-02, PNorm = 69.3012, GNorm = 0.8940, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 71.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.00it/s]
Validation prc-auc = 0.125000
Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 77.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 152.57it/s]
Validation prc-auc = 0.100000
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:01<00:00, 15.63it/s]Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7651e-02, PNorm = 69.3012, GNorm = 1.1296, lr_0 = 1.0000e-04

 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.45it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 31.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 150.01it/s]
Validation prc-auc = 0.100000
Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.99it/s]
Validation prc-auc = 0.100000
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:01<00:00, 13.31it/s]Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 75.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 149.86it/s]
Validation prc-auc = 0.100000
Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7579e-02, PNorm = 69.3012, GNorm = 1.0083, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 73.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 156.45it/s]
Validation prc-auc = 0.100000
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:01<00:00, 13.98it/s]Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 70.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.44it/s]
Validation prc-auc = 0.100000
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 14.79it/s]
Model 0 best validation prc-auc = 0.250000 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.58it/s]
Model 0 test prc-auc = 0.488787
Ensemble test prc-auc = 0.488787
5-fold cross validation
Seed 0 ==> test prc-auc = 0.075778
Seed 1 ==> test prc-auc = 0.083333
Seed 2 ==> test prc-auc = 1.000000
Seed 3 ==> test prc-auc = 0.287500
Seed 4 ==> test prc-auc = 0.488787
Overall test prc-auc = 0.387080 +/- 0.342082
wandb: Waiting for W&B process to finish, PID 15453
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: wandb/run-20200917_125943-3daqu3xc/logs/debug.log
wandb: Find internal logs for this run at: wandb/run-20200917_125943-3daqu3xc/logs/debug-internal.log
wandb: Run summary:
wandb:   validation_prc-auc 0.1
wandb:                _step 154
wandb:             _runtime 48
wandb:           _timestamp 1600347632
wandb:         test_prc-auc 0.48878676470588234
wandb: Run history:
wandb:   validation_prc-auc ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÖ‚ñÑ‚ñÉ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñà‚ñà‚ñÖ‚ñÖ‚ñÖ‚ñÉ‚ñÉ
wandb:                _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:             _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:           _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:         test_prc-auc ‚ñÅ‚ñÅ‚ñà‚ñÉ‚ñÑ
wandb: Synced 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced finetuning_finetuning_on_CHEMBL3215176_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/3daqu3xc

