wandb: Currently logged in as: apappu97 (use `wandb login --relogin` to force relogin)
wandb: Tracking run with wandb version 0.10.1
wandb: Run data is saved locally in wandb/run-20200917_130958-1pqkebnm
wandb: Syncing run finetuning_finetuning_on_CHEMBL918058_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/1pqkebnm
wandb: Run `wandb off` to turn off syncing.
Fold 0
Command line
python chemprop/finetune.py --seeds 1 3 4 6 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL918058 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL918058_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL918058_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpr7n5a1kx/fold_0',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': [1, 3, 4, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL918058'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]934it [00:00, 9333.07it/s]1853it [00:00, 9288.73it/s]2752it [00:00, 9195.70it/s]3679it [00:00, 9216.36it/s]4558it [00:00, 9083.92it/s]5485it [00:00, 9137.54it/s]6409it [00:00, 9165.51it/s]7336it [00:00, 9194.81it/s]8222it [00:00, 9090.60it/s]9109it [00:01, 9021.26it/s]9986it [00:01, 8878.06it/s]10857it [00:01, 8775.44it/s]11799it [00:01, 8957.49it/s]12748it [00:01, 9109.60it/s]13707it [00:01, 9247.25it/s]14664it [00:01, 9339.30it/s]15597it [00:01, 9304.08it/s]16551it [00:01, 9373.47it/s]17493it [00:01, 9386.47it/s]18456it [00:02, 9456.66it/s]19413it [00:02, 9488.42it/s]20362it [00:02, 9479.93it/s]21310it [00:02, 9421.03it/s]22255it [00:02, 9427.38it/s]23212it [00:02, 9467.55it/s]24170it [00:02, 9500.29it/s]25121it [00:02, 9492.13it/s]26085it [00:02, 9533.98it/s]27039it [00:02, 9510.08it/s]27998it [00:03, 9532.21it/s]28952it [00:03, 9513.76it/s]29904it [00:03, 9505.56it/s]30859it [00:03, 9517.69it/s]31811it [00:03, 9493.73it/s]32761it [00:03, 9491.86it/s]33711it [00:05, 1212.76it/s]34657it [00:05, 1642.28it/s]35523it [00:06, 2169.64it/s]36468it [00:06, 2821.82it/s]37419it [00:06, 3576.35it/s]38350it [00:06, 4386.23it/s]39281it [00:06, 5213.38it/s]40220it [00:06, 6015.24it/s]41173it [00:06, 6762.18it/s]42124it [00:06, 7403.41it/s]43060it [00:06, 7896.90it/s]44001it [00:06, 8295.69it/s]44954it [00:07, 8630.32it/s]45895it [00:07, 8835.42it/s]46841it [00:07, 9011.73it/s]47782it [00:07, 9049.90it/s]48731it [00:07, 9176.60it/s]49669it [00:07, 9205.42it/s]50604it [00:07, 8970.86it/s]51546it [00:07, 9100.78it/s]52483it [00:07, 9178.07it/s]53427it [00:08, 9252.63it/s]54357it [00:08, 9189.85it/s]55280it [00:08, 9185.07it/s]56217it [00:08, 9237.22it/s]57149it [00:08, 9261.50it/s]58102it [00:08, 9338.18it/s]59049it [00:08, 9376.84it/s]59991it [00:08, 9387.20it/s]60935it [00:08, 9401.39it/s]61865it [00:08, 6944.14it/s]
Number of examples remaining: 225
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 76994.24it/s]
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 4675.46it/s]
Number of tasks = 1
Splitting data with seed 1
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5347.39it/s]
Total scaffolds = 69 | train scaffolds = 54 | val scaffolds = 10 | test scaffolds = 5
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.15384615]), array([39])), (array([0.05555556]), array([18])), (array([0.]), array([1])), (array([0.]), array([5])), (array([0.]), array([3])), (array([0.]), array([2])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([2]))]
Class sizes
CHEMBL918058 0: 93.33%, 1: 6.67%
Total size = 225 | train size = 180 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|‚ñà‚ñã        | 1/6 [00:00<00:00,  5.28it/s][A
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 4/6 [00:00<00:00,  6.92it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 15.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 40.39it/s]
Validation prc-auc = 0.396140
  3%|‚ñé         | 1/30 [00:00<00:13,  2.22it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2182e-02, PNorm = 69.3011, GNorm = 1.4626, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 87.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.05it/s]
Validation prc-auc = 0.396140
Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.85it/s]
Validation prc-auc = 0.396140
 10%|‚ñà         | 3/30 [00:00<00:09,  2.96it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1530e-02, PNorm = 69.3011, GNorm = 1.9548, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.57it/s]
Validation prc-auc = 0.396140
Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.23it/s]
Validation prc-auc = 0.396140
 17%|‚ñà‚ñã        | 5/30 [00:00<00:06,  3.87it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1254e-02, PNorm = 69.3011, GNorm = 1.8456, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.05it/s]
Validation prc-auc = 0.396140
Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.68it/s]
Validation prc-auc = 0.146140
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:04,  4.91it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1183e-02, PNorm = 69.3011, GNorm = 1.4207, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.56it/s]
Validation prc-auc = 0.146140
Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0354e-02, PNorm = 69.3011, GNorm = 1.5704, lr_0 = 1.0000e-04
Loss = 3.2242e-02, PNorm = 69.3011, GNorm = 1.2672, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.39it/s]
Validation prc-auc = 0.146140
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:01<00:03,  6.05it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.37it/s]
Validation prc-auc = 0.118362
Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9698e-02, PNorm = 69.3011, GNorm = 1.6165, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.27it/s]
Validation prc-auc = 0.096140
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:01<00:02,  7.25it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.15it/s]
Validation prc-auc = 0.083640
Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9481e-02, PNorm = 69.3011, GNorm = 1.3609, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.96it/s]
Validation prc-auc = 0.081325
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:02,  8.41it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 147.72it/s]
Validation prc-auc = 0.079473
Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8946e-02, PNorm = 69.3011, GNorm = 1.6222, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.17it/s]
Validation prc-auc = 0.079190
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01,  9.47it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9923e-02, PNorm = 69.3011, GNorm = 1.2461, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.12it/s]
Validation prc-auc = 0.082074
Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.38it/s]
Validation prc-auc = 0.080812
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:01, 10.39it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8311e-02, PNorm = 69.3012, GNorm = 0.9158, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 89.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.15it/s]
Validation prc-auc = 0.080812
Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 4/6 [00:00<00:00, 37.20it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 47.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 135.98it/s]
Validation prc-auc = 0.081445
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:01, 10.05it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7734e-02, PNorm = 69.3012, GNorm = 1.2737, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.25it/s]
Validation prc-auc = 0.083365
Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.20it/s]
Validation prc-auc = 0.082449
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:02<00:00, 10.88it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7799e-02, PNorm = 69.3012, GNorm = 1.0726, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.65it/s]
Validation prc-auc = 0.077308
Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.32it/s]
Validation prc-auc = 0.078224
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:02<00:00, 11.55it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7759e-02, PNorm = 69.3012, GNorm = 1.0183, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.73it/s]
Validation prc-auc = 0.078224
Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6771e-02, PNorm = 69.3013, GNorm = 1.0693, lr_0 = 1.0000e-04
Loss = 2.5779e-02, PNorm = 69.3013, GNorm = 1.4034, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 89.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 139.76it/s]
Validation prc-auc = 0.078224
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:02<00:00, 11.99it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.61it/s]
Validation prc-auc = 0.079292
Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6523e-02, PNorm = 69.3013, GNorm = 1.2620, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.64it/s]
Validation prc-auc = 0.079292
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:02<00:00, 12.42it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 146.19it/s]
Validation prc-auc = 0.082070
Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6317e-02, PNorm = 69.3013, GNorm = 0.7802, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.15it/s]
Validation prc-auc = 0.082070
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:02<00:00, 12.72it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.27it/s]
Validation prc-auc = 0.082070
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 11.19it/s]
Model 0 best validation prc-auc = 0.396140 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 39.28it/s]
Model 0 test prc-auc = 1.000000
Ensemble test prc-auc = 1.000000
Fold 1
Command line
python chemprop/finetune.py --seeds 1 3 4 6 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL918058 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL918058_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL918058_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpr7n5a1kx/fold_1',
 'save_smiles_splits': False,
 'seed': 3,
 'seeds': [1, 3, 4, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL918058'],
 'task_names': ['CHEMBL918058'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 180,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]920it [00:00, 9194.24it/s]1855it [00:00, 9238.00it/s]2766it [00:00, 9197.91it/s]3698it [00:00, 9231.75it/s]4605it [00:00, 9180.48it/s]5527it [00:00, 9191.23it/s]6464it [00:00, 9243.70it/s]7391it [00:00, 9248.92it/s]8306it [00:00, 9216.62it/s]9222it [00:01, 9197.29it/s]10148it [00:01, 9213.28it/s]11085it [00:01, 9257.11it/s]11999it [00:01, 9198.13it/s]12915it [00:01, 9185.99it/s]13839it [00:01, 9199.41it/s]14772it [00:01, 9237.22it/s]15711it [00:01, 9281.01it/s]16646it [00:01, 9300.00it/s]17587it [00:01, 9330.41it/s]18520it [00:02, 9264.25it/s]19453it [00:02, 9282.96it/s]20390it [00:02, 9308.84it/s]21321it [00:02, 9241.49it/s]22246it [00:02, 9201.27it/s]23167it [00:02, 8864.72it/s]24098it [00:02, 8992.55it/s]25026it [00:02, 9076.29it/s]25946it [00:02, 9111.20it/s]26875it [00:02, 9163.41it/s]27793it [00:03, 9128.03it/s]28716it [00:03, 9156.21it/s]29649it [00:03, 9206.15it/s]30571it [00:03, 9207.48it/s]31493it [00:03, 9186.98it/s]32412it [00:03, 9155.71it/s]33348it [00:03, 9215.65it/s]34272it [00:03, 9220.16it/s]35203it [00:03, 9245.94it/s]36130it [00:03, 9250.70it/s]37056it [00:04, 9226.02it/s]37992it [00:04, 9263.96it/s]38929it [00:04, 9293.88it/s]39859it [00:04, 9282.94it/s]40795it [00:04, 9304.30it/s]41726it [00:04, 9209.20it/s]42660it [00:04, 9247.89it/s]43588it [00:04, 9256.61it/s]44523it [00:04, 9283.15it/s]45453it [00:04, 9286.63it/s]46382it [00:05, 9239.55it/s]47308it [00:05, 9244.08it/s]48240it [00:05, 9263.90it/s]49173it [00:05, 9282.28it/s]50102it [00:05, 9256.67it/s]51028it [00:05, 9223.82it/s]51955it [00:05, 9235.65it/s]52892it [00:05, 9275.01it/s]53820it [00:05, 9211.14it/s]54742it [00:05, 9164.89it/s]55659it [00:06, 9113.21it/s]56583it [00:06, 9148.11it/s]57508it [00:06, 9177.06it/s]58435it [00:06, 9202.19it/s]59372it [00:06, 9248.67it/s]60297it [00:06, 9219.68it/s]61224it [00:06, 9232.38it/s]61865it [00:06, 9218.34it/s]
Number of examples remaining: 225
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 68123.76it/s]
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5586.45it/s]
Number of tasks = 1
Splitting data with seed 3
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5451.46it/s]
Total scaffolds = 69 | train scaffolds = 57 | val scaffolds = 8 | test scaffolds = 4
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.15384615]), array([39])), (array([0.05555556]), array([18])), (array([0.]), array([2])), (array([0.]), array([2])), (array([0.]), array([2])), (array([0.]), array([3])), (array([0.]), array([3])), (array([0.]), array([3])), (array([0.]), array([5])), (array([0.]), array([1]))]
Class sizes
CHEMBL918058 0: 93.33%, 1: 6.67%
Total size = 225 | train size = 180 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 86.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 134.40it/s]
Warning: Found a task with targets all 0s or all 1s
/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2166e-02, PNorm = 69.3011, GNorm = 1.4013, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.05it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7%|‚ñã         | 2/30 [00:00<00:02, 12.78it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1668e-02, PNorm = 69.3011, GNorm = 1.5545, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13%|‚ñà‚ñé        | 4/30 [00:00<00:01, 13.00it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1670e-02, PNorm = 69.3011, GNorm = 1.4346, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 89.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.01it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20%|‚ñà‚ñà        | 6/30 [00:00<00:01, 13.12it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 130.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0933e-02, PNorm = 69.3011, GNorm = 1.2184, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.46it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 13.19it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0433e-02, PNorm = 69.3011, GNorm = 1.4422, lr_0 = 1.0000e-04
Loss = 3.2993e-02, PNorm = 69.3011, GNorm = 1.2196, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 86.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.77it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.49it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 13.14it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9926e-02, PNorm = 69.3011, GNorm = 1.4447, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 101.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:00<00:01, 13.10it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9648e-02, PNorm = 69.3011, GNorm = 1.2983, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 87.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 82.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:01<00:01, 12.86it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9123e-02, PNorm = 69.3011, GNorm = 1.1828, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 87.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.92it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0003e-02, PNorm = 69.3011, GNorm = 1.2079, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.75it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:01<00:01, 12.87it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8248e-02, PNorm = 69.3012, GNorm = 1.2020, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.61it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:00, 13.06it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 141.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7870e-02, PNorm = 69.3012, GNorm = 1.1497, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.79it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 13.20it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.12it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7350e-02, PNorm = 69.3012, GNorm = 1.2715, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 13.28it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 144.45it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7787e-02, PNorm = 69.3012, GNorm = 0.9986, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:01<00:00, 13.34it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7003e-02, PNorm = 69.3013, GNorm = 0.8515, lr_0 = 1.0000e-04
Loss = 2.5339e-02, PNorm = 69.3013, GNorm = 1.3360, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.72it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.45it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:01<00:00, 13.33it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6839e-02, PNorm = 69.3013, GNorm = 1.0103, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 145.73it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:02<00:00, 13.36it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6658e-02, PNorm = 69.3013, GNorm = 0.9542, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 89.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 13.38it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 13.22it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 148.30it/s]
Model 0 test prc-auc = 0.533103
Ensemble test prc-auc = 0.533103
Fold 2
Command line
python chemprop/finetune.py --seeds 1 3 4 6 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL918058 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL918058_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL918058_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpr7n5a1kx/fold_2',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [1, 3, 4, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL918058'],
 'task_names': ['CHEMBL918058'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 180,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]911it [00:00, 9107.21it/s]1789it [00:00, 9005.30it/s]2687it [00:00, 8996.56it/s]3594it [00:00, 9017.23it/s]4505it [00:00, 9042.43it/s]5413it [00:00, 9051.75it/s]6347it [00:00, 9133.81it/s]7284it [00:00, 9201.56it/s]8219it [00:00, 9244.33it/s]9153it [00:01, 9270.22it/s]10080it [00:01, 9267.91it/s]11016it [00:01, 9295.15it/s]11953it [00:01, 9315.34it/s]12892it [00:01, 9336.65it/s]13821it [00:01, 9321.41it/s]14749it [00:01, 9255.61it/s]15683it [00:01, 9279.96it/s]16627it [00:01, 9327.27it/s]17564it [00:01, 9338.32it/s]18504it [00:02, 9356.23it/s]19439it [00:02, 9318.26it/s]20372it [00:02, 9321.47it/s]21304it [00:02, 9205.73it/s]22232it [00:02, 9226.72it/s]23155it [00:02, 9195.24it/s]24075it [00:02, 9147.62it/s]25010it [00:02, 9205.91it/s]25941it [00:02, 9235.02it/s]26865it [00:02, 9080.73it/s]27792it [00:03, 9135.26it/s]28723it [00:03, 9185.44it/s]29660it [00:03, 9238.76it/s]30595it [00:03, 9270.04it/s]31523it [00:03, 9270.20it/s]32451it [00:03, 9111.48it/s]33363it [00:03, 9080.60it/s]34296it [00:03, 9151.45it/s]35232it [00:03, 9210.81it/s]36156it [00:03, 9217.47it/s]37092it [00:04, 9259.30it/s]38020it [00:04, 9258.22it/s]38959it [00:04, 9295.75it/s]39889it [00:04, 9194.45it/s]40822it [00:04, 9234.28it/s]41760it [00:04, 9271.34it/s]42688it [00:04, 9219.00it/s]43631it [00:04, 9280.99it/s]44561it [00:04, 9285.09it/s]45492it [00:04, 9292.54it/s]46425it [00:05, 9301.83it/s]47356it [00:05, 8935.77it/s]48297it [00:05, 9071.55it/s]49243it [00:05, 9182.02it/s]50183it [00:05, 9245.75it/s]51119it [00:05, 9278.29it/s]52049it [00:05, 9209.21it/s]52979it [00:05, 9233.54it/s]53904it [00:05, 9145.66it/s]54820it [00:05, 9099.94it/s]55731it [00:06, 9093.99it/s]56646it [00:06, 9110.09it/s]57567it [00:06, 9138.39it/s]58500it [00:06, 9192.64it/s]59432it [00:06, 9227.92it/s]60355it [00:06, 9195.05it/s]61275it [00:06, 9168.16it/s]61865it [00:06, 9206.09it/s]
Number of examples remaining: 225
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 75953.19it/s]
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5558.02it/s]
Number of tasks = 1
Splitting data with seed 4
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5312.26it/s]
Total scaffolds = 69 | train scaffolds = 53 | val scaffolds = 5 | test scaffolds = 11
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.15384615]), array([39])), (array([0.05555556]), array([18])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([8])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1]))]
Class sizes
CHEMBL918058 0: 93.33%, 1: 6.67%
Total size = 225 | train size = 180 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.79it/s]
Validation prc-auc = 0.023810
  3%|‚ñé         | 1/30 [00:00<00:03,  8.54it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2236e-02, PNorm = 69.3010, GNorm = 1.5354, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 89.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.43it/s]
Validation prc-auc = 0.023810
Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.96it/s]
Validation prc-auc = 0.023810
 10%|‚ñà         | 3/30 [00:00<00:02,  9.56it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1673e-02, PNorm = 69.3010, GNorm = 1.8375, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.70it/s]
Validation prc-auc = 0.023810
Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 135.80it/s]
Validation prc-auc = 0.023810
 17%|‚ñà‚ñã        | 5/30 [00:00<00:02, 10.45it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0765e-02, PNorm = 69.3011, GNorm = 1.5298, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.80it/s]
Validation prc-auc = 0.023810
Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 139.29it/s]
Validation prc-auc = 0.023810
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:02, 11.25it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1234e-02, PNorm = 69.3011, GNorm = 1.2641, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.07it/s]
Validation prc-auc = 0.023810
Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0489e-02, PNorm = 69.3011, GNorm = 1.6171, lr_0 = 1.0000e-04
Loss = 3.1818e-02, PNorm = 69.3011, GNorm = 1.3192, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 84.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 126.17it/s]
Validation prc-auc = 0.023810
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:01, 11.69it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 135.38it/s]
Validation prc-auc = 0.023810
Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9829e-02, PNorm = 69.3011, GNorm = 1.2973, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.28it/s]
Validation prc-auc = 0.023810
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:00<00:01, 12.09it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 135.72it/s]
Validation prc-auc = 0.023810
Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9848e-02, PNorm = 69.3011, GNorm = 1.1525, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 143.47it/s]
Validation prc-auc = 0.023810
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:01, 12.47it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 96.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 137.41it/s]
Validation prc-auc = 0.023810
Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9325e-02, PNorm = 69.3011, GNorm = 1.3350, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 139.87it/s]
Validation prc-auc = 0.023810
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01, 12.80it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0014e-02, PNorm = 69.3011, GNorm = 1.3419, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 139.30it/s]
Validation prc-auc = 0.023810
Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 137.64it/s]
Validation prc-auc = 0.023810
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:00, 13.01it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8450e-02, PNorm = 69.3011, GNorm = 1.2309, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.74it/s]
Validation prc-auc = 0.023810
Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 3/6 [00:00<00:00, 23.33it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 37.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.44it/s]
Validation prc-auc = 0.023810
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 11.02it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8164e-02, PNorm = 69.3012, GNorm = 1.1513, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.11it/s]
Validation prc-auc = 0.023810
Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.12it/s]
Validation prc-auc = 0.023810
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 11.63it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7899e-02, PNorm = 69.3012, GNorm = 1.0638, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 87.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.01it/s]
Validation prc-auc = 0.023810
Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.79it/s]
Validation prc-auc = 0.023810
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 12.05it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6354e-02, PNorm = 69.3012, GNorm = 1.2756, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.55it/s]
Validation prc-auc = 0.023810
Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7053e-02, PNorm = 69.3012, GNorm = 1.0529, lr_0 = 1.0000e-04
Loss = 2.8891e-02, PNorm = 69.3012, GNorm = 0.9385, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 87.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 135.12it/s]
Validation prc-auc = 0.023810
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:02<00:00, 12.33it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 140.66it/s]
Validation prc-auc = 0.023810
Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6533e-02, PNorm = 69.3013, GNorm = 1.1105, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 139.26it/s]
Validation prc-auc = 0.022727
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:02<00:00, 12.61it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.15it/s]
Validation prc-auc = 0.022727
Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6480e-02, PNorm = 69.3013, GNorm = 1.2571, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 138.44it/s]
Validation prc-auc = 0.022727
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:02<00:00, 12.82it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.44it/s]
Validation prc-auc = 0.022727
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 12.55it/s]
Model 0 best validation prc-auc = 0.023810 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 126.41it/s]
Model 0 test prc-auc = 1.000000
Ensemble test prc-auc = 1.000000
Fold 3
Command line
python chemprop/finetune.py --seeds 1 3 4 6 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL918058 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL918058_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL918058_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpr7n5a1kx/fold_3',
 'save_smiles_splits': False,
 'seed': 6,
 'seeds': [1, 3, 4, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL918058'],
 'task_names': ['CHEMBL918058'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 180,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]858it [00:00, 8577.21it/s]1753it [00:00, 8684.94it/s]2605it [00:00, 8633.49it/s]3497it [00:00, 8714.87it/s]4381it [00:00, 8751.05it/s]5255it [00:00, 8746.04it/s]6166it [00:00, 8835.97it/s]7066it [00:00, 8883.29it/s]7955it [00:00, 8885.22it/s]8844it [00:01, 8884.93it/s]9731it [00:01, 8880.10it/s]10639it [00:01, 8937.66it/s]11551it [00:01, 8990.54it/s]12450it [00:01, 8988.76it/s]13354it [00:01, 9002.64it/s]14253it [00:01, 8997.42it/s]15150it [00:01, 8841.74it/s]16050it [00:01, 8888.53it/s]16960it [00:01, 8948.21it/s]17855it [00:02, 8932.80it/s]18758it [00:02, 8961.14it/s]19670it [00:02, 9008.17it/s]20582it [00:02, 9040.46it/s]21487it [00:02, 9036.62it/s]22395it [00:02, 9049.15it/s]23300it [00:02, 9010.97it/s]24202it [00:02, 8905.33it/s]25093it [00:02, 8821.58it/s]25986it [00:02, 8853.00it/s]26896it [00:03, 8924.78it/s]27794it [00:03, 8938.47it/s]28709it [00:03, 8998.62it/s]29610it [00:03, 8854.57it/s]30517it [00:03, 8917.52it/s]31430it [00:03, 8978.77it/s]32329it [00:03, 8980.56it/s]33238it [00:03, 9012.03it/s]34142it [00:03, 9018.50it/s]35045it [00:03, 8820.12it/s]35954it [00:04, 8899.29it/s]36852it [00:04, 8921.42it/s]37758it [00:04, 8960.68it/s]38668it [00:04, 9000.58it/s]39582it [00:04, 9041.29it/s]40501it [00:04, 9082.68it/s]41410it [00:04, 9068.79it/s]42318it [00:04, 9034.79it/s]43241it [00:04, 9091.53it/s]44159it [00:04, 9116.53it/s]45071it [00:05, 9097.63it/s]45990it [00:05, 9119.76it/s]46903it [00:05, 9080.12it/s]47823it [00:05, 9113.97it/s]48742it [00:05, 9134.03it/s]49656it [00:05, 9115.75it/s]50568it [00:05, 9090.88it/s]51478it [00:05, 9092.58it/s]52391it [00:05, 9100.06it/s]53302it [00:05, 8988.89it/s]54202it [00:06, 8952.42it/s]55098it [00:06, 8941.80it/s]55993it [00:06, 8889.35it/s]56883it [00:06, 8891.10it/s]57795it [00:06, 8958.43it/s]58710it [00:06, 9012.80it/s]59627it [00:06, 9058.01it/s]60534it [00:06, 9056.10it/s]61440it [00:06, 9053.73it/s]61865it [00:06, 8975.19it/s]
Number of examples remaining: 225
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 69962.07it/s]
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5437.29it/s]
Number of tasks = 1
Splitting data with seed 6
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5406.70it/s]
Total scaffolds = 69 | train scaffolds = 53 | val scaffolds = 12 | test scaffolds = 4
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.15384615]), array([39])), (array([0.05555556]), array([18])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([6])), (array([0.]), array([3])), (array([0.11111111]), array([9])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL918058 0: 93.33%, 1: 6.67%
Total size = 225 | train size = 180 | val size = 21 | test size = 24
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.70it/s]
Validation prc-auc = 0.250000
  3%|‚ñé         | 1/30 [00:00<00:03,  8.45it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2187e-02, PNorm = 69.3011, GNorm = 1.5723, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.47it/s]
Validation prc-auc = 0.250000
Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 96.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.60it/s]
Validation prc-auc = 0.250000
 10%|‚ñà         | 3/30 [00:00<00:02,  9.51it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1741e-02, PNorm = 69.3011, GNorm = 1.6537, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.70it/s]
Validation prc-auc = 0.250000
Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 130.58it/s]
Validation prc-auc = 0.250000
 17%|‚ñà‚ñã        | 5/30 [00:00<00:02, 10.37it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1353e-02, PNorm = 69.3011, GNorm = 1.6694, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.12it/s]
Validation prc-auc = 0.250000
Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.40it/s]
Validation prc-auc = 0.250000
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:02, 11.10it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0805e-02, PNorm = 69.3011, GNorm = 1.7174, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.77it/s]
Validation prc-auc = 0.250000
Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0545e-02, PNorm = 69.3011, GNorm = 1.5249, lr_0 = 1.0000e-04
Loss = 3.3583e-02, PNorm = 69.3011, GNorm = 1.5248, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.93it/s]
Validation prc-auc = 0.250000
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:01, 11.61it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.62it/s]
Validation prc-auc = 0.250000
Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9988e-02, PNorm = 69.3011, GNorm = 1.4719, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 130.64it/s]
Validation prc-auc = 0.250000
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:00<00:01, 12.06it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.02it/s]
Validation prc-auc = 0.166667
Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9440e-02, PNorm = 69.3011, GNorm = 1.3719, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 130.25it/s]
Validation prc-auc = 0.125000
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:01, 12.42it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.66it/s]
Validation prc-auc = 0.100000
Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8640e-02, PNorm = 69.3011, GNorm = 1.1970, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.43it/s]
Validation prc-auc = 0.083333
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01, 12.66it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0011e-02, PNorm = 69.3011, GNorm = 1.2708, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.63it/s]
Validation prc-auc = 0.050000
Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 123.57it/s]
Validation prc-auc = 0.045455
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:01, 12.91it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8169e-02, PNorm = 69.3011, GNorm = 1.3606, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.53it/s]
Validation prc-auc = 0.045455
Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 126.28it/s]
Validation prc-auc = 0.038462
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 13.06it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7739e-02, PNorm = 69.3012, GNorm = 1.4724, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 130.99it/s]
Validation prc-auc = 0.035714
Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.33it/s]
Validation prc-auc = 0.035714
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 13.14it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7367e-02, PNorm = 69.3012, GNorm = 1.1742, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.05it/s]
Validation prc-auc = 0.033333
Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.19it/s]
Validation prc-auc = 0.033333
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 13.20it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7349e-02, PNorm = 69.3012, GNorm = 1.2047, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.77it/s]
Validation prc-auc = 0.033333
Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7057e-02, PNorm = 69.3012, GNorm = 1.2524, lr_0 = 1.0000e-04
Loss = 2.9073e-02, PNorm = 69.3012, GNorm = 0.8531, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 88.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 132.70it/s]
Validation prc-auc = 0.033333
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:01<00:00, 13.09it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 132.53it/s]
Validation prc-auc = 0.029412
Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6964e-02, PNorm = 69.3013, GNorm = 0.9411, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.27it/s]
Validation prc-auc = 0.029412
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:02<00:00, 13.14it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.72it/s]
Validation prc-auc = 0.027778
Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6687e-02, PNorm = 69.3013, GNorm = 0.9060, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 89.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.41it/s]
Validation prc-auc = 0.026316
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:02<00:00, 12.81it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.22it/s]
Validation prc-auc = 0.026316
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 12.95it/s]
Model 0 best validation prc-auc = 0.250000 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 142.98it/s]
Model 0 test prc-auc = 0.021739
Ensemble test prc-auc = 0.021739
Fold 4
Command line
python chemprop/finetune.py --seeds 1 3 4 6 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL918058 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL918058_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL918058_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpr7n5a1kx/fold_4',
 'save_smiles_splits': False,
 'seed': 7,
 'seeds': [1, 3, 4, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL918058'],
 'task_names': ['CHEMBL918058'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 180,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]910it [00:00, 9097.67it/s]1827it [00:00, 9117.65it/s]2731it [00:00, 9092.00it/s]3637it [00:00, 9081.65it/s]4506it [00:00, 8960.37it/s]5414it [00:00, 8995.13it/s]6317it [00:00, 9003.38it/s]7216it [00:00, 8998.28it/s]8124it [00:00, 9019.79it/s]9046it [00:01, 9077.60it/s]9965it [00:01, 9109.60it/s]10879it [00:01, 9117.49it/s]11801it [00:01, 9146.77it/s]12727it [00:01, 9177.84it/s]13653it [00:01, 9200.69it/s]14572it [00:01, 9197.36it/s]15500it [00:01, 9220.98it/s]16426it [00:01, 9230.39it/s]17348it [00:01, 9216.76it/s]18269it [00:02, 9196.09it/s]19188it [00:02, 9181.41it/s]20114it [00:02, 9204.57it/s]21035it [00:02, 9049.56it/s]21961it [00:02, 9111.05it/s]22888it [00:02, 9155.19it/s]23804it [00:02, 9145.50it/s]24736it [00:02, 9194.08it/s]25657it [00:02, 9197.45it/s]26596it [00:02, 9253.47it/s]27530it [00:03, 9278.67it/s]28459it [00:03, 9258.21it/s]29385it [00:03, 9243.96it/s]30322it [00:03, 9280.61it/s]31254it [00:03, 9289.77it/s]32188it [00:03, 9303.35it/s]33119it [00:03, 9212.66it/s]34054it [00:03, 9251.18it/s]34987it [00:03, 9271.87it/s]35928it [00:03, 9309.77it/s]36860it [00:04, 9307.26it/s]37791it [00:04, 9260.07it/s]38718it [00:04, 9126.45it/s]39642it [00:04, 9157.97it/s]40574it [00:04, 9205.71it/s]41495it [00:04, 9036.05it/s]42412it [00:04, 9073.40it/s]43332it [00:04, 9108.30it/s]44258it [00:04, 9151.48it/s]45185it [00:04, 9185.57it/s]46107it [00:05, 9193.23it/s]47027it [00:05, 9187.14it/s]47958it [00:05, 9216.67it/s]48887it [00:05, 9237.28it/s]49811it [00:05, 9237.10it/s]50735it [00:05, 9222.65it/s]51658it [00:05, 9148.23it/s]52585it [00:05, 9183.95it/s]53504it [00:05, 9169.14it/s]54422it [00:05, 9045.29it/s]55327it [00:06, 9043.50it/s]56232it [00:06, 8969.23it/s]57154it [00:06, 9041.53it/s]58062it [00:06, 9052.01it/s]58972it [00:06, 9065.14it/s]59886it [00:06, 9084.79it/s]60795it [00:06, 9080.80it/s]61722it [00:06, 9133.81it/s]61865it [00:06, 9156.12it/s]
Number of examples remaining: 225
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 69360.46it/s]
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5551.28it/s]
Number of tasks = 1
Splitting data with seed 7
  0%|          | 0/225 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 225/225 [00:00<00:00, 5388.43it/s]
Total scaffolds = 69 | train scaffolds = 48 | val scaffolds = 12 | test scaffolds = 9
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.05555556]), array([18])), (array([0.15384615]), array([39])), (array([0.]), array([9])), (array([0.]), array([8])), (array([0.5]), array([2])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([9])), (array([0.]), array([1])), (array([0.]), array([2]))]
Class sizes
CHEMBL918058 0: 93.33%, 1: 6.67%
Total size = 225 | train size = 180 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 123.24it/s]
Validation prc-auc = 0.087572
  3%|‚ñé         | 1/30 [00:00<00:03,  8.71it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2151e-02, PNorm = 69.3010, GNorm = 1.6845, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 87.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.58it/s]
Validation prc-auc = 0.087572
Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.23it/s]
Validation prc-auc = 0.087572
 10%|‚ñà         | 3/30 [00:00<00:02,  9.69it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1508e-02, PNorm = 69.3010, GNorm = 1.4507, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.18it/s]
Validation prc-auc = 0.089640
 13%|‚ñà‚ñé        | 4/30 [00:00<00:02,  9.33it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 98.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.81it/s]
Validation prc-auc = 0.094325
 17%|‚ñà‚ñã        | 5/30 [00:00<00:02,  9.19it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0856e-02, PNorm = 69.3011, GNorm = 1.3408, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.28it/s]
Validation prc-auc = 0.094325
Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.69it/s]
Validation prc-auc = 0.094325
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:02, 10.18it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1125e-02, PNorm = 69.3011, GNorm = 1.3105, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 127.72it/s]
Validation prc-auc = 0.098131
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:02,  9.66it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0393e-02, PNorm = 69.3011, GNorm = 1.5302, lr_0 = 1.0000e-04
Loss = 3.2866e-02, PNorm = 69.3011, GNorm = 1.3676, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 91.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 131.19it/s]
Validation prc-auc = 0.098131
Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 98.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 127.83it/s]
Validation prc-auc = 0.098131
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 10.55it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9865e-02, PNorm = 69.3011, GNorm = 1.3562, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.52it/s]
Validation prc-auc = 0.098131
Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 96.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.51it/s]
Validation prc-auc = 0.098131
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:01<00:01, 11.29it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9082e-02, PNorm = 69.3011, GNorm = 1.6117, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.22it/s]
Validation prc-auc = 0.102883
Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 124.34it/s]
Validation prc-auc = 0.102883
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:01<00:01, 10.97it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8745e-02, PNorm = 69.3011, GNorm = 1.1374, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.43it/s]
Validation prc-auc = 0.102883
Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9890e-02, PNorm = 69.3011, GNorm = 1.5012, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.69it/s]
Validation prc-auc = 0.102883
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:01<00:01, 11.59it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 127.23it/s]
Validation prc-auc = 0.101031
Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8215e-02, PNorm = 69.3011, GNorm = 1.3352, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.48it/s]
Validation prc-auc = 0.101031
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:00, 12.07it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 124.20it/s]
Validation prc-auc = 0.109841
Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7664e-02, PNorm = 69.3012, GNorm = 1.2594, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.25it/s]
Validation prc-auc = 0.109841
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 11.60it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 127.70it/s]
Validation prc-auc = 0.109841
Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7830e-02, PNorm = 69.3012, GNorm = 1.0783, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 93.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 117.50it/s]
Validation prc-auc = 0.109841
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 12.14it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.69it/s]
Validation prc-auc = 0.113881
Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7239e-02, PNorm = 69.3012, GNorm = 1.2463, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 90.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 127.91it/s]
Validation prc-auc = 0.109841
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:02<00:00, 11.41it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6916e-02, PNorm = 69.3013, GNorm = 1.3442, lr_0 = 1.0000e-04
Loss = 2.6521e-02, PNorm = 69.3013, GNorm = 1.3161, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 83.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 10.42it/s]
Validation prc-auc = 0.108326
Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 94.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 123.58it/s]
Validation prc-auc = 0.111553
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:02<00:00, 10.19it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6602e-02, PNorm = 69.3013, GNorm = 1.1803, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 129.62it/s]
Validation prc-auc = 0.111553
Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 97.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.56it/s]
Validation prc-auc = 0.111553
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:02<00:00, 11.00it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6438e-02, PNorm = 69.3013, GNorm = 1.2224, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 92.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 128.98it/s]
Validation prc-auc = 0.111553
Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 95.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.80it/s]
Validation prc-auc = 0.111553
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 11.64it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 11.42it/s]
Model 0 best validation prc-auc = 0.113881 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 118.20it/s]
Model 0 test prc-auc = 0.058103
Ensemble test prc-auc = 0.058103
5-fold cross validation
Seed 0 ==> test prc-auc = 1.000000
Seed 1 ==> test prc-auc = 0.533103
Seed 2 ==> test prc-auc = 1.000000
Seed 3 ==> test prc-auc = 0.021739
Seed 4 ==> test prc-auc = 0.058103
Overall test prc-auc = 0.522589 +/- 0.429547
wandb: Waiting for W&B process to finish, PID 22349
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: wandb/run-20200917_130958-1pqkebnm/logs/debug.log
wandb: Find internal logs for this run at: wandb/run-20200917_130958-1pqkebnm/logs/debug-internal.log
wandb: Run summary:
wandb:   validation_prc-auc 0.1115530303030303
wandb:                _step 154
wandb:             _runtime 52
wandb:           _timestamp 1600348251
wandb:         test_prc-auc 0.05810276679841898
wandb: Run history:
wandb:   validation_prc-auc ‚ñà‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÖ‚ñÖ‚ñÖ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÉ
wandb:                _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:             _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:           _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:         test_prc-auc ‚ñà‚ñÖ‚ñà‚ñÅ‚ñÅ
wandb: Synced 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced finetuning_finetuning_on_CHEMBL918058_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/1pqkebnm

