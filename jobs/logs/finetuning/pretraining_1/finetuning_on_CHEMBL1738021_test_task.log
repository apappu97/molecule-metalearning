wandb: Currently logged in as: apappu97 (use `wandb login --relogin` to force relogin)
wandb: Tracking run with wandb version 0.10.1
wandb: Run data is saved locally in wandb/run-20200917_125503-2har9xca
wandb: Syncing run finetuning_finetuning_on_CHEMBL1738021_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/2har9xca
wandb: Run `wandb off` to turn off syncing.
Fold 0
Command line
python chemprop/finetune.py --seeds 2 3 4 5 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738021 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738021_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738021_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpwv_0zlhm/fold_0',
 'save_smiles_splits': False,
 'seed': 2,
 'seeds': [2, 3, 4, 5, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738021'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]952it [00:00, 9512.55it/s]1906it [00:00, 9520.65it/s]2833it [00:00, 9441.93it/s]3788it [00:00, 9473.18it/s]4734it [00:00, 9466.65it/s]5691it [00:00, 9495.35it/s]6642it [00:00, 9499.73it/s]7557it [00:00, 9391.43it/s]8495it [00:00, 9387.74it/s]9445it [00:01, 9420.83it/s]10404it [00:01, 9468.76it/s]11359it [00:01, 9491.51it/s]12296it [00:01, 9442.33it/s]13252it [00:01, 9475.03it/s]14208it [00:01, 9499.28it/s]15167it [00:01, 9524.98it/s]16127it [00:01, 9546.17it/s]17080it [00:01, 9484.41it/s]18045it [00:01, 9531.70it/s]19001it [00:02, 9537.47it/s]19955it [00:02, 9508.75it/s]20918it [00:02, 9544.38it/s]21873it [00:02, 9510.88it/s]22824it [00:02, 9501.50it/s]23780it [00:02, 9518.18it/s]24732it [00:02, 9468.99it/s]25698it [00:02, 9523.39it/s]26651it [00:02, 9470.14it/s]27603it [00:02, 9483.97it/s]28555it [00:03, 9493.47it/s]29505it [00:03, 9488.15it/s]30459it [00:03, 9502.98it/s]31410it [00:03, 9435.83it/s]32354it [00:03, 9424.79it/s]33297it [00:03, 9414.93it/s]34239it [00:03, 9232.24it/s]35169it [00:03, 9250.27it/s]36103it [00:03, 9275.64it/s]37031it [00:03, 9238.49it/s]37993it [00:04, 9347.88it/s]38929it [00:04, 9224.76it/s]39880it [00:04, 9308.13it/s]40821it [00:04, 9335.99it/s]41781it [00:04, 9411.31it/s]42742it [00:04, 9467.48it/s]43690it [00:04, 9251.58it/s]44641it [00:04, 9325.47it/s]45575it [00:04, 9328.57it/s]46532it [00:04, 9397.80it/s]47473it [00:05, 9396.57it/s]48419it [00:05, 9414.90it/s]49372it [00:05, 9448.77it/s]50318it [00:05, 9436.48it/s]51262it [00:05, 9425.31it/s]52222it [00:05, 9476.34it/s]53174it [00:05, 9488.01it/s]54123it [00:05, 9464.04it/s]55070it [00:05, 9352.35it/s]56006it [00:05, 9323.20it/s]56946it [00:06, 9342.59it/s]57881it [00:06, 9187.15it/s]58826it [00:06, 9261.98it/s]59753it [00:06, 9123.17it/s]60667it [00:06, 9067.76it/s]61600it [00:06, 9144.44it/s]61865it [00:06, 9397.19it/s]
Number of examples remaining: 138
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 399733.39it/s]
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 3788.64it/s]
Number of tasks = 1
Splitting data with seed 2
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4765.16it/s]
Total scaffolds = 104 | train scaffolds = 83 | val scaffolds = 10 | test scaffolds = 11
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.75]), array([4])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([0.5]), array([2])), (array([1.]), array([2])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738021 0: 10.87%, 1: 89.13%
Total size = 138 | train size = 110 | val size = 13 | test size = 15
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.02it/s][A
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  6.64it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 58.93it/s]
Validation prc-auc = 0.859090
  3%|‚ñé         | 1/30 [00:00<00:10,  2.70it/s]Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.89it/s]
Validation prc-auc = 0.859090
Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.4982e-02, PNorm = 69.3011, GNorm = 1.1896, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.44it/s]
Validation prc-auc = 0.859090
 10%|‚ñà         | 3/30 [00:00<00:07,  3.63it/s]Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.46it/s]
Validation prc-auc = 0.859090
Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 133.99it/s]
Validation prc-auc = 0.870562
 17%|‚ñà‚ñã        | 5/30 [00:00<00:05,  4.66it/s]Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0614e-02, PNorm = 69.3011, GNorm = 1.4390, lr_0 = 1.0000e-04
Loss = 4.6295e-02, PNorm = 69.3011, GNorm = 0.9523, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 84.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 207.55it/s]
Validation prc-auc = 0.880843
Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 196.37it/s]
Validation prc-auc = 0.897510
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:04,  5.61it/s]Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 195.41it/s]
Validation prc-auc = 0.897510
Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0302e-02, PNorm = 69.3011, GNorm = 0.9536, lr_0 = 1.0000e-04
Loss = 4.4885e-02, PNorm = 69.3011, GNorm = 1.1895, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 84.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.36it/s]
Validation prc-auc = 0.897510
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:02,  7.12it/s]Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 202.97it/s]
Validation prc-auc = 0.897510
Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.59it/s]
Validation prc-auc = 0.911579
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:01<00:02,  8.37it/s]Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9912e-02, PNorm = 69.3011, GNorm = 1.1424, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.36it/s]
Validation prc-auc = 0.911579
Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.15it/s]
Validation prc-auc = 0.911579
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:01, 10.08it/s]Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 190.18it/s]
Validation prc-auc = 0.911579
Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9090e-02, PNorm = 69.3011, GNorm = 1.0943, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 82.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 165.48it/s]
Validation prc-auc = 0.920868
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01, 10.88it/s]Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 188.17it/s]
Validation prc-auc = 0.920868
Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.95it/s]
Validation prc-auc = 0.920868
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:01, 12.61it/s]Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9119e-02, PNorm = 69.3011, GNorm = 1.0703, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 197.92it/s]
Validation prc-auc = 0.920868
Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 189.55it/s]
Validation prc-auc = 0.920868
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:00, 14.06it/s]Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 168.82it/s]
Validation prc-auc = 0.920868
Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7715e-02, PNorm = 69.3012, GNorm = 1.1632, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.71it/s]
Validation prc-auc = 0.920868
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 15.27it/s]Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.34it/s]
Validation prc-auc = 0.920868
Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 96.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.57it/s]
Validation prc-auc = 0.920868
Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7715e-02, PNorm = 69.3012, GNorm = 0.9662, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 197.77it/s]
Validation prc-auc = 0.920868
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:01<00:00, 16.37it/s]Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.67it/s]
Validation prc-auc = 0.920868
Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 40.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 199.80it/s]
Validation prc-auc = 0.933044
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:01<00:00, 13.85it/s]Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7549e-02, PNorm = 69.3012, GNorm = 1.1240, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 204.08it/s]
Validation prc-auc = 0.933044
Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 186.87it/s]
Validation prc-auc = 0.933044
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:02<00:00, 15.18it/s]Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 194.75it/s]
Validation prc-auc = 0.933044
Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8030e-02, PNorm = 69.3013, GNorm = 0.8458, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 206.30it/s]
Validation prc-auc = 0.933044
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 16.12it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 13.81it/s]
Model 0 best validation prc-auc = 0.933044 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 54.02it/s]
Model 0 test prc-auc = 0.568594
Ensemble test prc-auc = 0.568594
Fold 1
Command line
python chemprop/finetune.py --seeds 2 3 4 5 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738021 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738021_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738021_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpwv_0zlhm/fold_1',
 'save_smiles_splits': False,
 'seed': 3,
 'seeds': [2, 3, 4, 5, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738021'],
 'task_names': ['CHEMBL1738021'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 110,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]939it [00:00, 9385.51it/s]1855it [00:00, 9315.63it/s]2793it [00:00, 9333.95it/s]3728it [00:00, 9338.40it/s]4669it [00:00, 9358.08it/s]5606it [00:00, 9360.02it/s]6529it [00:00, 9318.66it/s]7438it [00:00, 9247.81it/s]8356it [00:00, 9225.88it/s]9294it [00:01, 9269.15it/s]10235it [00:01, 9309.33it/s]11148it [00:01, 9194.30it/s]12068it [00:01, 9193.45it/s]12998it [00:01, 9222.64it/s]13915it [00:01, 9189.69it/s]14845it [00:01, 9221.88it/s]15767it [00:01, 9219.33it/s]16695it [00:01, 9237.28it/s]17618it [00:01, 8793.13it/s]18546it [00:02, 8920.64it/s]19489it [00:02, 9065.59it/s]20413it [00:02, 9114.59it/s]21360it [00:02, 9217.46it/s]22301it [00:02, 9272.90it/s]23230it [00:02, 9276.74it/s]24167it [00:02, 9303.59it/s]25098it [00:02, 9287.47it/s]26028it [00:02, 9242.90it/s]26953it [00:02, 9122.21it/s]27872it [00:03, 9140.82it/s]28821it [00:03, 9242.80it/s]29746it [00:03, 9106.26it/s]30683it [00:03, 9182.44it/s]31623it [00:03, 9244.12it/s]32561it [00:03, 9281.80it/s]33508it [00:03, 9336.98it/s]34443it [00:03, 9316.34it/s]35381it [00:03, 9332.81it/s]36322it [00:03, 9354.38it/s]37258it [00:04, 9206.98it/s]38180it [00:04, 9169.40it/s]39106it [00:04, 9195.65it/s]40039it [00:04, 9234.13it/s]40983it [00:04, 9294.75it/s]41913it [00:04, 9111.18it/s]42871it [00:04, 9245.18it/s]43798it [00:04, 9250.52it/s]44724it [00:04, 9192.66it/s]45644it [00:04, 9121.17it/s]46590it [00:05, 9217.70it/s]47542it [00:05, 9306.09it/s]48474it [00:05, 9282.20it/s]49403it [00:05, 9158.43it/s]50320it [00:05, 9160.26it/s]51269it [00:05, 9256.41it/s]52216it [00:05, 9316.97it/s]53149it [00:05, 9271.86it/s]54077it [00:05, 9249.86it/s]55010it [00:05, 9271.82it/s]55938it [00:06, 9228.13it/s]56874it [00:06, 9264.78it/s]57801it [00:06, 9150.99it/s]58740it [00:06, 9219.77it/s]59685it [00:06, 9286.93it/s]60620it [00:06, 9304.00it/s]61557it [00:06, 9323.52it/s]61865it [00:06, 9232.43it/s]
Number of examples remaining: 138
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 300370.50it/s]
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4663.83it/s]
Number of tasks = 1
Splitting data with seed 3
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4487.70it/s]
Total scaffolds = 104 | train scaffolds = 82 | val scaffolds = 12 | test scaffolds = 10
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([3])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738021 0: 10.87%, 1: 89.13%
Total size = 138 | train size = 110 | val size = 13 | test size = 15
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 185.73it/s]
Validation prc-auc = 0.825757
Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 186.38it/s]
Validation prc-auc = 0.838635
  7%|‚ñã         | 2/30 [00:00<00:02, 10.86it/s]Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.5405e-02, PNorm = 69.3011, GNorm = 1.1691, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 178.45it/s]
Validation prc-auc = 0.838635
Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 184.20it/s]
Validation prc-auc = 0.850107
 13%|‚ñà‚ñé        | 4/30 [00:00<00:02, 11.63it/s]Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 180.44it/s]
Validation prc-auc = 0.850107
Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0705e-02, PNorm = 69.3011, GNorm = 1.4750, lr_0 = 1.0000e-04
Loss = 5.0027e-02, PNorm = 69.3011, GNorm = 1.0464, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 186.66it/s]
Validation prc-auc = 0.870562
 20%|‚ñà‚ñà        | 6/30 [00:00<00:01, 12.18it/s]Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 184.75it/s]
Validation prc-auc = 0.870562
Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 185.82it/s]
Validation prc-auc = 0.870562
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 13.76it/s]Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0554e-02, PNorm = 69.3011, GNorm = 1.1615, lr_0 = 1.0000e-04
Loss = 4.7518e-02, PNorm = 69.3011, GNorm = 1.0982, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 188.64it/s]
Validation prc-auc = 0.870562
Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 192.63it/s]
Validation prc-auc = 0.870562
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 15.09it/s]Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 182.37it/s]
Validation prc-auc = 0.870562
Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0063e-02, PNorm = 69.3011, GNorm = 1.3234, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 189.70it/s]
Validation prc-auc = 0.870562
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:00<00:01, 16.22it/s]Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 192.63it/s]
Validation prc-auc = 0.870562
Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 181.12it/s]
Validation prc-auc = 0.870562
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:00<00:00, 17.09it/s]Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9466e-02, PNorm = 69.3011, GNorm = 1.1153, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 188.81it/s]
Validation prc-auc = 0.880843
Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 180.28it/s]
Validation prc-auc = 0.880843
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:01<00:00, 15.93it/s]Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 186.07it/s]
Validation prc-auc = 0.880843
Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8994e-02, PNorm = 69.3011, GNorm = 1.2456, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 186.82it/s]
Validation prc-auc = 0.880843
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:00, 16.82it/s]Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 184.54it/s]
Validation prc-auc = 0.898592
Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.75it/s]
Validation prc-auc = 0.898592
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 15.78it/s]Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8464e-02, PNorm = 69.3012, GNorm = 1.1022, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 191.89it/s]
Validation prc-auc = 0.906351
Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 191.18it/s]
Validation prc-auc = 0.906351
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 15.12it/s]Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 177.92it/s]
Validation prc-auc = 0.906351
Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8430e-02, PNorm = 69.3012, GNorm = 1.0971, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 187.40it/s]
Validation prc-auc = 0.906351
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:01<00:00, 16.12it/s]Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 190.72it/s]
Validation prc-auc = 0.906351
Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 187.84it/s]
Validation prc-auc = 0.913514
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:01<00:00, 15.52it/s]Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7376e-02, PNorm = 69.3012, GNorm = 1.0572, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 189.56it/s]
Validation prc-auc = 0.913514
Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 189.37it/s]
Validation prc-auc = 0.913514
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:01<00:00, 16.39it/s]Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 189.28it/s]
Validation prc-auc = 0.913514
Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7283e-02, PNorm = 69.3012, GNorm = 1.1182, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 188.14it/s]
Validation prc-auc = 0.913514
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 17.14it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 15.98it/s]
Model 0 best validation prc-auc = 0.913514 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 177.72it/s]
Model 0 test prc-auc = 0.952633
Ensemble test prc-auc = 0.952633
Fold 2
Command line
python chemprop/finetune.py --seeds 2 3 4 5 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738021 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738021_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738021_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpwv_0zlhm/fold_2',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [2, 3, 4, 5, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738021'],
 'task_names': ['CHEMBL1738021'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 110,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]942it [00:00, 9411.59it/s]1886it [00:00, 9418.66it/s]2789it [00:00, 9297.20it/s]3704it [00:00, 9250.61it/s]4639it [00:00, 9277.82it/s]5498it [00:00, 9059.08it/s]6434it [00:00, 9147.07it/s]7358it [00:00, 9173.96it/s]8289it [00:00, 9211.66it/s]9189it [00:01, 9147.08it/s]10136it [00:01, 9239.52it/s]11082it [00:01, 9301.08it/s]12000it [00:01, 9241.97it/s]12956it [00:01, 9333.61it/s]13906it [00:01, 9380.16it/s]14856it [00:01, 9415.23it/s]15802it [00:01, 9426.01it/s]16743it [00:01, 9327.55it/s]17675it [00:01, 9285.03it/s]18612it [00:02, 9308.67it/s]19550it [00:02, 9327.12it/s]20492it [00:02, 9354.38it/s]21428it [00:02, 9269.56it/s]22355it [00:02, 9243.26it/s]23296it [00:02, 9290.98it/s]24240it [00:02, 9335.06it/s]25184it [00:02, 9365.73it/s]26121it [00:02, 9296.01it/s]27058it [00:02, 9317.32it/s]27990it [00:03, 9285.81it/s]28931it [00:03, 9321.88it/s]29880it [00:03, 9370.36it/s]30818it [00:03, 9313.45it/s]31750it [00:03, 9295.21it/s]32698it [00:03, 9347.20it/s]33645it [00:03, 9383.55it/s]34590it [00:03, 9402.03it/s]35531it [00:03, 9341.34it/s]36466it [00:03, 9152.91it/s]37410it [00:04, 9235.49it/s]38357it [00:04, 9304.15it/s]39289it [00:04, 9261.17it/s]40221it [00:04, 9276.58it/s]41163it [00:04, 9317.14it/s]42110it [00:04, 9359.90it/s]43063it [00:04, 9409.75it/s]44005it [00:04, 9405.57it/s]44946it [00:04, 9314.84it/s]45885it [00:04, 9335.79it/s]46823it [00:05, 9345.98it/s]47760it [00:05, 9352.65it/s]48704it [00:05, 9378.06it/s]49642it [00:05, 9351.80it/s]50578it [00:05, 9328.56it/s]51521it [00:05, 9358.47it/s]52466it [00:05, 9385.47it/s]53405it [00:05, 9340.48it/s]54340it [00:05, 9226.91it/s]55271it [00:05, 9249.61it/s]56197it [00:06, 9237.19it/s]57138it [00:06, 9285.82it/s]58080it [00:06, 9323.65it/s]59015it [00:06, 9330.90it/s]59955it [00:06, 9349.86it/s]60906it [00:06, 9396.01it/s]61846it [00:06, 9382.40it/s]61865it [00:06, 9310.99it/s]
Number of examples remaining: 138
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 231340.51it/s]
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4751.23it/s]
Number of tasks = 1
Splitting data with seed 4
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4683.83it/s]
Total scaffolds = 104 | train scaffolds = 83 | val scaffolds = 8 | test scaffolds = 13
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([3])), (array([0.33333333]), array([3])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738021 0: 10.87%, 1: 89.13%
Total size = 138 | train size = 110 | val size = 13 | test size = 15
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 85.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 205.59it/s]
Validation prc-auc = 0.877083
Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.92it/s]
Validation prc-auc = 0.877083
  7%|‚ñã         | 2/30 [00:00<00:02, 13.81it/s]Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.5341e-02, PNorm = 69.3011, GNorm = 0.9882, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 213.89it/s]
Validation prc-auc = 0.877083
Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 207.58it/s]
Validation prc-auc = 0.877083
 13%|‚ñà‚ñé        | 4/30 [00:00<00:01, 15.15it/s]Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 79.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 204.83it/s]
Validation prc-auc = 0.877083
Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1015e-02, PNorm = 69.3011, GNorm = 1.3211, lr_0 = 1.0000e-04
Loss = 4.9626e-02, PNorm = 69.3011, GNorm = 1.1858, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 80.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 204.70it/s]
Validation prc-auc = 0.877083
 20%|‚ñà‚ñà        | 6/30 [00:00<00:01, 15.73it/s]Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 217.99it/s]
Validation prc-auc = 0.842361
Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 208.97it/s]
Validation prc-auc = 0.842361
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 16.74it/s]Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0395e-02, PNorm = 69.3011, GNorm = 1.0035, lr_0 = 1.0000e-04
Loss = 4.7071e-02, PNorm = 69.3011, GNorm = 1.6297, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 82.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.90it/s]
Validation prc-auc = 0.842361
Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 207.77it/s]
Validation prc-auc = 0.842361
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 17.33it/s]Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 208.66it/s]
Validation prc-auc = 0.842361
Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0213e-02, PNorm = 69.3011, GNorm = 1.0559, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 217.31it/s]
Validation prc-auc = 0.842361
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:00<00:01, 17.86it/s]Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 213.36it/s]
Validation prc-auc = 0.842361
Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 211.89it/s]
Validation prc-auc = 0.842361
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:00<00:00, 18.41it/s]Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9743e-02, PNorm = 69.3011, GNorm = 1.0155, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.98it/s]
Validation prc-auc = 0.842361
Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 197.16it/s]
Validation prc-auc = 0.842361
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:00<00:00, 18.74it/s]Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 214.20it/s]
Validation prc-auc = 0.842361
Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9049e-02, PNorm = 69.3011, GNorm = 0.8418, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 210.03it/s]
Validation prc-auc = 0.842361
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:00<00:00, 18.89it/s]Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 209.86it/s]
Validation prc-auc = 0.842361
Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 208.15it/s]
Validation prc-auc = 0.842361
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 19.16it/s]Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8674e-02, PNorm = 69.3012, GNorm = 1.0931, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 79.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 202.20it/s]
Validation prc-auc = 0.842361
Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 196.90it/s]
Validation prc-auc = 0.842361
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 18.90it/s]Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 214.28it/s]
Validation prc-auc = 0.842361
Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8905e-02, PNorm = 69.3012, GNorm = 0.9574, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 211.23it/s]
Validation prc-auc = 0.842361
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:01<00:00, 18.99it/s]Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 210.68it/s]
Validation prc-auc = 0.842361
Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 205.23it/s]
Validation prc-auc = 0.842361
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:01<00:00, 19.26it/s]Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8045e-02, PNorm = 69.3012, GNorm = 0.9394, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 208.96it/s]
Validation prc-auc = 0.842361
Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.03it/s]
Validation prc-auc = 0.842361
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:01<00:00, 19.25it/s]Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 205.28it/s]
Validation prc-auc = 0.842361
Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7778e-02, PNorm = 69.3013, GNorm = 0.8403, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 210.71it/s]
Validation prc-auc = 0.842361
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 19.18it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 18.69it/s]
Model 0 best validation prc-auc = 0.877083 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 161.42it/s]
Model 0 test prc-auc = 0.763862
Ensemble test prc-auc = 0.763862
Fold 3
Command line
python chemprop/finetune.py --seeds 2 3 4 5 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738021 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738021_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738021_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpwv_0zlhm/fold_3',
 'save_smiles_splits': False,
 'seed': 5,
 'seeds': [2, 3, 4, 5, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738021'],
 'task_names': ['CHEMBL1738021'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 110,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]863it [00:00, 8623.92it/s]1766it [00:00, 8739.82it/s]2653it [00:00, 8777.84it/s]3561it [00:00, 8864.90it/s]4415it [00:00, 8759.78it/s]5307it [00:00, 8806.28it/s]6210it [00:00, 8870.23it/s]7120it [00:00, 8935.91it/s]8031it [00:00, 8987.31it/s]8919it [00:01, 8952.95it/s]9813it [00:01, 8946.22it/s]10691it [00:01, 8708.99it/s]11586it [00:01, 8779.68it/s]12497it [00:01, 8875.69it/s]13380it [00:01, 8651.41it/s]14261it [00:01, 8696.35it/s]15168it [00:01, 8803.39it/s]16085it [00:01, 8908.88it/s]17002it [00:01, 8985.56it/s]17911it [00:02, 9014.20it/s]18813it [00:02, 8984.26it/s]19717it [00:02, 8998.59it/s]20631it [00:02, 9039.12it/s]21546it [00:02, 9070.10it/s]22454it [00:02, 9040.50it/s]23359it [00:02, 8990.07it/s]24259it [00:02, 8986.33it/s]25170it [00:02, 9021.03it/s]26073it [00:02, 9010.37it/s]26976it [00:03, 9014.40it/s]27878it [00:03, 8962.55it/s]28775it [00:03, 8734.00it/s]29675it [00:03, 8808.95it/s]30579it [00:03, 8876.27it/s]31480it [00:03, 8915.84it/s]32373it [00:03, 8852.11it/s]33261it [00:03, 8858.26it/s]34156it [00:03, 8883.65it/s]35048it [00:03, 8893.11it/s]35950it [00:04, 8929.74it/s]36844it [00:04, 8914.46it/s]37747it [00:04, 8946.50it/s]38642it [00:04, 8735.46it/s]39537it [00:04, 8796.68it/s]40435it [00:04, 8848.71it/s]41334it [00:04, 8887.92it/s]42228it [00:04, 8902.85it/s]43125it [00:04, 8921.73it/s]44023it [00:04, 8936.53it/s]44926it [00:05, 8962.47it/s]45823it [00:05, 8932.62it/s]46730it [00:05, 8970.70it/s]47628it [00:05, 8960.70it/s]48525it [00:05, 8645.27it/s]49427it [00:05, 8754.07it/s]50310it [00:05, 8774.11it/s]51189it [00:05, 8587.52it/s]52097it [00:05, 8729.48it/s]53003it [00:05, 8825.27it/s]53899it [00:06, 8862.71it/s]54787it [00:06, 8694.15it/s]55658it [00:06, 8689.85it/s]56546it [00:06, 8743.51it/s]57446it [00:06, 8817.28it/s]58345it [00:06, 8866.31it/s]59233it [00:06, 8860.30it/s]60131it [00:06, 8895.63it/s]61036it [00:06, 8941.19it/s]61865it [00:06, 8879.98it/s]
Number of examples remaining: 138
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 309360.74it/s]
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4777.74it/s]
Number of tasks = 1
Splitting data with seed 5
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4081.93it/s]
Total scaffolds = 104 | train scaffolds = 84 | val scaffolds = 10 | test scaffolds = 10
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([3])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([3]))]
Class sizes
CHEMBL1738021 0: 10.87%, 1: 89.13%
Total size = 138 | train size = 110 | val size = 13 | test size = 15
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 192.49it/s]
Validation prc-auc = 0.645594
Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.56it/s]
Validation prc-auc = 0.645594
  7%|‚ñã         | 2/30 [00:00<00:02, 13.90it/s]Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.5142e-02, PNorm = 69.3011, GNorm = 1.0210, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.61it/s]
Validation prc-auc = 0.645594
Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.47it/s]
Validation prc-auc = 0.645594
 13%|‚ñà‚ñé        | 4/30 [00:00<00:01, 15.18it/s]Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.37it/s]
Validation prc-auc = 0.645594
Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0793e-02, PNorm = 69.3011, GNorm = 1.1175, lr_0 = 1.0000e-04
Loss = 4.8545e-02, PNorm = 69.3011, GNorm = 0.8959, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 84.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 209.58it/s]
Validation prc-auc = 0.645594
 20%|‚ñà‚ñà        | 6/30 [00:00<00:01, 16.18it/s]Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 197.10it/s]
Validation prc-auc = 0.645594
Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.00it/s]
Validation prc-auc = 0.645594
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 17.15it/s]Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0367e-02, PNorm = 69.3011, GNorm = 0.9824, lr_0 = 1.0000e-04
Loss = 5.0254e-02, PNorm = 69.3011, GNorm = 0.6503, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 83.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 208.58it/s]
Validation prc-auc = 0.654820
Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 199.58it/s]
Validation prc-auc = 0.654820
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 15.93it/s]Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.80it/s]
Validation prc-auc = 0.654820
Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9933e-02, PNorm = 69.3011, GNorm = 0.8344, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 198.37it/s]
Validation prc-auc = 0.667439
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:00<00:01, 15.31it/s]Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 188.14it/s]
Validation prc-auc = 0.667439
Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 224.32it/s]
Validation prc-auc = 0.667439
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:00<00:00, 16.44it/s]Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0026e-02, PNorm = 69.3011, GNorm = 1.0798, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.47it/s]
Validation prc-auc = 0.667439
Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.46it/s]
Validation prc-auc = 0.667439
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:00<00:00, 17.21it/s]Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 202.29it/s]
Validation prc-auc = 0.667439
Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9833e-02, PNorm = 69.3011, GNorm = 0.9026, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 205.98it/s]
Validation prc-auc = 0.667439
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:00, 17.74it/s]Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 204.89it/s]
Validation prc-auc = 0.667439
Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 204.44it/s]
Validation prc-auc = 0.667439
Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9176e-02, PNorm = 69.3012, GNorm = 0.9120, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 202.38it/s]
Validation prc-auc = 0.667439
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:01<00:00, 18.30it/s]Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 204.97it/s]
Validation prc-auc = 0.667439
Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 199.71it/s]
Validation prc-auc = 0.667439
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:01<00:00, 18.55it/s]Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7898e-02, PNorm = 69.3012, GNorm = 1.0533, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 205.31it/s]
Validation prc-auc = 0.667439
Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 207.23it/s]
Validation prc-auc = 0.667439
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:01<00:00, 18.89it/s]Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 202.08it/s]
Validation prc-auc = 0.667439
Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8199e-02, PNorm = 69.3012, GNorm = 0.9961, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.80it/s]
Validation prc-auc = 0.667439
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:01<00:00, 18.84it/s]Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 203.56it/s]
Validation prc-auc = 0.667439
Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 177.87it/s]
Validation prc-auc = 0.667439
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:01<00:00, 19.06it/s]Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7902e-02, PNorm = 69.3013, GNorm = 0.7919, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 199.61it/s]
Validation prc-auc = 0.667439
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 17.97it/s]
Model 0 best validation prc-auc = 0.667439 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 173.70it/s]
Model 0 test prc-auc = 0.977823
Ensemble test prc-auc = 0.977823
Fold 4
Command line
python chemprop/finetune.py --seeds 2 3 4 5 7 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738021 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738021_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738021_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmpwv_0zlhm/fold_4',
 'save_smiles_splits': False,
 'seed': 7,
 'seeds': [2, 3, 4, 5, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738021'],
 'task_names': ['CHEMBL1738021'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 110,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]881it [00:00, 8801.93it/s]1797it [00:00, 8903.93it/s]2688it [00:00, 8905.37it/s]3614it [00:00, 9006.96it/s]4545it [00:00, 9094.75it/s]5435it [00:00, 9033.39it/s]6368it [00:00, 9119.69it/s]7292it [00:00, 9154.77it/s]8216it [00:00, 9178.22it/s]9146it [00:01, 9213.37it/s]10057it [00:01, 9180.30it/s]10978it [00:01, 9188.74it/s]11900it [00:01, 9196.54it/s]12824it [00:01, 9208.77it/s]13742it [00:01, 9197.43it/s]14658it [00:01, 9140.04it/s]15570it [00:01, 9132.23it/s]16486it [00:01, 9138.62it/s]17415it [00:01, 9183.34it/s]18346it [00:02, 9210.66it/s]19267it [00:02, 9165.02it/s]20197it [00:02, 9202.46it/s]21118it [00:02, 9186.38it/s]22049it [00:02, 9221.75it/s]22974it [00:02, 9230.00it/s]23906it [00:02, 9254.24it/s]24832it [00:02, 9244.84it/s]25761it [00:02, 9257.43it/s]26687it [00:02, 9222.87it/s]27610it [00:03, 9209.88it/s]28532it [00:03, 9000.81it/s]29434it [00:03, 8973.40it/s]30340it [00:03, 8938.63it/s]31265it [00:03, 9029.01it/s]32189it [00:03, 9091.10it/s]33118it [00:03, 9149.59it/s]34034it [00:03, 9143.35it/s]34949it [00:03, 9010.65it/s]35856it [00:03, 9026.89it/s]36783it [00:04, 9092.90it/s]37710it [00:04, 9144.37it/s]38625it [00:04, 9087.96it/s]39552it [00:04, 9141.51it/s]40467it [00:04, 9134.38it/s]41381it [00:04, 9135.17it/s]42295it [00:04, 9112.19it/s]43207it [00:04, 8973.56it/s]44129it [00:04, 9045.35it/s]45048it [00:04, 9086.59it/s]45971it [00:05, 9126.76it/s]46888it [00:05, 9138.35it/s]47803it [00:05, 9139.92it/s]48718it [00:05, 9113.82it/s]49637it [00:05, 9133.94it/s]50551it [00:05, 9111.67it/s]51463it [00:05, 9090.14it/s]52380it [00:05, 9112.07it/s]53301it [00:05, 9138.70it/s]54215it [00:05, 9082.41it/s]55124it [00:06, 9063.75it/s]56031it [00:06, 9037.36it/s]56935it [00:06, 8985.41it/s]57834it [00:06, 8968.47it/s]58742it [00:06, 8999.62it/s]59643it [00:06, 8682.83it/s]60549it [00:06, 8791.54it/s]61462it [00:06, 8888.38it/s]61865it [00:06, 9097.54it/s]
Number of examples remaining: 138
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 363805.12it/s]
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4819.67it/s]
Number of tasks = 1
Splitting data with seed 7
  0%|          | 0/138 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 138/138 [00:00<00:00, 4562.22it/s]
Total scaffolds = 104 | train scaffolds = 80 | val scaffolds = 12 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.75]), array([4])), (array([1.]), array([2])), (array([0.33333333]), array([3])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738021 0: 10.87%, 1: 89.13%
Total size = 138 | train size = 110 | val size = 13 | test size = 15
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 86.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.53it/s]
Validation prc-auc = 0.842361
Epoch 1

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 185.22it/s]
Validation prc-auc = 0.842361
  7%|‚ñã         | 2/30 [00:00<00:02, 13.96it/s]Epoch 2

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.5229e-02, PNorm = 69.3011, GNorm = 1.0221, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.52it/s]
Validation prc-auc = 0.842361
Epoch 3

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 194.88it/s]
Validation prc-auc = 0.842361
 13%|‚ñà‚ñé        | 4/30 [00:00<00:01, 15.22it/s]Epoch 4

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 176.59it/s]
Validation prc-auc = 0.842361
Epoch 5

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.1161e-02, PNorm = 69.3011, GNorm = 1.2796, lr_0 = 1.0000e-04
Loss = 4.6099e-02, PNorm = 69.3011, GNorm = 1.1073, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 82.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 197.64it/s]
Validation prc-auc = 0.842361
 20%|‚ñà‚ñà        | 6/30 [00:00<00:01, 16.03it/s]Epoch 6

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.56it/s]
Validation prc-auc = 0.842361
Epoch 7

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 125.79it/s]
Validation prc-auc = 0.842361
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 16.87it/s]Epoch 8

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 2.0518e-02, PNorm = 69.3011, GNorm = 0.9774, lr_0 = 1.0000e-04
Loss = 4.5323e-02, PNorm = 69.3011, GNorm = 1.0771, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 80.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.21it/s]
Validation prc-auc = 0.842361
Epoch 9

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 195.99it/s]
Validation prc-auc = 0.842361
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 17.33it/s]Epoch 10

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 196.61it/s]
Validation prc-auc = 0.842361
Epoch 11

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9967e-02, PNorm = 69.3011, GNorm = 0.9610, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 82.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 188.01it/s]
Validation prc-auc = 0.842361
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:00<00:01, 17.73it/s]Epoch 12

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 194.56it/s]
Validation prc-auc = 0.842361
Epoch 13

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 92.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 190.49it/s]
Validation prc-auc = 0.842361
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:00<00:00, 18.26it/s]Epoch 14

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9472e-02, PNorm = 69.3011, GNorm = 1.0687, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 196.12it/s]
Validation prc-auc = 0.842361
Epoch 15

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 189.64it/s]
Validation prc-auc = 0.842361
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:00<00:00, 18.61it/s]Epoch 16

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 95.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 195.72it/s]
Validation prc-auc = 0.842361
Epoch 17

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.9000e-02, PNorm = 69.3011, GNorm = 0.9030, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 199.41it/s]
Validation prc-auc = 0.842361
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:00<00:00, 18.90it/s]Epoch 18

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 176.28it/s]
Validation prc-auc = 0.842361
Epoch 19

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 191.75it/s]
Validation prc-auc = 0.842361
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 19.16it/s]Epoch 20

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8940e-02, PNorm = 69.3012, GNorm = 0.9824, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 90.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 200.03it/s]
Validation prc-auc = 0.842361
Epoch 21

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 201.07it/s]
Validation prc-auc = 0.842361
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 19.33it/s]Epoch 22

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 84.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 190.40it/s]
Validation prc-auc = 0.842361
Epoch 23

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8000e-02, PNorm = 69.3012, GNorm = 1.0004, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 89.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 192.97it/s]
Validation prc-auc = 0.842361
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:01<00:00, 19.13it/s]Epoch 24

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 91.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 193.73it/s]
Validation prc-auc = 0.842361
Epoch 25

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 187.94it/s]
Validation prc-auc = 0.842361
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:01<00:00, 19.24it/s]Epoch 26

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.7912e-02, PNorm = 69.3012, GNorm = 0.9834, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 88.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 195.54it/s]
Validation prc-auc = 0.842361
Epoch 27

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 94.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 194.99it/s]
Validation prc-auc = 0.877083
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:01<00:00, 17.23it/s]Epoch 28

  0%|          | 0/4 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 93.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 195.76it/s]
Validation prc-auc = 0.877083
Epoch 29

  0%|          | 0/4 [00:00<?, ?it/s][ALoss = 1.8711e-02, PNorm = 69.3012, GNorm = 0.8024, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 87.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 174.63it/s]
Validation prc-auc = 0.877083
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 17.75it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:01<00:00, 18.25it/s]
Model 0 best validation prc-auc = 0.877083 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 162.66it/s]
Model 0 test prc-auc = 0.854650
Ensemble test prc-auc = 0.854650
5-fold cross validation
Seed 0 ==> test prc-auc = 0.568594
Seed 1 ==> test prc-auc = 0.952633
Seed 2 ==> test prc-auc = 0.763862
Seed 3 ==> test prc-auc = 0.977823
Seed 4 ==> test prc-auc = 0.854650
Overall test prc-auc = 0.823513 +/- 0.148320
wandb: Waiting for W&B process to finish, PID 14023
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.10MB of 0.10MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: wandb/run-20200917_125503-2har9xca/logs/debug.log
wandb: Find internal logs for this run at: wandb/run-20200917_125503-2har9xca/logs/debug-internal.log
wandb: Run summary:
wandb:   validation_prc-auc 0.8770828708328708
wandb:                _step 154
wandb:             _runtime 46
wandb:           _timestamp 1600347350
wandb:         test_prc-auc 0.8546503100074528
wandb: Run history:
wandb:   validation_prc-auc ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá
wandb:                _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:             _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:           _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:         test_prc-auc ‚ñÅ‚ñà‚ñÑ‚ñà‚ñÜ
wandb: Synced 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced finetuning_finetuning_on_CHEMBL1738021_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/2har9xca

