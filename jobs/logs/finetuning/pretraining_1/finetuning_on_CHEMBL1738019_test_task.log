wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200808_200500-27z898fx
wandb: Syncing run finetuning_finetuning_on_CHEMBL1738019_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/27z898fx
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738019_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738019_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp5yrkpgs7/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]493it [00:00, 4924.05it/s]1257it [00:00, 5510.59it/s]2228it [00:00, 6332.04it/s]3211it [00:00, 7088.40it/s]4194it [00:00, 7735.34it/s]5190it [00:00, 8290.24it/s]6191it [00:00, 8739.98it/s]7178it [00:00, 9049.41it/s]8159it [00:00, 9263.80it/s]9146it [00:01, 9436.74it/s]10222it [00:01, 9796.34it/s]11312it [00:01, 10102.37it/s]12409it [00:01, 10346.83it/s]13508it [00:01, 10530.16it/s]14617it [00:01, 10691.50it/s]15723it [00:01, 10796.74it/s]16822it [00:01, 10852.03it/s]17910it [00:01, 10804.57it/s]19002it [00:01, 10836.56it/s]20100it [00:02, 10879.01it/s]21204it [00:02, 10926.35it/s]22309it [00:02, 10963.04it/s]23419it [00:02, 11003.49it/s]24530it [00:02, 11034.33it/s]25639it [00:02, 11048.87it/s]26748it [00:02, 11059.01it/s]27862it [00:02, 11081.88it/s]28973it [00:02, 11089.10it/s]30082it [00:02, 11019.56it/s]31198it [00:03, 11059.02it/s]32313it [00:03, 11084.19it/s]33427it [00:03, 11097.99it/s]34539it [00:03, 11102.23it/s]35650it [00:03, 11056.68it/s]36756it [00:03, 11051.66it/s]37871it [00:03, 11079.51it/s]38987it [00:03, 11100.72it/s]40098it [00:03, 10986.19it/s]41209it [00:03, 11021.08it/s]42319it [00:04, 11042.29it/s]43424it [00:04, 11042.20it/s]44530it [00:04, 11047.48it/s]45635it [00:04, 10971.46it/s]46750it [00:04, 11024.25it/s]47866it [00:04, 11062.74it/s]48979it [00:04, 11080.98it/s]50088it [00:04, 10957.71it/s]51202it [00:04, 11009.27it/s]52321it [00:04, 11062.02it/s]53438it [00:05, 11093.92it/s]54548it [00:05, 11074.37it/s]55656it [00:05, 11042.90it/s]56764it [00:05, 11051.91it/s]57885it [00:05, 11096.28it/s]59005it [00:05, 11125.42it/s]60118it [00:05, 10848.57it/s]61214it [00:05, 10879.89it/s]61865it [00:05, 10691.50it/s]
Number of examples remaining: 165
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 51055.71it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5670.90it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5687.22it/s]
Total scaffolds = 117 | train scaffolds = 91 | val scaffolds = 15 | test scaffolds = 11
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.61538462]), array([13])), (array([0.88888889]), array([9])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A
 20% 1/5 [00:00<00:00,  4.71it/s][A
 80% 4/5 [00:00<00:00,  6.28it/s][A100% 5/5 [00:00<00:00, 15.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 50.93it/s]
Validation prc-auc = 0.983214
  3% 1/30 [00:00<00:11,  2.56it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 123.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 223.43it/s]
Validation prc-auc = 0.983214
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1630e-02, PNorm = 69.3011, GNorm = 0.5551, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 57.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 121.70it/s]
Validation prc-auc = 0.988130
 10% 3/30 [00:01<00:13,  2.05it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 76.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.87it/s]
Validation prc-auc = 0.988130
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1609e-02, PNorm = 69.3011, GNorm = 0.4529, lr_0 = 1.0000e-04
Loss = 1.8041e-01, PNorm = 69.3011, GNorm = 1.5199, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 186.64it/s]
Validation prc-auc = 0.988130
 17% 5/30 [00:01<00:09,  2.75it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 202.02it/s]
Validation prc-auc = 0.988130
Epoch 6

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 117.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 203.33it/s]
Validation prc-auc = 0.988130
 23% 7/30 [00:02<00:06,  3.71it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1481e-02, PNorm = 69.3011, GNorm = 0.9135, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 116.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 208.06it/s]
Validation prc-auc = 0.994294
Epoch 8

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 114.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 202.04it/s]
Validation prc-auc = 0.994294
 30% 9/30 [00:02<00:04,  4.75it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1100e-02, PNorm = 69.3011, GNorm = 0.9216, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 59.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 123.30it/s]
Validation prc-auc = 1.000000
Epoch 10

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 95.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.25it/s]
Validation prc-auc = 1.000000
 37% 11/30 [00:02<00:03,  5.55it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 60.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 115.43it/s]
Validation prc-auc = 1.000000
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1473e-02, PNorm = 69.3011, GNorm = 0.6912, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 74.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 140.23it/s]
Validation prc-auc = 1.000000
 43% 13/30 [00:02<00:02,  6.52it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 82.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.32it/s]
Validation prc-auc = 1.000000
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1088e-02, PNorm = 69.3011, GNorm = 0.6908, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 87.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.63it/s]
Validation prc-auc = 1.000000
 50% 15/30 [00:02<00:01,  7.79it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 88.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.92it/s]
Validation prc-auc = 1.000000
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0626e-02, PNorm = 69.3011, GNorm = 0.8493, lr_0 = 1.0000e-04
Loss = 1.7655e-01, PNorm = 69.3011, GNorm = 0.8029, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 77.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.06it/s]
Validation prc-auc = 1.000000
 57% 17/30 [00:02<00:01,  8.97it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.52it/s]
Validation prc-auc = 1.000000
Epoch 18

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 121.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.02it/s]
Validation prc-auc = 1.000000
 63% 19/30 [00:03<00:01, 10.68it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0538e-02, PNorm = 69.3011, GNorm = 0.5105, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.29it/s]
Validation prc-auc = 1.000000
Epoch 20

  0% 0/5 [00:00<?, ?it/s][A
 40% 2/5 [00:00<00:00, 17.86it/s][A100% 5/5 [00:00<00:00, 36.90it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.54it/s]
Validation prc-auc = 1.000000
 70% 21/30 [00:03<00:00, 10.53it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0324e-02, PNorm = 69.3011, GNorm = 0.7221, lr_0 = 1.0000e-04
Loss = 1.8036e-01, PNorm = 69.3011, GNorm = 1.0985, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 110.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.32it/s]
Validation prc-auc = 1.000000
Epoch 22

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.54it/s]
Validation prc-auc = 1.000000
 77% 23/30 [00:03<00:00, 12.09it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.77it/s]
Validation prc-auc = 0.994294
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0782e-02, PNorm = 69.3011, GNorm = 0.5421, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.60it/s]
Validation prc-auc = 0.994294
 83% 25/30 [00:03<00:00, 13.49it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.63it/s]
Validation prc-auc = 0.994294
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0611e-02, PNorm = 69.3011, GNorm = 0.5675, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 113.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.82it/s]
Validation prc-auc = 0.994294
 90% 27/30 [00:03<00:00, 14.76it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 117.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.76it/s]
Validation prc-auc = 0.994294
Epoch 28

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.57it/s]
Validation prc-auc = 0.988130
 97% 29/30 [00:03<00:00, 15.85it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0310e-02, PNorm = 69.3011, GNorm = 0.7347, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 206.82it/s]
Validation prc-auc = 0.988130
100% 30/30 [00:03<00:00,  8.15it/s]
Model 0 best validation prc-auc = 1.000000 on epoch 9
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 45.79it/s]
Model 0 test prc-auc = 0.913003
Ensemble test prc-auc = 0.913003
Fold 1
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738019_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738019_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp5yrkpgs7/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]503it [00:00, 5026.69it/s]1277it [00:00, 5616.28it/s]2252it [00:00, 6433.87it/s]3241it [00:00, 7185.88it/s]4231it [00:00, 7829.66it/s]5225it [00:00, 8362.18it/s]6223it [00:00, 8788.11it/s]7214it [00:00, 9096.52it/s]8205it [00:00, 9325.09it/s]9186it [00:01, 9462.99it/s]10169it [00:01, 9570.03it/s]11249it [00:01, 9907.92it/s]12338it [00:01, 10182.42it/s]13417it [00:01, 10355.44it/s]14510it [00:01, 10520.04it/s]15599it [00:01, 10627.38it/s]16699it [00:01, 10736.11it/s]17775it [00:01, 10734.17it/s]18860it [00:01, 10766.45it/s]19938it [00:02, 10759.92it/s]21022it [00:02, 10781.94it/s]22101it [00:02, 10767.23it/s]23180it [00:02, 10771.90it/s]24263it [00:02, 10787.36it/s]25349it [00:02, 10807.26it/s]26430it [00:02, 10738.65it/s]27522it [00:02, 10790.86it/s]28602it [00:02, 10750.27it/s]29678it [00:02, 10560.07it/s]30735it [00:03, 10554.01it/s]31808it [00:03, 10603.59it/s]32881it [00:03, 10639.65it/s]33946it [00:03, 10607.83it/s]35008it [00:03, 10598.20it/s]36099it [00:03, 10687.93it/s]37177it [00:03, 10712.53it/s]38259it [00:03, 10741.85it/s]39336it [00:03, 10749.87it/s]40429it [00:03, 10802.71it/s]41520it [00:04, 10831.97it/s]42609it [00:04, 10846.98it/s]43694it [00:04, 10731.48it/s]44779it [00:04, 10765.61it/s]45868it [00:04, 10800.48it/s]46949it [00:04, 10794.48it/s]48029it [00:04, 10769.00it/s]49107it [00:04, 10733.57it/s]50190it [00:04, 10760.10it/s]51288it [00:04, 10823.47it/s]52390it [00:05, 10879.70it/s]53479it [00:05, 10850.20it/s]54565it [00:05, 10798.31it/s]55645it [00:05, 10487.71it/s]56696it [00:05, 10310.63it/s]57730it [00:05, 10235.19it/s]58756it [00:05, 10186.05it/s]59846it [00:05, 10389.05it/s]60941it [00:05, 10550.92it/s]61865it [00:05, 10435.50it/s]
Number of examples remaining: 165
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 478272.40it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5653.95it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5345.08it/s]
Total scaffolds = 117 | train scaffolds = 90 | val scaffolds = 10 | test scaffolds = 17
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([3])), (array([1.]), array([1])), (array([0.]), array([3])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 91.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 197.58it/s]
Validation prc-auc = 0.787346
  3% 1/30 [00:00<00:03,  9.47it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 121.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 207.53it/s]
Validation prc-auc = 0.787346
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1770e-02, PNorm = 69.3011, GNorm = 0.9373, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 213.96it/s]
Validation prc-auc = 0.787346
 10% 3/30 [00:00<00:02, 11.19it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 117.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.76it/s]
Validation prc-auc = 0.787346
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1798e-02, PNorm = 69.3011, GNorm = 0.6405, lr_0 = 1.0000e-04
Loss = 1.6400e-01, PNorm = 69.3011, GNorm = 3.1758, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 111.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.58it/s]
Validation prc-auc = 0.782122
 17% 5/30 [00:00<00:01, 12.75it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.69it/s]
Validation prc-auc = 0.770398
Epoch 6

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 117.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.94it/s]
Validation prc-auc = 0.770398
 23% 7/30 [00:00<00:01, 14.22it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1215e-02, PNorm = 69.3011, GNorm = 0.6197, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.46it/s]
Validation prc-auc = 0.763751
Epoch 8

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.69it/s]
Validation prc-auc = 0.763751
 30% 9/30 [00:00<00:01, 15.42it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0784e-02, PNorm = 69.3011, GNorm = 0.7234, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 113.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.13it/s]
Validation prc-auc = 0.739360
Epoch 10

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 209.17it/s]
Validation prc-auc = 0.739360
 37% 11/30 [00:00<00:01, 16.37it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.32it/s]
Validation prc-auc = 0.729241
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0756e-02, PNorm = 69.3011, GNorm = 0.7097, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.57it/s]
Validation prc-auc = 0.706027
 43% 13/30 [00:00<00:00, 17.11it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.47it/s]
Validation prc-auc = 0.706027
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0827e-02, PNorm = 69.3011, GNorm = 0.7517, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.25it/s]
Validation prc-auc = 0.700074
 50% 15/30 [00:00<00:00, 17.53it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.17it/s]
Validation prc-auc = 0.700074
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0591e-02, PNorm = 69.3011, GNorm = 0.6473, lr_0 = 1.0000e-04
Loss = 1.7563e-01, PNorm = 69.3011, GNorm = 1.1194, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 91.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 215.40it/s]
Validation prc-auc = 0.700074
 57% 17/30 [00:00<00:00, 17.50it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 127.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 217.51it/s]
Validation prc-auc = 0.700074
Epoch 18

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 129.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 231.90it/s]
Validation prc-auc = 0.700074
 63% 19/30 [00:01<00:00, 18.16it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0490e-02, PNorm = 69.3011, GNorm = 0.7291, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 122.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 232.65it/s]
Validation prc-auc = 0.700074
Epoch 20

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 129.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 217.55it/s]
Validation prc-auc = 0.700074
Epoch 21

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0243e-02, PNorm = 69.3011, GNorm = 0.8101, lr_0 = 1.0000e-04
Loss = 1.5433e-01, PNorm = 69.3011, GNorm = 1.1790, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 213.95it/s]
Validation prc-auc = 0.700074
 73% 22/30 [00:01<00:00, 18.68it/s]Epoch 22

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.55it/s]
Validation prc-auc = 0.700074
Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.07it/s]
Validation prc-auc = 0.700074
 80% 24/30 [00:01<00:00, 16.87it/s]Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1272e-02, PNorm = 69.3011, GNorm = 0.5522, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 77.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.29it/s]
Validation prc-auc = 0.700074
Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 97.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.34it/s]
Validation prc-auc = 0.700074
 87% 26/30 [00:01<00:00, 16.06it/s]Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9594e-02, PNorm = 69.3012, GNorm = 0.4745, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 111.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.23it/s]
Validation prc-auc = 0.700074
Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.75it/s]
Validation prc-auc = 0.700074
 93% 28/30 [00:01<00:00, 16.77it/s]Epoch 28

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.91it/s]
Validation prc-auc = 0.700074
Epoch 29

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.8952e-02, PNorm = 69.3012, GNorm = 0.7921, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.11it/s]
Validation prc-auc = 0.700074
100% 30/30 [00:01<00:00, 17.32it/s]100% 30/30 [00:01<00:00, 17.64it/s]
Model 0 best validation prc-auc = 0.787346 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 176.14it/s]
Model 0 test prc-auc = 0.765379
Ensemble test prc-auc = 0.765379
Fold 2
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738019_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738019_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp5yrkpgs7/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]945it [00:00, 9441.19it/s]1916it [00:00, 9519.74it/s]2879it [00:00, 9550.66it/s]3848it [00:00, 9590.13it/s]4818it [00:00, 9620.99it/s]5800it [00:00, 9678.40it/s]6779it [00:00, 9711.43it/s]7822it [00:00, 9916.18it/s]8894it [00:00, 10142.58it/s]9972it [00:01, 10324.40it/s]11057it [00:01, 10476.50it/s]12132it [00:01, 10556.91it/s]13224it [00:01, 10660.75it/s]14313it [00:01, 10725.86it/s]15404it [00:01, 10777.78it/s]16491it [00:01, 10802.34it/s]17579it [00:01, 10824.85it/s]18666it [00:01, 10835.85it/s]19751it [00:01, 10837.60it/s]20834it [00:02, 10819.05it/s]21916it [00:02, 10796.09it/s]22996it [00:02, 10779.52it/s]24084it [00:02, 10807.38it/s]25169it [00:02, 10818.23it/s]26253it [00:02, 10824.54it/s]27340it [00:02, 10836.41it/s]28428it [00:02, 10848.61it/s]29513it [00:02, 10821.35it/s]30596it [00:02, 10809.80it/s]31677it [00:03, 10727.34it/s]32750it [00:03, 10659.04it/s]33834it [00:03, 10711.61it/s]34915it [00:03, 10740.08it/s]35990it [00:03, 10703.58it/s]37078it [00:03, 10753.35it/s]38164it [00:03, 10784.78it/s]39257it [00:03, 10827.11it/s]40340it [00:03, 10647.51it/s]41412it [00:03, 10668.72it/s]42492it [00:04, 10705.61it/s]43583it [00:04, 10765.91it/s]44677it [00:04, 10815.18it/s]45767it [00:04, 10837.63it/s]46854it [00:04, 10847.03it/s]47939it [00:04, 9652.98it/s] 48929it [00:04, 8705.38it/s]49890it [00:04, 8956.51it/s]50868it [00:04, 9188.01it/s]51844it [00:04, 9352.38it/s]52828it [00:05, 9491.61it/s]53795it [00:05, 9542.43it/s]54757it [00:05, 9557.51it/s]55722it [00:05, 9582.10it/s]56717it [00:05, 9688.17it/s]57794it [00:05, 9988.75it/s]58876it [00:05, 10221.93it/s]59962it [00:05, 10403.96it/s]61051it [00:05, 10544.27it/s]61865it [00:05, 10357.98it/s]
Number of examples remaining: 165
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 469511.64it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5553.76it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5201.31it/s]
Total scaffolds = 117 | train scaffolds = 90 | val scaffolds = 14 | test scaffolds = 13
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([1.]), array([1])), (array([0.8]), array([5])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A
 40% 2/5 [00:00<00:00, 19.91it/s][A100% 5/5 [00:00<00:00, 37.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.42it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
  3% 1/30 [00:00<00:04,  6.85it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 92.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1959e-02, PNorm = 69.3011, GNorm = 0.7135, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 180.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 10% 3/30 [00:00<00:03,  8.23it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 107.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 203.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1778e-02, PNorm = 69.3011, GNorm = 0.4908, lr_0 = 1.0000e-04
Loss = 1.7391e-01, PNorm = 69.3011, GNorm = 2.4204, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 108.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.04it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 17% 5/30 [00:00<00:02,  9.82it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 106.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 208.44it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 6

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 114.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 23% 7/30 [00:00<00:02, 11.43it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1217e-02, PNorm = 69.3011, GNorm = 0.6890, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 113.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.29it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 8

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.78it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 30% 9/30 [00:00<00:01, 12.97it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0976e-02, PNorm = 69.3011, GNorm = 0.7416, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 56.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 113.50it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 10

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 60.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 37% 11/30 [00:00<00:01, 11.84it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 64.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.60it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0682e-02, PNorm = 69.3011, GNorm = 0.7908, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 84.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 167.66it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 43% 13/30 [00:00<00:01, 12.03it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 104.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.65it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1043e-02, PNorm = 69.3011, GNorm = 0.7668, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 56.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 119.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 50% 15/30 [00:01<00:01, 12.12it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 77.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0799e-02, PNorm = 69.3011, GNorm = 0.7382, lr_0 = 1.0000e-04
Loss = 1.6788e-01, PNorm = 69.3011, GNorm = 1.6778, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 69.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.89it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 57% 17/30 [00:01<00:01, 12.28it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 111.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 18

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 113.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 63% 19/30 [00:01<00:00, 13.71it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1073e-02, PNorm = 69.3011, GNorm = 0.5923, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 108.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.59it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 20

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 201.18it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 70% 21/30 [00:01<00:00, 14.84it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0376e-02, PNorm = 69.3011, GNorm = 0.6791, lr_0 = 1.0000e-04
Loss = 1.5034e-01, PNorm = 69.3011, GNorm = 1.4864, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 109.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 202.17it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 22

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 110.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 77% 23/30 [00:01<00:00, 15.74it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.61it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0629e-02, PNorm = 69.3011, GNorm = 0.5320, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 107.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.91it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 83% 25/30 [00:01<00:00, 16.15it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 110.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0150e-02, PNorm = 69.3011, GNorm = 0.5946, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 108.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.17it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 90% 27/30 [00:01<00:00, 16.69it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 110.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.31it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 28

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 109.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.69it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 97% 29/30 [00:01<00:00, 17.11it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0273e-02, PNorm = 69.3011, GNorm = 0.4817, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 108.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.21it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100% 30/30 [00:02<00:00, 14.99it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 187.17it/s]
Model 0 test prc-auc = 0.693952
Ensemble test prc-auc = 0.693952
Fold 3
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738019_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738019_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp5yrkpgs7/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]787it [00:00, 7869.86it/s]1440it [00:00, 7413.43it/s]2037it [00:00, 6911.29it/s]2894it [00:00, 7335.96it/s]3859it [00:00, 7904.35it/s]4821it [00:00, 8350.34it/s]5783it [00:00, 8693.30it/s]6749it [00:00, 8961.60it/s]7711it [00:00, 9146.94it/s]8671it [00:01, 9275.74it/s]9637it [00:01, 9386.42it/s]10606it [00:01, 9473.54it/s]11664it [00:01, 9779.57it/s]12727it [00:01, 10017.42it/s]13790it [00:01, 10192.90it/s]14863it [00:01, 10347.64it/s]15937it [00:01, 10459.90it/s]17008it [00:01, 10532.83it/s]18074it [00:01, 10567.90it/s]19140it [00:02, 10594.60it/s]20202it [00:02, 10601.83it/s]21264it [00:02, 10606.81it/s]22328it [00:02, 10615.01it/s]23392it [00:02, 10621.68it/s]24455it [00:02, 10621.26it/s]25518it [00:02, 10611.36it/s]26580it [00:02, 10608.52it/s]27642it [00:02, 10609.87it/s]28704it [00:02, 10604.80it/s]29765it [00:03, 10599.47it/s]30831it [00:03, 10617.16it/s]31893it [00:03, 10617.33it/s]32957it [00:03, 10621.54it/s]34025it [00:03, 10638.80it/s]35095it [00:03, 10655.22it/s]36165it [00:03, 10666.92it/s]37234it [00:03, 10673.52it/s]38303it [00:03, 10678.08it/s]39371it [00:03, 10674.67it/s]40439it [00:04, 10641.89it/s]41504it [00:04, 10617.43it/s]42566it [00:04, 10608.82it/s]43627it [00:04, 10606.23it/s]44694it [00:04, 10624.20it/s]45757it [00:04, 10610.02it/s]46819it [00:04, 10611.40it/s]47881it [00:04, 10607.54it/s]48942it [00:04, 10604.45it/s]50004it [00:04, 10606.32it/s]51068it [00:05, 10614.74it/s]52132it [00:05, 10621.58it/s]53195it [00:05, 10567.85it/s]54252it [00:05, 10523.94it/s]55305it [00:05, 10506.31it/s]56356it [00:05, 10499.65it/s]57417it [00:05, 10529.35it/s]58479it [00:05, 10556.17it/s]59538it [00:05, 10564.78it/s]60596it [00:05, 10569.28it/s]61659it [00:06, 10585.14it/s]61865it [00:06, 10259.15it/s]
Number of examples remaining: 165
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 428520.22it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5412.47it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5001.95it/s]
Total scaffolds = 117 | train scaffolds = 95 | val scaffolds = 10 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A
 20% 1/5 [00:00<00:02,  1.58it/s][A100% 5/5 [00:00<00:00,  7.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 112.48it/s]
Validation prc-auc = 0.284042
  3% 1/30 [00:00<00:23,  1.26it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 75.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.15it/s]
Validation prc-auc = 0.284042
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1669e-02, PNorm = 69.3011, GNorm = 0.8737, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 83.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.98it/s]
Validation prc-auc = 0.284042
 10% 3/30 [00:00<00:15,  1.73it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.82it/s]
Validation prc-auc = 0.284042
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1679e-02, PNorm = 69.3011, GNorm = 0.8058, lr_0 = 1.0000e-04
Loss = 1.6695e-01, PNorm = 69.3011, GNorm = 1.6517, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 101.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.18it/s]
Validation prc-auc = 0.284042
 17% 5/30 [00:01<00:10,  2.36it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.89it/s]
Validation prc-auc = 0.284042
Epoch 6

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 113.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.71it/s]
Validation prc-auc = 0.288045
 23% 7/30 [00:01<00:07,  3.13it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1249e-02, PNorm = 69.3011, GNorm = 0.7762, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 108.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.00it/s]
Validation prc-auc = 0.292169
Epoch 8

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 110.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.48it/s]
Validation prc-auc = 0.292169
 30% 9/30 [00:01<00:05,  4.07it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1416e-02, PNorm = 69.3011, GNorm = 0.8204, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 110.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.80it/s]
Validation prc-auc = 0.292169
Epoch 10

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 114.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.80it/s]
Validation prc-auc = 0.292169
 37% 11/30 [00:01<00:03,  5.31it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 114.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.47it/s]
Validation prc-auc = 0.292169
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1404e-02, PNorm = 69.3011, GNorm = 0.6770, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 110.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.38it/s]
Validation prc-auc = 0.292169
 43% 13/30 [00:01<00:02,  6.75it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.90it/s]
Validation prc-auc = 0.292169
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0663e-02, PNorm = 69.3011, GNorm = 0.7690, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 110.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.69it/s]
Validation prc-auc = 0.292169
 50% 15/30 [00:01<00:01,  8.31it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 113.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.67it/s]
Validation prc-auc = 0.292169
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0584e-02, PNorm = 69.3011, GNorm = 0.8399, lr_0 = 1.0000e-04
Loss = 1.6924e-01, PNorm = 69.3011, GNorm = 1.0681, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 86.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.94it/s]
Validation prc-auc = 0.292169
 57% 17/30 [00:01<00:01,  9.73it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.90it/s]
Validation prc-auc = 0.296282
Epoch 18

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 116.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.64it/s]
Validation prc-auc = 0.296282
 63% 19/30 [00:01<00:01, 10.70it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0307e-02, PNorm = 69.3011, GNorm = 0.9799, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 99.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 187.70it/s]
Validation prc-auc = 0.296282
Epoch 20

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 68.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 127.07it/s]
Validation prc-auc = 0.296282
 70% 21/30 [00:02<00:00, 11.37it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0367e-02, PNorm = 69.3011, GNorm = 0.6315, lr_0 = 1.0000e-04
Loss = 1.3456e-01, PNorm = 69.3011, GNorm = 1.4472, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 77.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.07it/s]
Validation prc-auc = 0.297983
Epoch 22

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 107.44it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.17it/s]
Validation prc-auc = 0.297983
 77% 23/30 [00:02<00:00, 11.32it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 61.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 114.81it/s]
Validation prc-auc = 0.297983
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0988e-02, PNorm = 69.3011, GNorm = 0.5930, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 72.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 136.56it/s]
Validation prc-auc = 0.297983
 83% 25/30 [00:02<00:00, 11.21it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 85.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.56it/s]
Validation prc-auc = 0.297983
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9803e-02, PNorm = 69.3011, GNorm = 0.5978, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 93.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 180.95it/s]
Validation prc-auc = 0.297983
 90% 27/30 [00:02<00:00, 12.07it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 107.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 197.22it/s]
Validation prc-auc = 0.297983
Epoch 28

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 112.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.21it/s]
Validation prc-auc = 0.302348
 97% 29/30 [00:02<00:00, 12.35it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9790e-02, PNorm = 69.3012, GNorm = 0.6183, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 109.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.34it/s]
Validation prc-auc = 0.306599
100% 30/30 [00:02<00:00, 10.49it/s]
Model 0 best validation prc-auc = 0.306599 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 145.68it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:243: RuntimeWarning: Mean of empty slice
  avg_test_score = np.nanmean(test_scores)
Model 0 test prc-auc = nan
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:267: RuntimeWarning: Mean of empty slice
  avg_ensemble_test_score = np.nanmean(ensemble_scores)
Ensemble test prc-auc = nan
Fold 4
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1738019 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1738019_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1738019_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp5yrkpgs7/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1738019'],
 'task_names': ['CHEMBL1738019'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 132,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]524it [00:00, 5235.36it/s]1317it [00:00, 5828.25it/s]2276it [00:00, 6604.52it/s]3226it [00:00, 7268.61it/s]4177it [00:00, 7820.29it/s]5128it [00:00, 8258.75it/s]6086it [00:00, 8613.29it/s]7043it [00:00, 8877.43it/s]7998it [00:00, 9068.28it/s]8949it [00:01, 9195.76it/s]9936it [00:01, 9386.13it/s]11011it [00:01, 9755.17it/s]12088it [00:01, 10038.30it/s]13149it [00:01, 10200.77it/s]14223it [00:01, 10355.92it/s]15304it [00:01, 10485.45it/s]16384it [00:01, 10576.57it/s]17462it [00:01, 10635.75it/s]18538it [00:01, 10671.43it/s]19611it [00:02, 10687.87it/s]20686it [00:02, 10703.99it/s]21759it [00:02, 10710.72it/s]22831it [00:02, 10694.90it/s]23904it [00:02, 10704.10it/s]24980it [00:02, 10718.31it/s]26052it [00:02, 10689.00it/s]27123it [00:02, 10694.71it/s]28198it [00:02, 10709.22it/s]29270it [00:02, 10711.25it/s]30342it [00:03, 10706.78it/s]31413it [00:03, 10685.85it/s]32489it [00:03, 10705.27it/s]33560it [00:03, 10703.29it/s]34635it [00:03, 10714.67it/s]35707it [00:03, 10700.99it/s]36778it [00:03, 10686.28it/s]37847it [00:03, 10660.67it/s]38914it [00:03, 10641.77it/s]39979it [00:03, 10623.33it/s]41043it [00:04, 10627.64it/s]42106it [00:04, 10626.20it/s]43169it [00:04, 10605.85it/s]44241it [00:04, 10636.71it/s]45314it [00:04, 10664.33it/s]46386it [00:04, 10680.13it/s]47455it [00:04, 10640.34it/s]48520it [00:04, 10604.49it/s]49586it [00:04, 10619.43it/s]50657it [00:04, 10644.96it/s]51725it [00:05, 10653.25it/s]52794it [00:05, 10661.17it/s]53861it [00:05, 10619.78it/s]54924it [00:05, 10589.73it/s]55984it [00:05, 10570.35it/s]57045it [00:05, 10579.55it/s]58111it [00:05, 10601.70it/s]59177it [00:05, 10616.59it/s]60244it [00:05, 10629.89it/s]61313it [00:05, 10647.62it/s]61865it [00:05, 10368.58it/s]
Number of examples remaining: 165
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 551882.11it/s]
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5580.01it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/165 [00:00<?, ?it/s]100% 165/165 [00:00<00:00, 5373.05it/s]
Total scaffolds = 117 | train scaffolds = 91 | val scaffolds = 14 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.88888889]), array([9])), (array([0.61538462]), array([13])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([3])), (array([1.]), array([1]))]
Class sizes
CHEMBL1738019 0: 24.85%, 1: 75.15%
Total size = 165 | train size = 132 | val size = 16 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 85.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.05it/s]
Validation prc-auc = 0.641333
  3% 1/30 [00:00<00:02,  9.73it/s]Epoch 1

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 131.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 203.90it/s]
Validation prc-auc = 0.656485
Epoch 2

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1449e-02, PNorm = 69.3011, GNorm = 0.9633, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 85.90it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 142.06it/s]
Validation prc-auc = 0.652237
 10% 3/30 [00:00<00:02, 10.51it/s]Epoch 3

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 94.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.68it/s]
Validation prc-auc = 0.643146
Epoch 4

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1434e-02, PNorm = 69.3011, GNorm = 0.6927, lr_0 = 1.0000e-04
Loss = 1.6337e-01, PNorm = 69.3011, GNorm = 3.0103, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 100.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 183.18it/s]
Validation prc-auc = 0.643146
 17% 5/30 [00:00<00:02, 11.67it/s]Epoch 5

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 117.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.49it/s]
Validation prc-auc = 0.643146
Epoch 6

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.92it/s]
Validation prc-auc = 0.643146
 23% 7/30 [00:00<00:01, 13.09it/s]Epoch 7

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0999e-02, PNorm = 69.3011, GNorm = 0.8601, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.15it/s]
Validation prc-auc = 0.643146
Epoch 8

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 115.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.17it/s]
Validation prc-auc = 0.574964
 30% 9/30 [00:00<00:01, 14.32it/s]Epoch 9

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0756e-02, PNorm = 69.3011, GNorm = 0.7648, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 114.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.33it/s]
Validation prc-auc = 0.570552
Epoch 10

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 118.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.77it/s]
Validation prc-auc = 0.570552
 37% 11/30 [00:00<00:01, 15.41it/s]Epoch 11

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 118.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 193.10it/s]
Validation prc-auc = 0.582661
Epoch 12

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.1098e-02, PNorm = 69.3011, GNorm = 0.6520, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 115.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.23it/s]
Validation prc-auc = 0.578083
 43% 13/30 [00:00<00:01, 16.27it/s]Epoch 13

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 118.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.41it/s]
Validation prc-auc = 0.572800
Epoch 14

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0325e-02, PNorm = 69.3011, GNorm = 0.6739, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 116.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 193.28it/s]
Validation prc-auc = 0.573341
 50% 15/30 [00:00<00:00, 16.79it/s]Epoch 15

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 117.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.73it/s]
Validation prc-auc = 0.573341
Epoch 16

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0128e-02, PNorm = 69.3011, GNorm = 0.8753, lr_0 = 1.0000e-04
Loss = 1.7572e-01, PNorm = 69.3011, GNorm = 0.9392, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 92.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 194.00it/s]
Validation prc-auc = 0.578083
 57% 17/30 [00:01<00:00, 16.62it/s]Epoch 17

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 123.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 194.69it/s]
Validation prc-auc = 0.582661
Epoch 18

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 120.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.68it/s]
Validation prc-auc = 0.576739
 63% 19/30 [00:01<00:00, 17.37it/s]Epoch 19

  0% 0/5 [00:00<?, ?it/s][ALoss = 2.0033e-02, PNorm = 69.3011, GNorm = 0.5921, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 111.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.87it/s]
Validation prc-auc = 0.576739
Epoch 20

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 111.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 171.86it/s]
Validation prc-auc = 0.570552
 70% 21/30 [00:01<00:00, 17.50it/s]Epoch 21

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9871e-02, PNorm = 69.3011, GNorm = 0.6727, lr_0 = 1.0000e-04
Loss = 1.5861e-01, PNorm = 69.3011, GNorm = 0.9887, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 102.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.15it/s]
Validation prc-auc = 0.570552
Epoch 22

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 107.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 173.33it/s]
Validation prc-auc = 0.570552
 77% 23/30 [00:01<00:00, 17.20it/s]Epoch 23

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 106.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.33it/s]
Validation prc-auc = 0.574964
Epoch 24

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9767e-02, PNorm = 69.3012, GNorm = 0.6276, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 104.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.37it/s]
Validation prc-auc = 0.574964
 83% 25/30 [00:01<00:00, 17.08it/s]Epoch 25

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 106.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 173.63it/s]
Validation prc-auc = 0.574964
Epoch 26

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9578e-02, PNorm = 69.3012, GNorm = 0.6639, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 103.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.38it/s]
Validation prc-auc = 0.574964
 90% 27/30 [00:01<00:00, 16.97it/s]Epoch 27

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 105.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.41it/s]
Validation prc-auc = 0.574964
Epoch 28

  0% 0/5 [00:00<?, ?it/s][A100% 5/5 [00:00<00:00, 104.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 173.59it/s]
Validation prc-auc = 0.574964
 97% 29/30 [00:01<00:00, 16.71it/s]Epoch 29

  0% 0/5 [00:00<?, ?it/s][ALoss = 1.9708e-02, PNorm = 69.3012, GNorm = 0.6453, lr_0 = 1.0000e-04
100% 5/5 [00:00<00:00, 101.96it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.54it/s]
Validation prc-auc = 0.568561
100% 30/30 [00:01<00:00, 16.57it/s]
Model 0 best validation prc-auc = 0.656485 on epoch 1
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 174.99it/s]
Model 0 test prc-auc = 0.668454
Ensemble test prc-auc = 0.668454
5-fold cross validation
Seed 0 ==> test prc-auc = 0.913003
Seed 1 ==> test prc-auc = 0.765379
Seed 2 ==> test prc-auc = 0.693952
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/finetune_cross_validate.py:45: RuntimeWarning: Mean of empty slice
  info(f'Seed {init_seed + fold_num} ==> test {args.metric} = {np.nanmean(scores):.6f}')
Seed 3 ==> test prc-auc = nan
Seed 4 ==> test prc-auc = 0.668454
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/finetune_cross_validate.py:52: RuntimeWarning: Mean of empty slice
  avg_scores = np.nanmean(all_scores, axis=1)  # average score for each model across tasks
Overall test prc-auc = 0.760197 +/- 0.095108
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/utils.py:38: RuntimeWarning: Mean of empty slice
  avg_scores = np.nanmean(all_scores, axis=1)

wandb: Waiting for W&B process to finish, PID 30572
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                     validation_prc-auc 0.568560669128851
wandb:                                               _runtime 49.8087112903595
wandb:                                             _timestamp 1596913549.0469363
wandb:                                                  _step 154
wandb:                                           test_prc-auc 0.6684536256227434
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL1738019_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/27z898fx
