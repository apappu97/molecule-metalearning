wandb: Currently logged in as: apappu97 (use `wandb login --relogin` to force relogin)
wandb: Tracking run with wandb version 0.10.1
wandb: Run data is saved locally in wandb/run-20200917_125649-1m2igl10
wandb: Syncing run finetuning_finetuning_on_CHEMBL1794358_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/1m2igl10
wandb: Run `wandb off` to turn off syncing.
Fold 0
Command line
python chemprop/finetune.py --seeds 1 4 5 6 12 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmp6szwlej1/fold_0',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': [1, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]926it [00:00, 9256.41it/s]1826it [00:00, 9177.13it/s]2746it [00:00, 9183.70it/s]3672it [00:00, 9206.19it/s]4580it [00:00, 9167.28it/s]5498it [00:00, 9169.24it/s]6433it [00:00, 9221.23it/s]7376it [00:00, 9282.33it/s]8310it [00:00, 9297.41it/s]9251it [00:01, 9330.73it/s]10181it [00:01, 9319.83it/s]11110it [00:01, 9310.25it/s]12047it [00:01, 9326.28it/s]12973it [00:01, 9305.08it/s]13911it [00:01, 9324.78it/s]14840it [00:01, 9306.81it/s]15768it [00:01, 9295.26it/s]16705it [00:01, 9316.52it/s]17648it [00:01, 9349.01it/s]18582it [00:02, 9115.29it/s]19499it [00:02, 9131.55it/s]20433it [00:02, 9191.76it/s]21365it [00:02, 9228.60it/s]22305it [00:02, 9276.80it/s]23233it [00:02, 9031.63it/s]24167it [00:02, 9119.70it/s]25109it [00:02, 9206.14it/s]26057it [00:02, 9284.11it/s]26999it [00:02, 9322.76it/s]27932it [00:03, 9251.48it/s]28867it [00:03, 9279.81it/s]29816it [00:03, 9339.50it/s]30751it [00:03, 9099.24it/s]31690it [00:03, 9183.13it/s]32642it [00:03, 9279.78it/s]33580it [00:03, 9306.99it/s]34514it [00:03, 9315.90it/s]35465it [00:03, 9371.71it/s]36421it [00:03, 9425.06it/s]37380it [00:04, 9473.70it/s]38328it [00:04, 9453.80it/s]39285it [00:04, 9488.20it/s]40243it [00:04, 9515.13it/s]41202it [00:04, 9537.40it/s]42166it [00:04, 9565.86it/s]43123it [00:04, 9504.34it/s]44074it [00:04, 9462.44it/s]45023it [00:04, 9468.56it/s]45983it [00:04, 9506.64it/s]46934it [00:05, 9488.00it/s]47883it [00:05, 9417.33it/s]48825it [00:05, 9313.33it/s]49768it [00:05, 9345.49it/s]50703it [00:05, 9268.47it/s]51634it [00:05, 9280.06it/s]52563it [00:05, 9269.76it/s]53491it [00:05, 9267.42it/s]54418it [00:05, 9260.86it/s]55345it [00:05, 9162.80it/s]56262it [00:06, 9145.72it/s]57178it [00:06, 9148.03it/s]58095it [00:06, 9154.42it/s]59044it [00:06, 9249.77it/s]59992it [00:06, 9317.07it/s]60946it [00:06, 9379.84it/s]61865it [00:06, 9303.39it/s]
Number of examples remaining: 222
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 65361.19it/s]
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 3122.46it/s]
Number of tasks = 1
Splitting data with seed 1
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 2792.18it/s]
Total scaffolds = 182 | train scaffolds = 154 | val scaffolds = 8 | test scaffolds = 20
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|‚ñà‚ñã        | 1/6 [00:00<00:00,  5.01it/s][A
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 3/6 [00:00<00:00,  6.45it/s][A
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00,  8.24it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 13.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 12.85it/s]
Validation prc-auc = 0.225431
  3%|‚ñé         | 1/30 [00:00<00:16,  1.80it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1094e-02, PNorm = 69.3011, GNorm = 1.2014, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.88it/s]
Validation prc-auc = 0.225431
Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 79.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.63it/s]
Validation prc-auc = 0.225431
 10%|‚ñà         | 3/30 [00:00<00:11,  2.40it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0639e-02, PNorm = 69.3011, GNorm = 1.1934, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 34.89it/s]
Validation prc-auc = 0.229522
 13%|‚ñà‚ñé        | 4/30 [00:00<00:09,  2.80it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 79.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.53it/s]
Validation prc-auc = 0.234909
 17%|‚ñà‚ñã        | 5/30 [00:01<00:07,  3.44it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9806e-02, PNorm = 69.3011, GNorm = 1.2162, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.49it/s]
Validation prc-auc = 0.241831
 20%|‚ñà‚ñà        | 6/30 [00:01<00:05,  4.08it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 79.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.56it/s]
Validation prc-auc = 0.241831
Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9725e-02, PNorm = 69.3011, GNorm = 1.1803, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.80it/s]
Validation prc-auc = 0.238622
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:01<00:04,  5.00it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.01it/s]
Validation prc-auc = 0.238622
Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8207e-02, PNorm = 69.3011, GNorm = 1.2816, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.87it/s]
Validation prc-auc = 0.235558
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:01<00:03,  5.92it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8623e-02, PNorm = 69.3011, GNorm = 1.0785, lr_0 = 1.0000e-04
Loss = 3.4278e-02, PNorm = 69.3011, GNorm = 1.7678, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 75.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 58.04it/s]
Validation prc-auc = 0.237290
Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.99it/s]
Validation prc-auc = 0.235235
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:01<00:02,  6.78it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7824e-02, PNorm = 69.3011, GNorm = 1.1750, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.57it/s]
Validation prc-auc = 0.235235
Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.38it/s]
Validation prc-auc = 0.237691
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:02<00:02,  7.49it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7397e-02, PNorm = 69.3012, GNorm = 1.0622, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.41it/s]
Validation prc-auc = 0.237691
Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 81.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 61.16it/s]
Validation prc-auc = 0.237691
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:02<00:01,  8.20it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7226e-02, PNorm = 69.3012, GNorm = 1.0128, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.95it/s]
Validation prc-auc = 0.238683
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:02<00:01,  8.59it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.94it/s]
Validation prc-auc = 0.238683
Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5760e-02, PNorm = 69.3012, GNorm = 1.0904, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.70it/s]
Validation prc-auc = 0.238764
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:02<00:01,  9.08it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6283e-02, PNorm = 69.3013, GNorm = 1.0367, lr_0 = 1.0000e-04
Loss = 3.4283e-02, PNorm = 69.3013, GNorm = 0.7589, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.69it/s]
Validation prc-auc = 0.242131
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:02<00:01,  8.42it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.54it/s]
Validation prc-auc = 0.243832
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:02<00:01,  8.09it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5884e-02, PNorm = 69.3013, GNorm = 0.9318, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 58.92it/s]
Validation prc-auc = 0.243832
Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 79.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.40it/s]
Validation prc-auc = 0.243832
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:02<00:00,  8.67it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5216e-02, PNorm = 69.3013, GNorm = 0.9173, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 60.57it/s]
Validation prc-auc = 0.243832
Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 61.01it/s]
Validation prc-auc = 0.243832
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:03<00:00,  9.15it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4969e-02, PNorm = 69.3014, GNorm = 0.9498, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.33it/s]
Validation prc-auc = 0.246213
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:03<00:00,  8.45it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 5/6 [00:00<00:00, 38.36it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 43.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.66it/s]
Validation prc-auc = 0.249135
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:03<00:00,  7.02it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5156e-02, PNorm = 69.3014, GNorm = 0.9018, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.56it/s]
Validation prc-auc = 0.246497
Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5804e-02, PNorm = 69.3015, GNorm = 0.8488, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 58.41it/s]
Validation prc-auc = 0.246497
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:03<00:00,  7.77it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 59.56it/s]
Validation prc-auc = 0.246497
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:03<00:00,  7.93it/s]
Model 0 best validation prc-auc = 0.249135 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 29.93it/s]
Model 0 test prc-auc = 0.195455
Ensemble test prc-auc = 0.195455
Fold 1
Command line
python chemprop/finetune.py --seeds 1 4 5 6 12 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmp6szwlej1/fold_1',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [1, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]919it [00:00, 9179.74it/s]1669it [00:00, 8599.61it/s]2592it [00:00, 8778.12it/s]3526it [00:00, 8937.80it/s]4429it [00:00, 8962.43it/s]5368it [00:00, 9083.67it/s]6305it [00:00, 9164.95it/s]7225it [00:00, 9174.15it/s]8154it [00:00, 9207.19it/s]9083it [00:01, 9231.11it/s]10021it [00:01, 9268.57it/s]10960it [00:01, 9303.72it/s]11879it [00:01, 9153.19it/s]12816it [00:01, 9216.28it/s]13749it [00:01, 9247.96it/s]14681it [00:01, 9269.28it/s]15606it [00:01, 9162.88it/s]16521it [00:01, 9054.90it/s]17464it [00:01, 9163.91it/s]18412it [00:02, 9253.84it/s]19338it [00:02, 9172.04it/s]20294it [00:02, 9284.98it/s]21223it [00:02, 9258.16it/s]22168it [00:02, 9314.84it/s]23108it [00:02, 9340.07it/s]24057it [00:02, 9382.39it/s]24996it [00:02, 9335.00it/s]25930it [00:02, 9325.28it/s]26879it [00:02, 9371.36it/s]27817it [00:03, 9280.24it/s]28746it [00:03, 9216.57it/s]29678it [00:03, 9246.00it/s]30617it [00:03, 9288.63it/s]31563it [00:03, 9336.84it/s]32513it [00:03, 9383.62it/s]33453it [00:03, 9387.52it/s]34400it [00:03, 9410.28it/s]35342it [00:03, 9345.04it/s]36282it [00:03, 9358.57it/s]37220it [00:04, 9364.73it/s]38157it [00:04, 9329.33it/s]39091it [00:04, 9196.58it/s]40012it [00:04, 9037.77it/s]40917it [00:04, 9040.69it/s]41860it [00:04, 9151.77it/s]42793it [00:04, 9204.40it/s]43726it [00:04, 9240.90it/s]44651it [00:04, 9176.20it/s]45594it [00:04, 9248.93it/s]46540it [00:05, 9310.37it/s]47472it [00:05, 9246.42it/s]48398it [00:05, 9179.41it/s]49317it [00:05, 9179.31it/s]50236it [00:05, 9179.04it/s]51169it [00:05, 9222.80it/s]52092it [00:05, 9187.31it/s]53020it [00:05, 9214.53it/s]53942it [00:05, 9186.56it/s]54863it [00:05, 9190.83it/s]55783it [00:06, 9127.71it/s]56696it [00:06, 9109.90it/s]57639it [00:06, 9202.18it/s]58573it [00:06, 9241.66it/s]59517it [00:06, 9299.36it/s]60459it [00:06, 9332.57it/s]61399it [00:06, 9351.19it/s]61865it [00:06, 9228.51it/s]
Number of examples remaining: 222
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 68728.63it/s]
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 3435.80it/s]
Number of tasks = 1
Splitting data with seed 4
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 2774.65it/s]
Total scaffolds = 182 | train scaffolds = 143 | val scaffolds = 20 | test scaffolds = 19
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([2]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 117.82it/s]
Warning: Found a task with targets all 0s or all 1s
/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1488e-02, PNorm = 69.3011, GNorm = 1.1100, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 61.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.45it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7%|‚ñã         | 2/30 [00:00<00:02,  9.73it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 117.43it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0961e-02, PNorm = 69.3011, GNorm = 1.1337, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13%|‚ñà‚ñé        | 4/30 [00:00<00:02,  9.94it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.54it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0847e-02, PNorm = 69.3011, GNorm = 1.4831, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.29it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20%|‚ñà‚ñà        | 6/30 [00:00<00:02, 10.05it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 118.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0022e-02, PNorm = 69.3011, GNorm = 1.0925, lr_0 = 1.0000e-04

100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 58.51it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 58.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:02,  9.92it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9070e-02, PNorm = 69.3011, GNorm = 1.2838, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 10.11it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8975e-02, PNorm = 69.3011, GNorm = 1.1672, lr_0 = 1.0000e-04
Loss = 3.2964e-02, PNorm = 69.3011, GNorm = 1.2693, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 61.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.20it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:01<00:01,  9.84it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.54it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8500e-02, PNorm = 69.3011, GNorm = 1.1846, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:01,  9.96it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.70it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8113e-02, PNorm = 69.3012, GNorm = 0.9952, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 118.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01, 10.11it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 73.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 123.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7615e-02, PNorm = 69.3012, GNorm = 0.9959, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:01, 10.25it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 73.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 124.02it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7385e-02, PNorm = 69.3012, GNorm = 1.0114, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.46it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:01, 10.35it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7122e-02, PNorm = 69.3012, GNorm = 0.9331, lr_0 = 1.0000e-04
Loss = 2.9898e-02, PNorm = 69.3013, GNorm = 1.1777, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:02<00:00, 10.40it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6307e-02, PNorm = 69.3013, GNorm = 1.0618, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 73.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.61it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 23/30 [00:02<00:00, 10.45it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7065e-02, PNorm = 69.3013, GNorm = 1.0173, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 107.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 118.61it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:02<00:00, 10.47it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6475e-02, PNorm = 69.3014, GNorm = 0.8466, lr_0 = 1.0000e-04

 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 3/6 [00:00<00:00, 22.77it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 34.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.91it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.60it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:02<00:00,  9.23it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4388e-02, PNorm = 69.3014, GNorm = 0.9899, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.35it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6796e-02, PNorm = 69.3014, GNorm = 0.6838, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:02<00:00,  9.56it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 10.03it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 107.18it/s]
Model 0 test prc-auc = 1.000000
Ensemble test prc-auc = 1.000000
Fold 2
Command line
python chemprop/finetune.py --seeds 1 4 5 6 12 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmp6szwlej1/fold_2',
 'save_smiles_splits': False,
 'seed': 5,
 'seeds': [1, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]864it [00:00, 8632.39it/s]1733it [00:00, 8648.05it/s]2612it [00:00, 8688.95it/s]3515it [00:00, 8787.29it/s]4414it [00:00, 8845.19it/s]5306it [00:00, 8864.97it/s]6204it [00:00, 8898.42it/s]7099it [00:00, 8911.57it/s]7992it [00:00, 8916.85it/s]8852it [00:01, 8819.22it/s]9735it [00:01, 8822.18it/s]10601it [00:01, 8698.76it/s]11502it [00:01, 8788.54it/s]12374it [00:01, 8584.37it/s]13260it [00:01, 8665.23it/s]14130it [00:01, 8675.40it/s]15002it [00:01, 8688.13it/s]15886it [00:01, 8732.43it/s]16759it [00:01, 8701.90it/s]17641it [00:02, 8736.32it/s]18533it [00:02, 8789.28it/s]19412it [00:02, 8744.99it/s]20288it [00:02, 8749.43it/s]21163it [00:02, 8714.55it/s]22058it [00:02, 8781.89it/s]22954it [00:02, 8834.20it/s]23838it [00:02, 8782.85it/s]24734it [00:02, 8834.74it/s]25630it [00:02, 8871.26it/s]26524it [00:03, 8891.07it/s]27414it [00:03, 8858.35it/s]28307it [00:03, 8877.14it/s]29195it [00:03, 8871.12it/s]30083it [00:03, 8858.11it/s]30969it [00:03, 8813.67it/s]31851it [00:03, 8782.17it/s]32730it [00:03, 8693.58it/s]33629it [00:03, 8780.40it/s]34521it [00:03, 8820.29it/s]35404it [00:04, 8793.06it/s]36299it [00:04, 8839.28it/s]37184it [00:04, 8806.16it/s]38080it [00:04, 8851.41it/s]38975it [00:04, 8878.70it/s]39865it [00:04, 8882.18it/s]40765it [00:04, 8914.65it/s]41657it [00:04, 8837.52it/s]42541it [00:04, 8799.61it/s]43438it [00:04, 8847.45it/s]44337it [00:05, 8888.03it/s]45238it [00:05, 8923.14it/s]46131it [00:05, 8894.32it/s]47028it [00:05, 8916.85it/s]47920it [00:05, 8916.18it/s]48817it [00:05, 8931.78it/s]49711it [00:05, 8933.67it/s]50605it [00:05, 8812.46it/s]51499it [00:05, 8849.62it/s]52392it [00:05, 8871.94it/s]53282it [00:06, 8879.07it/s]54171it [00:06, 8825.44it/s]55054it [00:06, 8710.00it/s]55926it [00:06, 8569.77it/s]56784it [00:06, 8568.97it/s]57642it [00:06, 8548.95it/s]58513it [00:06, 8595.51it/s]59393it [00:06, 8654.73it/s]60282it [00:06, 8723.24it/s]61155it [00:06, 8710.56it/s]61865it [00:07, 8790.85it/s]
Number of examples remaining: 222
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 69643.64it/s]
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 3464.84it/s]
Number of tasks = 1
Splitting data with seed 5
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 2772.19it/s]
Total scaffolds = 182 | train scaffolds = 150 | val scaffolds = 20 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 75.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.27it/s]
Warning: Found a task with targets all 0s or all 1s
/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1170e-02, PNorm = 69.3011, GNorm = 1.3648, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7%|‚ñã         | 2/30 [00:00<00:02, 11.17it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0409e-02, PNorm = 69.3011, GNorm = 1.1572, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 117.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13%|‚ñà‚ñé        | 4/30 [00:00<00:02, 11.25it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.89it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9936e-02, PNorm = 69.3011, GNorm = 1.3153, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.70it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20%|‚ñà‚ñà        | 6/30 [00:00<00:02, 11.19it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 79.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9660e-02, PNorm = 69.3011, GNorm = 1.1374, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:01, 11.29it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8553e-02, PNorm = 69.3011, GNorm = 1.2123, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.58it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:00<00:01, 11.35it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8605e-02, PNorm = 69.3011, GNorm = 1.1473, lr_0 = 1.0000e-04
Loss = 3.4281e-02, PNorm = 69.3011, GNorm = 1.0376, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.68it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 81.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:01<00:01, 11.39it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7982e-02, PNorm = 69.3011, GNorm = 1.1005, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.32it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:01<00:01, 11.47it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7776e-02, PNorm = 69.3012, GNorm = 1.0336, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.43it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.75it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:01<00:01, 11.51it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6860e-02, PNorm = 69.3012, GNorm = 1.0603, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 100.05it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.21it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:01, 11.45it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6331e-02, PNorm = 69.3012, GNorm = 1.0817, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6516e-02, PNorm = 69.3013, GNorm = 1.0257, lr_0 = 1.0000e-04
Loss = 3.0414e-02, PNorm = 69.3013, GNorm = 1.1107, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 75.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:01<00:00, 11.38it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 79.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 121.56it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5776e-02, PNorm = 69.3013, GNorm = 0.9868, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.86it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:01<00:00, 11.42it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.49it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6043e-02, PNorm = 69.3013, GNorm = 0.9186, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 77.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 118.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:02<00:00, 11.47it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 122.32it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5212e-02, PNorm = 69.3014, GNorm = 0.9986, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 120.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:02<00:00, 11.47it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 80.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4901e-02, PNorm = 69.3014, GNorm = 0.9409, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 119.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:02<00:00, 11.33it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6037e-02, PNorm = 69.3015, GNorm = 0.8849, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 76.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 78.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 118.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 11.33it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:02<00:00, 11.39it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 56.24it/s]
Model 0 test prc-auc = 0.259061
Ensemble test prc-auc = 0.259061
Fold 3
Command line
python chemprop/finetune.py --seeds 1 4 5 6 12 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmp6szwlej1/fold_3',
 'save_smiles_splits': False,
 'seed': 6,
 'seeds': [1, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]911it [00:00, 9106.90it/s]1825it [00:00, 9115.41it/s]2738it [00:00, 9118.66it/s]3603it [00:00, 8971.72it/s]4497it [00:00, 8960.22it/s]5416it [00:00, 9026.45it/s]6336it [00:00, 9075.44it/s]7229it [00:00, 9030.21it/s]8080it [00:00, 8853.78it/s]8957it [00:01, 8826.16it/s]9874it [00:01, 8924.70it/s]10792it [00:01, 8998.01it/s]11709it [00:01, 9046.15it/s]12614it [00:01, 9045.53it/s]13513it [00:01, 9020.77it/s]14412it [00:01, 9002.40it/s]15318it [00:01, 9019.18it/s]16218it [00:01, 8673.18it/s]17087it [00:01, 8258.05it/s]17930it [00:02, 8236.17it/s]18758it [00:02, 7040.95it/s]19622it [00:02, 7453.21it/s]20547it [00:02, 7912.94it/s]21453it [00:02, 8224.16it/s]22376it [00:02, 8500.90it/s]23297it [00:02, 8700.19it/s]24182it [00:02, 8630.62it/s]25072it [00:02, 8707.29it/s]25959it [00:02, 8752.70it/s]26853it [00:03, 8806.62it/s]27761it [00:03, 8885.83it/s]28653it [00:03, 8794.30it/s]29548it [00:03, 8839.77it/s]30434it [00:03, 8791.87it/s]31343it [00:03, 8878.28it/s]32255it [00:03, 8946.90it/s]33172it [00:03, 9012.51it/s]34081it [00:03, 9034.27it/s]34985it [00:04, 8954.48it/s]35899it [00:04, 9008.90it/s]36801it [00:04, 9001.48it/s]37703it [00:04, 9006.42it/s]38624it [00:04, 9066.53it/s]39531it [00:04, 9036.29it/s]40446it [00:04, 9068.06it/s]41360it [00:04, 9086.93it/s]42269it [00:04, 9068.39it/s]43176it [00:04, 8976.06it/s]44074it [00:05, 8798.71it/s]44955it [00:05, 8791.84it/s]45835it [00:05, 8729.09it/s]46710it [00:05, 8734.16it/s]47599it [00:05, 8778.62it/s]48478it [00:05, 8484.22it/s]49329it [00:05, 8468.10it/s]50218it [00:05, 8588.13it/s]51079it [00:05, 8584.77it/s]51939it [00:05, 8584.40it/s]52850it [00:06, 8734.59it/s]53740it [00:06, 8781.07it/s]54643it [00:06, 8853.12it/s]55537it [00:06, 8877.05it/s]56434it [00:06, 8903.51it/s]57327it [00:06, 8910.11it/s]58219it [00:06, 8751.59it/s]59122it [00:06, 8831.98it/s]60008it [00:06, 8840.32it/s]60915it [00:06, 8907.56it/s]61824it [00:07, 8959.75it/s]61865it [00:07, 8778.01it/s]
Number of examples remaining: 222
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 62030.21it/s]
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 3363.73it/s]
Number of tasks = 1
Splitting data with seed 6
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 2835.01it/s]
Total scaffolds = 182 | train scaffolds = 142 | val scaffolds = 20 | test scaffolds = 20
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.02it/s]
Warning: Found a task with targets all 0s or all 1s
/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1308e-02, PNorm = 69.3011, GNorm = 1.0514, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7%|‚ñã         | 2/30 [00:00<00:02, 10.35it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.92it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0522e-02, PNorm = 69.3011, GNorm = 1.3130, lr_0 = 1.0000e-04

 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 4/6 [00:00<00:00, 25.98it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 33.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13%|‚ñà‚ñé        | 4/30 [00:00<00:02,  9.03it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 106.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0424e-02, PNorm = 69.3011, GNorm = 1.0777, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20%|‚ñà‚ñà        | 6/30 [00:00<00:02,  9.35it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9381e-02, PNorm = 69.3011, GNorm = 1.1890, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27%|‚ñà‚ñà‚ñã       | 8/30 [00:00<00:02,  9.65it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.13it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9774e-02, PNorm = 69.3011, GNorm = 1.2115, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.55it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33%|‚ñà‚ñà‚ñà‚ñé      | 10/30 [00:01<00:02,  9.86it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8754e-02, PNorm = 69.3011, GNorm = 0.9572, lr_0 = 1.0000e-04
Loss = 3.6273e-02, PNorm = 69.3011, GNorm = 1.3032, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 108.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40%|‚ñà‚ñà‚ñà‚ñà      | 12/30 [00:01<00:01,  9.92it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8586e-02, PNorm = 69.3011, GNorm = 1.1427, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 104.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.55it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 14/30 [00:01<00:01, 10.05it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8025e-02, PNorm = 69.3012, GNorm = 1.1516, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.07it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 16/30 [00:01<00:01, 10.19it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7035e-02, PNorm = 69.3012, GNorm = 1.0498, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.59it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 18/30 [00:01<00:01, 10.26it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6994e-02, PNorm = 69.3012, GNorm = 0.8696, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6788e-02, PNorm = 69.3012, GNorm = 0.8643, lr_0 = 1.0000e-04
Loss = 3.3167e-02, PNorm = 69.3012, GNorm = 0.8946, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:02<00:00, 10.21it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.49it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6409e-02, PNorm = 69.3013, GNorm = 1.0119, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.81it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:02<00:00, 10.18it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.29it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6256e-02, PNorm = 69.3013, GNorm = 0.9956, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 106.77it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:02<00:00, 10.24it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4446e-02, PNorm = 69.3014, GNorm = 1.0275, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.48it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 26/30 [00:02<00:00, 10.21it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 105.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4703e-02, PNorm = 69.3014, GNorm = 0.9076, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 28/30 [00:02<00:00, 10.20it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6741e-02, PNorm = 69.3014, GNorm = 0.7112, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.85it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 112.35it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:03<00:00, 10.27it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:03<00:00,  9.97it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 107.74it/s]
Model 0 test prc-auc = 0.102705
Ensemble test prc-auc = 0.102705
Fold 4
Command line
python chemprop/finetune.py --seeds 1 4 5 6 12 --data_path /home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/azureuser/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/tmp6szwlej1/fold_4',
 'save_smiles_splits': False,
 'seed': 12,
 'seeds': [1, 4, 5, 6, 12],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]860it [00:00, 8599.74it/s]1710it [00:00, 8568.50it/s]2579it [00:00, 8602.16it/s]3452it [00:00, 8638.23it/s]4312it [00:00, 8625.97it/s]5183it [00:00, 8648.57it/s]6058it [00:00, 8677.63it/s]6942it [00:00, 8723.43it/s]7824it [00:00, 8750.56it/s]8665it [00:01, 8634.79it/s]9516it [00:01, 8594.14it/s]10405it [00:01, 8679.43it/s]11296it [00:01, 8746.93it/s]12199it [00:01, 8828.54it/s]13086it [00:01, 8838.47it/s]13967it [00:01, 8823.80it/s]14861it [00:01, 8857.39it/s]15756it [00:01, 8884.60it/s]16652it [00:01, 8904.52it/s]17542it [00:02, 8874.89it/s]18437it [00:02, 8896.02it/s]19328it [00:02, 8899.43it/s]20220it [00:02, 8902.72it/s]21111it [00:02, 8885.23it/s]22000it [00:02, 8886.15it/s]22889it [00:02, 8884.27it/s]23779it [00:02, 8887.64it/s]24668it [00:02, 8877.26it/s]25556it [00:02, 8836.32it/s]26440it [00:03, 8780.49it/s]27319it [00:03, 8778.84it/s]28202it [00:03, 8793.81it/s]29085it [00:03, 8795.47it/s]29970it [00:03, 8810.60it/s]30861it [00:03, 8838.10it/s]31755it [00:03, 8868.40it/s]32643it [00:03, 8871.22it/s]33533it [00:03, 8879.42it/s]34421it [00:03, 8855.65it/s]35309it [00:04, 8860.17it/s]36196it [00:04, 8859.98it/s]37088it [00:04, 8876.28it/s]37978it [00:04, 8880.72it/s]38867it [00:04, 8868.56it/s]39754it [00:04, 8859.82it/s]40640it [00:04, 8852.87it/s]41527it [00:04, 8856.62it/s]42413it [00:04, 8822.13it/s]43297it [00:04, 8824.78it/s]44180it [00:05, 8783.79it/s]45072it [00:05, 8823.96it/s]45963it [00:05, 8848.23it/s]46852it [00:05, 8860.07it/s]47739it [00:05, 8601.93it/s]48613it [00:05, 8641.92it/s]49505it [00:05, 8722.13it/s]50393it [00:05, 8766.38it/s]51278it [00:05, 8790.55it/s]52165it [00:05, 8811.66it/s]53047it [00:06, 8767.41it/s]53925it [00:06, 8697.16it/s]54796it [00:06, 8534.51it/s]55656it [00:06, 8552.73it/s]56532it [00:06, 8613.32it/s]57402it [00:06, 8638.49it/s]58297it [00:06, 8729.27it/s]59189it [00:06, 8784.90it/s]60084it [00:06, 8831.76it/s]60979it [00:06, 8866.43it/s]61865it [00:07, 8791.54it/s]
Number of examples remaining: 222
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 65963.13it/s]
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 3303.48it/s]
Number of tasks = 1
Splitting data with seed 12
  0%|          | 0/222 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 222/222 [00:00<00:00, 2853.58it/s]
Total scaffolds = 182 | train scaffolds = 145 | val scaffolds = 18 | test scaffolds = 19
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.63636364]), array([11])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/azureuser/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0%|          | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.91it/s]
Validation prc-auc = 1.000000
  3%|‚ñé         | 1/30 [00:00<00:04,  6.99it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1096e-02, PNorm = 69.3011, GNorm = 1.1801, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.26it/s]
Validation prc-auc = 1.000000
Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.82it/s]
Validation prc-auc = 1.000000
 10%|‚ñà         | 3/30 [00:00<00:03,  7.75it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0721e-02, PNorm = 69.3011, GNorm = 1.4734, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 103.77it/s]
Validation prc-auc = 1.000000
Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 3/6 [00:00<00:00, 24.24it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 36.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.45it/s]
Validation prc-auc = 1.000000
 17%|‚ñà‚ñã        | 5/30 [00:00<00:03,  7.60it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0095e-02, PNorm = 69.3011, GNorm = 1.0882, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.69it/s]
Validation prc-auc = 1.000000
Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 115.57it/s]
Validation prc-auc = 1.000000
 23%|‚ñà‚ñà‚ñé       | 7/30 [00:00<00:02,  8.25it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9947e-02, PNorm = 69.3011, GNorm = 1.0650, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.25it/s]
Validation prc-auc = 1.000000
Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.86it/s]
Validation prc-auc = 1.000000
 30%|‚ñà‚ñà‚ñà       | 9/30 [00:00<00:02,  8.79it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8336e-02, PNorm = 69.3011, GNorm = 1.3207, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.66it/s]
Validation prc-auc = 1.000000
Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8800e-02, PNorm = 69.3011, GNorm = 1.1788, lr_0 = 1.0000e-04
Loss = 3.6941e-02, PNorm = 69.3011, GNorm = 0.9553, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 66.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 116.42it/s]
Validation prc-auc = 1.000000
 37%|‚ñà‚ñà‚ñà‚ñã      | 11/30 [00:01<00:02,  9.13it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.66it/s]
Validation prc-auc = 1.000000
Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8663e-02, PNorm = 69.3011, GNorm = 0.9716, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.67it/s]
Validation prc-auc = 1.000000
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 13/30 [00:01<00:01,  9.49it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 116.44it/s]
Validation prc-auc = 1.000000
Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7727e-02, PNorm = 69.3012, GNorm = 1.0618, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 116.59it/s]
Validation prc-auc = 1.000000
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 15/30 [00:01<00:01,  9.73it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 72.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.76it/s]
Validation prc-auc = 1.000000
Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7813e-02, PNorm = 69.3012, GNorm = 0.8945, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.85it/s]
Validation prc-auc = 1.000000
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 17/30 [00:01<00:01,  9.92it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.00it/s]
Validation prc-auc = 1.000000
Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7613e-02, PNorm = 69.3012, GNorm = 0.9611, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 68.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 110.10it/s]
Validation prc-auc = 1.000000
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 19/30 [00:01<00:01, 10.01it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6898e-02, PNorm = 69.3012, GNorm = 1.0381, lr_0 = 1.0000e-04
Loss = 3.0620e-02, PNorm = 69.3013, GNorm = 1.0554, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 67.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.78it/s]
Validation prc-auc = 1.000000
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 20/30 [00:02<00:01,  9.98it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 100.73it/s]
Validation prc-auc = 1.000000
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 21/30 [00:02<00:00,  9.95it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6311e-02, PNorm = 69.3013, GNorm = 1.0291, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 63.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.81it/s]
Validation prc-auc = 1.000000
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 22/30 [00:02<00:00,  9.74it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 116.13it/s]
Validation prc-auc = 1.000000
Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5659e-02, PNorm = 69.3013, GNorm = 1.0211, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 63.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.76it/s]
Validation prc-auc = 0.250000
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 24/30 [00:02<00:00,  9.78it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 66.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.97it/s]
Validation prc-auc = 0.250000
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 25/30 [00:02<00:00,  9.80it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6409e-02, PNorm = 69.3014, GNorm = 0.9846, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 116.20it/s]
Validation prc-auc = 0.250000
Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 100.79it/s]
Validation prc-auc = 0.250000
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 27/30 [00:02<00:00,  9.95it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4340e-02, PNorm = 69.3014, GNorm = 0.9903, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 69.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 114.83it/s]
Validation prc-auc = 0.250000
Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7071e-02, PNorm = 69.3015, GNorm = 0.6641, lr_0 = 1.0000e-04
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 70.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 113.09it/s]
Validation prc-auc = 0.250000
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 29/30 [00:02<00:00, 10.04it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6/6 [00:00<00:00, 71.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 111.12it/s]
Validation prc-auc = 0.250000
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 30/30 [00:03<00:00,  9.78it/s]
Model 0 best validation prc-auc = 1.000000 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00<00:00, 107.98it/s]
Model 0 test prc-auc = 0.167484
Ensemble test prc-auc = 0.167484
5-fold cross validation
Seed 0 ==> test prc-auc = 0.195455
Seed 1 ==> test prc-auc = 1.000000
Seed 2 ==> test prc-auc = 0.259061
Seed 3 ==> test prc-auc = 0.102705
Seed 4 ==> test prc-auc = 0.167484
Overall test prc-auc = 0.344941 +/- 0.331359
wandb: Waiting for W&B process to finish, PID 14608
wandb: Program ended successfully.
wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.11MB of 0.11MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Find user logs for this run at: wandb/run-20200917_125649-1m2igl10/logs/debug.log
wandb: Find internal logs for this run at: wandb/run-20200917_125649-1m2igl10/logs/debug-internal.log
wandb: Run summary:
wandb:   validation_prc-auc 0.25
wandb:                _step 154
wandb:             _runtime 54
wandb:           _timestamp 1600347464
wandb:         test_prc-auc 0.16748366013071897
wandb: Run history:
wandb:   validation_prc-auc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÅ‚ñÅ
wandb:                _step ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:             _runtime ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:           _timestamp ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:         test_prc-auc ‚ñÇ‚ñà‚ñÇ‚ñÅ‚ñÇ
wandb: Synced 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: 
wandb: Synced finetuning_finetuning_on_CHEMBL1794358_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/1m2igl10

