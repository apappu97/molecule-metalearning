wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200808_202815-28637ow2
wandb: Syncing run finetuning_finetuning_on_CHEMBL2114797_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/28637ow2
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL2114797 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL2114797_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL2114797_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp8krhugqn/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL2114797'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]514it [00:00, 5138.99it/s]1165it [00:00, 5482.09it/s]1707it [00:00, 5462.36it/s]2526it [00:00, 6068.68it/s]3530it [00:00, 6884.87it/s]4372it [00:00, 7279.36it/s]5084it [00:00, 6887.46it/s]5991it [00:00, 7422.63it/s]6982it [00:00, 8026.40it/s]7932it [00:01, 8417.80it/s]8938it [00:01, 8849.91it/s]9956it [00:01, 9209.77it/s]10977it [00:01, 9488.63it/s]12002it [00:01, 9702.35it/s]13023it [00:01, 9848.63it/s]14120it [00:01, 10157.98it/s]15242it [00:01, 10454.57it/s]16350it [00:01, 10633.99it/s]17472it [00:01, 10801.55it/s]18601it [00:02, 10943.46it/s]19729it [00:02, 11039.53it/s]20836it [00:02, 11025.05it/s]21958it [00:02, 11082.27it/s]23068it [00:02, 11080.80it/s]24203it [00:02, 11159.27it/s]25320it [00:02, 10949.86it/s]26417it [00:02, 10769.13it/s]27518it [00:02, 10839.60it/s]28663it [00:02, 11012.91it/s]29810it [00:03, 11145.33it/s]30943it [00:03, 11198.52it/s]32065it [00:03, 11204.83it/s]33187it [00:03, 11190.51it/s]34320it [00:03, 11229.94it/s]35444it [00:03, 11226.95it/s]36567it [00:03, 11170.21it/s]37694it [00:03, 11198.63it/s]38824it [00:03, 11227.51it/s]39948it [00:03, 11228.33it/s]41071it [00:04, 11222.76it/s]42194it [00:04, 10969.29it/s]43293it [00:04, 10579.68it/s]44381it [00:04, 10665.36it/s]45485it [00:04, 10773.20it/s]46607it [00:04, 10903.16it/s]47731it [00:04, 11000.79it/s]48865it [00:04, 11099.91it/s]49992it [00:04, 11150.32it/s]51116it [00:04, 11176.38it/s]52236it [00:05, 11181.30it/s]53355it [00:05, 11150.41it/s]54471it [00:05, 11129.44it/s]55585it [00:05, 11108.75it/s]56701it [00:05, 11123.51it/s]57831it [00:05, 11173.74it/s]58961it [00:05, 11209.40it/s]60093it [00:05, 11240.58it/s]61226it [00:05, 11265.67it/s]61865it [00:05, 10460.80it/s]
Number of examples remaining: 224
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 45378.87it/s]
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5888.96it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 4976.00it/s]
Total scaffolds = 139 | train scaffolds = 105 | val scaffolds = 19 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.31578947]), array([19])), (array([0.4]), array([30])), (array([1.]), array([2])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([1.]), array([2])), (array([0.66666667]), array([3])), (array([1.]), array([1]))]
Class sizes
CHEMBL2114797 0: 42.41%, 1: 57.59%
Total size = 224 | train size = 179 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A
 17% 1/6 [00:00<00:01,  4.68it/s][A
 67% 4/6 [00:00<00:00,  6.17it/s][A100% 6/6 [00:00<00:00, 14.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 32.69it/s]
Validation prc-auc = 0.494807
  3% 1/30 [00:00<00:13,  2.09it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1938e-02, PNorm = 69.3011, GNorm = 0.7104, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 55.75it/s]
Validation prc-auc = 0.499302
  7% 2/30 [00:00<00:10,  2.61it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 72.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 113.70it/s]
Validation prc-auc = 0.504030
 10% 3/30 [00:00<00:08,  3.23it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1332e-02, PNorm = 69.3011, GNorm = 0.8101, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.19it/s]
Validation prc-auc = 0.504030
Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 100.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.43it/s]
Validation prc-auc = 0.506567
 17% 5/30 [00:00<00:06,  4.10it/s]Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1572e-02, PNorm = 69.3011, GNorm = 0.8792, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.48it/s]
Validation prc-auc = 0.508952
 20% 6/30 [00:01<00:04,  4.90it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.96it/s]
Validation prc-auc = 0.515363
 23% 7/30 [00:01<00:04,  5.69it/s]Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.2371e-02, PNorm = 69.3011, GNorm = 0.7957, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 133.36it/s]
Validation prc-auc = 0.520036
 27% 8/30 [00:01<00:03,  6.38it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A
 83% 5/6 [00:00<00:00, 32.93it/s][ALoss = 2.2639e-02, PNorm = 69.3011, GNorm = 0.7027, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 37.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 133.93it/s]
Validation prc-auc = 0.531743
 30% 9/30 [00:01<00:03,  5.78it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.39it/s]
Validation prc-auc = 0.531743
Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1050e-02, PNorm = 69.3011, GNorm = 0.7178, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.15it/s]
Validation prc-auc = 0.533330
 37% 11/30 [00:01<00:02,  6.71it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.97it/s]
Validation prc-auc = 0.545691
 40% 12/30 [00:01<00:02,  7.43it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1122e-02, PNorm = 69.3011, GNorm = 0.6743, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 110.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.69it/s]
Validation prc-auc = 0.545691
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 113.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.07it/s]
Validation prc-auc = 0.545691
 47% 14/30 [00:01<00:01,  8.78it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0153e-02, PNorm = 69.3011, GNorm = 0.7586, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.03it/s]
Validation prc-auc = 0.545691
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 114.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.84it/s]
Validation prc-auc = 0.545691
 53% 16/30 [00:02<00:01,  9.94it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0990e-02, PNorm = 69.3011, GNorm = 0.6761, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.04it/s]
Validation prc-auc = 0.551247
Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0466e-02, PNorm = 69.3011, GNorm = 0.5669, lr_0 = 1.0000e-04
Loss = 3.6005e-02, PNorm = 69.3011, GNorm = 1.1433, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 113.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.94it/s]
Validation prc-auc = 0.554377
 60% 18/30 [00:02<00:01,  9.90it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 110.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.62it/s]
Validation prc-auc = 0.561520
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0061e-02, PNorm = 69.3011, GNorm = 0.8655, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.78it/s]
Validation prc-auc = 0.561520
 67% 20/30 [00:02<00:00, 10.35it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.90it/s]
Validation prc-auc = 0.569522
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0660e-02, PNorm = 69.3011, GNorm = 0.7227, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.67it/s]
Validation prc-auc = 0.569522
 73% 22/30 [00:02<00:00, 10.66it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.73it/s]
Validation prc-auc = 0.569522
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9389e-02, PNorm = 69.3012, GNorm = 0.8594, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.40it/s]
Validation prc-auc = 0.569522
 80% 24/30 [00:02<00:00, 11.71it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.48it/s]
Validation prc-auc = 0.576565
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9490e-02, PNorm = 69.3012, GNorm = 0.8500, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.51it/s]
Validation prc-auc = 0.618232
 87% 26/30 [00:02<00:00, 10.96it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9661e-02, PNorm = 69.3012, GNorm = 0.6280, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 103.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 143.72it/s]
Validation prc-auc = 0.621161
Epoch 27

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.72it/s]
Validation prc-auc = 0.621161
 93% 28/30 [00:03<00:00, 11.12it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9993e-02, PNorm = 69.3012, GNorm = 0.9344, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 93.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.00it/s]
Validation prc-auc = 0.621161
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 116.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.83it/s]
Validation prc-auc = 0.621161
100% 30/30 [00:03<00:00, 11.94it/s]100% 30/30 [00:03<00:00,  9.19it/s]
Model 0 best validation prc-auc = 0.621161 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 35.12it/s]
Model 0 test prc-auc = 0.818136
Ensemble test prc-auc = 0.818136
Fold 1
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL2114797 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL2114797_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL2114797_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp8krhugqn/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL2114797'],
 'task_names': ['CHEMBL2114797'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 179,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]507it [00:00, 5063.03it/s]1284it [00:00, 5652.74it/s]2271it [00:00, 6483.40it/s]3110it [00:00, 6956.06it/s]3735it [00:00, 6482.29it/s]4583it [00:00, 6973.26it/s]5557it [00:00, 7622.35it/s]6566it [00:00, 8225.70it/s]7569it [00:00, 8692.71it/s]8573it [00:01, 9055.74it/s]9574it [00:01, 9320.94it/s]10588it [00:01, 9551.35it/s]11605it [00:01, 9727.48it/s]12628it [00:01, 9871.13it/s]13742it [00:01, 10220.24it/s]14862it [00:01, 10494.00it/s]15989it [00:01, 10713.92it/s]17105it [00:01, 10842.92it/s]18194it [00:01, 10688.51it/s]19267it [00:02, 10502.99it/s]20321it [00:02, 10451.56it/s]21423it [00:02, 10613.67it/s]22537it [00:02, 10765.16it/s]23662it [00:02, 10905.10it/s]24773it [00:02, 10965.18it/s]25896it [00:02, 11043.25it/s]27020it [00:02, 11100.86it/s]28145it [00:02, 11142.73it/s]29272it [00:02, 11179.19it/s]30398it [00:03, 11202.49it/s]31519it [00:03, 11197.11it/s]32641it [00:03, 11202.86it/s]33762it [00:03, 11204.81it/s]34883it [00:03, 11172.46it/s]36001it [00:03, 11135.75it/s]37115it [00:03, 11116.90it/s]38227it [00:03, 11113.94it/s]39347it [00:03, 11139.58it/s]40462it [00:03, 11138.38it/s]41576it [00:04, 11130.18it/s]42690it [00:04, 11127.35it/s]43803it [00:04, 11117.58it/s]44918it [00:04, 11125.70it/s]46031it [00:04, 11034.84it/s]47135it [00:04, 10812.50it/s]48218it [00:04, 10687.60it/s]49328it [00:04, 10805.77it/s]50430it [00:04, 10869.03it/s]51534it [00:04, 10918.89it/s]52627it [00:05, 10916.48it/s]53720it [00:05, 10915.12it/s]54812it [00:05, 10897.16it/s]55908it [00:05, 10913.51it/s]57006it [00:05, 10931.75it/s]58111it [00:05, 10964.27it/s]59216it [00:05, 10989.34it/s]60327it [00:05, 11023.65it/s]61438it [00:05, 11048.58it/s]61865it [00:05, 10513.08it/s]
Number of examples remaining: 224
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 89478.49it/s]
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5889.18it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 4992.69it/s]
Total scaffolds = 139 | train scaffolds = 103 | val scaffolds = 20 | test scaffolds = 16
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4]), array([30])), (array([0.31578947]), array([19])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.5]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL2114797 0: 42.41%, 1: 57.59%
Total size = 224 | train size = 179 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 132.93it/s]
Validation prc-auc = 0.520199
  3% 1/30 [00:00<00:03,  9.25it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1528e-02, PNorm = 69.3011, GNorm = 0.6838, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 111.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 141.10it/s]
Validation prc-auc = 0.536866
  7% 2/30 [00:00<00:02,  9.38it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 75.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 96.94it/s]
Validation prc-auc = 0.536866
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1091e-02, PNorm = 69.3011, GNorm = 0.7761, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 87.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 118.59it/s]
Validation prc-auc = 0.539395
 13% 4/30 [00:00<00:02,  9.35it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.09it/s]
Validation prc-auc = 0.539395
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1406e-02, PNorm = 69.3011, GNorm = 0.5645, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 110.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.99it/s]
Validation prc-auc = 0.541889
 20% 6/30 [00:00<00:02,  9.99it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.01it/s]
Validation prc-auc = 0.541889
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1443e-02, PNorm = 69.3011, GNorm = 0.7911, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.22it/s]
Validation prc-auc = 0.544101
 27% 8/30 [00:00<00:02, 10.46it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.2810e-02, PNorm = 69.3011, GNorm = 0.8780, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.46it/s]
Validation prc-auc = 0.552858
 30% 9/30 [00:00<00:02, 10.08it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 137.89it/s]
Validation prc-auc = 0.562041
 33% 10/30 [00:00<00:02,  9.94it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1031e-02, PNorm = 69.3011, GNorm = 0.6903, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.10it/s]
Validation prc-auc = 0.562041
Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 110.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 139.13it/s]
Validation prc-auc = 0.564837
 40% 12/30 [00:01<00:01, 10.42it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1246e-02, PNorm = 69.3011, GNorm = 0.7956, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.20it/s]
Validation prc-auc = 0.564837
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 137.89it/s]
Validation prc-auc = 0.564837
 47% 14/30 [00:01<00:01, 11.22it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0801e-02, PNorm = 69.3011, GNorm = 0.9676, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.44it/s]
Validation prc-auc = 0.564837
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 114.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.90it/s]
Validation prc-auc = 0.564837
 53% 16/30 [00:01<00:01, 11.95it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0125e-02, PNorm = 69.3011, GNorm = 0.7962, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 138.30it/s]
Validation prc-auc = 0.571248
Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0579e-02, PNorm = 69.3011, GNorm = 0.7227, lr_0 = 1.0000e-04
Loss = 3.2073e-02, PNorm = 69.3011, GNorm = 1.1795, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.70it/s]
Validation prc-auc = 0.571248
 60% 18/30 [00:01<00:01, 11.91it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 124.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.52it/s]
Validation prc-auc = 0.576680
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0146e-02, PNorm = 69.3011, GNorm = 0.5444, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 123.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.42it/s]
Validation prc-auc = 0.569171
 67% 20/30 [00:01<00:00, 12.21it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 127.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.02it/s]
Validation prc-auc = 0.571576
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0258e-02, PNorm = 69.3012, GNorm = 0.7169, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 125.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.36it/s]
Validation prc-auc = 0.576811
 73% 22/30 [00:01<00:00, 12.49it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 123.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.75it/s]
Validation prc-auc = 0.592363
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9732e-02, PNorm = 69.3012, GNorm = 0.7390, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 120.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.88it/s]
Validation prc-auc = 0.600533
 80% 24/30 [00:02<00:00, 11.85it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 120.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.80it/s]
Validation prc-auc = 0.600533
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0732e-02, PNorm = 69.3012, GNorm = 0.6145, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 121.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.79it/s]
Validation prc-auc = 0.603597
 87% 26/30 [00:02<00:00, 11.93it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9842e-02, PNorm = 69.3012, GNorm = 0.6974, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 120.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.96it/s]
Validation prc-auc = 0.607330
Epoch 27

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 121.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.14it/s]
Validation prc-auc = 0.619510
 93% 28/30 [00:02<00:00, 11.49it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9659e-02, PNorm = 69.3012, GNorm = 0.6919, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.46it/s]
Validation prc-auc = 0.619510
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 125.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 151.47it/s]
Validation prc-auc = 0.619510
100% 30/30 [00:02<00:00, 12.46it/s]100% 30/30 [00:02<00:00, 11.62it/s]
Model 0 best validation prc-auc = 0.619510 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 155.92it/s]
Model 0 test prc-auc = 0.721627
Ensemble test prc-auc = 0.721627
Fold 2
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL2114797 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL2114797_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL2114797_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp8krhugqn/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL2114797'],
 'task_names': ['CHEMBL2114797'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 179,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]627it [00:00, 6268.12it/s]1508it [00:00, 6861.49it/s]2500it [00:00, 7559.64it/s]3474it [00:00, 8102.34it/s]4462it [00:00, 8564.24it/s]5465it [00:00, 8955.35it/s]6469it [00:00, 9253.95it/s]7446it [00:00, 9402.82it/s]8427it [00:00, 9519.67it/s]9434it [00:01, 9676.61it/s]10539it [00:01, 10049.04it/s]11646it [00:01, 10334.72it/s]12744it [00:01, 10518.90it/s]13842it [00:01, 10651.82it/s]14941it [00:01, 10749.15it/s]16055it [00:01, 10860.99it/s]17171it [00:01, 10946.60it/s]18283it [00:01, 10997.03it/s]19395it [00:01, 11033.57it/s]20508it [00:02, 11061.14it/s]21628it [00:02, 11100.80it/s]22740it [00:02, 11105.02it/s]23851it [00:02, 11079.92it/s]24965it [00:02, 11095.87it/s]26076it [00:02, 11099.71it/s]27187it [00:02, 11101.71it/s]28311it [00:02, 11142.34it/s]29436it [00:02, 11171.50it/s]30554it [00:02, 11171.31it/s]31672it [00:03, 11118.39it/s]32798it [00:03, 11158.68it/s]33923it [00:03, 11184.64it/s]35042it [00:03, 11183.87it/s]36163it [00:03, 11190.99it/s]37283it [00:03, 11121.00it/s]38396it [00:03, 11111.11it/s]39525it [00:03, 11161.37it/s]40648it [00:03, 11180.88it/s]41769it [00:03, 11186.94it/s]42896it [00:04, 11209.28it/s]44023it [00:04, 11226.60it/s]45152it [00:04, 11244.40it/s]46277it [00:04, 11244.49it/s]47402it [00:04, 11235.20it/s]48531it [00:04, 11250.53it/s]49657it [00:04, 11238.36it/s]50781it [00:04, 11238.64it/s]51905it [00:04, 11119.48it/s]53018it [00:04, 11120.07it/s]54131it [00:05, 11099.97it/s]55242it [00:05, 11026.31it/s]56348it [00:05, 11034.09it/s]57466it [00:05, 11076.08it/s]58591it [00:05, 11124.98it/s]59720it [00:05, 11171.30it/s]60844it [00:05, 11189.74it/s]61865it [00:05, 10843.31it/s]
Number of examples remaining: 224
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 89012.23it/s]
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 6060.55it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5089.73it/s]
Total scaffolds = 139 | train scaffolds = 107 | val scaffolds = 17 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4]), array([30])), (array([0.31578947]), array([19])), (array([1.]), array([1])), (array([1.]), array([2])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL2114797 0: 42.41%, 1: 57.59%
Total size = 224 | train size = 179 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.53it/s]
Validation prc-auc = 0.436084
  3% 1/30 [00:00<00:02,  9.99it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1683e-02, PNorm = 69.3011, GNorm = 1.0295, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 122.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.23it/s]
Validation prc-auc = 0.436084
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 116.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.34it/s]
Validation prc-auc = 0.443383
 10% 3/30 [00:00<00:02, 10.66it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1380e-02, PNorm = 69.3011, GNorm = 1.0178, lr_0 = 1.0000e-04

 67% 4/6 [00:00<00:00, 24.78it/s][A100% 6/6 [00:00<00:00, 33.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.80it/s]
Validation prc-auc = 0.444715
 13% 4/30 [00:00<00:03,  7.44it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.45it/s]
Validation prc-auc = 0.448195
 17% 5/30 [00:00<00:03,  8.00it/s]Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1722e-02, PNorm = 69.3011, GNorm = 0.8503, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.87it/s]
Validation prc-auc = 0.457332
 20% 6/30 [00:00<00:02,  8.24it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.46it/s]
Validation prc-auc = 0.457332
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1958e-02, PNorm = 69.3011, GNorm = 0.8490, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.90it/s]
Validation prc-auc = 0.467045
 27% 8/30 [00:00<00:02,  9.05it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.2631e-02, PNorm = 69.3011, GNorm = 1.0518, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.47it/s]
Validation prc-auc = 0.484794
 30% 9/30 [00:00<00:02,  9.22it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.48it/s]
Validation prc-auc = 0.491197
 33% 10/30 [00:01<00:02,  9.22it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1051e-02, PNorm = 69.3011, GNorm = 0.9317, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.65it/s]
Validation prc-auc = 0.498773
 37% 11/30 [00:01<00:02,  9.34it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.77it/s]
Validation prc-auc = 0.511780
 40% 12/30 [00:01<00:01,  9.52it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1461e-02, PNorm = 69.3011, GNorm = 0.7516, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 116.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 171.52it/s]
Validation prc-auc = 0.511780
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 121.96it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 172.72it/s]
Validation prc-auc = 0.529052
 47% 14/30 [00:01<00:01, 10.30it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1365e-02, PNorm = 69.3011, GNorm = 0.8388, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 101.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.95it/s]
Validation prc-auc = 0.529052
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 125.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 169.14it/s]
Validation prc-auc = 0.529052
 53% 16/30 [00:01<00:01, 11.45it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1011e-02, PNorm = 69.3011, GNorm = 0.7074, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 118.17it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 168.55it/s]
Validation prc-auc = 0.531718
Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0644e-02, PNorm = 69.3011, GNorm = 0.9474, lr_0 = 1.0000e-04
Loss = 3.2991e-02, PNorm = 69.3011, GNorm = 0.9155, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 112.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.41it/s]
Validation prc-auc = 0.556541
 60% 18/30 [00:01<00:01, 11.04it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.53it/s]
Validation prc-auc = 0.559489
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0381e-02, PNorm = 69.3011, GNorm = 0.9997, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.46it/s]
Validation prc-auc = 0.556053
 67% 20/30 [00:01<00:00, 11.18it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.45it/s]
Validation prc-auc = 0.570447
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0637e-02, PNorm = 69.3011, GNorm = 0.7798, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.36it/s]
Validation prc-auc = 0.573883
 73% 22/30 [00:02<00:00, 10.66it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 129.29it/s]
Validation prc-auc = 0.637297
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0435e-02, PNorm = 69.3012, GNorm = 1.0195, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 153.70it/s]
Validation prc-auc = 0.637297
 80% 24/30 [00:02<00:00, 10.59it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.50it/s]
Validation prc-auc = 0.637297
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0349e-02, PNorm = 69.3012, GNorm = 0.7974, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.51it/s]
Validation prc-auc = 0.637297
 87% 26/30 [00:02<00:00, 11.51it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0026e-02, PNorm = 69.3012, GNorm = 0.5562, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.08it/s]
Validation prc-auc = 0.633165
Epoch 27

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.02it/s]
Validation prc-auc = 0.633165
 93% 28/30 [00:02<00:00, 12.28it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9484e-02, PNorm = 69.3012, GNorm = 0.8748, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.54it/s]
Validation prc-auc = 0.671044
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 120.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 166.20it/s]
Validation prc-auc = 0.671044
100% 30/30 [00:02<00:00, 11.84it/s]100% 30/30 [00:02<00:00, 10.70it/s]
Model 0 best validation prc-auc = 0.671044 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 102.21it/s]
Model 0 test prc-auc = 0.831960
Ensemble test prc-auc = 0.831960
Fold 3
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL2114797 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL2114797_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL2114797_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp8krhugqn/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL2114797'],
 'task_names': ['CHEMBL2114797'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 179,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]504it [00:00, 5039.99it/s]1261it [00:00, 5600.92it/s]2204it [00:00, 6377.04it/s]3153it [00:00, 7072.43it/s]4099it [00:00, 7650.21it/s]5048it [00:00, 8121.60it/s]5993it [00:00, 8478.62it/s]6941it [00:00, 8753.46it/s]7888it [00:00, 8954.31it/s]8834it [00:01, 9100.11it/s]9830it [00:01, 9340.34it/s]10895it [00:01, 9695.92it/s]11963it [00:01, 9969.89it/s]13033it [00:01, 10175.84it/s]14103it [00:01, 10325.14it/s]15168it [00:01, 10419.60it/s]16236it [00:01, 10493.54it/s]17297it [00:01, 10527.73it/s]18366it [00:01, 10574.85it/s]19435it [00:02, 10607.01it/s]20500it [00:02, 10619.82it/s]21565it [00:02, 10627.51it/s]22629it [00:02, 10623.82it/s]23698it [00:02, 10642.18it/s]24769it [00:02, 10662.42it/s]25837it [00:02, 10666.37it/s]26910it [00:02, 10683.05it/s]27987it [00:02, 10706.31it/s]29065it [00:02, 10726.23it/s]30143it [00:03, 10741.26it/s]31218it [00:03, 10739.86it/s]32293it [00:03, 10716.14it/s]33365it [00:03, 10710.33it/s]34437it [00:03, 10698.02it/s]35507it [00:03, 10675.17it/s]36575it [00:03, 10611.90it/s]37641it [00:03, 10625.42it/s]38710it [00:03, 10642.19it/s]39784it [00:03, 10668.62it/s]40851it [00:04, 10661.87it/s]41918it [00:04, 10639.21it/s]42982it [00:04, 10626.05it/s]44047it [00:04, 10630.96it/s]45116it [00:04, 10646.09it/s]46184it [00:04, 10654.20it/s]47250it [00:04, 10651.22it/s]48316it [00:04, 10648.11it/s]49381it [00:04, 10643.90it/s]50448it [00:04, 10649.72it/s]51513it [00:05, 10633.54it/s]52577it [00:05, 10615.50it/s]53639it [00:05, 10571.39it/s]54697it [00:05, 10527.87it/s]55750it [00:05, 10507.44it/s]56801it [00:05, 10507.98it/s]57869it [00:05, 10556.58it/s]58940it [00:05, 10601.72it/s]60011it [00:05, 10633.81it/s]61084it [00:05, 10661.25it/s]61865it [00:05, 10333.97it/s]
Number of examples remaining: 224
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 70386.88it/s]
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5922.66it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5032.62it/s]
Total scaffolds = 139 | train scaffolds = 105 | val scaffolds = 16 | test scaffolds = 18
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4]), array([30])), (array([0.31578947]), array([19])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.75]), array([4])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL2114797 0: 42.41%, 1: 57.59%
Total size = 224 | train size = 179 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 96.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.11it/s]
Validation prc-auc = 0.764665
  3% 1/30 [00:00<00:03,  9.21it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1608e-02, PNorm = 69.3011, GNorm = 0.7373, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.66it/s]
Validation prc-auc = 0.766548
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 82.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 127.07it/s]
Validation prc-auc = 0.766548
 10% 3/30 [00:00<00:02,  9.62it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1556e-02, PNorm = 69.3011, GNorm = 0.7024, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.83it/s]
Validation prc-auc = 0.770202
 13% 4/30 [00:00<00:02,  9.36it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.80it/s]
Validation prc-auc = 0.784907
 17% 5/30 [00:00<00:02,  9.33it/s]Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1176e-02, PNorm = 69.3011, GNorm = 1.2086, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.45it/s]
Validation prc-auc = 0.787656
 20% 6/30 [00:00<00:02,  9.40it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 106.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.13it/s]
Validation prc-auc = 0.787656
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0975e-02, PNorm = 69.3011, GNorm = 0.6210, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.13it/s]
Validation prc-auc = 0.807544
 27% 8/30 [00:00<00:02,  9.99it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.2528e-02, PNorm = 69.3011, GNorm = 0.8084, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.94it/s]
Validation prc-auc = 0.828382
 30% 9/30 [00:00<00:02,  9.86it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.15it/s]
Validation prc-auc = 0.828382
Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1356e-02, PNorm = 69.3011, GNorm = 0.9644, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.05it/s]
Validation prc-auc = 0.837195
 37% 11/30 [00:01<00:01, 10.23it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.36it/s]
Validation prc-auc = 0.848631
 40% 12/30 [00:01<00:01, 10.01it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1246e-02, PNorm = 69.3011, GNorm = 0.8573, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.38it/s]
Validation prc-auc = 0.848631
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.67it/s]
Validation prc-auc = 0.848631
 47% 14/30 [00:01<00:01, 11.08it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0277e-02, PNorm = 69.3011, GNorm = 0.9019, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 93.90it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.82it/s]
Validation prc-auc = 0.848631
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 114.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.93it/s]
Validation prc-auc = 0.856652
 53% 16/30 [00:01<00:01, 11.15it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9363e-02, PNorm = 69.3011, GNorm = 0.9369, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.17it/s]
Validation prc-auc = 0.856652
Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0662e-02, PNorm = 69.3011, GNorm = 0.8816, lr_0 = 1.0000e-04
Loss = 3.4665e-02, PNorm = 69.3011, GNorm = 0.8306, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.40it/s]
Validation prc-auc = 0.856652
 60% 18/30 [00:01<00:01, 11.85it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.66it/s]
Validation prc-auc = 0.856652
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0753e-02, PNorm = 69.3011, GNorm = 0.9623, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.66it/s]
Validation prc-auc = 0.856652
 67% 20/30 [00:01<00:00, 12.54it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 110.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.19it/s]
Validation prc-auc = 0.875411
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0110e-02, PNorm = 69.3011, GNorm = 0.6220, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.75it/s]
Validation prc-auc = 0.875411
 73% 22/30 [00:01<00:00, 12.22it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.46it/s]
Validation prc-auc = 0.883289
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0797e-02, PNorm = 69.3011, GNorm = 0.6922, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.74it/s]
Validation prc-auc = 0.883289
 80% 24/30 [00:02<00:00, 12.00it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.71it/s]
Validation prc-auc = 0.883289
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9470e-02, PNorm = 69.3012, GNorm = 0.6908, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.44it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.00it/s]
Validation prc-auc = 0.892687
 87% 26/30 [00:02<00:00, 11.83it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0323e-02, PNorm = 69.3012, GNorm = 0.7683, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.73it/s]
Validation prc-auc = 0.892687
Epoch 27

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 109.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.57it/s]
Validation prc-auc = 0.889024
 93% 28/30 [00:02<00:00, 12.47it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9889e-02, PNorm = 69.3012, GNorm = 0.6797, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.97it/s]
Validation prc-auc = 0.889024
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 116.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.72it/s]
Validation prc-auc = 0.898245
100% 30/30 [00:02<00:00, 11.96it/s]100% 30/30 [00:02<00:00, 11.46it/s]
Model 0 best validation prc-auc = 0.898245 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 157.88it/s]
Model 0 test prc-auc = 0.792043
Ensemble test prc-auc = 0.792043
Fold 4
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL2114797 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL2114797_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL2114797_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmp8krhugqn/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL2114797'],
 'task_names': ['CHEMBL2114797'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 179,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]616it [00:00, 6158.71it/s]1487it [00:00, 6751.90it/s]2555it [00:00, 7589.00it/s]3626it [00:00, 8315.04it/s]4701it [00:00, 8921.09it/s]5774it [00:00, 9395.64it/s]6856it [00:00, 9779.73it/s]7943it [00:00, 10081.61it/s]9023it [00:00, 10285.11it/s]10103it [00:01, 10434.07it/s]11190it [00:01, 10559.67it/s]12276it [00:01, 10647.61it/s]13358it [00:01, 10697.63it/s]14444it [00:01, 10744.65it/s]15529it [00:01, 10773.84it/s]16606it [00:01, 10622.68it/s]17701it [00:01, 10717.35it/s]18793it [00:01, 10776.01it/s]19884it [00:01, 10814.73it/s]20976it [00:02, 10844.65it/s]22070it [00:02, 10871.79it/s]23158it [00:02, 10871.64it/s]24254it [00:02, 10897.84it/s]25350it [00:02, 10915.29it/s]26443it [00:02, 10917.88it/s]27542it [00:02, 10937.22it/s]28639it [00:02, 10945.84it/s]29737it [00:02, 10954.15it/s]30833it [00:02, 10951.55it/s]31929it [00:03, 10947.78it/s]33024it [00:03, 10946.64it/s]34119it [00:03, 10923.19it/s]35212it [00:03, 10881.28it/s]36305it [00:03, 10894.25it/s]37395it [00:03, 10797.08it/s]38475it [00:03, 10783.61it/s]39569it [00:03, 10828.51it/s]40658it [00:03, 10844.71it/s]41747it [00:03, 10857.41it/s]42841it [00:04, 10880.84it/s]43932it [00:04, 10887.84it/s]45025it [00:04, 10899.56it/s]46115it [00:04, 10896.79it/s]47205it [00:04, 10895.81it/s]48296it [00:04, 10899.85it/s]49386it [00:04, 10898.99it/s]50476it [00:04, 10883.01it/s]51565it [00:04, 10850.27it/s]52651it [00:04, 10831.63it/s]53735it [00:05, 10802.65it/s]54816it [00:05, 10781.63it/s]55895it [00:05, 10767.48it/s]56979it [00:05, 10786.84it/s]58067it [00:05, 10812.99it/s]59149it [00:05, 10788.87it/s]60228it [00:05, 10768.55it/s]61305it [00:05, 10757.27it/s]61865it [00:05, 10719.92it/s]
Number of examples remaining: 224
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 82334.95it/s]
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5899.09it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/224 [00:00<?, ?it/s]100% 224/224 [00:00<00:00, 5092.00it/s]
Total scaffolds = 139 | train scaffolds = 103 | val scaffolds = 17 | test scaffolds = 19
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4]), array([30])), (array([0.31578947]), array([19])), (array([0.75]), array([4])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1]))]
Class sizes
CHEMBL2114797 0: 42.41%, 1: 57.59%
Total size = 224 | train size = 179 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 88.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 176.25it/s]
Validation prc-auc = 0.630946
  3% 1/30 [00:00<00:03,  8.72it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1591e-02, PNorm = 69.3011, GNorm = 0.9126, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 120.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 182.09it/s]
Validation prc-auc = 0.630946
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 117.22it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 169.75it/s]
Validation prc-auc = 0.634181
 10% 3/30 [00:00<00:02,  9.60it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1246e-02, PNorm = 69.3011, GNorm = 0.9188, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.56it/s]
Validation prc-auc = 0.646184
 13% 4/30 [00:00<00:02,  9.58it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 106.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.32it/s]
Validation prc-auc = 0.646184
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1113e-02, PNorm = 69.3011, GNorm = 0.8326, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.75it/s]
Validation prc-auc = 0.696184
 20% 6/30 [00:00<00:02, 10.08it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.43it/s]
Validation prc-auc = 0.709134
 23% 7/30 [00:00<00:02,  9.90it/s]Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1322e-02, PNorm = 69.3011, GNorm = 0.8239, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.18it/s]
Validation prc-auc = 0.709134
Epoch 8

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.2973e-02, PNorm = 69.3011, GNorm = 1.1539, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.46it/s]
Validation prc-auc = 0.739062
 30% 9/30 [00:00<00:02, 10.33it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.01it/s]
Validation prc-auc = 0.736810
Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0944e-02, PNorm = 69.3011, GNorm = 0.8724, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.12it/s]
Validation prc-auc = 0.736810
 37% 11/30 [00:00<00:01, 11.33it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.90it/s]
Validation prc-auc = 0.771255
Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1028e-02, PNorm = 69.3011, GNorm = 0.6658, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.90it/s]
Validation prc-auc = 0.771255
 43% 13/30 [00:01<00:01, 11.36it/s]Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.79it/s]
Validation prc-auc = 0.771255
Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0564e-02, PNorm = 69.3011, GNorm = 0.6966, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.83it/s]
Validation prc-auc = 0.779664
 50% 15/30 [00:01<00:01, 11.22it/s]Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 120.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 178.44it/s]
Validation prc-auc = 0.779664
Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9344e-02, PNorm = 69.3011, GNorm = 0.9442, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 119.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 181.80it/s]
Validation prc-auc = 0.792574
 57% 17/30 [00:01<00:01, 11.57it/s]Epoch 17

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0696e-02, PNorm = 69.3011, GNorm = 0.7256, lr_0 = 1.0000e-04
Loss = 3.5427e-02, PNorm = 69.3011, GNorm = 0.8732, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 85.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 135.94it/s]
Validation prc-auc = 0.794405
Epoch 18

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.42it/s]
Validation prc-auc = 0.806628
 63% 19/30 [00:01<00:01, 10.44it/s]Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0232e-02, PNorm = 69.3011, GNorm = 0.6777, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.54it/s]
Validation prc-auc = 0.819943
Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 106.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.84it/s]
Validation prc-auc = 0.819943
 70% 21/30 [00:01<00:00, 10.67it/s]Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0258e-02, PNorm = 69.3011, GNorm = 0.6249, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 105.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.44it/s]
Validation prc-auc = 0.824505
Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.49it/s]
Validation prc-auc = 0.829522
 77% 23/30 [00:02<00:00,  9.64it/s]Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0333e-02, PNorm = 69.3012, GNorm = 0.7937, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 75.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 134.26it/s]
Validation prc-auc = 0.829522
Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 158.83it/s]
Validation prc-auc = 0.829522
 83% 25/30 [00:02<00:00, 10.18it/s]Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0435e-02, PNorm = 69.3012, GNorm = 0.6894, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 106.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 164.44it/s]
Validation prc-auc = 0.829522
Epoch 26

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9949e-02, PNorm = 69.3012, GNorm = 0.8116, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.02it/s]
Validation prc-auc = 0.829522
 90% 27/30 [00:02<00:00, 11.04it/s]Epoch 27

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 106.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 163.39it/s]
Validation prc-auc = 0.829522
Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0052e-02, PNorm = 69.3012, GNorm = 0.7221, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.06it/s]
Validation prc-auc = 0.833465
 97% 29/30 [00:02<00:00, 10.94it/s]Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 162.41it/s]
Validation prc-auc = 0.839525
100% 30/30 [00:02<00:00, 10.87it/s]
Model 0 best validation prc-auc = 0.839525 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 140.58it/s]
Model 0 test prc-auc = 0.872951
Ensemble test prc-auc = 0.872951
5-fold cross validation
Seed 0 ==> test prc-auc = 0.818136
Seed 1 ==> test prc-auc = 0.721627
Seed 2 ==> test prc-auc = 0.831960
Seed 3 ==> test prc-auc = 0.792043
Seed 4 ==> test prc-auc = 0.872951
Overall test prc-auc = 0.807343 +/- 0.050216

wandb: Waiting for W&B process to finish, PID 2317
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                             _timestamp 1596914945.415731
wandb:                                     validation_prc-auc 0.8395245911925477
wandb:                                               _runtime 50.68028926849365
wandb:                                                  _step 154
wandb:                                           test_prc-auc 0.8729512517018967
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb: \ 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL2114797_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/28637ow2
