wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200808_202244-8kpw1qw0
wandb: Syncing run finetuning_finetuning_on_CHEMBL1963741_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/8kpw1qw0
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963741 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1963741_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1963741_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpkx7_lrnv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963741'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]994it [00:00, 9934.94it/s]2001it [00:00, 9973.09it/s]2986it [00:00, 9933.47it/s]3989it [00:00, 9961.02it/s]4993it [00:00, 9984.18it/s]6009it [00:00, 10033.57it/s]7074it [00:00, 10208.32it/s]8183it [00:00, 10456.01it/s]9304it [00:00, 10670.73it/s]10433it [00:01, 10848.68it/s]11557it [00:01, 10961.40it/s]12674it [00:01, 11020.91it/s]13764it [00:01, 10971.07it/s]14879it [00:01, 11023.49it/s]15999it [00:01, 11074.80it/s]17119it [00:01, 11109.65it/s]18247it [00:01, 11157.81it/s]19362it [00:01, 11151.47it/s]20476it [00:01, 10699.30it/s]21549it [00:02, 10419.17it/s]22665it [00:02, 10628.92it/s]23778it [00:02, 10772.16it/s]24891it [00:02, 10875.62it/s]26002it [00:02, 10944.62it/s]27114it [00:02, 10993.82it/s]28228it [00:02, 11034.76it/s]29342it [00:02, 11066.11it/s]30455it [00:02, 11084.50it/s]31574it [00:02, 11113.48it/s]32700it [00:03, 11155.58it/s]33816it [00:03, 9704.59it/s] 34821it [00:03, 9049.26it/s]35832it [00:03, 9343.17it/s]36850it [00:03, 9578.45it/s]37867it [00:03, 9748.23it/s]38885it [00:03, 9873.36it/s]39904it [00:03, 9965.09it/s]40922it [00:03, 10028.51it/s]41942it [00:04, 10077.99it/s]43005it [00:04, 10235.31it/s]44128it [00:04, 10513.88it/s]45251it [00:04, 10717.35it/s]46375it [00:04, 10867.89it/s]47500it [00:04, 10978.13it/s]48621it [00:04, 11044.65it/s]49739it [00:04, 11082.24it/s]50864it [00:04, 11131.73it/s]51979it [00:04, 11075.61it/s]53088it [00:05, 11029.35it/s]54192it [00:05, 10563.57it/s]55253it [00:05, 10422.02it/s]56299it [00:05, 10421.07it/s]57384it [00:05, 10543.41it/s]58478it [00:05, 10658.84it/s]59586it [00:05, 10780.36it/s]60696it [00:05, 10872.17it/s]61806it [00:05, 10937.59it/s]61865it [00:05, 10604.73it/s]
Number of examples remaining: 919
  0% 0/919 [00:00<?, ?it/s]100% 919/919 [00:00<00:00, 66791.98it/s]
  0% 0/919 [00:00<?, ?it/s] 48% 438/919 [00:00<00:00, 4371.52it/s] 98% 901/919 [00:00<00:00, 4445.38it/s]100% 919/919 [00:00<00:00, 4498.59it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/919 [00:00<?, ?it/s] 45% 413/919 [00:00<00:00, 4121.58it/s] 92% 850/919 [00:00<00:00, 4190.87it/s]100% 919/919 [00:00<00:00, 4245.81it/s]
Total scaffolds = 546 | train scaffolds = 443 | val scaffolds = 45 | test scaffolds = 58
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1963741 0: 67.03%, 1: 32.97%
Total size = 919 | train size = 735 | val size = 91 | test size = 93
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/23 [00:00<?, ?it/s][A
  4% 1/23 [00:00<00:04,  5.23it/s][A
 17% 4/23 [00:00<00:02,  6.81it/s][A
 30% 7/23 [00:00<00:01,  8.61it/s][ALoss = 2.1910e-02, PNorm = 69.3011, GNorm = 0.5186, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:01,  9.38it/s][A
 57% 13/23 [00:00<00:00, 11.38it/s][A
 70% 16/23 [00:00<00:00, 13.43it/s][A
 83% 19/23 [00:01<00:00, 15.17it/s][ALoss = 2.1733e-02, PNorm = 69.3010, GNorm = 0.6233, lr_0 = 1.0000e-04

 96% 22/23 [00:01<00:00, 16.63it/s][A100% 23/23 [00:01<00:00, 17.78it/s]

  0% 0/3 [00:00<?, ?it/s][A
100% 3/3 [00:00<00:00, 23.57it/s][A100% 3/3 [00:00<00:00, 23.54it/s]
Validation prc-auc = 0.311672
  3% 1/30 [00:01<00:42,  1.46s/it]Epoch 1

  0% 0/23 [00:00<?, ?it/s][A
 30% 7/23 [00:00<00:00, 33.56it/s][ALoss = 2.1655e-02, PNorm = 69.3010, GNorm = 0.7346, lr_0 = 1.0000e-04

 74% 17/23 [00:00<00:00, 41.57it/s][ALoss = 2.1390e-02, PNorm = 69.3010, GNorm = 0.7020, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 60.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 113.38it/s]
Validation prc-auc = 0.379542
  7% 2/30 [00:01<00:32,  1.16s/it]Epoch 2

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1598e-02, PNorm = 69.3010, GNorm = 0.7660, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 93.33it/s][ALoss = 2.1443e-02, PNorm = 69.3010, GNorm = 0.7881, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 93.55it/s][A100% 23/23 [00:00<00:00, 94.02it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 113.69it/s]
Validation prc-auc = 0.466287
 10% 3/30 [00:02<00:24,  1.11it/s]Epoch 3

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1049e-02, PNorm = 69.3011, GNorm = 0.6664, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.27it/s][ALoss = 2.1014e-02, PNorm = 69.3011, GNorm = 0.4641, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 93.21it/s][ALoss = 2.1015e-02, PNorm = 69.3011, GNorm = 0.5961, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 89.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.91it/s]
Validation prc-auc = 0.532788
 13% 4/30 [00:02<00:18,  1.37it/s]Epoch 4

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0942e-02, PNorm = 69.3011, GNorm = 0.7368, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.75it/s][ALoss = 2.0835e-02, PNorm = 69.3011, GNorm = 0.6588, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 93.06it/s][A100% 23/23 [00:00<00:00, 94.05it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.83it/s]
Validation prc-auc = 0.582420
 17% 5/30 [00:02<00:15,  1.65it/s]Epoch 5

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0860e-02, PNorm = 69.3011, GNorm = 0.6702, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.72it/s][ALoss = 2.0410e-02, PNorm = 69.3011, GNorm = 0.6890, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.87it/s][A100% 23/23 [00:00<00:00, 90.58it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.78it/s]
Validation prc-auc = 0.624782
 20% 6/30 [00:03<00:12,  1.92it/s]Epoch 6

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0561e-02, PNorm = 69.3011, GNorm = 0.7221, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.34it/s][ALoss = 2.0338e-02, PNorm = 69.3011, GNorm = 0.6654, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 93.94it/s][ALoss = 2.0570e-02, PNorm = 69.3011, GNorm = 0.7354, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 96.37it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 122.65it/s]
Validation prc-auc = 0.644889
 23% 7/30 [00:03<00:10,  2.20it/s]Epoch 7

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0368e-02, PNorm = 69.3011, GNorm = 0.5185, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 99.91it/s][ALoss = 2.0312e-02, PNorm = 69.3012, GNorm = 0.5431, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 97.93it/s][A100% 23/23 [00:00<00:00, 98.06it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.83it/s]
Validation prc-auc = 0.689829
 27% 8/30 [00:03<00:08,  2.45it/s]Epoch 8

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9584e-02, PNorm = 69.3012, GNorm = 0.4654, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 102.83it/s][ALoss = 2.0459e-02, PNorm = 69.3012, GNorm = 0.4895, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 99.36it/s] [A100% 23/23 [00:00<00:00, 97.16it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.59it/s]
Validation prc-auc = 0.719364
 30% 9/30 [00:04<00:07,  2.65it/s]Epoch 9

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9952e-02, PNorm = 69.3012, GNorm = 0.5719, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.48it/s][ALoss = 2.0042e-02, PNorm = 69.3012, GNorm = 0.4968, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.54it/s][A100% 23/23 [00:00<00:00, 91.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.47it/s]
Validation prc-auc = 0.737556
 33% 10/30 [00:04<00:07,  2.78it/s]Epoch 10

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9483e-02, PNorm = 69.3012, GNorm = 0.4770, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.90it/s][ALoss = 2.0139e-02, PNorm = 69.3013, GNorm = 0.4736, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.28it/s][ALoss = 1.9540e-02, PNorm = 69.3013, GNorm = 0.4980, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 91.35it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.78it/s]
Validation prc-auc = 0.750117
 37% 11/30 [00:04<00:06,  2.89it/s]Epoch 11

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9601e-02, PNorm = 69.3013, GNorm = 0.5454, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 102.59it/s][ALoss = 1.9756e-02, PNorm = 69.3013, GNorm = 0.9484, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 99.88it/s] [A100% 23/23 [00:00<00:00, 98.86it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.52it/s]
Validation prc-auc = 0.758759
 40% 12/30 [00:05<00:05,  3.02it/s]Epoch 12

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9567e-02, PNorm = 69.3013, GNorm = 0.3939, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 99.26it/s][ALoss = 1.9539e-02, PNorm = 69.3013, GNorm = 0.5264, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 97.62it/s][A100% 23/23 [00:00<00:00, 95.85it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.67it/s]
Validation prc-auc = 0.779917
 43% 13/30 [00:05<00:05,  3.08it/s]Epoch 13

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9016e-02, PNorm = 69.3014, GNorm = 0.3920, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 87.97it/s][ALoss = 1.9452e-02, PNorm = 69.3014, GNorm = 0.6971, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.20it/s][ALoss = 1.9747e-02, PNorm = 69.3014, GNorm = 0.5636, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 89.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.71it/s]
Validation prc-auc = 0.788591
 47% 14/30 [00:05<00:05,  3.08it/s]Epoch 14

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9535e-02, PNorm = 69.3014, GNorm = 0.4910, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.55it/s][ALoss = 1.9186e-02, PNorm = 69.3015, GNorm = 0.4930, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.00it/s][A100% 23/23 [00:00<00:00, 91.53it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.65it/s]
Validation prc-auc = 0.816433
 50% 15/30 [00:05<00:04,  3.11it/s]Epoch 15

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9356e-02, PNorm = 69.3015, GNorm = 0.4882, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.73it/s][ALoss = 1.9388e-02, PNorm = 69.3015, GNorm = 0.4597, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 95.10it/s][A100% 23/23 [00:00<00:00, 98.14it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.52it/s]
Validation prc-auc = 0.830372
 53% 16/30 [00:06<00:04,  3.18it/s]Epoch 16

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8508e-02, PNorm = 69.3015, GNorm = 0.4697, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 103.57it/s][ALoss = 1.9182e-02, PNorm = 69.3016, GNorm = 0.4516, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 103.93it/s][ALoss = 1.9532e-02, PNorm = 69.3016, GNorm = 0.5067, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 103.81it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 122.24it/s]
Validation prc-auc = 0.832395
 57% 17/30 [00:06<00:03,  3.27it/s]Epoch 17

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9171e-02, PNorm = 69.3016, GNorm = 0.5029, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 100.48it/s][ALoss = 1.8963e-02, PNorm = 69.3016, GNorm = 0.4766, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 101.27it/s][A100% 23/23 [00:00<00:00, 101.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 122.49it/s]
Validation prc-auc = 0.838455
 60% 18/30 [00:06<00:03,  3.33it/s]Epoch 18

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8700e-02, PNorm = 69.3016, GNorm = 0.4221, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 101.99it/s][ALoss = 1.8764e-02, PNorm = 69.3017, GNorm = 0.4487, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 102.58it/s][A100% 23/23 [00:00<00:00, 103.01it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 122.36it/s]
Validation prc-auc = 0.840532
 63% 19/30 [00:07<00:03,  3.38it/s]Epoch 19

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8682e-02, PNorm = 69.3017, GNorm = 0.4571, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 93.14it/s][ALoss = 1.8874e-02, PNorm = 69.3017, GNorm = 0.4983, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 96.30it/s][A100% 23/23 [00:00<00:00, 99.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.57it/s]
Validation prc-auc = 0.846461
 67% 20/30 [00:07<00:02,  3.38it/s]Epoch 20

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0498e-02, PNorm = 69.3018, GNorm = 0.4036, lr_0 = 1.0000e-04

 30% 7/23 [00:00<00:00, 62.10it/s][A
 39% 9/23 [00:00<00:00, 27.66it/s][ALoss = 1.9089e-02, PNorm = 69.3018, GNorm = 0.4245, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 34.95it/s][ALoss = 1.8433e-02, PNorm = 69.3018, GNorm = 0.4078, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 53.08it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.44it/s]
Validation prc-auc = 0.844646
 70% 21/30 [00:08<00:04,  1.81it/s]Epoch 21

  0% 0/23 [00:00<?, ?it/s][A
 22% 5/23 [00:00<00:00, 41.48it/s][ALoss = 1.8194e-02, PNorm = 69.3018, GNorm = 0.3924, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 45.43it/s][ALoss = 1.8966e-02, PNorm = 69.3019, GNorm = 0.3692, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 52.56it/s][A100% 23/23 [00:00<00:00, 63.09it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.29it/s]
Validation prc-auc = 0.846557
 73% 22/30 [00:09<00:05,  1.46it/s]Epoch 22

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8554e-02, PNorm = 69.3019, GNorm = 0.4327, lr_0 = 1.0000e-04

 30% 7/23 [00:00<00:00, 65.79it/s][ALoss = 1.8469e-02, PNorm = 69.3019, GNorm = 0.4405, lr_0 = 1.0000e-04

 70% 16/23 [00:00<00:00, 71.50it/s][A100% 23/23 [00:00<00:00, 81.46it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.42it/s]
Validation prc-auc = 0.851193
 77% 23/30 [00:09<00:04,  1.71it/s]Epoch 23

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0292e-02, PNorm = 69.3020, GNorm = 0.5149, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.12it/s][ALoss = 1.8137e-02, PNorm = 69.3020, GNorm = 0.5512, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 86.19it/s][ALoss = 1.8543e-02, PNorm = 69.3020, GNorm = 0.5429, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 88.23it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.05it/s]
Validation prc-auc = 0.850017
 80% 24/30 [00:10<00:02,  2.01it/s]Epoch 24

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8892e-02, PNorm = 69.3020, GNorm = 0.5467, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 82.85it/s][A
 78% 18/23 [00:00<00:00, 83.46it/s][ALoss = 1.8341e-02, PNorm = 69.3021, GNorm = 0.4299, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 83.82it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.09it/s]
Validation prc-auc = 0.855388
 83% 25/30 [00:10<00:02,  2.21it/s]Epoch 25

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8893e-02, PNorm = 69.3021, GNorm = 0.3765, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 82.37it/s][ALoss = 1.8263e-02, PNorm = 69.3021, GNorm = 0.4335, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 82.66it/s][A100% 23/23 [00:00<00:00, 83.14it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.13it/s]
Validation prc-auc = 0.858876
 87% 26/30 [00:10<00:01,  2.37it/s]Epoch 26

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8890e-02, PNorm = 69.3022, GNorm = 0.3703, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 81.85it/s][ALoss = 1.8308e-02, PNorm = 69.3022, GNorm = 0.4511, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 85.06it/s][ALoss = 1.8155e-02, PNorm = 69.3022, GNorm = 0.5041, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 88.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 81.16it/s]
Validation prc-auc = 0.858876
 90% 27/30 [00:11<00:01,  2.59it/s]Epoch 27

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8520e-02, PNorm = 69.3023, GNorm = 0.5049, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 93.95it/s][ALoss = 1.8171e-02, PNorm = 69.3023, GNorm = 0.3856, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 94.48it/s][A100% 23/23 [00:00<00:00, 95.24it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.06it/s]
Validation prc-auc = 0.861420
 93% 28/30 [00:11<00:00,  2.75it/s]Epoch 28

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7601e-02, PNorm = 69.3023, GNorm = 0.4799, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.11it/s][ALoss = 1.8133e-02, PNorm = 69.3024, GNorm = 0.4331, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.24it/s][A100% 23/23 [00:00<00:00, 91.37it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.20it/s]
Validation prc-auc = 0.859893
 97% 29/30 [00:11<00:00,  2.95it/s]Epoch 29

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8243e-02, PNorm = 69.3024, GNorm = 0.3975, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.28it/s][ALoss = 1.8252e-02, PNorm = 69.3024, GNorm = 0.3578, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.31it/s][A100% 23/23 [00:00<00:00, 91.09it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.63it/s]
Validation prc-auc = 0.861272
100% 30/30 [00:12<00:00,  3.10it/s]100% 30/30 [00:12<00:00,  2.48it/s]
Model 0 best validation prc-auc = 0.861420 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s] 67% 2/3 [00:00<00:00,  8.93it/s]100% 3/3 [00:00<00:00, 11.80it/s]
Model 0 test prc-auc = 0.499853
Ensemble test prc-auc = 0.499853
Fold 1
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963741 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1963741_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1963741_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpkx7_lrnv/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963741'],
 'task_names': ['CHEMBL1963741'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 735,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]589it [00:00, 5882.33it/s]1438it [00:00, 6479.31it/s]2440it [00:00, 7246.66it/s]3427it [00:00, 7873.51it/s]4421it [00:00, 8395.64it/s]5404it [00:00, 8778.47it/s]6412it [00:00, 9130.09it/s]7399it [00:00, 9339.57it/s]8407it [00:00, 9548.61it/s]9406it [00:01, 9676.81it/s]10393it [00:01, 9731.37it/s]11488it [00:01, 10066.14it/s]12610it [00:01, 10386.05it/s]13732it [00:01, 10622.21it/s]14856it [00:01, 10799.85it/s]15978it [00:01, 10920.84it/s]17100it [00:01, 11006.68it/s]18221it [00:01, 11065.84it/s]19336it [00:01, 11089.20it/s]20455it [00:02, 11118.28it/s]21568it [00:02, 11112.75it/s]22687it [00:02, 11134.14it/s]23801it [00:02, 11127.09it/s]24918it [00:02, 11139.63it/s]26037it [00:02, 11153.11it/s]27159it [00:02, 11170.76it/s]28282it [00:02, 11187.83it/s]29404it [00:02, 11197.33it/s]30527it [00:02, 11205.00it/s]31651it [00:03, 11214.21it/s]32782it [00:03, 11241.12it/s]33918it [00:03, 11275.57it/s]35053it [00:03, 11296.46it/s]36188it [00:03, 11310.16it/s]37323it [00:03, 11320.10it/s]38456it [00:03, 11317.60it/s]39588it [00:03, 11303.38it/s]40719it [00:03, 11299.04it/s]41849it [00:03, 11293.54it/s]42979it [00:04, 11290.02it/s]44109it [00:04, 11288.68it/s]45239it [00:04, 11289.36it/s]46368it [00:04, 11286.45it/s]47497it [00:04, 11286.76it/s]48626it [00:04, 11063.29it/s]49734it [00:04, 10847.72it/s]50853it [00:04, 10945.98it/s]51952it [00:04, 10958.92it/s]53065it [00:04, 11009.41it/s]54167it [00:05, 10711.11it/s]55241it [00:05, 10481.01it/s]56292it [00:05, 10476.42it/s]57391it [00:05, 10623.26it/s]58501it [00:05, 10760.87it/s]59611it [00:05, 10860.37it/s]60720it [00:05, 10928.19it/s]61829it [00:05, 10975.14it/s]61865it [00:05, 10781.26it/s]
Number of examples remaining: 919
  0% 0/919 [00:00<?, ?it/s]100% 919/919 [00:00<00:00, 338149.43it/s]
  0% 0/919 [00:00<?, ?it/s] 48% 444/919 [00:00<00:00, 4438.08it/s]100% 916/919 [00:00<00:00, 4517.73it/s]100% 919/919 [00:00<00:00, 4571.62it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/919 [00:00<?, ?it/s] 45% 418/919 [00:00<00:00, 4169.33it/s] 94% 863/919 [00:00<00:00, 4249.06it/s]100% 919/919 [00:00<00:00, 4113.65it/s]
Total scaffolds = 546 | train scaffolds = 436 | val scaffolds = 63 | test scaffolds = 47
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963741 0: 67.03%, 1: 32.97%
Total size = 919 | train size = 735 | val size = 91 | test size = 93
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.2076e-02, PNorm = 69.3010, GNorm = 0.8017, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 95.95it/s][ALoss = 2.1757e-02, PNorm = 69.3010, GNorm = 0.5351, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 97.39it/s][A100% 23/23 [00:00<00:00, 98.52it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.41it/s]
Validation prc-auc = 0.308857
  3% 1/30 [00:00<00:08,  3.31it/s]Epoch 1

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1819e-02, PNorm = 69.3010, GNorm = 0.6745, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.23it/s][ALoss = 2.1704e-02, PNorm = 69.3010, GNorm = 0.6649, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 92.22it/s][A100% 23/23 [00:00<00:00, 92.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.22it/s]
Validation prc-auc = 0.324394
  7% 2/30 [00:00<00:08,  3.26it/s]Epoch 2

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1493e-02, PNorm = 69.3010, GNorm = 0.4449, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.01it/s][ALoss = 2.1229e-02, PNorm = 69.3010, GNorm = 0.6451, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 92.38it/s][A100% 23/23 [00:00<00:00, 92.54it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.36it/s]
Validation prc-auc = 0.344586
 10% 3/30 [00:00<00:08,  3.23it/s]Epoch 3

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0419e-02, PNorm = 69.3010, GNorm = 0.7105, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 100.69it/s][ALoss = 2.1163e-02, PNorm = 69.3010, GNorm = 0.4491, lr_0 = 1.0000e-04
Loss = 2.1059e-02, PNorm = 69.3011, GNorm = 0.5353, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 98.56it/s] [A100% 23/23 [00:00<00:00, 97.51it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.42it/s]
Validation prc-auc = 0.369178
 13% 4/30 [00:01<00:07,  3.26it/s]Epoch 4

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0842e-02, PNorm = 69.3011, GNorm = 0.4894, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 103.04it/s][ALoss = 2.1007e-02, PNorm = 69.3011, GNorm = 0.5347, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 101.37it/s][A100% 23/23 [00:00<00:00, 99.88it/s] 

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.49it/s]
Validation prc-auc = 0.415560
 17% 5/30 [00:01<00:07,  3.28it/s]Epoch 5

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0586e-02, PNorm = 69.3011, GNorm = 0.5794, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.62it/s][ALoss = 2.0760e-02, PNorm = 69.3011, GNorm = 0.4813, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.49it/s][A100% 23/23 [00:00<00:00, 91.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.15it/s]
Validation prc-auc = 0.481039
 20% 6/30 [00:01<00:07,  3.23it/s]Epoch 6

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0389e-02, PNorm = 69.3011, GNorm = 0.5509, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.71it/s][ALoss = 2.0478e-02, PNorm = 69.3011, GNorm = 0.6203, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.30it/s][ALoss = 2.0695e-02, PNorm = 69.3011, GNorm = 0.5583, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 91.74it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.63it/s]
Validation prc-auc = 0.505342
 23% 7/30 [00:02<00:07,  3.20it/s]Epoch 7

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9994e-02, PNorm = 69.3011, GNorm = 0.5332, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 101.88it/s][ALoss = 2.0282e-02, PNorm = 69.3011, GNorm = 0.5407, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 99.29it/s] [A100% 23/23 [00:00<00:00, 98.57it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.60it/s]
Validation prc-auc = 0.527260
 27% 8/30 [00:02<00:06,  3.25it/s]Epoch 8

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0156e-02, PNorm = 69.3011, GNorm = 0.4157, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 102.98it/s][ALoss = 2.0226e-02, PNorm = 69.3012, GNorm = 0.5485, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 99.42it/s] [A100% 23/23 [00:00<00:00, 97.14it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.24it/s]
Validation prc-auc = 0.526994
 30% 9/30 [00:02<00:06,  3.37it/s]Epoch 9

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9897e-02, PNorm = 69.3012, GNorm = 0.5840, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.19it/s][ALoss = 2.0196e-02, PNorm = 69.3012, GNorm = 0.3445, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 92.36it/s][A100% 23/23 [00:00<00:00, 92.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.40it/s]
Validation prc-auc = 0.518801
 33% 10/30 [00:03<00:05,  3.42it/s]Epoch 10

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9875e-02, PNorm = 69.3012, GNorm = 0.5137, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.47it/s][ALoss = 1.9903e-02, PNorm = 69.3012, GNorm = 0.5190, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 92.66it/s][ALoss = 1.9900e-02, PNorm = 69.3012, GNorm = 0.6975, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 92.45it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.85it/s]
Validation prc-auc = 0.527270
 37% 11/30 [00:03<00:05,  3.33it/s]Epoch 11

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0228e-02, PNorm = 69.3013, GNorm = 0.5056, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.43it/s][ALoss = 1.9598e-02, PNorm = 69.3013, GNorm = 0.6851, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 87.21it/s][A100% 23/23 [00:00<00:00, 87.60it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.36it/s]
Validation prc-auc = 0.536495
 40% 12/30 [00:03<00:05,  3.24it/s]Epoch 12

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9453e-02, PNorm = 69.3013, GNorm = 0.4868, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 101.00it/s][ALoss = 1.9544e-02, PNorm = 69.3013, GNorm = 0.5077, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 101.77it/s][A100% 23/23 [00:00<00:00, 102.24it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 122.55it/s]
Validation prc-auc = 0.534919
 43% 13/30 [00:03<00:04,  3.42it/s]Epoch 13

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8518e-02, PNorm = 69.3013, GNorm = 0.7419, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 103.64it/s][ALoss = 1.9969e-02, PNorm = 69.3014, GNorm = 0.4636, lr_0 = 1.0000e-04
Loss = 1.9287e-02, PNorm = 69.3014, GNorm = 0.3801, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 103.70it/s][A100% 23/23 [00:00<00:00, 103.97it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 122.28it/s]
Validation prc-auc = 0.535703
 47% 14/30 [00:04<00:04,  3.58it/s]Epoch 14

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9531e-02, PNorm = 69.3014, GNorm = 0.4608, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 104.96it/s][ALoss = 1.9462e-02, PNorm = 69.3014, GNorm = 0.6743, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 104.81it/s][A100% 23/23 [00:00<00:00, 104.85it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.95it/s]
Validation prc-auc = 0.531056
 50% 15/30 [00:04<00:04,  3.70it/s]Epoch 15

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0065e-02, PNorm = 69.3014, GNorm = 0.4699, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 95.67it/s][ALoss = 1.9108e-02, PNorm = 69.3015, GNorm = 0.4661, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 97.90it/s][A100% 23/23 [00:00<00:00, 99.96it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.62it/s]
Validation prc-auc = 0.535604
 53% 16/30 [00:04<00:03,  3.74it/s]Epoch 16

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9643e-02, PNorm = 69.3015, GNorm = 0.4341, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 94.06it/s][ALoss = 1.9122e-02, PNorm = 69.3015, GNorm = 0.5238, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 91.03it/s][ALoss = 1.9125e-02, PNorm = 69.3015, GNorm = 0.5063, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 88.08it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 101.04it/s]
Validation prc-auc = 0.534744
 57% 17/30 [00:04<00:03,  3.61it/s]Epoch 17

  0% 0/23 [00:00<?, ?it/s][A
 39% 9/23 [00:00<00:00, 82.16it/s][ALoss = 1.8895e-02, PNorm = 69.3016, GNorm = 0.3574, lr_0 = 1.0000e-04

 57% 13/23 [00:00<00:00, 36.67it/s][ALoss = 1.9157e-02, PNorm = 69.3016, GNorm = 0.4106, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 44.05it/s][A100% 23/23 [00:00<00:00, 47.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 99.52it/s]
Validation prc-auc = 0.539632
 60% 18/30 [00:05<00:04,  2.76it/s]Epoch 18

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8638e-02, PNorm = 69.3016, GNorm = 0.5309, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 82.63it/s][ALoss = 1.8997e-02, PNorm = 69.3016, GNorm = 0.4946, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 83.65it/s][A100% 23/23 [00:00<00:00, 86.45it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.56it/s]
Validation prc-auc = 0.540769
 63% 19/30 [00:05<00:03,  2.83it/s]Epoch 19

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8654e-02, PNorm = 69.3017, GNorm = 0.4797, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.23it/s][ALoss = 1.8703e-02, PNorm = 69.3017, GNorm = 0.4504, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 86.51it/s][A100% 23/23 [00:00<00:00, 90.41it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.90it/s]
Validation prc-auc = 0.528743
 67% 20/30 [00:06<00:03,  3.00it/s]Epoch 20

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.6845e-02, PNorm = 69.3017, GNorm = 0.5505, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 95.75it/s][ALoss = 1.9084e-02, PNorm = 69.3018, GNorm = 0.3737, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 94.65it/s][ALoss = 1.8755e-02, PNorm = 69.3018, GNorm = 0.6020, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 93.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.59it/s]
Validation prc-auc = 0.525638
 70% 21/30 [00:06<00:02,  3.15it/s]Epoch 21

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8624e-02, PNorm = 69.3018, GNorm = 0.4539, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.53it/s][ALoss = 1.9044e-02, PNorm = 69.3018, GNorm = 0.5938, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.83it/s][A100% 23/23 [00:00<00:00, 91.48it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.26it/s]
Validation prc-auc = 0.526459
 73% 22/30 [00:06<00:02,  3.25it/s]Epoch 22

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8509e-02, PNorm = 69.3019, GNorm = 0.4212, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.88it/s][ALoss = 1.8749e-02, PNorm = 69.3019, GNorm = 0.7863, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.27it/s][A100% 23/23 [00:00<00:00, 91.53it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.31it/s]
Validation prc-auc = 0.525821
 77% 23/30 [00:07<00:02,  3.33it/s]Epoch 23

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9070e-02, PNorm = 69.3019, GNorm = 0.3734, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 93.29it/s][ALoss = 1.8291e-02, PNorm = 69.3019, GNorm = 0.4668, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 96.20it/s][ALoss = 1.8797e-02, PNorm = 69.3020, GNorm = 0.4394, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 98.81it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.15it/s]
Validation prc-auc = 0.529132
 80% 24/30 [00:07<00:01,  3.46it/s]Epoch 24

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8288e-02, PNorm = 69.3020, GNorm = 0.4554, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 95.59it/s][ALoss = 1.8469e-02, PNorm = 69.3020, GNorm = 0.4422, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 94.48it/s][A100% 23/23 [00:00<00:00, 93.40it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 106.65it/s]
Validation prc-auc = 0.527136
 83% 25/30 [00:07<00:01,  3.49it/s]Epoch 25

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9012e-02, PNorm = 69.3021, GNorm = 0.4704, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.31it/s][ALoss = 1.8515e-02, PNorm = 69.3021, GNorm = 0.4271, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.33it/s][A100% 23/23 [00:00<00:00, 91.28it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.19it/s]
Validation prc-auc = 0.526289
 87% 26/30 [00:07<00:01,  3.50it/s]Epoch 26

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7954e-02, PNorm = 69.3021, GNorm = 0.3416, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 87.86it/s][ALoss = 1.7938e-02, PNorm = 69.3021, GNorm = 0.5746, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.09it/s][ALoss = 1.9058e-02, PNorm = 69.3022, GNorm = 0.4476, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 90.04it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 81.72it/s]
Validation prc-auc = 0.516952
 90% 27/30 [00:08<00:00,  3.45it/s]Epoch 27

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8212e-02, PNorm = 69.3022, GNorm = 0.4902, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 102.69it/s][ALoss = 1.8154e-02, PNorm = 69.3022, GNorm = 0.4757, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 102.36it/s][A100% 23/23 [00:00<00:00, 102.07it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.09it/s]
Validation prc-auc = 0.518468
 93% 28/30 [00:08<00:00,  3.56it/s]Epoch 28

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8185e-02, PNorm = 69.3023, GNorm = 0.4016, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.47it/s][A
 57% 13/23 [00:00<00:00, 39.79it/s][ALoss = 1.8663e-02, PNorm = 69.3023, GNorm = 0.4548, lr_0 = 1.0000e-04

100% 23/23 [00:00<00:00, 47.95it/s][A100% 23/23 [00:00<00:00, 58.57it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.30it/s]
Validation prc-auc = 0.516665
 97% 29/30 [00:08<00:00,  3.08it/s]Epoch 29

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7593e-02, PNorm = 69.3023, GNorm = 0.4921, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.27it/s][ALoss = 1.8386e-02, PNorm = 69.3024, GNorm = 0.4896, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.52it/s][A100% 23/23 [00:00<00:00, 91.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.26it/s]
Validation prc-auc = 0.517943
100% 30/30 [00:09<00:00,  3.20it/s]100% 30/30 [00:09<00:00,  3.29it/s]
Model 0 best validation prc-auc = 0.540769 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 116.26it/s]
Model 0 test prc-auc = 0.831539
Ensemble test prc-auc = 0.831539
Fold 2
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963741 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1963741_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1963741_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpkx7_lrnv/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963741'],
 'task_names': ['CHEMBL1963741'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 735,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]940it [00:00, 9397.99it/s]1891it [00:00, 9430.66it/s]2826it [00:00, 9404.44it/s]3771it [00:00, 9417.64it/s]4712it [00:00, 9413.66it/s]5657it [00:00, 9424.47it/s]6603it [00:00, 9433.76it/s]7643it [00:00, 9702.90it/s]8696it [00:00, 9936.14it/s]9751it [00:01, 10110.25it/s]10805it [00:01, 10232.83it/s]11866it [00:01, 10340.65it/s]12928it [00:01, 10421.50it/s]13992it [00:01, 10485.09it/s]15057it [00:01, 10532.22it/s]16120it [00:01, 10559.77it/s]17182it [00:01, 10575.13it/s]18245it [00:01, 10589.43it/s]19307it [00:01, 10597.28it/s]20366it [00:02, 10583.90it/s]21428it [00:02, 10593.97it/s]22489it [00:02, 10596.40it/s]23554it [00:02, 10609.71it/s]24622it [00:02, 10628.10it/s]25685it [00:02, 10577.05it/s]26743it [00:02, 10544.92it/s]27798it [00:02, 10520.19it/s]28851it [00:02, 10505.65it/s]29902it [00:02, 10505.30it/s]30966it [00:03, 10543.27it/s]32033it [00:03, 10579.87it/s]33103it [00:03, 10615.14it/s]34172it [00:03, 10636.01it/s]35240it [00:03, 10649.10it/s]36309it [00:03, 10660.46it/s]37378it [00:03, 10668.50it/s]38448it [00:03, 10675.15it/s]39516it [00:03, 10667.18it/s]40583it [00:03, 10664.88it/s]41650it [00:04, 10657.00it/s]42716it [00:04, 10614.45it/s]43780it [00:04, 10620.80it/s]44845it [00:04, 10628.54it/s]45911it [00:04, 10635.16it/s]46978it [00:04, 10643.26it/s]48043it [00:04, 10629.96it/s]49110it [00:04, 10639.42it/s]50174it [00:04, 10590.35it/s]51246it [00:04, 10626.28it/s]52309it [00:05, 10603.02it/s]53370it [00:05, 10507.14it/s]54421it [00:05, 10200.32it/s]55444it [00:05, 10034.39it/s]56451it [00:05, 10042.70it/s]57511it [00:05, 10201.72it/s]58575it [00:05, 10328.95it/s]59640it [00:05, 10422.80it/s]60708it [00:05, 10498.57it/s]61777it [00:05, 10554.07it/s]61865it [00:05, 10416.67it/s]
Number of examples remaining: 919
  0% 0/919 [00:00<?, ?it/s]100% 919/919 [00:00<00:00, 76171.16it/s]
  0% 0/919 [00:00<?, ?it/s] 48% 444/919 [00:00<00:00, 4433.56it/s] 99% 908/919 [00:00<00:00, 4492.05it/s]100% 919/919 [00:00<00:00, 4531.97it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/919 [00:00<?, ?it/s] 45% 415/919 [00:00<00:00, 4136.94it/s] 93% 853/919 [00:00<00:00, 4205.22it/s]100% 919/919 [00:00<00:00, 4265.37it/s]
Total scaffolds = 546 | train scaffolds = 430 | val scaffolds = 64 | test scaffolds = 52
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([5])), (array([1.]), array([1])), (array([0.5]), array([2])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([0.66666667]), array([3])), (array([0.]), array([1]))]
Class sizes
CHEMBL1963741 0: 67.03%, 1: 32.97%
Total size = 919 | train size = 735 | val size = 91 | test size = 93
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/23 [00:00<?, ?it/s][A
 39% 9/23 [00:00<00:00, 86.04it/s][ALoss = 2.1839e-02, PNorm = 69.3011, GNorm = 0.5271, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 88.48it/s][ALoss = 2.1804e-02, PNorm = 69.3011, GNorm = 0.5527, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 90.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.52it/s]
Validation prc-auc = 0.365040
  3% 1/30 [00:00<00:09,  3.11it/s]Epoch 1

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1478e-02, PNorm = 69.3011, GNorm = 0.5657, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.54it/s][ALoss = 2.1431e-02, PNorm = 69.3011, GNorm = 0.6345, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.22it/s][A100% 23/23 [00:00<00:00, 91.01it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.97it/s]
Validation prc-auc = 0.400871
  7% 2/30 [00:00<00:08,  3.11it/s]Epoch 2

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1245e-02, PNorm = 69.3011, GNorm = 0.5986, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.08it/s][ALoss = 2.1379e-02, PNorm = 69.3011, GNorm = 0.4939, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.14it/s][A100% 23/23 [00:00<00:00, 91.34it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.37it/s]
Validation prc-auc = 0.430603
 10% 3/30 [00:00<00:08,  3.12it/s]Epoch 3

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1377e-02, PNorm = 69.3011, GNorm = 0.6748, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.81it/s][ALoss = 2.1026e-02, PNorm = 69.3011, GNorm = 0.7297, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.41it/s][ALoss = 2.0970e-02, PNorm = 69.3011, GNorm = 0.5695, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 89.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.15it/s]
Validation prc-auc = 0.440760
 13% 4/30 [00:01<00:08,  3.12it/s]Epoch 4

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0888e-02, PNorm = 69.3011, GNorm = 0.3819, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 102.02it/s][ALoss = 2.0783e-02, PNorm = 69.3011, GNorm = 0.4437, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 100.70it/s][A100% 23/23 [00:00<00:00, 99.62it/s] 

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.23it/s]
Validation prc-auc = 0.469034
 17% 5/30 [00:01<00:07,  3.18it/s]Epoch 5

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0475e-02, PNorm = 69.3011, GNorm = 0.6268, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.33it/s][ALoss = 2.0768e-02, PNorm = 69.3011, GNorm = 0.4476, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.54it/s][A100% 23/23 [00:00<00:00, 89.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.20it/s]
Validation prc-auc = 0.486058
 20% 6/30 [00:01<00:07,  3.15it/s]Epoch 6

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0158e-02, PNorm = 69.3011, GNorm = 0.6275, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.51it/s][ALoss = 2.0524e-02, PNorm = 69.3011, GNorm = 0.6448, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.50it/s][ALoss = 2.0475e-02, PNorm = 69.3012, GNorm = 0.4483, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 91.30it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.30it/s]
Validation prc-auc = 0.503478
 23% 7/30 [00:02<00:07,  3.14it/s]Epoch 7

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0260e-02, PNorm = 69.3012, GNorm = 0.6624, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 97.65it/s][ALoss = 2.0353e-02, PNorm = 69.3012, GNorm = 0.4708, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 96.14it/s][A100% 23/23 [00:00<00:00, 96.46it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.39it/s]
Validation prc-auc = 0.531652
 27% 8/30 [00:02<00:07,  3.02it/s]Epoch 8

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9978e-02, PNorm = 69.3012, GNorm = 0.5974, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 88.22it/s][ALoss = 2.0000e-02, PNorm = 69.3012, GNorm = 0.5950, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 88.75it/s][A100% 23/23 [00:00<00:00, 89.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.46it/s]
Validation prc-auc = 0.559381
 30% 9/30 [00:02<00:06,  3.04it/s]Epoch 9

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9485e-02, PNorm = 69.3012, GNorm = 0.4687, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.84it/s][ALoss = 1.9698e-02, PNorm = 69.3012, GNorm = 0.6325, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.55it/s][A100% 23/23 [00:00<00:00, 91.85it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.32it/s]
Validation prc-auc = 0.576429
 33% 10/30 [00:03<00:06,  3.07it/s]Epoch 10

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9870e-02, PNorm = 69.3013, GNorm = 0.6340, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.99it/s][ALoss = 1.9764e-02, PNorm = 69.3013, GNorm = 0.6192, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 92.01it/s][ALoss = 1.9926e-02, PNorm = 69.3013, GNorm = 0.5169, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 93.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.15it/s]
Validation prc-auc = 0.590662
 37% 11/30 [00:03<00:06,  2.76it/s]Epoch 11

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0082e-02, PNorm = 69.3013, GNorm = 0.7670, lr_0 = 1.0000e-04

 35% 8/23 [00:00<00:00, 76.67it/s][ALoss = 1.9282e-02, PNorm = 69.3013, GNorm = 0.4880, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 80.79it/s][A
100% 23/23 [00:00<00:00, 42.11it/s][A100% 23/23 [00:00<00:00, 49.55it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 70.25it/s]
Validation prc-auc = 0.598136
 40% 12/30 [00:04<00:07,  2.36it/s]Epoch 12

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9604e-02, PNorm = 69.3014, GNorm = 0.5255, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 86.82it/s][ALoss = 1.9427e-02, PNorm = 69.3014, GNorm = 0.5291, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 87.73it/s][A100% 23/23 [00:00<00:00, 88.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.11it/s]
Validation prc-auc = 0.601611
 43% 13/30 [00:04<00:06,  2.53it/s]Epoch 13

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9077e-02, PNorm = 69.3014, GNorm = 0.6016, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 87.52it/s][ALoss = 1.9064e-02, PNorm = 69.3014, GNorm = 0.7767, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 88.35it/s][ALoss = 1.9555e-02, PNorm = 69.3015, GNorm = 0.5205, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 89.55it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.84it/s]
Validation prc-auc = 0.611450
 47% 14/30 [00:04<00:05,  2.67it/s]Epoch 14

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9528e-02, PNorm = 69.3015, GNorm = 0.4108, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.24it/s][ALoss = 1.8940e-02, PNorm = 69.3015, GNorm = 0.5773, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.52it/s][A100% 23/23 [00:00<00:00, 90.53it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.87it/s]
Validation prc-auc = 0.621938
 50% 15/30 [00:05<00:05,  2.78it/s]Epoch 15

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8612e-02, PNorm = 69.3015, GNorm = 0.3917, lr_0 = 1.0000e-04

 30% 7/23 [00:00<00:00, 61.57it/s][A
 57% 13/23 [00:00<00:00, 59.87it/s][ALoss = 1.9334e-02, PNorm = 69.3015, GNorm = 0.4907, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 66.34it/s][A100% 23/23 [00:00<00:00, 69.19it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.64it/s]
Validation prc-auc = 0.631002
 53% 16/30 [00:05<00:05,  2.69it/s]Epoch 16

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0296e-02, PNorm = 69.3016, GNorm = 0.3609, lr_0 = 1.0000e-04

 30% 7/23 [00:00<00:00, 66.59it/s][ALoss = 1.9560e-02, PNorm = 69.3016, GNorm = 0.5410, lr_0 = 1.0000e-04

 70% 16/23 [00:00<00:00, 70.29it/s][ALoss = 1.8345e-02, PNorm = 69.3016, GNorm = 0.6011, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 76.76it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.08it/s]
Validation prc-auc = 0.631951
 57% 17/30 [00:05<00:04,  2.69it/s]Epoch 17

  0% 0/23 [00:00<?, ?it/s][A
 39% 9/23 [00:00<00:00, 81.86it/s][ALoss = 1.9124e-02, PNorm = 69.3016, GNorm = 0.5697, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 82.25it/s][ALoss = 1.8487e-02, PNorm = 69.3017, GNorm = 0.4291, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 82.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.17it/s]
Validation prc-auc = 0.630669
 60% 18/30 [00:06<00:04,  2.82it/s]Epoch 18

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8450e-02, PNorm = 69.3017, GNorm = 0.3693, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.25it/s][ALoss = 1.9129e-02, PNorm = 69.3017, GNorm = 0.5976, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 83.09it/s][A100% 23/23 [00:00<00:00, 83.49it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.82it/s]
Validation prc-auc = 0.632951
 63% 19/30 [00:06<00:03,  2.84it/s]Epoch 19

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7839e-02, PNorm = 69.3018, GNorm = 0.4699, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.02it/s][ALoss = 1.8877e-02, PNorm = 69.3018, GNorm = 0.3891, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 85.93it/s][A100% 23/23 [00:00<00:00, 89.68it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 119.33it/s]
Validation prc-auc = 0.634399
 67% 20/30 [00:06<00:03,  2.92it/s]Epoch 20

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7937e-02, PNorm = 69.3018, GNorm = 0.4642, lr_0 = 1.0000e-04

 35% 8/23 [00:00<00:00, 73.48it/s][ALoss = 1.8183e-02, PNorm = 69.3018, GNorm = 0.4536, lr_0 = 1.0000e-04

 74% 17/23 [00:00<00:00, 77.39it/s][ALoss = 1.9344e-02, PNorm = 69.3019, GNorm = 0.4562, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 82.94it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.94it/s]
Validation prc-auc = 0.638368
 70% 21/30 [00:07<00:03,  2.90it/s]Epoch 21

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8678e-02, PNorm = 69.3019, GNorm = 0.4623, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.24it/s][ALoss = 1.8674e-02, PNorm = 69.3019, GNorm = 0.4920, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 90.39it/s][A100% 23/23 [00:00<00:00, 91.00it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.99it/s]
Validation prc-auc = 0.637673
 73% 22/30 [00:07<00:02,  3.06it/s]Epoch 22

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9416e-02, PNorm = 69.3020, GNorm = 0.5351, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.07it/s][ALoss = 1.7742e-02, PNorm = 69.3020, GNorm = 0.4982, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.38it/s][A100% 23/23 [00:00<00:00, 91.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 117.03it/s]
Validation prc-auc = 0.638896
 77% 23/30 [00:07<00:02,  3.08it/s]Epoch 23

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9076e-02, PNorm = 69.3020, GNorm = 0.4840, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.53it/s][ALoss = 1.7804e-02, PNorm = 69.3021, GNorm = 0.5466, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 88.20it/s][ALoss = 1.8665e-02, PNorm = 69.3021, GNorm = 0.6705, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 93.17it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.71it/s]
Validation prc-auc = 0.639173
 80% 24/30 [00:08<00:01,  3.11it/s]Epoch 24

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8114e-02, PNorm = 69.3021, GNorm = 0.6594, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 94.98it/s][ALoss = 1.8638e-02, PNorm = 69.3021, GNorm = 0.5350, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 93.70it/s][A100% 23/23 [00:00<00:00, 92.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.74it/s]
Validation prc-auc = 0.643262
 83% 25/30 [00:08<00:01,  3.12it/s]Epoch 25

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8313e-02, PNorm = 69.3022, GNorm = 0.4067, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.14it/s][ALoss = 1.8048e-02, PNorm = 69.3022, GNorm = 0.4670, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 90.49it/s][A100% 23/23 [00:00<00:00, 90.78it/s]

  0% 0/3 [00:00<?, ?it/s][A
 67% 2/3 [00:00<00:00, 12.79it/s][A100% 3/3 [00:00<00:00, 18.34it/s]
Validation prc-auc = 0.645094
 87% 26/30 [00:09<00:01,  2.77it/s]Epoch 26

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7578e-02, PNorm = 69.3022, GNorm = 0.3677, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 98.13it/s][ALoss = 1.8174e-02, PNorm = 69.3023, GNorm = 0.4109, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 99.19it/s][ALoss = 1.8367e-02, PNorm = 69.3023, GNorm = 0.4709, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 100.07it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 90.74it/s]
Validation prc-auc = 0.644615
 90% 27/30 [00:09<00:01,  3.00it/s]Epoch 27

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8273e-02, PNorm = 69.3023, GNorm = 0.5096, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 101.90it/s][ALoss = 1.7591e-02, PNorm = 69.3024, GNorm = 0.3430, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 101.56it/s][A100% 23/23 [00:00<00:00, 101.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 120.10it/s]
Validation prc-auc = 0.647518
 93% 28/30 [00:09<00:00,  3.09it/s]Epoch 28

  0% 0/23 [00:00<?, ?it/s][A
 26% 6/23 [00:00<00:00, 59.58it/s][ALoss = 1.8384e-02, PNorm = 69.3024, GNorm = 0.4102, lr_0 = 1.0000e-04

 65% 15/23 [00:00<00:00, 65.21it/s][ALoss = 1.7863e-02, PNorm = 69.3024, GNorm = 0.5332, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 77.67it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.88it/s]
Validation prc-auc = 0.650231
 97% 29/30 [00:09<00:00,  2.97it/s]Epoch 29

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8483e-02, PNorm = 69.3025, GNorm = 0.3852, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.67it/s][ALoss = 1.7766e-02, PNorm = 69.3025, GNorm = 0.4241, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.38it/s][A100% 23/23 [00:00<00:00, 91.22it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.61it/s]
Validation prc-auc = 0.650772
100% 30/30 [00:10<00:00,  2.94it/s]100% 30/30 [00:10<00:00,  2.91it/s]
Model 0 best validation prc-auc = 0.650772 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 106.03it/s]
Model 0 test prc-auc = 0.286747
Ensemble test prc-auc = 0.286747
Fold 3
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963741 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1963741_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1963741_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpkx7_lrnv/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963741'],
 'task_names': ['CHEMBL1963741'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 735,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]481it [00:00, 4808.59it/s]1236it [00:00, 5395.09it/s]2191it [00:00, 6204.43it/s]3147it [00:00, 6934.26it/s]4104it [00:00, 7558.11it/s]5071it [00:00, 8087.53it/s]6039it [00:00, 8506.57it/s]7010it [00:00, 8834.95it/s]7976it [00:00, 9065.28it/s]8945it [00:01, 9242.96it/s]9937it [00:01, 9433.75it/s]11006it [00:01, 9778.36it/s]12085it [00:01, 10060.81it/s]13169it [00:01, 10280.02it/s]14255it [00:01, 10446.62it/s]15341it [00:01, 10567.02it/s]16408it [00:01, 10597.23it/s]17493it [00:01, 10671.76it/s]18579it [00:01, 10724.89it/s]19653it [00:02, 10718.52it/s]20726it [00:02, 10710.53it/s]21798it [00:02, 10704.98it/s]22871it [00:02, 10709.77it/s]23946it [00:02, 10719.53it/s]25022it [00:02, 10731.16it/s]26102it [00:02, 10749.61it/s]27179it [00:02, 10753.27it/s]28255it [00:02, 10749.93it/s]29332it [00:02, 10753.79it/s]30408it [00:03, 10724.51it/s]31481it [00:03, 10702.62it/s]32552it [00:03, 10653.85it/s]33618it [00:03, 10596.54it/s]34678it [00:03, 10584.63it/s]35737it [00:03, 10573.39it/s]36795it [00:03, 10567.63it/s]37852it [00:03, 10550.98it/s]38914it [00:03, 10571.31it/s]39979it [00:03, 10592.12it/s]41041it [00:04, 10599.71it/s]42105it [00:04, 10611.20it/s]43172it [00:04, 10626.75it/s]44239it [00:04, 10637.89it/s]45311it [00:04, 10661.46it/s]46387it [00:04, 10690.58it/s]47463it [00:04, 10711.11it/s]48535it [00:04, 10694.96it/s]49605it [00:04, 10665.35it/s]50686it [00:04, 10706.18it/s]51757it [00:05, 10669.91it/s]52826it [00:05, 10674.38it/s]53894it [00:05, 10314.02it/s]54929it [00:05, 10199.12it/s]55952it [00:05, 10042.86it/s]57009it [00:05, 10192.77it/s]58093it [00:05, 10375.96it/s]59179it [00:05, 10515.01it/s]60267it [00:05, 10619.45it/s]61355it [00:05, 10695.41it/s]61865it [00:05, 10342.22it/s]
Number of examples remaining: 919
  0% 0/919 [00:00<?, ?it/s]100% 919/919 [00:00<00:00, 292056.78it/s]
  0% 0/919 [00:00<?, ?it/s] 48% 438/919 [00:00<00:00, 4374.49it/s] 97% 896/919 [00:00<00:00, 4433.20it/s]100% 919/919 [00:00<00:00, 4481.33it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/919 [00:00<?, ?it/s] 44% 403/919 [00:00<00:00, 4020.54it/s] 91% 836/919 [00:00<00:00, 4107.02it/s]100% 919/919 [00:00<00:00, 3950.26it/s]
Total scaffolds = 546 | train scaffolds = 447 | val scaffolds = 50 | test scaffolds = 49
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([2])), (array([1.]), array([1])), (array([0.4]), array([5])), (array([0.2]), array([5])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([0.5]), array([2])), (array([0.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963741 0: 67.03%, 1: 32.97%
Total size = 919 | train size = 735 | val size = 91 | test size = 93
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/23 [00:00<?, ?it/s][A
 39% 9/23 [00:00<00:00, 87.87it/s][ALoss = 2.1579e-02, PNorm = 69.3011, GNorm = 0.9364, lr_0 = 1.0000e-04
Loss = 2.1684e-02, PNorm = 69.3011, GNorm = 0.5572, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.09it/s][A100% 23/23 [00:00<00:00, 94.72it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 120.64it/s]
Validation prc-auc = 0.367716
  3% 1/30 [00:00<00:08,  3.25it/s]Epoch 1

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1419e-02, PNorm = 69.3011, GNorm = 0.7670, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 97.40it/s][ALoss = 2.1284e-02, PNorm = 69.3011, GNorm = 0.4802, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 97.48it/s][A100% 23/23 [00:00<00:00, 97.36it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 52.14it/s]
Validation prc-auc = 0.367805
  7% 2/30 [00:00<00:09,  3.07it/s]Epoch 2

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1109e-02, PNorm = 69.3011, GNorm = 0.5208, lr_0 = 1.0000e-04

 35% 8/23 [00:00<00:00, 73.44it/s][ALoss = 2.1195e-02, PNorm = 69.3011, GNorm = 0.5488, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 78.15it/s][A100% 23/23 [00:00<00:00, 85.38it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.81it/s]
Validation prc-auc = 0.377523
 10% 3/30 [00:01<00:08,  3.03it/s]Epoch 3

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1272e-02, PNorm = 69.3011, GNorm = 0.4774, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.44it/s][ALoss = 2.0776e-02, PNorm = 69.3011, GNorm = 0.6052, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.96it/s][ALoss = 2.1023e-02, PNorm = 69.3011, GNorm = 0.4582, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 81.28it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 63.02it/s]
Validation prc-auc = 0.380554
 13% 4/30 [00:01<00:09,  2.87it/s]Epoch 4

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0954e-02, PNorm = 69.3011, GNorm = 0.4739, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 81.65it/s][A
 78% 18/23 [00:00<00:00, 83.39it/s][ALoss = 2.0535e-02, PNorm = 69.3011, GNorm = 0.5777, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 84.92it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.58it/s]
Validation prc-auc = 0.382456
 17% 5/30 [00:01<00:08,  2.88it/s]Epoch 5

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0536e-02, PNorm = 69.3011, GNorm = 0.3913, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 86.16it/s][ALoss = 2.0688e-02, PNorm = 69.3011, GNorm = 0.5564, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 86.47it/s][A100% 23/23 [00:00<00:00, 86.94it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.38it/s]
Validation prc-auc = 0.385189
 20% 6/30 [00:02<00:08,  2.90it/s]Epoch 6

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0501e-02, PNorm = 69.3011, GNorm = 0.5746, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 86.94it/s][ALoss = 2.0453e-02, PNorm = 69.3012, GNorm = 0.5909, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 87.00it/s][ALoss = 2.0088e-02, PNorm = 69.3012, GNorm = 0.5224, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 86.59it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.20it/s]
Validation prc-auc = 0.379171
 23% 7/30 [00:02<00:07,  3.02it/s]Epoch 7

  0% 0/23 [00:00<?, ?it/s][A
 39% 9/23 [00:00<00:00, 88.66it/s][ALoss = 2.0165e-02, PNorm = 69.3012, GNorm = 0.5927, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 85.73it/s][ALoss = 2.0025e-02, PNorm = 69.3012, GNorm = 0.8314, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 84.73it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.54it/s]
Validation prc-auc = 0.345265
 27% 8/30 [00:02<00:07,  3.09it/s]Epoch 8

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9783e-02, PNorm = 69.3012, GNorm = 0.5748, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.88it/s][ALoss = 2.0158e-02, PNorm = 69.3012, GNorm = 0.4782, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.43it/s][A100% 23/23 [00:00<00:00, 91.38it/s]

  0% 0/3 [00:00<?, ?it/s][A
100% 3/3 [00:00<00:00, 10.24it/s][A100% 3/3 [00:00<00:00, 10.24it/s]
Validation prc-auc = 0.347853
 30% 9/30 [00:03<00:08,  2.52it/s]Epoch 9

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9447e-02, PNorm = 69.3013, GNorm = 0.5031, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 94.89it/s][ALoss = 2.0188e-02, PNorm = 69.3013, GNorm = 0.3635, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 95.48it/s][A100% 23/23 [00:00<00:00, 96.24it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 51.31it/s]
Validation prc-auc = 0.355056
 33% 10/30 [00:03<00:07,  2.69it/s]Epoch 10

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0480e-02, PNorm = 69.3013, GNorm = 0.4547, lr_0 = 1.0000e-04

 30% 7/23 [00:00<00:00, 63.14it/s][ALoss = 1.9471e-02, PNorm = 69.3013, GNorm = 0.5519, lr_0 = 1.0000e-04

 70% 16/23 [00:00<00:00, 68.57it/s][ALoss = 1.9708e-02, PNorm = 69.3013, GNorm = 0.6036, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 78.96it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.14it/s]
Validation prc-auc = 0.356758
 37% 11/30 [00:03<00:06,  2.78it/s]Epoch 11

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9758e-02, PNorm = 69.3014, GNorm = 0.4280, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.17it/s][ALoss = 1.9358e-02, PNorm = 69.3014, GNorm = 0.7354, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 88.09it/s][A100% 23/23 [00:00<00:00, 88.37it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.19it/s]
Validation prc-auc = 0.356170
 40% 12/30 [00:04<00:06,  2.94it/s]Epoch 12

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9664e-02, PNorm = 69.3014, GNorm = 0.5188, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 93.29it/s][ALoss = 1.9289e-02, PNorm = 69.3014, GNorm = 0.6346, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 93.15it/s][A100% 23/23 [00:00<00:00, 92.83it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.04it/s]
Validation prc-auc = 0.356436
 43% 13/30 [00:04<00:05,  3.10it/s]Epoch 13

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9614e-02, PNorm = 69.3015, GNorm = 0.4205, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 88.44it/s][ALoss = 1.9276e-02, PNorm = 69.3015, GNorm = 0.5073, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.43it/s][ALoss = 1.9044e-02, PNorm = 69.3015, GNorm = 0.5456, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 90.26it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.88it/s]
Validation prc-auc = 0.358939
 47% 14/30 [00:04<00:04,  3.20it/s]Epoch 14

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9625e-02, PNorm = 69.3015, GNorm = 0.5276, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.34it/s][ALoss = 1.8569e-02, PNorm = 69.3016, GNorm = 0.5460, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 90.76it/s][A100% 23/23 [00:00<00:00, 91.66it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 115.14it/s]
Validation prc-auc = 0.361344
 50% 15/30 [00:05<00:04,  3.29it/s]Epoch 15

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8771e-02, PNorm = 69.3016, GNorm = 0.5297, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.37it/s][ALoss = 1.9385e-02, PNorm = 69.3016, GNorm = 0.3852, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 94.21it/s][A100% 23/23 [00:00<00:00, 97.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.95it/s]
Validation prc-auc = 0.367192
 53% 16/30 [00:05<00:04,  3.42it/s]Epoch 16

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8705e-02, PNorm = 69.3016, GNorm = 0.4758, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 97.80it/s][ALoss = 1.9512e-02, PNorm = 69.3017, GNorm = 0.3900, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 96.82it/s][ALoss = 1.8438e-02, PNorm = 69.3017, GNorm = 0.5713, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 95.49it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.11it/s]
Validation prc-auc = 0.367060
 57% 17/30 [00:05<00:03,  3.49it/s]Epoch 17

  0% 0/23 [00:00<?, ?it/s][A
 26% 6/23 [00:00<00:00, 54.84it/s][ALoss = 1.9039e-02, PNorm = 69.3017, GNorm = 0.4579, lr_0 = 1.0000e-04

 57% 13/23 [00:00<00:00, 57.98it/s][ALoss = 1.9060e-02, PNorm = 69.3017, GNorm = 0.4658, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 64.76it/s][A100% 23/23 [00:00<00:00, 70.66it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.31it/s]
Validation prc-auc = 0.368731
 60% 18/30 [00:05<00:03,  3.24it/s]Epoch 18

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8710e-02, PNorm = 69.3018, GNorm = 0.4406, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.61it/s][ALoss = 1.8894e-02, PNorm = 69.3018, GNorm = 0.4398, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 91.47it/s][A100% 23/23 [00:00<00:00, 91.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.65it/s]
Validation prc-auc = 0.375371
 63% 19/30 [00:06<00:03,  3.27it/s]Epoch 19

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8758e-02, PNorm = 69.3018, GNorm = 0.4764, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 81.60it/s][ALoss = 1.8862e-02, PNorm = 69.3019, GNorm = 0.4402, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 85.14it/s][A100% 23/23 [00:00<00:00, 88.99it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.30it/s]
Validation prc-auc = 0.375015
 67% 20/30 [00:06<00:03,  3.31it/s]Epoch 20

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8552e-02, PNorm = 69.3019, GNorm = 0.4307, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 93.17it/s][ALoss = 1.8819e-02, PNorm = 69.3019, GNorm = 0.5068, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 92.93it/s][ALoss = 1.8209e-02, PNorm = 69.3020, GNorm = 0.5371, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 92.48it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 120.23it/s]
Validation prc-auc = 0.376303
 70% 21/30 [00:06<00:02,  3.39it/s]Epoch 21

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8323e-02, PNorm = 69.3020, GNorm = 0.5376, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 100.00it/s][ALoss = 1.8842e-02, PNorm = 69.3020, GNorm = 0.6433, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 100.59it/s][A100% 23/23 [00:00<00:00, 101.41it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.07it/s]
Validation prc-auc = 0.391627
 73% 22/30 [00:07<00:02,  3.40it/s]Epoch 22

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8733e-02, PNorm = 69.3020, GNorm = 0.5175, lr_0 = 1.0000e-04

 48% 11/23 [00:00<00:00, 100.84it/s][ALoss = 1.8490e-02, PNorm = 69.3021, GNorm = 0.5459, lr_0 = 1.0000e-04

 96% 22/23 [00:00<00:00, 101.61it/s][A100% 23/23 [00:00<00:00, 102.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.26it/s]
Validation prc-auc = 0.386624
 77% 23/30 [00:07<00:01,  3.54it/s]Epoch 23

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9518e-02, PNorm = 69.3021, GNorm = 0.3959, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 91.97it/s][ALoss = 1.7871e-02, PNorm = 69.3021, GNorm = 0.3384, lr_0 = 1.0000e-04

 61% 14/23 [00:00<00:00, 49.04it/s][A
 91% 21/23 [00:00<00:00, 52.37it/s][ALoss = 1.8333e-02, PNorm = 69.3022, GNorm = 0.4154, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 54.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 96.11it/s]
Validation prc-auc = 0.395435
 80% 24/30 [00:07<00:02,  2.88it/s]Epoch 24

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8185e-02, PNorm = 69.3022, GNorm = 0.5281, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 81.91it/s][A
 78% 18/23 [00:00<00:00, 82.62it/s][ALoss = 1.8969e-02, PNorm = 69.3022, GNorm = 0.3575, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 83.15it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.70it/s]
Validation prc-auc = 0.389059
 83% 25/30 [00:08<00:01,  2.97it/s]Epoch 25

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8173e-02, PNorm = 69.3023, GNorm = 0.4744, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.51it/s][ALoss = 1.8638e-02, PNorm = 69.3023, GNorm = 0.4544, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 83.47it/s][A100% 23/23 [00:00<00:00, 83.67it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.65it/s]
Validation prc-auc = 0.398167
 87% 26/30 [00:08<00:01,  2.94it/s]Epoch 26

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8139e-02, PNorm = 69.3023, GNorm = 0.4107, lr_0 = 1.0000e-04

 35% 8/23 [00:00<00:00, 79.67it/s][ALoss = 1.8157e-02, PNorm = 69.3024, GNorm = 0.4210, lr_0 = 1.0000e-04

 74% 17/23 [00:00<00:00, 80.84it/s][ALoss = 1.8136e-02, PNorm = 69.3024, GNorm = 0.4500, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 82.42it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 79.58it/s]
Validation prc-auc = 0.401016
 90% 27/30 [00:08<00:01,  2.89it/s]Epoch 27

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7640e-02, PNorm = 69.3024, GNorm = 0.4385, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 94.20it/s][ALoss = 1.8641e-02, PNorm = 69.3025, GNorm = 0.3626, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 94.55it/s][A100% 23/23 [00:00<00:00, 94.81it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.92it/s]
Validation prc-auc = 0.403015
 93% 28/30 [00:09<00:00,  2.97it/s]Epoch 28

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7716e-02, PNorm = 69.3025, GNorm = 0.4141, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 90.52it/s][ALoss = 1.8031e-02, PNorm = 69.3025, GNorm = 0.4562, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 90.64it/s][A100% 23/23 [00:00<00:00, 90.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.11it/s]
Validation prc-auc = 0.403748
 97% 29/30 [00:09<00:00,  3.01it/s]Epoch 29

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8370e-02, PNorm = 69.3026, GNorm = 0.4621, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.67it/s][ALoss = 1.7843e-02, PNorm = 69.3026, GNorm = 0.4263, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.05it/s][A100% 23/23 [00:00<00:00, 91.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.25it/s]
Validation prc-auc = 0.400807
100% 30/30 [00:09<00:00,  3.14it/s]100% 30/30 [00:09<00:00,  3.06it/s]
Model 0 best validation prc-auc = 0.403748 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 109.63it/s]
Model 0 test prc-auc = 0.696960
Ensemble test prc-auc = 0.696960
Fold 4
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1963741 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/pretraining_1/ --experiment_name finetuning_on_CHEMBL1963741_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1963741_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/pretraining_1/',
 'save_dir': '/tmp/2323741.1.gpu.q/tmpkx7_lrnv/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1963741'],
 'task_names': ['CHEMBL1963741'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 735,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]524it [00:00, 5234.95it/s]1313it [00:00, 5821.99it/s]2268it [00:00, 6593.54it/s]3228it [00:00, 7276.01it/s]4175it [00:00, 7818.10it/s]5135it [00:00, 8277.01it/s]6102it [00:00, 8650.78it/s]7068it [00:00, 8928.72it/s]8032it [00:00, 9130.28it/s]8996it [00:01, 9274.98it/s]9980it [00:01, 9436.97it/s]11048it [00:01, 9778.21it/s]12108it [00:01, 10009.71it/s]13181it [00:01, 10214.59it/s]14258it [00:01, 10374.35it/s]15334it [00:01, 10484.39it/s]16419it [00:01, 10589.27it/s]17505it [00:01, 10668.23it/s]18591it [00:01, 10722.19it/s]19672it [00:02, 10746.91it/s]20748it [00:02, 10730.53it/s]21822it [00:02, 10720.24it/s]22895it [00:02, 10696.00it/s]23965it [00:02, 10695.20it/s]25035it [00:02, 10687.38it/s]26106it [00:02, 10693.03it/s]27176it [00:02, 10693.33it/s]28246it [00:02, 10687.52it/s]29315it [00:02, 10683.02it/s]30384it [00:03, 10674.71it/s]31460it [00:03, 10700.06it/s]32544it [00:03, 10739.65it/s]33619it [00:03, 10708.30it/s]34702it [00:03, 10743.20it/s]35786it [00:03, 10770.57it/s]36869it [00:03, 10786.09it/s]37954it [00:03, 10803.60it/s]39036it [00:03, 10805.89it/s]40117it [00:03, 10804.41it/s]41198it [00:04, 10801.97it/s]42279it [00:04, 10803.93it/s]43360it [00:04, 10804.14it/s]44441it [00:04, 10786.41it/s]45523it [00:04, 10794.58it/s]46605it [00:04, 10801.81it/s]47686it [00:04, 10803.74it/s]48767it [00:04, 10782.68it/s]49846it [00:04, 10647.31it/s]50912it [00:04, 10632.42it/s]51989it [00:05, 10673.25it/s]53057it [00:05, 10661.05it/s]54124it [00:05, 10323.87it/s]55159it [00:05, 10191.52it/s]56181it [00:05, 10091.91it/s]57192it [00:05, 9991.82it/s] 58193it [00:05, 9896.80it/s]59184it [00:05, 9835.72it/s]60169it [00:05, 9801.01it/s]61150it [00:05, 9774.57it/s]61865it [00:06, 10281.74it/s]
Number of examples remaining: 919
  0% 0/919 [00:00<?, ?it/s]100% 919/919 [00:00<00:00, 260813.68it/s]
  0% 0/919 [00:00<?, ?it/s] 48% 437/919 [00:00<00:00, 4367.43it/s] 98% 899/919 [00:00<00:00, 4439.28it/s]100% 919/919 [00:00<00:00, 4496.10it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/919 [00:00<?, ?it/s] 44% 408/919 [00:00<00:00, 4076.54it/s] 93% 855/919 [00:00<00:00, 4185.29it/s]100% 919/919 [00:00<00:00, 4273.15it/s]
Total scaffolds = 546 | train scaffolds = 443 | val scaffolds = 55 | test scaffolds = 48
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.5]), array([18])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([2])), (array([1.]), array([1]))]
Class sizes
CHEMBL1963741 0: 67.03%, 1: 32.97%
Total size = 919 | train size = 735 | val size = 91 | test size = 93
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/checkpoints/fold_0/model_0/pretraining_1.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/23 [00:00<?, ?it/s][A
 26% 6/23 [00:00<00:00, 54.51it/s][ALoss = 2.1840e-02, PNorm = 69.3011, GNorm = 0.7697, lr_0 = 1.0000e-04

 61% 14/23 [00:00<00:00, 58.87it/s][ALoss = 2.1885e-02, PNorm = 69.3010, GNorm = 0.8038, lr_0 = 1.0000e-04

100% 23/23 [00:00<00:00, 65.05it/s][A100% 23/23 [00:00<00:00, 70.71it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 105.29it/s]
Validation prc-auc = 0.316967
  3% 1/30 [00:00<00:11,  2.51it/s]Epoch 1

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1789e-02, PNorm = 69.3010, GNorm = 0.6433, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.13it/s][ALoss = 2.1337e-02, PNorm = 69.3010, GNorm = 0.7219, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.99it/s][A100% 23/23 [00:00<00:00, 91.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 113.38it/s]
Validation prc-auc = 0.344991
  7% 2/30 [00:00<00:10,  2.66it/s]Epoch 2

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.1413e-02, PNorm = 69.3010, GNorm = 0.5585, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.92it/s][ALoss = 2.1233e-02, PNorm = 69.3010, GNorm = 0.4020, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 90.19it/s][A100% 23/23 [00:00<00:00, 90.73it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 113.07it/s]
Validation prc-auc = 0.379210
 10% 3/30 [00:01<00:09,  2.77it/s]Epoch 3

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0762e-02, PNorm = 69.3011, GNorm = 0.7771, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.31it/s][ALoss = 2.1116e-02, PNorm = 69.3011, GNorm = 0.4021, lr_0 = 1.0000e-04

 91% 21/23 [00:00<00:00, 94.67it/s][ALoss = 2.0857e-02, PNorm = 69.3011, GNorm = 0.5577, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 93.01it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 123.53it/s]
Validation prc-auc = 0.422973
 13% 4/30 [00:01<00:09,  2.89it/s]Epoch 4

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0798e-02, PNorm = 69.3011, GNorm = 0.4017, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 97.48it/s][ALoss = 2.0785e-02, PNorm = 69.3011, GNorm = 0.5790, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 97.31it/s][A100% 23/23 [00:00<00:00, 96.49it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.37it/s]
Validation prc-auc = 0.459256
 17% 5/30 [00:01<00:08,  2.98it/s]Epoch 5

  0% 0/23 [00:00<?, ?it/s][A
  4% 1/23 [00:00<00:05,  4.07it/s][ALoss = 2.0361e-02, PNorm = 69.3011, GNorm = 0.7204, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:02,  5.70it/s][ALoss = 2.0915e-02, PNorm = 69.3011, GNorm = 0.4793, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00,  7.93it/s][A100% 23/23 [00:00<00:00, 46.82it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.56it/s]
Validation prc-auc = 0.564739
 20% 6/30 [00:02<00:09,  2.47it/s]Epoch 6

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0793e-02, PNorm = 69.3011, GNorm = 0.4544, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 88.86it/s][ALoss = 2.0119e-02, PNorm = 69.3011, GNorm = 0.5125, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 91.43it/s][ALoss = 2.0655e-02, PNorm = 69.3011, GNorm = 0.4250, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 94.73it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.93it/s]
Validation prc-auc = 0.607647
 23% 7/30 [00:02<00:08,  2.66it/s]Epoch 7

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0591e-02, PNorm = 69.3011, GNorm = 0.6234, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 99.64it/s][A
 83% 19/23 [00:00<00:00, 90.36it/s][ALoss = 2.0109e-02, PNorm = 69.3012, GNorm = 0.5576, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 78.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 83.56it/s]
Validation prc-auc = 0.642979
 27% 8/30 [00:02<00:08,  2.64it/s]Epoch 8

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0574e-02, PNorm = 69.3012, GNorm = 0.5525, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.89it/s][ALoss = 1.9621e-02, PNorm = 69.3012, GNorm = 0.5041, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 88.98it/s][A100% 23/23 [00:00<00:00, 88.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.18it/s]
Validation prc-auc = 0.661214
 30% 9/30 [00:03<00:07,  2.74it/s]Epoch 9

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9474e-02, PNorm = 69.3012, GNorm = 0.7063, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 85.74it/s][ALoss = 1.9877e-02, PNorm = 69.3012, GNorm = 0.4621, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 86.84it/s][A100% 23/23 [00:00<00:00, 88.25it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.50it/s]
Validation prc-auc = 0.658099
 33% 10/30 [00:03<00:06,  2.91it/s]Epoch 10

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9335e-02, PNorm = 69.3012, GNorm = 0.7081, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 88.54it/s][ALoss = 2.0084e-02, PNorm = 69.3013, GNorm = 0.4767, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 87.98it/s][ALoss = 1.9792e-02, PNorm = 69.3013, GNorm = 0.3981, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 87.96it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 116.95it/s]
Validation prc-auc = 0.666702
 37% 11/30 [00:03<00:06,  2.95it/s]Epoch 11

  0% 0/23 [00:00<?, ?it/s][ALoss = 2.0119e-02, PNorm = 69.3013, GNorm = 0.4852, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 95.31it/s][ALoss = 1.9576e-02, PNorm = 69.3013, GNorm = 0.4198, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 93.36it/s][A100% 23/23 [00:00<00:00, 93.58it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.49it/s]
Validation prc-auc = 0.701053
 40% 12/30 [00:04<00:05,  3.01it/s]Epoch 12

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9821e-02, PNorm = 69.3013, GNorm = 0.4890, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 92.75it/s][ALoss = 1.9534e-02, PNorm = 69.3013, GNorm = 0.5368, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 91.46it/s][A100% 23/23 [00:00<00:00, 90.82it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.84it/s]
Validation prc-auc = 0.705811
 43% 13/30 [00:04<00:05,  3.03it/s]Epoch 13

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9512e-02, PNorm = 69.3014, GNorm = 0.4148, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 82.85it/s][ALoss = 1.9424e-02, PNorm = 69.3014, GNorm = 0.4497, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 84.31it/s][ALoss = 1.9679e-02, PNorm = 69.3014, GNorm = 0.5538, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 85.97it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 107.07it/s]
Validation prc-auc = 0.711404
 47% 14/30 [00:04<00:05,  2.89it/s]Epoch 14

  0% 0/23 [00:00<?, ?it/s][A
 30% 7/23 [00:00<00:00, 65.27it/s][ALoss = 1.9741e-02, PNorm = 69.3014, GNorm = 0.5938, lr_0 = 1.0000e-04

 70% 16/23 [00:00<00:00, 70.39it/s][ALoss = 1.9270e-02, PNorm = 69.3014, GNorm = 0.5298, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 79.40it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 108.14it/s]
Validation prc-auc = 0.715233
 50% 15/30 [00:05<00:05,  2.85it/s]Epoch 15

  0% 0/23 [00:00<?, ?it/s][A
 17% 4/23 [00:00<00:00, 39.25it/s][ALoss = 1.9170e-02, PNorm = 69.3015, GNorm = 0.5381, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 41.51it/s][ALoss = 1.9285e-02, PNorm = 69.3015, GNorm = 0.4105, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 48.15it/s][A100% 23/23 [00:00<00:00, 59.03it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.65it/s]
Validation prc-auc = 0.715409
 53% 16/30 [00:05<00:05,  2.59it/s]Epoch 16

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9735e-02, PNorm = 69.3015, GNorm = 0.4649, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 83.00it/s][ALoss = 1.9259e-02, PNorm = 69.3015, GNorm = 0.5883, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 82.30it/s][ALoss = 1.9119e-02, PNorm = 69.3016, GNorm = 0.4944, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 81.47it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.49it/s]
Validation prc-auc = 0.718795
 57% 17/30 [00:06<00:04,  2.65it/s]Epoch 17

  0% 0/23 [00:00<?, ?it/s][A
 39% 9/23 [00:00<00:00, 79.20it/s][ALoss = 1.9337e-02, PNorm = 69.3016, GNorm = 0.8005, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 79.72it/s][ALoss = 1.8743e-02, PNorm = 69.3016, GNorm = 0.5116, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 80.39it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.94it/s]
Validation prc-auc = 0.721520
 60% 18/30 [00:06<00:04,  2.69it/s]Epoch 18

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9495e-02, PNorm = 69.3016, GNorm = 0.4273, lr_0 = 1.0000e-04

 35% 8/23 [00:00<00:00, 79.82it/s][ALoss = 1.9082e-02, PNorm = 69.3017, GNorm = 0.5172, lr_0 = 1.0000e-04

 74% 17/23 [00:00<00:00, 80.11it/s][A100% 23/23 [00:00<00:00, 82.34it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 114.82it/s]
Validation prc-auc = 0.723552
 63% 19/30 [00:08<00:09,  1.11it/s]Epoch 19

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9514e-02, PNorm = 69.3017, GNorm = 0.2947, lr_0 = 1.0000e-04

 26% 6/23 [00:00<00:00, 48.03it/s][ALoss = 1.8792e-02, PNorm = 69.3017, GNorm = 0.3685, lr_0 = 1.0000e-04

 61% 14/23 [00:00<00:00, 53.93it/s][A
100% 23/23 [00:00<00:00, 60.53it/s][A100% 23/23 [00:00<00:00, 68.22it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.77it/s]
Validation prc-auc = 0.727417
 67% 20/30 [00:09<00:07,  1.32it/s]Epoch 20

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9356e-02, PNorm = 69.3017, GNorm = 0.5078, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 80.68it/s][ALoss = 1.9414e-02, PNorm = 69.3018, GNorm = 0.5143, lr_0 = 1.0000e-04

 74% 17/23 [00:00<00:00, 80.30it/s][ALoss = 1.8956e-02, PNorm = 69.3018, GNorm = 0.3909, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 80.58it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.62it/s]
Validation prc-auc = 0.728326
 70% 21/30 [00:09<00:05,  1.57it/s]Epoch 21

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8643e-02, PNorm = 69.3018, GNorm = 0.4855, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 80.23it/s][A
 74% 17/23 [00:00<00:00, 79.86it/s][ALoss = 1.8938e-02, PNorm = 69.3018, GNorm = 0.5430, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 79.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.09it/s]
Validation prc-auc = 0.730138
 73% 22/30 [00:09<00:04,  1.80it/s]Epoch 22

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9491e-02, PNorm = 69.3019, GNorm = 0.3640, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 80.37it/s][ALoss = 1.8924e-02, PNorm = 69.3019, GNorm = 0.5120, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 80.57it/s][A100% 23/23 [00:00<00:00, 80.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.72it/s]
Validation prc-auc = 0.734381
 77% 23/30 [00:10<00:03,  2.02it/s]Epoch 23

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8532e-02, PNorm = 69.3019, GNorm = 0.3867, lr_0 = 1.0000e-04

 35% 8/23 [00:00<00:00, 72.50it/s][ALoss = 1.9142e-02, PNorm = 69.3019, GNorm = 0.3740, lr_0 = 1.0000e-04

 74% 17/23 [00:00<00:00, 75.38it/s][ALoss = 1.8630e-02, PNorm = 69.3020, GNorm = 0.4620, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 80.45it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.47it/s]
Validation prc-auc = 0.734713
 80% 24/30 [00:10<00:02,  2.20it/s]Epoch 24

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.9095e-02, PNorm = 69.3020, GNorm = 0.4804, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.45it/s][A
 74% 17/23 [00:00<00:00, 83.34it/s][ALoss = 1.8397e-02, PNorm = 69.3020, GNorm = 0.6063, lr_0 = 1.0000e-04

100% 23/23 [00:00<00:00, 46.07it/s][A100% 23/23 [00:00<00:00, 48.09it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 110.74it/s]
Validation prc-auc = 0.735292
 83% 25/30 [00:10<00:02,  2.07it/s]Epoch 25

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8240e-02, PNorm = 69.3021, GNorm = 0.4568, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 88.67it/s][ALoss = 1.9225e-02, PNorm = 69.3021, GNorm = 0.7672, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 89.45it/s][A100% 23/23 [00:00<00:00, 90.23it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.04it/s]
Validation prc-auc = 0.737548
 87% 26/30 [00:11<00:01,  2.29it/s]Epoch 26

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8792e-02, PNorm = 69.3021, GNorm = 0.3613, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 86.31it/s][ALoss = 1.8993e-02, PNorm = 69.3021, GNorm = 0.4683, lr_0 = 1.0000e-04

 83% 19/23 [00:00<00:00, 87.52it/s][ALoss = 1.7947e-02, PNorm = 69.3022, GNorm = 0.5605, lr_0 = 1.0000e-04
100% 23/23 [00:00<00:00, 88.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 79.24it/s]
Validation prc-auc = 0.740393
 90% 27/30 [00:11<00:01,  2.45it/s]Epoch 27

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8346e-02, PNorm = 69.3022, GNorm = 0.5829, lr_0 = 1.0000e-04

 43% 10/23 [00:00<00:00, 97.59it/s][ALoss = 1.8691e-02, PNorm = 69.3022, GNorm = 0.3578, lr_0 = 1.0000e-04

 87% 20/23 [00:00<00:00, 97.87it/s][A100% 23/23 [00:00<00:00, 97.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.24it/s]
Validation prc-auc = 0.741306
 93% 28/30 [00:11<00:00,  2.65it/s]Epoch 28

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.8703e-02, PNorm = 69.3023, GNorm = 0.4009, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 89.73it/s][ALoss = 1.8479e-02, PNorm = 69.3023, GNorm = 0.4308, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 89.34it/s][A100% 23/23 [00:00<00:00, 88.07it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 103.33it/s]
Validation prc-auc = 0.742270
 97% 29/30 [00:12<00:00,  2.74it/s]Epoch 29

  0% 0/23 [00:00<?, ?it/s][ALoss = 1.7503e-02, PNorm = 69.3023, GNorm = 0.4570, lr_0 = 1.0000e-04

 39% 9/23 [00:00<00:00, 85.10it/s][ALoss = 1.8467e-02, PNorm = 69.3024, GNorm = 0.4333, lr_0 = 1.0000e-04

 78% 18/23 [00:00<00:00, 85.46it/s][A100% 23/23 [00:00<00:00, 86.76it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.68it/s]
Validation prc-auc = 0.744130
100% 30/30 [00:12<00:00,  2.82it/s]100% 30/30 [00:12<00:00,  2.37it/s]
Model 0 best validation prc-auc = 0.744130 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 114.52it/s]
Model 0 test prc-auc = 0.621779
Ensemble test prc-auc = 0.621779
5-fold cross validation
Seed 0 ==> test prc-auc = 0.499853
Seed 1 ==> test prc-auc = 0.831539
Seed 2 ==> test prc-auc = 0.286747
Seed 3 ==> test prc-auc = 0.696960
Seed 4 ==> test prc-auc = 0.621779
Overall test prc-auc = 0.587376 +/- 0.184849

wandb: Waiting for W&B process to finish, PID 1267
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                     validation_prc-auc 0.7441299287001331
wandb:                                             _timestamp 1596914656.4109726
wandb:                                                  _step 154
wandb:                                               _runtime 93.31344318389893
wandb:                                           test_prc-auc 0.621778658080097
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.20MB of 0.20MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL1963741_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/8kpw1qw0
