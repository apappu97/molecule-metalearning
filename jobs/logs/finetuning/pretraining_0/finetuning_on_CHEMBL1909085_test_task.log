wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200807_184623-1rhiboza
wandb: Syncing run finetuning_finetuning_on_CHEMBL1909085_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/1rhiboza
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909085 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1909085_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909085_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmp4n_8j26t/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909085'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]922it [00:00, 9218.69it/s]1821it [00:00, 9147.55it/s]2794it [00:00, 9314.47it/s]3747it [00:00, 9376.10it/s]4726it [00:00, 9494.23it/s]5692it [00:00, 9540.62it/s]6633it [00:00, 9500.00it/s]7649it [00:00, 9688.12it/s]8566it [00:00, 8116.94it/s]9458it [00:01, 8342.14it/s]10457it [00:01, 8776.30it/s]11454it [00:01, 9103.03it/s]12453it [00:01, 9350.24it/s]13444it [00:01, 9509.80it/s]14445it [00:01, 9653.49it/s]15425it [00:01, 9696.85it/s]16409it [00:01, 9738.44it/s]17462it [00:01, 9961.23it/s]18562it [00:01, 10249.50it/s]19659it [00:02, 10455.07it/s]20723it [00:02, 10509.32it/s]21799it [00:02, 10581.78it/s]22898it [00:02, 10698.66it/s]24002it [00:02, 10798.78it/s]25108it [00:02, 10873.02it/s]26208it [00:02, 10908.15it/s]27313it [00:02, 10947.72it/s]28422it [00:02, 10989.21it/s]29522it [00:02, 10986.20it/s]30623it [00:03, 10990.70it/s]31723it [00:03, 10986.79it/s]32822it [00:03, 10943.55it/s]33917it [00:03, 10904.76it/s]35008it [00:03, 10864.35it/s]36095it [00:03, 10848.48it/s]37180it [00:03, 10844.55it/s]38280it [00:03, 10888.01it/s]39381it [00:03, 10922.96it/s]40474it [00:03, 10916.88it/s]41566it [00:04, 10855.58it/s]42667it [00:04, 10898.66it/s]43768it [00:04, 10929.99it/s]44874it [00:04, 10966.23it/s]45971it [00:04, 10965.15it/s]47069it [00:04, 10968.04it/s]48166it [00:04, 10905.75it/s]49265it [00:04, 10930.85it/s]50367it [00:04, 10955.58it/s]51474it [00:04, 10988.40it/s]52573it [00:05, 10875.47it/s]53661it [00:05, 10871.43it/s]54749it [00:05, 10867.52it/s]55836it [00:05, 10865.91it/s]56923it [00:05, 10815.64it/s]58025it [00:05, 10874.01it/s]59113it [00:05, 10800.66it/s]60218it [00:05, 10872.68it/s]61306it [00:05, 10605.12it/s]61865it [00:05, 10417.14it/s]
Number of examples remaining: 835
  0% 0/835 [00:00<?, ?it/s]100% 835/835 [00:00<00:00, 45977.50it/s]
  0% 0/835 [00:00<?, ?it/s] 73% 612/835 [00:00<00:00, 6117.34it/s]100% 835/835 [00:00<00:00, 5373.73it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/835 [00:00<?, ?it/s] 67% 557/835 [00:00<00:00, 5561.00it/s]100% 835/835 [00:00<00:00, 4198.93it/s]
Total scaffolds = 490 | train scaffolds = 364 | val scaffolds = 59 | test scaffolds = 67
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.03061224]), array([98])), (array([0.]), array([55])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909085 0: 92.10%, 1: 7.90%
Total size = 835 | train size = 668 | val size = 83 | test size = 84
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][A
  5% 1/21 [00:00<00:03,  5.32it/s][A
 19% 4/21 [00:00<00:02,  6.98it/s][A
 33% 7/21 [00:00<00:01,  9.06it/s][ALoss = 2.2310e-02, PNorm = 64.1483, GNorm = 2.5585, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 11.26it/s][A
 57% 12/21 [00:00<00:00, 10.56it/s][A
 71% 15/21 [00:00<00:00, 12.90it/s][A
 86% 18/21 [00:00<00:00, 15.06it/s][ALoss = 2.0754e-02, PNorm = 64.1483, GNorm = 2.4754, lr_0 = 1.0000e-04
Loss = 2.2760e-02, PNorm = 64.1483, GNorm = 2.3292, lr_0 = 1.0000e-04

100% 21/21 [00:01<00:00, 17.50it/s][A100% 21/21 [00:01<00:00, 19.45it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 34.25it/s]
Validation prc-auc = 0.088350
  3% 1/30 [00:01<00:34,  1.20s/it]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0413e-02, PNorm = 64.1483, GNorm = 1.9451, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.41it/s][ALoss = 1.8886e-02, PNorm = 64.1483, GNorm = 3.0975, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 109.33it/s]
Validation prc-auc = 0.089520
  7% 2/30 [00:01<00:26,  1.07it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][A
 29% 6/21 [00:00<00:00, 59.82it/s][ALoss = 1.8204e-02, PNorm = 64.1483, GNorm = 2.4320, lr_0 = 1.0000e-04

 62% 13/21 [00:00<00:00, 61.88it/s][ALoss = 1.8062e-02, PNorm = 64.1483, GNorm = 1.7843, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 65.49it/s][A100% 21/21 [00:00<00:00, 67.72it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.68it/s]
Validation prc-auc = 0.090429
 10% 3/30 [00:01<00:20,  1.30it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6993e-02, PNorm = 64.1484, GNorm = 2.0239, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 82.31it/s][ALoss = 1.6489e-02, PNorm = 64.1484, GNorm = 2.1050, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 83.91it/s][A100% 21/21 [00:00<00:00, 85.55it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.52it/s]
Validation prc-auc = 0.092153
 13% 4/30 [00:02<00:16,  1.58it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][A
 19% 4/21 [00:00<00:00, 17.75it/s][ALoss = 1.5227e-02, PNorm = 64.1484, GNorm = 1.8716, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 22.50it/s][ALoss = 1.5740e-02, PNorm = 64.1484, GNorm = 1.2716, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 28.25it/s][A100% 21/21 [00:00<00:00, 45.42it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.84it/s]
Validation prc-auc = 0.094362
 17% 5/30 [00:02<00:14,  1.67it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4569e-02, PNorm = 64.1485, GNorm = 1.5783, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.90it/s][ALoss = 1.4023e-02, PNorm = 64.1485, GNorm = 1.6385, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 103.32it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.00it/s]
Validation prc-auc = 0.098228
 20% 6/30 [00:02<00:11,  2.00it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3720e-02, PNorm = 64.1485, GNorm = 1.4064, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.27it/s][ALoss = 1.3956e-02, PNorm = 64.1486, GNorm = 1.2919, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 100.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.93it/s]
Validation prc-auc = 0.103809
 23% 7/30 [00:03<00:09,  2.32it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3350e-02, PNorm = 64.1486, GNorm = 1.5453, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.40it/s][ALoss = 1.3137e-02, PNorm = 64.1486, GNorm = 1.2402, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.10it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 156.09it/s]
Validation prc-auc = 0.108655
 27% 8/30 [00:03<00:08,  2.65it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2127e-02, PNorm = 64.1487, GNorm = 1.2023, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.62it/s][ALoss = 1.2542e-02, PNorm = 64.1487, GNorm = 1.2089, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.16it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 153.99it/s]
Validation prc-auc = 0.116258
 30% 9/30 [00:03<00:07,  2.94it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2436e-02, PNorm = 64.1487, GNorm = 1.0687, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.67it/s][ALoss = 1.1711e-02, PNorm = 64.1488, GNorm = 0.9362, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.51it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 156.24it/s]
Validation prc-auc = 0.124924
 33% 10/30 [00:04<00:06,  3.22it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0784e-02, PNorm = 64.1488, GNorm = 0.8819, lr_0 = 1.0000e-04
Loss = 1.0894e-02, PNorm = 64.1488, GNorm = 0.8390, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.14it/s][A100% 21/21 [00:00<00:00, 113.49it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 154.58it/s]
Validation prc-auc = 0.133870
 37% 11/30 [00:04<00:05,  3.45it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1503e-02, PNorm = 64.1489, GNorm = 0.8148, lr_0 = 1.0000e-04
Loss = 1.0007e-02, PNorm = 64.1489, GNorm = 0.9886, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.87it/s][ALoss = 1.1198e-02, PNorm = 64.1490, GNorm = 1.0186, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.38it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 152.49it/s]
Validation prc-auc = 0.144673
 40% 12/30 [00:04<00:04,  3.63it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0464e-02, PNorm = 64.1490, GNorm = 0.9810, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 104.92it/s][ALoss = 9.7491e-03, PNorm = 64.1490, GNorm = 0.6365, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 154.14it/s]
Validation prc-auc = 0.153592
 43% 13/30 [00:04<00:04,  3.73it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.9739e-03, PNorm = 64.1491, GNorm = 0.7692, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 115.45it/s][ALoss = 9.4790e-03, PNorm = 64.1491, GNorm = 0.8498, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.55it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 157.52it/s]
Validation prc-auc = 0.163943
 47% 14/30 [00:04<00:04,  3.83it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][A
 29% 6/21 [00:00<00:00, 51.43it/s][ALoss = 9.0614e-03, PNorm = 64.1491, GNorm = 0.6436, lr_0 = 1.0000e-04

 62% 13/21 [00:00<00:00, 55.75it/s][ALoss = 1.0074e-02, PNorm = 64.1492, GNorm = 0.7079, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 61.07it/s][A100% 21/21 [00:00<00:00, 65.70it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.35it/s]
Validation prc-auc = 0.175675
 50% 15/30 [00:05<00:04,  3.34it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][A
 29% 6/21 [00:00<00:00, 57.30it/s][ALoss = 9.3751e-03, PNorm = 64.1492, GNorm = 0.7337, lr_0 = 1.0000e-04

 71% 15/21 [00:00<00:00, 64.22it/s][ALoss = 9.9629e-03, PNorm = 64.1493, GNorm = 0.6947, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 80.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.99it/s]
Validation prc-auc = 0.189207
 53% 16/30 [00:05<00:04,  3.26it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.8001e-03, PNorm = 64.1493, GNorm = 0.6904, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 102.96it/s][ALoss = 9.4897e-03, PNorm = 64.1493, GNorm = 0.7327, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 94.51it/s] [A100% 21/21 [00:00<00:00, 92.71it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.99it/s]
Validation prc-auc = 0.204503
 57% 17/30 [00:05<00:03,  3.30it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.6996e-03, PNorm = 64.1494, GNorm = 0.6721, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.65it/s][ALoss = 9.1303e-03, PNorm = 64.1494, GNorm = 0.5215, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.65it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 145.33it/s]
Validation prc-auc = 0.217447
 60% 18/30 [00:06<00:03,  3.47it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.7741e-03, PNorm = 64.1494, GNorm = 0.5468, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 104.49it/s][ALoss = 8.6182e-03, PNorm = 64.1495, GNorm = 0.6201, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.44it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 152.28it/s]
Validation prc-auc = 0.233616
 63% 19/30 [00:06<00:03,  3.60it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.3616e-03, PNorm = 64.1495, GNorm = 0.6166, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.29it/s][ALoss = 9.2538e-03, PNorm = 64.1496, GNorm = 0.6228, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 111.51it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 152.94it/s]
Validation prc-auc = 0.250358
 67% 20/30 [00:06<00:02,  3.35it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0105e-02, PNorm = 64.1496, GNorm = 0.5755, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.94it/s][ALoss = 7.7553e-03, PNorm = 64.1496, GNorm = 0.5451, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.92it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 153.64it/s]
Validation prc-auc = 0.263948
 70% 21/30 [00:07<00:02,  3.51it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0746e-02, PNorm = 64.1497, GNorm = 0.7927, lr_0 = 1.0000e-04
Loss = 8.4828e-03, PNorm = 64.1497, GNorm = 0.5608, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.89it/s][A100% 21/21 [00:00<00:00, 114.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 158.09it/s]
Validation prc-auc = 0.294552
 73% 22/30 [00:07<00:02,  3.62it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 6.2069e-03, PNorm = 64.1497, GNorm = 0.5401, lr_0 = 1.0000e-04
Loss = 7.6442e-03, PNorm = 64.1498, GNorm = 0.5607, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.59it/s][ALoss = 8.7074e-03, PNorm = 64.1498, GNorm = 0.6148, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.81it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 156.71it/s]
Validation prc-auc = 0.310058
 77% 23/30 [00:07<00:01,  3.76it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][A
 33% 7/21 [00:00<00:00, 39.42it/s][ALoss = 8.0573e-03, PNorm = 64.1499, GNorm = 0.6442, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 49.03it/s][ALoss = 7.7806e-03, PNorm = 64.1499, GNorm = 0.5635, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 69.40it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 157.24it/s]
Validation prc-auc = 0.370739
 80% 24/30 [00:07<00:01,  3.41it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.4200e-03, PNorm = 64.1499, GNorm = 0.4861, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 110.48it/s][ALoss = 7.7151e-03, PNorm = 64.1500, GNorm = 0.5262, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 104.66it/s]
Validation prc-auc = 0.395172
 83% 25/30 [00:08<00:01,  3.56it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.7359e-03, PNorm = 64.1500, GNorm = 0.5135, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.35it/s][ALoss = 7.6586e-03, PNorm = 64.1500, GNorm = 0.4571, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.60it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 157.60it/s]
Validation prc-auc = 0.409907
 87% 26/30 [00:08<00:01,  3.66it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.9804e-03, PNorm = 64.1501, GNorm = 0.5180, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.26it/s][ALoss = 6.8743e-03, PNorm = 64.1501, GNorm = 0.6528, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.80it/s][A100% 21/21 [00:00<00:00, 102.70it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.77it/s]
Validation prc-auc = 0.427257
 90% 27/30 [00:08<00:00,  3.69it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.6046e-03, PNorm = 64.1502, GNorm = 0.4776, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.75it/s][ALoss = 7.4614e-03, PNorm = 64.1502, GNorm = 0.5228, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.24it/s][A100% 21/21 [00:00<00:00, 101.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.66it/s]
Validation prc-auc = 0.450715
 93% 28/30 [00:08<00:00,  3.70it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.5412e-03, PNorm = 64.1502, GNorm = 0.4043, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.29it/s][ALoss = 7.5181e-03, PNorm = 64.1503, GNorm = 0.4107, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.82it/s][A100% 21/21 [00:00<00:00, 102.54it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 156.18it/s]
Validation prc-auc = 0.484859
 97% 29/30 [00:09<00:00,  3.73it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.4707e-03, PNorm = 64.1503, GNorm = 0.5568, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 72.51it/s][ALoss = 7.4045e-03, PNorm = 64.1503, GNorm = 0.4723, lr_0 = 1.0000e-04

 71% 15/21 [00:00<00:00, 71.17it/s][A100% 21/21 [00:00<00:00, 77.98it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 144.51it/s]
Validation prc-auc = 0.602640
100% 30/30 [00:09<00:00,  3.49it/s]100% 30/30 [00:09<00:00,  3.13it/s]
Model 0 best validation prc-auc = 0.602640 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 22.78it/s]100% 3/3 [00:00<00:00, 22.75it/s]
Model 0 test prc-auc = 0.109385
Ensemble test prc-auc = 0.109385
Fold 1
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909085 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1909085_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909085_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmp4n_8j26t/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909085'],
 'task_names': ['CHEMBL1909085'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 668,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]453it [00:00, 4527.49it/s]1178it [00:00, 5101.17it/s]2124it [00:00, 5918.70it/s]3029it [00:00, 6603.84it/s]3970it [00:00, 7252.56it/s]4925it [00:00, 7814.66it/s]5892it [00:00, 8290.38it/s]6856it [00:00, 8652.41it/s]7837it [00:00, 8968.65it/s]8773it [00:01, 9080.77it/s]9850it [00:01, 9528.56it/s]10920it [00:01, 9850.74it/s]11992it [00:01, 10094.72it/s]13080it [00:01, 10316.34it/s]14163it [00:01, 10465.12it/s]15246it [00:01, 10570.70it/s]16330it [00:01, 10648.61it/s]17419it [00:01, 10719.46it/s]18503it [00:01, 10753.20it/s]19583it [00:02, 10764.49it/s]20661it [00:02, 10570.86it/s]21745it [00:02, 10648.28it/s]22840it [00:02, 10736.74it/s]23924it [00:02, 10764.48it/s]25011it [00:02, 10794.39it/s]26095it [00:02, 10807.67it/s]27182it [00:02, 10824.90it/s]28268it [00:02, 10834.96it/s]29353it [00:02, 10838.20it/s]30437it [00:03, 10797.29it/s]31517it [00:03, 10757.43it/s]32593it [00:03, 10746.13it/s]33669it [00:03, 10749.35it/s]34748it [00:03, 10760.22it/s]35828it [00:03, 10770.06it/s]36909it [00:03, 10780.23it/s]37988it [00:03, 10768.50it/s]39069it [00:03, 10777.78it/s]40147it [00:03, 10738.35it/s]41221it [00:04, 10670.05it/s]42304it [00:04, 10715.38it/s]43389it [00:04, 10754.17it/s]44471it [00:04, 10771.09it/s]45554it [00:04, 10785.82it/s]46636it [00:04, 10794.11it/s]47716it [00:04, 10786.29it/s]48805it [00:04, 10816.40it/s]49894it [00:04, 10837.83it/s]50984it [00:04, 10855.25it/s]52081it [00:05, 10887.58it/s]53170it [00:05, 10861.79it/s]54257it [00:05, 10810.47it/s]55339it [00:05, 10749.59it/s]56415it [00:05, 10740.58it/s]57499it [00:05, 10767.26it/s]58594it [00:05, 10821.14it/s]59688it [00:05, 10854.98it/s]60783it [00:05, 10881.10it/s]61865it [00:05, 10450.74it/s]
Number of examples remaining: 835
  0% 0/835 [00:00<?, ?it/s]100% 835/835 [00:00<00:00, 347203.71it/s]
  0% 0/835 [00:00<?, ?it/s] 37% 308/835 [00:00<00:00, 3077.74it/s] 83% 696/835 [00:00<00:00, 3278.43it/s]100% 835/835 [00:00<00:00, 3457.88it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/835 [00:00<?, ?it/s] 59% 489/835 [00:00<00:00, 4880.36it/s] 96% 805/835 [00:00<00:00, 4171.11it/s]100% 835/835 [00:00<00:00, 3724.11it/s]
Total scaffolds = 490 | train scaffolds = 372 | val scaffolds = 65 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.03061224]), array([98])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909085 0: 92.10%, 1: 7.90%
Total size = 835 | train size = 668 | val size = 83 | test size = 84
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][A
 38% 8/21 [00:00<00:00, 73.54it/s][ALoss = 2.2284e-02, PNorm = 64.1483, GNorm = 3.0629, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 81.08it/s][ALoss = 2.1410e-02, PNorm = 64.1483, GNorm = 2.1993, lr_0 = 1.0000e-04
Loss = 2.7971e-02, PNorm = 64.1483, GNorm = 3.7921, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 90.93it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 151.04it/s]
Validation prc-auc = 0.025331
  3% 1/30 [00:00<00:08,  3.47it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0553e-02, PNorm = 64.1483, GNorm = 2.2197, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 110.89it/s][ALoss = 1.9677e-02, PNorm = 64.1483, GNorm = 2.2759, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.12it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 149.19it/s]
Validation prc-auc = 0.027060
  7% 2/30 [00:00<00:07,  3.64it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8848e-02, PNorm = 64.1483, GNorm = 1.7096, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.48it/s][ALoss = 1.8078e-02, PNorm = 64.1483, GNorm = 1.8664, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 153.13it/s]
Validation prc-auc = 0.028946
 10% 3/30 [00:00<00:07,  3.77it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7807e-02, PNorm = 64.1484, GNorm = 1.5537, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.83it/s][ALoss = 1.6747e-02, PNorm = 64.1484, GNorm = 1.6371, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.26it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 152.70it/s]
Validation prc-auc = 0.031390
 13% 4/30 [00:01<00:06,  3.88it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.6355e-02, PNorm = 64.1484, GNorm = 1.7908, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 102.41it/s][ALoss = 1.5484e-02, PNorm = 64.1484, GNorm = 1.4713, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.58it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 148.68it/s]
Validation prc-auc = 0.036568
 17% 5/30 [00:01<00:06,  3.88it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5285e-02, PNorm = 64.1485, GNorm = 1.5972, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.55it/s][ALoss = 1.5006e-02, PNorm = 64.1485, GNorm = 1.6135, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.76it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 151.39it/s]
Validation prc-auc = 0.041030
 20% 6/30 [00:01<00:07,  3.29it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4567e-02, PNorm = 64.1485, GNorm = 1.2561, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.38it/s][ALoss = 1.4088e-02, PNorm = 64.1486, GNorm = 1.1473, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 111.76it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.06it/s]
Validation prc-auc = 0.051383
 23% 7/30 [00:01<00:06,  3.48it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3768e-02, PNorm = 64.1486, GNorm = 1.2083, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.61it/s][ALoss = 1.3185e-02, PNorm = 64.1486, GNorm = 1.1189, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 151.02it/s]
Validation prc-auc = 0.060286
 27% 8/30 [00:02<00:06,  3.64it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3663e-02, PNorm = 64.1487, GNorm = 1.2551, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.66it/s][ALoss = 1.2148e-02, PNorm = 64.1487, GNorm = 1.0660, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.56it/s][A100% 21/21 [00:00<00:00, 102.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.99it/s]
Validation prc-auc = 0.075622
 30% 9/30 [00:02<00:05,  3.67it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2504e-02, PNorm = 64.1487, GNorm = 1.2800, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.73it/s][ALoss = 1.1847e-02, PNorm = 64.1488, GNorm = 1.0752, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.98it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 150.00it/s]
Validation prc-auc = 0.090823
 33% 10/30 [00:02<00:05,  3.73it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2781e-02, PNorm = 64.1488, GNorm = 0.8232, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.03it/s][ALoss = 1.1104e-02, PNorm = 64.1488, GNorm = 1.3840, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 110.01it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 149.28it/s]
Validation prc-auc = 0.093775
 37% 11/30 [00:02<00:04,  3.81it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3233e-02, PNorm = 64.1489, GNorm = 0.7659, lr_0 = 1.0000e-04
Loss = 1.1017e-02, PNorm = 64.1489, GNorm = 0.9525, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.34it/s][ALoss = 1.1167e-02, PNorm = 64.1490, GNorm = 0.9366, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 111.89it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 149.78it/s]
Validation prc-auc = 0.097797
 40% 12/30 [00:03<00:04,  3.87it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0779e-02, PNorm = 64.1490, GNorm = 0.8125, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 108.73it/s][ALoss = 1.1053e-02, PNorm = 64.1490, GNorm = 0.7741, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 148.18it/s]
Validation prc-auc = 0.102565
 43% 13/30 [00:03<00:04,  3.86it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1256e-02, PNorm = 64.1491, GNorm = 0.7197, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.53it/s][ALoss = 9.7536e-03, PNorm = 64.1491, GNorm = 0.6923, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 111.47it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 142.45it/s]
Validation prc-auc = 0.107535
 47% 14/30 [00:03<00:04,  3.74it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.7283e-03, PNorm = 64.1491, GNorm = 0.8024, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 75.40it/s][ALoss = 1.0489e-02, PNorm = 64.1492, GNorm = 0.5638, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 81.18it/s][A100% 21/21 [00:00<00:00, 88.91it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.93it/s]
Validation prc-auc = 0.110730
 50% 15/30 [00:04<00:04,  3.55it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0396e-02, PNorm = 64.1492, GNorm = 0.8401, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.74it/s][ALoss = 9.6665e-03, PNorm = 64.1493, GNorm = 0.6821, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.03it/s][A100% 21/21 [00:00<00:00, 96.97it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.52it/s]
Validation prc-auc = 0.124692
 53% 16/30 [00:04<00:03,  3.56it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.7473e-03, PNorm = 64.1493, GNorm = 0.6022, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.38it/s][ALoss = 9.8062e-03, PNorm = 64.1493, GNorm = 0.8123, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.32it/s][A100% 21/21 [00:00<00:00, 96.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 142.19it/s]
Validation prc-auc = 0.159992
 57% 17/30 [00:04<00:03,  3.57it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.0630e-03, PNorm = 64.1494, GNorm = 0.6202, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.77it/s][ALoss = 9.8760e-03, PNorm = 64.1494, GNorm = 0.5982, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.00it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.11it/s]
Validation prc-auc = 0.411563
 60% 18/30 [00:04<00:03,  3.64it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0216e-02, PNorm = 64.1494, GNorm = 0.6476, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 100.14it/s][ALoss = 9.2040e-03, PNorm = 64.1495, GNorm = 0.8207, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 102.21it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 148.94it/s]
Validation prc-auc = 0.417581
 63% 19/30 [00:05<00:03,  3.51it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.0301e-03, PNorm = 64.1495, GNorm = 0.6203, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 73.63it/s][ALoss = 9.8371e-03, PNorm = 64.1495, GNorm = 0.6750, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 78.30it/s][A100% 21/21 [00:00<00:00, 85.22it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 135.53it/s]
Validation prc-auc = 0.427956
 67% 20/30 [00:05<00:02,  3.42it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0785e-02, PNorm = 64.1496, GNorm = 0.4906, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.08it/s][ALoss = 9.1000e-03, PNorm = 64.1496, GNorm = 0.5724, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 95.38it/s][A100% 21/21 [00:00<00:00, 94.69it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 136.48it/s]
Validation prc-auc = 0.431374
 70% 21/30 [00:05<00:02,  3.44it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0224e-02, PNorm = 64.1497, GNorm = 0.6210, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 97.80it/s][ALoss = 8.4730e-03, PNorm = 64.1497, GNorm = 0.4939, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.85it/s][A100% 21/21 [00:00<00:00, 97.80it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.61it/s]
Validation prc-auc = 0.441353
 73% 22/30 [00:06<00:02,  3.50it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0176e-02, PNorm = 64.1497, GNorm = 0.4836, lr_0 = 1.0000e-04
Loss = 8.9535e-03, PNorm = 64.1498, GNorm = 0.5370, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.48it/s][ALoss = 8.1979e-03, PNorm = 64.1498, GNorm = 0.5495, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.84it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 149.30it/s]
Validation prc-auc = 0.452282
 77% 23/30 [00:06<00:01,  3.63it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.4038e-03, PNorm = 64.1498, GNorm = 0.5004, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.50it/s][ALoss = 8.5755e-03, PNorm = 64.1499, GNorm = 0.6897, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 105.36it/s]

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  6.11it/s][A100% 3/3 [00:00<00:00, 17.04it/s]
Validation prc-auc = 0.470085
 80% 24/30 [00:06<00:01,  3.15it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.1808e-03, PNorm = 64.1499, GNorm = 0.5288, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.38it/s][ALoss = 7.8823e-03, PNorm = 64.1500, GNorm = 0.6127, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.33it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 94.78it/s]
Validation prc-auc = 0.501010
 83% 25/30 [00:07<00:01,  3.26it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.2747e-03, PNorm = 64.1500, GNorm = 0.6734, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.44it/s][ALoss = 8.4019e-03, PNorm = 64.1500, GNorm = 0.4918, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 109.74it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 152.32it/s]
Validation prc-auc = 0.509259
 87% 26/30 [00:07<00:01,  3.46it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.4387e-03, PNorm = 64.1501, GNorm = 0.4016, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.23it/s][ALoss = 8.1979e-03, PNorm = 64.1501, GNorm = 0.4278, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 109.00it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 149.95it/s]
Validation prc-auc = 0.519444
 90% 27/30 [00:07<00:00,  3.60it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.5104e-03, PNorm = 64.1501, GNorm = 0.5625, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.74it/s][ALoss = 7.9852e-03, PNorm = 64.1502, GNorm = 0.4641, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.79it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 151.23it/s]
Validation prc-auc = 0.551786
 93% 28/30 [00:07<00:00,  3.70it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.1384e-03, PNorm = 64.1502, GNorm = 0.5176, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.20it/s][ALoss = 7.1576e-03, PNorm = 64.1503, GNorm = 0.4636, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.48it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 146.97it/s]
Validation prc-auc = 0.599206
 97% 29/30 [00:08<00:00,  3.76it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 5.8096e-03, PNorm = 64.1503, GNorm = 0.4720, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.40it/s][ALoss = 8.3215e-03, PNorm = 64.1503, GNorm = 0.4515, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 101.04it/s][A100% 21/21 [00:00<00:00, 103.02it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 146.50it/s]
Validation prc-auc = 0.599206
100% 30/30 [00:08<00:00,  3.92it/s]100% 30/30 [00:08<00:00,  3.64it/s]
Model 0 best validation prc-auc = 0.599206 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 129.97it/s]
Model 0 test prc-auc = 0.344455
Ensemble test prc-auc = 0.344455
Fold 2
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909085 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1909085_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909085_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmp4n_8j26t/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909085'],
 'task_names': ['CHEMBL1909085'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 668,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]971it [00:00, 9703.25it/s]1983it [00:00, 9824.62it/s]2952it [00:00, 9783.78it/s]3959it [00:00, 9865.23it/s]4984it [00:00, 9976.40it/s]6028it [00:00, 10109.05it/s]7074it [00:00, 10211.54it/s]8123it [00:00, 10291.69it/s]9121it [00:00, 10193.48it/s]10181it [00:01, 10309.75it/s]11245it [00:01, 10404.07it/s]12268it [00:01, 10341.41it/s]13290it [00:01, 10298.72it/s]14316it [00:01, 10284.35it/s]15344it [00:01, 10282.79it/s]16383it [00:01, 10313.72it/s]17426it [00:01, 10345.93it/s]18484it [00:01, 10412.48it/s]19535it [00:01, 10439.33it/s]20578it [00:02, 10283.23it/s]21631it [00:02, 10353.60it/s]22692it [00:02, 10426.44it/s]23753it [00:02, 10479.65it/s]24815it [00:02, 10520.75it/s]25879it [00:02, 10555.24it/s]26943it [00:02, 10579.12it/s]28002it [00:02, 10530.54it/s]29069it [00:02, 10571.76it/s]30127it [00:02, 10559.59it/s]31189it [00:03, 10577.22it/s]32251it [00:03, 10588.42it/s]33310it [00:03, 10522.40it/s]34363it [00:03, 10387.90it/s]35403it [00:03, 10276.44it/s]36432it [00:03, 10258.78it/s]37466it [00:03, 10281.98it/s]38495it [00:03, 10279.61it/s]39534it [00:03, 10311.69it/s]40576it [00:03, 10342.20it/s]41611it [00:04, 10340.01it/s]42665it [00:04, 10396.46it/s]43705it [00:04, 10391.88it/s]44757it [00:04, 10427.72it/s]45810it [00:04, 10455.37it/s]46860it [00:04, 10467.66it/s]47911it [00:04, 10479.95it/s]48968it [00:04, 10504.89it/s]50025it [00:04, 10523.08it/s]51078it [00:04, 10504.08it/s]52141it [00:05, 10539.14it/s]53195it [00:05, 10538.54it/s]54249it [00:05, 10501.43it/s]55300it [00:05, 10485.73it/s]56349it [00:05, 10483.30it/s]57407it [00:05, 10509.51it/s]58475it [00:05, 10557.32it/s]59539it [00:05, 10580.98it/s]60598it [00:05, 10560.54it/s]61655it [00:05, 10549.97it/s]61865it [00:05, 10404.62it/s]
Number of examples remaining: 835
  0% 0/835 [00:00<?, ?it/s]100% 835/835 [00:00<00:00, 244399.43it/s]
  0% 0/835 [00:00<?, ?it/s] 71% 597/835 [00:00<00:00, 5957.95it/s]100% 835/835 [00:00<00:00, 5198.13it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/835 [00:00<?, ?it/s] 65% 539/835 [00:00<00:00, 5352.58it/s]100% 832/835 [00:00<00:00, 4225.44it/s]100% 835/835 [00:00<00:00, 4037.56it/s]
Total scaffolds = 490 | train scaffolds = 367 | val scaffolds = 65 | test scaffolds = 58
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.03061224]), array([98])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909085 0: 92.10%, 1: 7.90%
Total size = 835 | train size = 668 | val size = 83 | test size = 84
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.2341e-02, PNorm = 64.1483, GNorm = 2.1156, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 95.29it/s][ALoss = 2.1446e-02, PNorm = 64.1483, GNorm = 1.7348, lr_0 = 1.0000e-04
Loss = 2.2728e-02, PNorm = 64.1483, GNorm = 2.4850, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.68it/s][A100% 21/21 [00:00<00:00, 101.30it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 133.77it/s]
Validation prc-auc = 0.061125
  3% 1/30 [00:00<00:07,  3.74it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0037e-02, PNorm = 64.1483, GNorm = 2.6985, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.14it/s][ALoss = 1.9642e-02, PNorm = 64.1483, GNorm = 2.5602, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 115.04it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.23it/s]
Validation prc-auc = 0.065879
  7% 2/30 [00:00<00:07,  3.84it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8571e-02, PNorm = 64.1483, GNorm = 2.2080, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.23it/s][ALoss = 1.8205e-02, PNorm = 64.1483, GNorm = 2.0749, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 142.56it/s]
Validation prc-auc = 0.073897
 10% 3/30 [00:00<00:06,  3.93it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7042e-02, PNorm = 64.1484, GNorm = 1.7553, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.90it/s][ALoss = 1.6582e-02, PNorm = 64.1484, GNorm = 1.8245, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 115.22it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.77it/s]
Validation prc-auc = 0.080633
 13% 4/30 [00:00<00:06,  3.99it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5903e-02, PNorm = 64.1484, GNorm = 1.3840, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 104.31it/s][ALoss = 1.5865e-02, PNorm = 64.1484, GNorm = 1.9138, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.49it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.30it/s]
Validation prc-auc = 0.089515
 17% 5/30 [00:01<00:06,  3.96it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4520e-02, PNorm = 64.1485, GNorm = 1.7870, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 115.97it/s][ALoss = 1.4377e-02, PNorm = 64.1485, GNorm = 1.6976, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.98it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.46it/s]
Validation prc-auc = 0.099630
 20% 6/30 [00:01<00:05,  4.01it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4464e-02, PNorm = 64.1485, GNorm = 1.6160, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.65it/s][ALoss = 1.3656e-02, PNorm = 64.1486, GNorm = 1.5218, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 115.32it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.70it/s]
Validation prc-auc = 0.112989
 23% 7/30 [00:01<00:05,  4.05it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3377e-02, PNorm = 64.1486, GNorm = 1.2339, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.51it/s][ALoss = 1.3283e-02, PNorm = 64.1486, GNorm = 0.9559, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.53it/s]
Validation prc-auc = 0.124728
 27% 8/30 [00:01<00:05,  4.07it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3806e-02, PNorm = 64.1486, GNorm = 1.1761, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 104.13it/s][ALoss = 1.2245e-02, PNorm = 64.1487, GNorm = 1.3099, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.64it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.69it/s]
Validation prc-auc = 0.134116
 30% 9/30 [00:02<00:05,  4.03it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2697e-02, PNorm = 64.1487, GNorm = 1.1188, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.42it/s][ALoss = 1.1726e-02, PNorm = 64.1488, GNorm = 0.9618, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.66it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.96it/s]
Validation prc-auc = 0.139709
 33% 10/30 [00:02<00:04,  4.05it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3695e-02, PNorm = 64.1488, GNorm = 0.9797, lr_0 = 1.0000e-04
Loss = 1.1729e-02, PNorm = 64.1488, GNorm = 1.1004, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.58it/s][A100% 21/21 [00:00<00:00, 115.96it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 142.94it/s]
Validation prc-auc = 0.151264
 37% 11/30 [00:02<00:04,  4.08it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1093e-02, PNorm = 64.1489, GNorm = 1.2065, lr_0 = 1.0000e-04
Loss = 1.1492e-02, PNorm = 64.1489, GNorm = 1.0260, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.54it/s][ALoss = 1.0937e-02, PNorm = 64.1489, GNorm = 0.9193, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.30it/s]

  0% 0/3 [00:00<?, ?it/s][A
 33% 1/3 [00:00<00:00,  5.23it/s][A100% 3/3 [00:00<00:00, 14.58it/s]
Validation prc-auc = 0.167939
 40% 12/30 [00:03<00:05,  3.34it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0813e-02, PNorm = 64.1490, GNorm = 0.8577, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 105.17it/s][ALoss = 1.0647e-02, PNorm = 64.1490, GNorm = 0.8237, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.13it/s]
Validation prc-auc = 0.174382
 43% 13/30 [00:03<00:04,  3.49it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0375e-02, PNorm = 64.1491, GNorm = 0.9161, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.76it/s][ALoss = 1.0640e-02, PNorm = 64.1491, GNorm = 0.6257, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.63it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.84it/s]
Validation prc-auc = 0.196260
 47% 14/30 [00:03<00:04,  3.65it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0144e-02, PNorm = 64.1491, GNorm = 0.7887, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.68it/s][ALoss = 1.0708e-02, PNorm = 64.1492, GNorm = 0.7847, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.59it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.89it/s]
Validation prc-auc = 0.201975
 50% 15/30 [00:03<00:03,  3.77it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0821e-02, PNorm = 64.1492, GNorm = 0.5911, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.40it/s][ALoss = 9.2726e-03, PNorm = 64.1492, GNorm = 0.6749, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.88it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.10it/s]
Validation prc-auc = 0.210800
 53% 16/30 [00:04<00:03,  3.87it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.9135e-03, PNorm = 64.1493, GNorm = 0.6985, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 109.22it/s][ALoss = 1.0347e-02, PNorm = 64.1493, GNorm = 0.6541, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 103.46it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.98it/s]
Validation prc-auc = 0.219362
 57% 17/30 [00:04<00:03,  3.84it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0269e-02, PNorm = 64.1494, GNorm = 0.6274, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.32it/s][ALoss = 9.2329e-03, PNorm = 64.1494, GNorm = 0.6822, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 111.35it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.34it/s]
Validation prc-auc = 0.219362
 60% 18/30 [00:04<00:02,  4.05it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.0427e-03, PNorm = 64.1494, GNorm = 0.7697, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.42it/s][ALoss = 9.0448e-03, PNorm = 64.1495, GNorm = 0.6411, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.59it/s]
Validation prc-auc = 0.228164
 63% 19/30 [00:04<00:02,  4.07it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.4011e-03, PNorm = 64.1495, GNorm = 0.7033, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.90it/s][ALoss = 9.1502e-03, PNorm = 64.1496, GNorm = 0.6521, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.86it/s]
Validation prc-auc = 0.229240
 67% 20/30 [00:05<00:02,  4.07it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.3882e-03, PNorm = 64.1496, GNorm = 0.5770, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.32it/s][ALoss = 8.2525e-03, PNorm = 64.1496, GNorm = 0.6495, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.92it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 133.62it/s]
Validation prc-auc = 0.249601
 70% 21/30 [00:05<00:02,  4.00it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.5182e-03, PNorm = 64.1497, GNorm = 0.5268, lr_0 = 1.0000e-04
Loss = 8.4541e-03, PNorm = 64.1497, GNorm = 0.5002, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 110.18it/s][A100% 21/21 [00:00<00:00, 111.68it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.13it/s]
Validation prc-auc = 0.253727
 73% 22/30 [00:05<00:02,  3.90it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0574e-02, PNorm = 64.1497, GNorm = 0.4961, lr_0 = 1.0000e-04
Loss = 7.5585e-03, PNorm = 64.1498, GNorm = 0.5278, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.33it/s][ALoss = 9.2511e-03, PNorm = 64.1498, GNorm = 0.6752, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.40it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.04it/s]
Validation prc-auc = 0.261547
 77% 23/30 [00:05<00:01,  3.96it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.3501e-03, PNorm = 64.1498, GNorm = 0.4666, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 115.35it/s][ALoss = 8.5452e-03, PNorm = 64.1499, GNorm = 0.5722, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.17it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.36it/s]
Validation prc-auc = 0.282830
 80% 24/30 [00:06<00:01,  3.99it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.7104e-03, PNorm = 64.1499, GNorm = 0.5505, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 116.77it/s][ALoss = 8.2822e-03, PNorm = 64.1499, GNorm = 0.5798, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 98.37it/s]
Validation prc-auc = 0.296469
 83% 25/30 [00:06<00:01,  3.97it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.3595e-03, PNorm = 64.1500, GNorm = 0.5453, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.39it/s][ALoss = 8.4466e-03, PNorm = 64.1500, GNorm = 0.4423, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.11it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.18it/s]
Validation prc-auc = 0.304716
 87% 26/30 [00:06<00:01,  3.99it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.1888e-03, PNorm = 64.1501, GNorm = 0.4790, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.85it/s][ALoss = 8.0862e-03, PNorm = 64.1501, GNorm = 0.5115, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.22it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.77it/s]
Validation prc-auc = 0.327622
 90% 27/30 [00:06<00:00,  4.02it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.5992e-03, PNorm = 64.1501, GNorm = 0.6881, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 114.05it/s][ALoss = 8.0188e-03, PNorm = 64.1502, GNorm = 0.5362, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 114.58it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 141.14it/s]
Validation prc-auc = 0.343748
 93% 28/30 [00:07<00:00,  4.05it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.6295e-03, PNorm = 64.1502, GNorm = 0.5693, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.40it/s][ALoss = 7.3992e-03, PNorm = 64.1502, GNorm = 0.3994, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.83it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 136.74it/s]
Validation prc-auc = 0.388903
 97% 29/30 [00:07<00:00,  4.04it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.1877e-03, PNorm = 64.1503, GNorm = 0.4449, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.52it/s][ALoss = 7.6796e-03, PNorm = 64.1503, GNorm = 0.3832, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.05it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.53it/s]
Validation prc-auc = 0.395454
100% 30/30 [00:07<00:00,  3.99it/s]100% 30/30 [00:07<00:00,  3.94it/s]
Model 0 best validation prc-auc = 0.395454 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 118.19it/s]
Model 0 test prc-auc = 0.497112
Ensemble test prc-auc = 0.497112
Fold 3
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909085 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1909085_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909085_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmp4n_8j26t/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909085'],
 'task_names': ['CHEMBL1909085'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 668,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]459it [00:00, 4586.14it/s]1195it [00:00, 5169.32it/s]2082it [00:00, 5908.17it/s]2935it [00:00, 6507.65it/s]3851it [00:00, 7126.43it/s]4781it [00:00, 7663.77it/s]5720it [00:00, 8110.40it/s]6645it [00:00, 8420.74it/s]7579it [00:00, 8674.79it/s]8482it [00:01, 8778.35it/s]9524it [00:01, 9213.43it/s]10571it [00:01, 9555.96it/s]11557it [00:01, 9644.29it/s]12602it [00:01, 9872.24it/s]13654it [00:01, 10056.21it/s]14700it [00:01, 10172.07it/s]15753it [00:01, 10274.42it/s]16784it [00:01, 10265.97it/s]17831it [00:01, 10325.20it/s]18886it [00:02, 10391.32it/s]19939it [00:02, 10431.18it/s]20989it [00:02, 10449.67it/s]22035it [00:02, 10450.98it/s]23088it [00:02, 10474.15it/s]24141it [00:02, 10487.99it/s]25195it [00:02, 10503.24it/s]26247it [00:02, 10507.01it/s]27300it [00:02, 10512.10it/s]28352it [00:02, 10477.34it/s]29400it [00:03, 10476.10it/s]30449it [00:03, 10479.96it/s]31502it [00:03, 10493.79it/s]32552it [00:03, 10478.08it/s]33600it [00:03, 10436.80it/s]34644it [00:03, 10410.23it/s]35686it [00:03, 10392.70it/s]36732it [00:03, 10412.08it/s]37781it [00:03, 10435.29it/s]38847it [00:03, 10501.51it/s]39913it [00:04, 10547.51it/s]40978it [00:04, 10578.05it/s]42036it [00:04, 10574.60it/s]43096it [00:04, 10580.56it/s]44155it [00:04, 10582.65it/s]45215it [00:04, 10586.16it/s]46279it [00:04, 10601.55it/s]47340it [00:04, 10537.97it/s]48394it [00:04, 10439.95it/s]49439it [00:04, 10349.99it/s]50475it [00:05, 10197.17it/s]51539it [00:05, 10325.85it/s]52603it [00:05, 10417.09it/s]53646it [00:05, 10374.43it/s]54685it [00:05, 10374.92it/s]55727it [00:05, 10386.39it/s]56778it [00:05, 10420.43it/s]57838it [00:05, 10473.63it/s]58889it [00:05, 10482.45it/s]59956it [00:05, 10537.16it/s]61024it [00:06, 10577.42it/s]61865it [00:06, 10139.31it/s]
Number of examples remaining: 835
  0% 0/835 [00:00<?, ?it/s]100% 835/835 [00:00<00:00, 280695.99it/s]
  0% 0/835 [00:00<?, ?it/s] 72% 603/835 [00:00<00:00, 6029.56it/s]100% 835/835 [00:00<00:00, 5276.21it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/835 [00:00<?, ?it/s] 65% 546/835 [00:00<00:00, 5454.82it/s]100% 833/835 [00:00<00:00, 4283.22it/s]100% 835/835 [00:00<00:00, 4148.73it/s]
Total scaffolds = 490 | train scaffolds = 376 | val scaffolds = 54 | test scaffolds = 60
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.03061224]), array([98])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1909085 0: 92.10%, 1: 7.90%
Total size = 835 | train size = 668 | val size = 83 | test size = 84
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][A
 10% 2/21 [00:00<00:03,  5.86it/s][ALoss = 2.2645e-02, PNorm = 64.1483, GNorm = 2.1956, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:01,  8.15it/s][ALoss = 2.1905e-02, PNorm = 64.1483, GNorm = 2.8243, lr_0 = 1.0000e-04
Loss = 2.4034e-02, PNorm = 64.1483, GNorm = 1.8927, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 38.37it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 120.43it/s]
Validation prc-auc = 0.020194
  3% 1/30 [00:00<00:17,  1.62it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 2.0539e-02, PNorm = 64.1483, GNorm = 3.3814, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 91.34it/s][ALoss = 1.9763e-02, PNorm = 64.1483, GNorm = 3.1017, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.47it/s][A100% 21/21 [00:00<00:00, 93.46it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.02it/s]
Validation prc-auc = 0.022046
  7% 2/30 [00:00<00:14,  1.90it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8776e-02, PNorm = 64.1483, GNorm = 1.9402, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 92.62it/s][ALoss = 1.8523e-02, PNorm = 64.1483, GNorm = 1.7271, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 92.76it/s][A100% 21/21 [00:00<00:00, 93.13it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 120.52it/s]
Validation prc-auc = 0.023800
 10% 3/30 [00:01<00:12,  2.19it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7615e-02, PNorm = 64.1484, GNorm = 1.9987, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 93.62it/s][ALoss = 1.6967e-02, PNorm = 64.1484, GNorm = 1.3822, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 93.63it/s][A100% 21/21 [00:00<00:00, 93.40it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 121.46it/s]
Validation prc-auc = 0.025722
 13% 4/30 [00:01<00:10,  2.45it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5899e-02, PNorm = 64.1484, GNorm = 1.5306, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 85.16it/s][ALoss = 1.6225e-02, PNorm = 64.1484, GNorm = 1.4813, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 88.80it/s][A100% 21/21 [00:00<00:00, 92.98it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 83.38it/s]
Validation prc-auc = 0.027262
 17% 5/30 [00:01<00:09,  2.64it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5412e-02, PNorm = 64.1485, GNorm = 1.7074, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 83.41it/s][ALoss = 1.4937e-02, PNorm = 64.1485, GNorm = 1.3417, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 83.74it/s][A100% 21/21 [00:00<00:00, 84.73it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.44it/s]
Validation prc-auc = 0.029816
 20% 6/30 [00:02<00:08,  2.77it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4569e-02, PNorm = 64.1485, GNorm = 1.2647, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 81.80it/s][ALoss = 1.4579e-02, PNorm = 64.1485, GNorm = 1.1629, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 83.09it/s][A100% 21/21 [00:00<00:00, 84.51it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.56it/s]
Validation prc-auc = 0.034869
 23% 7/30 [00:02<00:08,  2.87it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4044e-02, PNorm = 64.1486, GNorm = 1.3045, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 84.88it/s][ALoss = 1.3387e-02, PNorm = 64.1486, GNorm = 0.9238, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 84.89it/s][A100% 21/21 [00:00<00:00, 85.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.37it/s]
Validation prc-auc = 0.036853
 27% 8/30 [00:02<00:07,  2.95it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3944e-02, PNorm = 64.1486, GNorm = 0.8773, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 72.41it/s][ALoss = 1.2330e-02, PNorm = 64.1487, GNorm = 1.1504, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 74.85it/s][A100% 21/21 [00:00<00:00, 78.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 111.12it/s]
Validation prc-auc = 0.045991
 30% 9/30 [00:03<00:07,  2.95it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2390e-02, PNorm = 64.1487, GNorm = 1.1265, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 89.55it/s][ALoss = 1.2604e-02, PNorm = 64.1487, GNorm = 1.4091, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 90.69it/s][A100% 21/21 [00:00<00:00, 92.32it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.62it/s]
Validation prc-auc = 0.052334
 33% 10/30 [00:03<00:06,  3.07it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2657e-02, PNorm = 64.1488, GNorm = 0.9396, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 94.61it/s][ALoss = 1.2344e-02, PNorm = 64.1488, GNorm = 0.9615, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 95.30it/s][A100% 21/21 [00:00<00:00, 95.92it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.30it/s]
Validation prc-auc = 0.057143
 37% 11/30 [00:03<00:05,  3.20it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0778e-02, PNorm = 64.1489, GNorm = 1.0856, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 93.35it/s][ALoss = 1.1977e-02, PNorm = 64.1489, GNorm = 1.0678, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 93.97it/s][ALoss = 1.1339e-02, PNorm = 64.1489, GNorm = 0.8733, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 94.51it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.48it/s]
Validation prc-auc = 0.063317
 40% 12/30 [00:03<00:05,  3.28it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1322e-02, PNorm = 64.1490, GNorm = 0.7832, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 92.32it/s][A
 90% 19/21 [00:00<00:00, 89.80it/s][ALoss = 1.0796e-02, PNorm = 64.1490, GNorm = 0.8195, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 89.57it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 94.39it/s]
Validation prc-auc = 0.063317
 43% 13/30 [00:04<00:05,  3.37it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0552e-02, PNorm = 64.1490, GNorm = 0.8264, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.94it/s][ALoss = 1.1113e-02, PNorm = 64.1491, GNorm = 0.6047, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 98.16it/s][A100% 21/21 [00:00<00:00, 99.01it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.24it/s]
Validation prc-auc = 0.073918
 47% 14/30 [00:04<00:04,  3.43it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1212e-02, PNorm = 64.1491, GNorm = 0.7329, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.61it/s][ALoss = 1.0065e-02, PNorm = 64.1491, GNorm = 0.8233, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.06it/s][A100% 21/21 [00:00<00:00, 97.07it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.14it/s]
Validation prc-auc = 0.077672
 50% 15/30 [00:04<00:04,  3.46it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1481e-02, PNorm = 64.1492, GNorm = 0.7630, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.34it/s][ALoss = 1.0134e-02, PNorm = 64.1492, GNorm = 0.6684, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 99.05it/s][A100% 21/21 [00:00<00:00, 100.27it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 124.79it/s]
Validation prc-auc = 0.087073
 53% 16/30 [00:05<00:04,  3.50it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0275e-02, PNorm = 64.1492, GNorm = 0.7432, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 104.54it/s][ALoss = 9.9066e-03, PNorm = 64.1493, GNorm = 0.5366, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 102.83it/s][A100% 21/21 [00:00<00:00, 101.78it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.17it/s]
Validation prc-auc = 0.098232
 57% 17/30 [00:05<00:03,  3.56it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.7252e-03, PNorm = 64.1493, GNorm = 0.5259, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.71it/s][ALoss = 9.7804e-03, PNorm = 64.1494, GNorm = 0.7973, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.33it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.48it/s]
Validation prc-auc = 0.105556
 60% 18/30 [00:05<00:03,  3.38it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.5017e-03, PNorm = 64.1494, GNorm = 0.6200, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 87.62it/s][ALoss = 9.6551e-03, PNorm = 64.1494, GNorm = 0.6839, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 64.43it/s][A100% 21/21 [00:00<00:00, 61.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.61it/s]
Validation prc-auc = 0.105556
 63% 19/30 [00:06<00:03,  3.14it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.3246e-03, PNorm = 64.1495, GNorm = 0.4218, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.48it/s][ALoss = 9.7549e-03, PNorm = 64.1495, GNorm = 0.5790, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.08it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 140.51it/s]
Validation prc-auc = 0.105556
 67% 20/30 [00:06<00:02,  3.45it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 6.8461e-03, PNorm = 64.1495, GNorm = 0.6325, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.95it/s][ALoss = 9.8048e-03, PNorm = 64.1496, GNorm = 0.7274, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 105.37it/s][A100% 21/21 [00:00<00:00, 103.83it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 136.99it/s]
Validation prc-auc = 0.109028
 70% 21/30 [00:06<00:02,  3.54it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1878e-02, PNorm = 64.1496, GNorm = 0.5662, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 105.52it/s][ALoss = 8.8740e-03, PNorm = 64.1496, GNorm = 0.6009, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 103.93it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 130.58it/s]
Validation prc-auc = 0.118056
 73% 22/30 [00:06<00:02,  3.43it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.6519e-03, PNorm = 64.1497, GNorm = 0.5508, lr_0 = 1.0000e-04

 38% 8/21 [00:00<00:00, 76.96it/s][ALoss = 9.4066e-03, PNorm = 64.1497, GNorm = 0.5319, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 82.15it/s][ALoss = 8.8988e-03, PNorm = 64.1498, GNorm = 0.5705, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 89.10it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 128.00it/s]
Validation prc-auc = 0.122520
 77% 23/30 [00:07<00:02,  3.24it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][A
 33% 7/21 [00:00<00:00, 66.69it/s][ALoss = 9.1396e-03, PNorm = 64.1498, GNorm = 0.6255, lr_0 = 1.0000e-04

 76% 16/21 [00:00<00:00, 71.84it/s][ALoss = 8.7326e-03, PNorm = 64.1498, GNorm = 0.5227, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 80.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 123.03it/s]
Validation prc-auc = 0.122520
 80% 24/30 [00:07<00:01,  3.29it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.1075e-03, PNorm = 64.1499, GNorm = 0.5707, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.19it/s][ALoss = 9.5259e-03, PNorm = 64.1499, GNorm = 0.5129, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 95.91it/s][A100% 21/21 [00:00<00:00, 95.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 83.66it/s]
Validation prc-auc = 0.128472
 83% 25/30 [00:07<00:01,  3.28it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.8866e-03, PNorm = 64.1499, GNorm = 0.5134, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 96.53it/s][ALoss = 8.2964e-03, PNorm = 64.1500, GNorm = 0.5588, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 97.75it/s][A100% 21/21 [00:00<00:00, 98.59it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.82it/s]
Validation prc-auc = 0.148214
 87% 26/30 [00:08<00:01,  3.23it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][A
 33% 7/21 [00:00<00:00, 68.13it/s][ALoss = 9.3323e-03, PNorm = 64.1500, GNorm = 0.4993, lr_0 = 1.0000e-04

 76% 16/21 [00:00<00:00, 73.19it/s][ALoss = 8.0992e-03, PNorm = 64.1500, GNorm = 0.3785, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 81.77it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 123.61it/s]
Validation prc-auc = 0.148214
 90% 27/30 [00:08<00:00,  3.30it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.0608e-03, PNorm = 64.1501, GNorm = 0.5253, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 97.65it/s][ALoss = 7.8374e-03, PNorm = 64.1501, GNorm = 0.3818, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 96.81it/s][A100% 21/21 [00:00<00:00, 96.46it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.12it/s]
Validation prc-auc = 0.181548
 93% 28/30 [00:08<00:00,  3.36it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.2126e-03, PNorm = 64.1502, GNorm = 0.4301, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.57it/s][ALoss = 8.0885e-03, PNorm = 64.1502, GNorm = 0.3708, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 97.58it/s][A100% 21/21 [00:00<00:00, 97.19it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.51it/s]
Validation prc-auc = 0.223214
 97% 29/30 [00:09<00:00,  3.41it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.7049e-03, PNorm = 64.1502, GNorm = 0.4212, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 85.87it/s][ALoss = 8.4420e-03, PNorm = 64.1503, GNorm = 0.5214, lr_0 = 1.0000e-04

 90% 19/21 [00:00<00:00, 89.20it/s][A100% 21/21 [00:00<00:00, 89.09it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 112.37it/s]
Validation prc-auc = 0.598214
100% 30/30 [00:09<00:00,  3.23it/s]100% 30/30 [00:09<00:00,  3.21it/s]
Model 0 best validation prc-auc = 0.598214 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 63.67it/s]
Model 0 test prc-auc = 0.633333
Ensemble test prc-auc = 0.633333
Fold 4
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1909085 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1909085_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1909085_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmp4n_8j26t/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1909085'],
 'task_names': ['CHEMBL1909085'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 668,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]431it [00:00, 4305.60it/s]1119it [00:00, 4849.22it/s]2016it [00:00, 5623.92it/s]2873it [00:00, 6270.27it/s]3774it [00:00, 6898.97it/s]4690it [00:00, 7450.47it/s]5615it [00:00, 7910.71it/s]6549it [00:00, 8290.39it/s]7487it [00:00, 8588.97it/s]8369it [00:01, 8655.54it/s]9344it [00:01, 8956.92it/s]10388it [00:01, 9354.25it/s]11433it [00:01, 9656.40it/s]12476it [00:01, 9875.16it/s]13524it [00:01, 10047.18it/s]14569it [00:01, 10164.43it/s]15615it [00:01, 10250.97it/s]16651it [00:01, 10282.38it/s]17690it [00:01, 10312.29it/s]18724it [00:02, 10299.84it/s]19756it [00:02, 10240.40it/s]20782it [00:02, 10030.21it/s]21818it [00:02, 10126.18it/s]22872it [00:02, 10246.10it/s]23929it [00:02, 10340.90it/s]24988it [00:02, 10411.57it/s]26048it [00:02, 10464.63it/s]27108it [00:02, 10502.31it/s]28159it [00:02, 10441.45it/s]29210it [00:03, 10460.99it/s]30265it [00:03, 10485.10it/s]31323it [00:03, 10512.87it/s]32375it [00:03, 10514.89it/s]33431it [00:03, 10525.54it/s]34484it [00:03, 10502.71it/s]35537it [00:03, 10510.42it/s]36591it [00:03, 10518.30it/s]37645it [00:03, 10523.22it/s]38698it [00:03, 10517.56it/s]39750it [00:04, 10462.56it/s]40797it [00:04, 10452.96it/s]41843it [00:04, 10387.52it/s]42882it [00:04, 8938.21it/s] 43812it [00:04, 8402.78it/s]44740it [00:04, 8646.56it/s]45660it [00:04, 8804.09it/s]46574it [00:04, 8901.71it/s]47496it [00:04, 8993.33it/s]48414it [00:05, 9003.52it/s]49338it [00:05, 9070.54it/s]50266it [00:05, 9130.40it/s]51242it [00:05, 9308.06it/s]52271it [00:05, 9581.87it/s]53295it [00:05, 9770.06it/s]54315it [00:05, 9893.40it/s]55322it [00:05, 9943.72it/s]56344it [00:05, 10024.92it/s]57379it [00:05, 10119.38it/s]58401it [00:06, 10147.01it/s]59443it [00:06, 10224.59it/s]60478it [00:06, 10260.99it/s]61505it [00:06, 10233.71it/s]61865it [00:06, 9761.09it/s] 
Number of examples remaining: 835
  0% 0/835 [00:00<?, ?it/s]100% 835/835 [00:00<00:00, 184678.54it/s]
  0% 0/835 [00:00<?, ?it/s] 70% 584/835 [00:00<00:00, 5837.96it/s]100% 835/835 [00:00<00:00, 5143.00it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/835 [00:00<?, ?it/s] 62% 520/835 [00:00<00:00, 5184.62it/s] 99% 824/835 [00:00<00:00, 4273.67it/s]100% 835/835 [00:00<00:00, 3946.72it/s]
Total scaffolds = 490 | train scaffolds = 365 | val scaffolds = 64 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([55])), (array([0.03061224]), array([98])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([1.]), array([1]))]
Class sizes
CHEMBL1909085 0: 92.10%, 1: 7.90%
Total size = 835 | train size = 668 | val size = 83 | test size = 84
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/21 [00:00<?, ?it/s][A
 38% 8/21 [00:00<00:00, 76.58it/s][ALoss = 2.2441e-02, PNorm = 64.1483, GNorm = 2.5735, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 81.95it/s][ALoss = 2.1593e-02, PNorm = 64.1483, GNorm = 1.9156, lr_0 = 1.0000e-04
Loss = 2.2586e-02, PNorm = 64.1483, GNorm = 2.1675, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 87.51it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 118.40it/s]
Validation prc-auc = 0.079529
  3% 1/30 [00:00<00:08,  3.25it/s]Epoch 1

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.9942e-02, PNorm = 64.1483, GNorm = 2.4653, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.08it/s][ALoss = 1.9524e-02, PNorm = 64.1483, GNorm = 2.1594, lr_0 = 1.0000e-04

100% 21/21 [00:00<00:00, 100.64it/s][A100% 21/21 [00:00<00:00, 101.75it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.60it/s]
Validation prc-auc = 0.084115
  7% 2/30 [00:00<00:08,  3.36it/s]Epoch 2

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.8730e-02, PNorm = 64.1483, GNorm = 1.8874, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.27it/s][ALoss = 1.7743e-02, PNorm = 64.1483, GNorm = 2.0770, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.15it/s][A100% 21/21 [00:00<00:00, 98.57it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 125.26it/s]
Validation prc-auc = 0.086533
 10% 3/30 [00:00<00:07,  3.43it/s]Epoch 3

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.7222e-02, PNorm = 64.1484, GNorm = 1.7501, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 99.80it/s][ALoss = 1.6574e-02, PNorm = 64.1484, GNorm = 1.9458, lr_0 = 1.0000e-04

 95% 20/21 [00:00<00:00, 98.51it/s][A100% 21/21 [00:00<00:00, 98.40it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.51it/s]
Validation prc-auc = 0.089793
 13% 4/30 [00:01<00:07,  3.47it/s]Epoch 4

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.5981e-02, PNorm = 64.1484, GNorm = 1.9286, lr_0 = 1.0000e-04

 43% 9/21 [00:00<00:00, 84.89it/s][ALoss = 1.5576e-02, PNorm = 64.1484, GNorm = 1.2939, lr_0 = 1.0000e-04

 81% 17/21 [00:00<00:00, 81.74it/s][A100% 21/21 [00:00<00:00, 84.66it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 126.97it/s]
Validation prc-auc = 0.092948
 17% 5/30 [00:01<00:07,  3.38it/s]Epoch 5

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.4838e-02, PNorm = 64.1485, GNorm = 1.6894, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 101.47it/s][ALoss = 1.4478e-02, PNorm = 64.1485, GNorm = 1.7105, lr_0 = 1.0000e-04

 86% 18/21 [00:00<00:00, 53.42it/s] [A100% 21/21 [00:00<00:00, 50.95it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.33it/s]
Validation prc-auc = 0.097087
 20% 6/30 [00:01<00:08,  2.86it/s]Epoch 6

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3730e-02, PNorm = 64.1485, GNorm = 1.1130, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.07it/s][ALoss = 1.3198e-02, PNorm = 64.1486, GNorm = 1.2137, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 111.72it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.87it/s]
Validation prc-auc = 0.101525
 23% 7/30 [00:02<00:07,  3.13it/s]Epoch 7

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.1930e-02, PNorm = 64.1486, GNorm = 1.3816, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.96it/s][ALoss = 1.3171e-02, PNorm = 64.1486, GNorm = 1.0597, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.71it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.05it/s]
Validation prc-auc = 0.105481
 27% 8/30 [00:02<00:06,  3.36it/s]Epoch 8

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2471e-02, PNorm = 64.1487, GNorm = 1.2667, lr_0 = 1.0000e-04

 48% 10/21 [00:00<00:00, 98.53it/s][ALoss = 1.2231e-02, PNorm = 64.1487, GNorm = 0.8286, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 104.69it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 134.02it/s]
Validation prc-auc = 0.109849
 30% 9/30 [00:02<00:06,  3.47it/s]Epoch 9

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2377e-02, PNorm = 64.1487, GNorm = 1.1473, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 107.60it/s][ALoss = 1.1388e-02, PNorm = 64.1488, GNorm = 0.9977, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 110.92it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.06it/s]
Validation prc-auc = 0.116887
 33% 10/30 [00:02<00:05,  3.61it/s]Epoch 10

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.2148e-02, PNorm = 64.1488, GNorm = 1.0521, lr_0 = 1.0000e-04
Loss = 1.1366e-02, PNorm = 64.1489, GNorm = 0.8249, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.82it/s][A100% 21/21 [00:00<00:00, 114.17it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.65it/s]
Validation prc-auc = 0.120834
 37% 11/30 [00:03<00:05,  3.74it/s]Epoch 11

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.3162e-02, PNorm = 64.1489, GNorm = 0.8234, lr_0 = 1.0000e-04
Loss = 1.0937e-02, PNorm = 64.1489, GNorm = 1.0263, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.30it/s][ALoss = 1.0589e-02, PNorm = 64.1490, GNorm = 0.8028, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.17it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.05it/s]
Validation prc-auc = 0.128771
 40% 12/30 [00:03<00:04,  3.83it/s]Epoch 12

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0899e-02, PNorm = 64.1490, GNorm = 0.9806, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 104.97it/s][ALoss = 9.7342e-03, PNorm = 64.1490, GNorm = 0.9299, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 107.68it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 127.15it/s]
Validation prc-auc = 0.136936
 43% 13/30 [00:03<00:04,  3.84it/s]Epoch 13

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.8893e-03, PNorm = 64.1491, GNorm = 0.7054, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 113.70it/s][ALoss = 1.0221e-02, PNorm = 64.1491, GNorm = 0.8036, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.42it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.45it/s]
Validation prc-auc = 0.141237
 47% 14/30 [00:03<00:04,  3.89it/s]Epoch 14

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.6100e-03, PNorm = 64.1492, GNorm = 0.8842, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 108.84it/s][ALoss = 1.0594e-02, PNorm = 64.1492, GNorm = 0.7261, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.43it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.25it/s]
Validation prc-auc = 0.147721
 50% 15/30 [00:04<00:03,  3.93it/s]Epoch 15

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.2338e-03, PNorm = 64.1492, GNorm = 0.8939, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.27it/s][ALoss = 9.3796e-03, PNorm = 64.1493, GNorm = 0.7145, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.00it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 135.13it/s]
Validation prc-auc = 0.151508
 53% 16/30 [00:04<00:03,  3.95it/s]Epoch 16

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.6904e-03, PNorm = 64.1493, GNorm = 0.7825, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.31it/s][ALoss = 9.8772e-03, PNorm = 64.1493, GNorm = 0.6965, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 106.98it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 134.81it/s]
Validation prc-auc = 0.159669
 57% 17/30 [00:04<00:03,  3.92it/s]Epoch 17

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.3579e-03, PNorm = 64.1494, GNorm = 0.7023, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.87it/s][ALoss = 8.9099e-03, PNorm = 64.1494, GNorm = 0.5380, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.06it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.01it/s]
Validation prc-auc = 0.165000
 60% 18/30 [00:04<00:03,  3.95it/s]Epoch 18

  0% 0/21 [00:00<?, ?it/s][ALoss = 1.0467e-02, PNorm = 64.1495, GNorm = 0.5691, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.49it/s][ALoss = 8.5235e-03, PNorm = 64.1495, GNorm = 0.6317, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.64it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.08it/s]
Validation prc-auc = 0.174668
 63% 19/30 [00:05<00:02,  3.99it/s]Epoch 19

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.0765e-03, PNorm = 64.1495, GNorm = 0.6728, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 108.34it/s][ALoss = 8.3026e-03, PNorm = 64.1496, GNorm = 0.6770, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 109.34it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 131.46it/s]
Validation prc-auc = 0.181227
 67% 20/30 [00:05<00:02,  3.97it/s]Epoch 20

  0% 0/21 [00:00<?, ?it/s][ALoss = 9.4925e-03, PNorm = 64.1496, GNorm = 0.4827, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.10it/s][ALoss = 8.2265e-03, PNorm = 64.1496, GNorm = 0.5152, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.18it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 135.69it/s]
Validation prc-auc = 0.192066
 70% 21/30 [00:05<00:02,  3.93it/s]Epoch 21

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.1762e-03, PNorm = 64.1497, GNorm = 0.6434, lr_0 = 1.0000e-04
Loss = 7.7316e-03, PNorm = 64.1497, GNorm = 0.5372, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.02it/s][A100% 21/21 [00:00<00:00, 113.50it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 135.11it/s]
Validation prc-auc = 0.205133
 73% 22/30 [00:05<00:02,  3.96it/s]Epoch 22

  0% 0/21 [00:00<?, ?it/s][ALoss = 6.3334e-03, PNorm = 64.1498, GNorm = 0.5937, lr_0 = 1.0000e-04
Loss = 8.2401e-03, PNorm = 64.1498, GNorm = 0.5098, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.51it/s][ALoss = 8.3329e-03, PNorm = 64.1498, GNorm = 0.5181, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.70it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.47it/s]
Validation prc-auc = 0.222259
 77% 23/30 [00:06<00:01,  3.98it/s]Epoch 23

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.4917e-03, PNorm = 64.1499, GNorm = 0.4972, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 109.72it/s][ALoss = 8.5051e-03, PNorm = 64.1499, GNorm = 0.4136, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 108.55it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 129.68it/s]
Validation prc-auc = 0.237488
 80% 24/30 [00:06<00:01,  3.95it/s]Epoch 24

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.5971e-03, PNorm = 64.1499, GNorm = 0.5788, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.58it/s][ALoss = 8.5160e-03, PNorm = 64.1500, GNorm = 0.5056, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.37it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 95.48it/s]
Validation prc-auc = 0.251272
 83% 25/30 [00:06<00:01,  3.92it/s]Epoch 25

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.5006e-03, PNorm = 64.1500, GNorm = 0.5230, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 48.93it/s][ALoss = 8.3005e-03, PNorm = 64.1500, GNorm = 0.4687, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 64.74it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 137.52it/s]
Validation prc-auc = 0.263995
 87% 26/30 [00:07<00:01,  3.40it/s]Epoch 26

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.2333e-03, PNorm = 64.1501, GNorm = 0.4177, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 106.86it/s][ALoss = 8.0926e-03, PNorm = 64.1501, GNorm = 0.4185, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 110.48it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 135.02it/s]
Validation prc-auc = 0.273156
 90% 27/30 [00:07<00:00,  3.55it/s]Epoch 27

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.2591e-03, PNorm = 64.1502, GNorm = 0.3886, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 112.22it/s][ALoss = 7.5478e-03, PNorm = 64.1502, GNorm = 0.4601, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 113.29it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 139.11it/s]
Validation prc-auc = 0.374881
 93% 28/30 [00:07<00:00,  3.68it/s]Epoch 28

  0% 0/21 [00:00<?, ?it/s][ALoss = 8.3959e-03, PNorm = 64.1502, GNorm = 0.6473, lr_0 = 1.0000e-04

 57% 12/21 [00:00<00:00, 111.51it/s][ALoss = 7.0166e-03, PNorm = 64.1503, GNorm = 0.3911, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 112.90it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 138.83it/s]
Validation prc-auc = 0.406780
 97% 29/30 [00:07<00:00,  3.78it/s]Epoch 29

  0% 0/21 [00:00<?, ?it/s][ALoss = 7.2781e-03, PNorm = 64.1503, GNorm = 0.4219, lr_0 = 1.0000e-04

 52% 11/21 [00:00<00:00, 103.67it/s][ALoss = 7.4569e-03, PNorm = 64.1503, GNorm = 0.4343, lr_0 = 1.0000e-04
100% 21/21 [00:00<00:00, 102.21it/s]

  0% 0/3 [00:00<?, ?it/s][A100% 3/3 [00:00<00:00, 102.94it/s]
Validation prc-auc = 0.437512
100% 30/30 [00:08<00:00,  3.73it/s]100% 30/30 [00:08<00:00,  3.69it/s]
Model 0 best validation prc-auc = 0.437512 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/3 [00:00<?, ?it/s]100% 3/3 [00:00<00:00, 123.20it/s]
Model 0 test prc-auc = 0.456707
Ensemble test prc-auc = 0.456707
5-fold cross validation
Seed 0 ==> test prc-auc = 0.109385
Seed 1 ==> test prc-auc = 0.344455
Seed 2 ==> test prc-auc = 0.497112
Seed 3 ==> test prc-auc = 0.633333
Seed 4 ==> test prc-auc = 0.456707
Overall test prc-auc = 0.408198 +/- 0.175669

wandb: Waiting for W&B process to finish, PID 1073
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                     validation_prc-auc 0.43751151653622367
wandb:                                             _timestamp 1596822464.8027387
wandb:                                               _runtime 83.84366416931152
wandb:                                                  _step 154
wandb:                                           test_prc-auc 0.4567071415656321
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.20MB of 0.20MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL1909085_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/1rhiboza
