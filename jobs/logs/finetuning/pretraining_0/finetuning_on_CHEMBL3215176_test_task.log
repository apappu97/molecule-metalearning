wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200808_063412-23d6kv8y
wandb: Syncing run finetuning_finetuning_on_CHEMBL3215176_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/23d6kv8y
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --seeds 4 5 6 7 9 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323364.1.gpu.q/tmpq51qke6_/fold_0',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [4, 5, 6, 7, 9],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]486it [00:00, 4858.88it/s]1234it [00:00, 5429.13it/s]2224it [00:00, 6279.80it/s]3235it [00:00, 7084.77it/s]4253it [00:00, 7795.37it/s]5277it [00:00, 8394.87it/s]6301it [00:00, 8874.22it/s]7323it [00:00, 9237.74it/s]8335it [00:00, 9484.78it/s]9351it [00:01, 9677.31it/s]10448it [00:01, 10030.66it/s]11558it [00:01, 10329.16it/s]12678it [00:01, 10573.99it/s]13797it [00:01, 10750.47it/s]14911it [00:01, 10861.78it/s]16010it [00:01, 10899.26it/s]17128it [00:01, 10979.79it/s]18229it [00:01, 10986.10it/s]19343it [00:01, 11029.37it/s]20468it [00:02, 11093.96it/s]21595it [00:02, 11144.48it/s]22711it [00:02, 11138.16it/s]23826it [00:02, 11132.30it/s]24940it [00:02, 11127.93it/s]26054it [00:02, 11119.96it/s]27167it [00:02, 11109.65it/s]28279it [00:02, 11108.00it/s]29390it [00:02, 11104.69it/s]30511it [00:02, 11133.25it/s]31631it [00:03, 11151.82it/s]32747it [00:03, 11139.86it/s]33862it [00:03, 11122.39it/s]34975it [00:03, 11108.49it/s]36094it [00:03, 11130.73it/s]37219it [00:03, 11165.95it/s]38336it [00:03, 11140.98it/s]39455it [00:03, 11154.88it/s]40578it [00:03, 11175.78it/s]41696it [00:03, 11163.56it/s]42815it [00:04, 11168.52it/s]43939it [00:04, 11188.53it/s]45058it [00:04, 11108.04it/s]46170it [00:04, 11108.78it/s]47286it [00:04, 11122.05it/s]48405it [00:04, 11141.14it/s]49522it [00:04, 11148.03it/s]50637it [00:04, 11081.10it/s]51746it [00:04, 11049.73it/s]52852it [00:04, 10973.28it/s]53950it [00:05, 10923.76it/s]55060it [00:05, 10973.19it/s]56158it [00:05, 10961.46it/s]57283it [00:05, 11044.22it/s]58408it [00:05, 11104.89it/s]59519it [00:05, 11059.44it/s]60626it [00:05, 11047.20it/s]61745it [00:05, 11086.89it/s]61865it [00:05, 10797.06it/s]
Number of examples remaining: 157
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 57286.27it/s]
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4940.29it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4567.98it/s]
Total scaffolds = 131 | train scaffolds = 104 | val scaffolds = 15 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/4 [00:00<?, ?it/s][A
 25% 1/4 [00:00<00:00,  3.45it/s][A
100% 4/4 [00:00<00:00,  4.60it/s][A100% 4/4 [00:00<00:00,  9.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 51.39it/s]
Validation prc-auc = 0.166667
  3% 1/30 [00:00<00:14,  2.01it/s]Epoch 1

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 82.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.36it/s]
Validation prc-auc = 0.166667
Epoch 2

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1912e-02, PNorm = 64.1483, GNorm = 1.6890, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 83.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.47it/s]
Validation prc-auc = 0.166667
 10% 3/30 [00:00<00:09,  2.74it/s]Epoch 3

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 85.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.46it/s]
Validation prc-auc = 0.166667
Epoch 4

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 86.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.89it/s]
Validation prc-auc = 0.166667
 17% 5/30 [00:00<00:06,  3.68it/s]Epoch 5

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1594e-02, PNorm = 64.1483, GNorm = 1.8022, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 84.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.88it/s]
Validation prc-auc = 0.166667
Epoch 6

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 86.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.86it/s]
Validation prc-auc = 0.166667
 23% 7/30 [00:00<00:04,  4.83it/s]Epoch 7

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0616e-02, PNorm = 64.1483, GNorm = 1.6576, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 84.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.91it/s]
Validation prc-auc = 0.166667
Epoch 8

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 86.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.76it/s]
Validation prc-auc = 0.166667
 30% 9/30 [00:00<00:03,  6.18it/s]Epoch 9

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 86.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.82it/s]
Validation prc-auc = 0.166667
Epoch 10

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9818e-02, PNorm = 64.1483, GNorm = 1.6270, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 85.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.93it/s]
Validation prc-auc = 0.166667
 37% 11/30 [00:01<00:02,  7.67it/s]Epoch 11

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 87.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.14it/s]
Validation prc-auc = 0.166667
Epoch 12

  0% 0/4 [00:00<?, ?it/s][A
 50% 2/4 [00:00<00:00, 17.29it/s][ALoss = 1.9988e-02, PNorm = 64.1483, GNorm = 1.0048, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 28.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.36it/s]
Validation prc-auc = 0.166667
 43% 13/30 [00:01<00:02,  8.22it/s]Epoch 13

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 86.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.86it/s]
Validation prc-auc = 0.166667
Epoch 14

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 81.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 177.13it/s]
Validation prc-auc = 0.166667
 50% 15/30 [00:01<00:01,  9.76it/s]Epoch 15

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8630e-02, PNorm = 64.1483, GNorm = 1.4638, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 83.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.08it/s]
Validation prc-auc = 0.166667
Epoch 16

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 92.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 207.99it/s]
Validation prc-auc = 0.166667
 57% 17/30 [00:01<00:01, 11.37it/s]Epoch 17

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9038e-02, PNorm = 64.1484, GNorm = 1.4537, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 216.87it/s]
Validation prc-auc = 0.166667
Epoch 18

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 215.79it/s]
Validation prc-auc = 0.250000
 63% 19/30 [00:01<00:00, 12.25it/s]Epoch 19

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 55.59it/s]
Validation prc-auc = 0.250000
Epoch 20

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7975e-02, PNorm = 64.1484, GNorm = 1.0117, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.42it/s]
Validation prc-auc = 0.250000
 70% 21/30 [00:01<00:00, 11.24it/s]Epoch 21

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 70.11it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 217.66it/s]
Validation prc-auc = 0.250000
Epoch 22

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 212.05it/s]
Validation prc-auc = 0.250000
 77% 23/30 [00:01<00:00, 12.55it/s]Epoch 23

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6955e-02, PNorm = 64.1484, GNorm = 1.0907, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.26it/s]
Validation prc-auc = 0.166667
Epoch 24

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 89.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.21it/s]
Validation prc-auc = 0.166667
 83% 25/30 [00:02<00:00, 13.96it/s]Epoch 25

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7129e-02, PNorm = 64.1485, GNorm = 1.0818, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 93.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.80it/s]
Validation prc-auc = 0.166667
Epoch 26

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 212.35it/s]
Validation prc-auc = 0.166667
 90% 27/30 [00:02<00:00, 15.32it/s]Epoch 27

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.90it/s]
Validation prc-auc = 0.166667
Epoch 28

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.5469e-02, PNorm = 64.1485, GNorm = 1.5230, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.06it/s]
Validation prc-auc = 0.166667
 97% 29/30 [00:02<00:00, 16.40it/s]Epoch 29

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.79it/s]
Validation prc-auc = 0.125000
100% 30/30 [00:02<00:00, 13.01it/s]
Model 0 best validation prc-auc = 0.250000 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 49.54it/s]
Model 0 test prc-auc = 0.250000
Ensemble test prc-auc = 0.250000
Fold 1
Command line
python chemprop/finetune.py --seeds 4 5 6 7 9 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323364.1.gpu.q/tmpq51qke6_/fold_1',
 'save_smiles_splits': False,
 'seed': 5,
 'seeds': [4, 5, 6, 7, 9],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]934it [00:00, 9336.27it/s]1923it [00:00, 9493.79it/s]2907it [00:00, 9594.99it/s]3676it [00:00, 8925.91it/s]4355it [00:00, 7900.23it/s]5264it [00:00, 8221.31it/s]6267it [00:00, 8690.93it/s]7269it [00:00, 9050.63it/s]8257it [00:00, 9281.71it/s]9249it [00:01, 9463.97it/s]10247it [00:01, 9612.54it/s]11244it [00:01, 9715.21it/s]12238it [00:01, 9780.88it/s]13258it [00:01, 9900.92it/s]14355it [00:01, 10198.94it/s]15458it [00:01, 10433.86it/s]16561it [00:01, 10604.95it/s]17668it [00:01, 10738.93it/s]18767it [00:01, 10811.34it/s]19865it [00:02, 10861.12it/s]20957it [00:02, 10876.53it/s]22047it [00:02, 10883.44it/s]23136it [00:02, 10883.79it/s]24225it [00:02, 10885.14it/s]25316it [00:02, 10890.48it/s]26408it [00:02, 10896.29it/s]27502it [00:02, 10907.84it/s]28593it [00:02, 10837.97it/s]29690it [00:02, 10874.90it/s]30787it [00:03, 10902.37it/s]31878it [00:03, 10862.48it/s]32969it [00:03, 10874.37it/s]34063it [00:03, 10892.89it/s]35156it [00:03, 10901.17it/s]36247it [00:03, 10887.41it/s]37338it [00:03, 10892.04it/s]38428it [00:03, 10886.56it/s]39517it [00:03, 10879.71it/s]40605it [00:03, 10871.30it/s]41693it [00:04, 10854.29it/s]42780it [00:04, 10856.35it/s]43866it [00:04, 10824.08it/s]44949it [00:04, 10818.68it/s]46039it [00:04, 10842.67it/s]47129it [00:04, 10859.13it/s]48221it [00:04, 10876.18it/s]49310it [00:04, 10879.51it/s]50398it [00:04, 10869.55it/s]51485it [00:04, 10865.75it/s]52572it [00:05, 10860.10it/s]53659it [00:05, 10769.19it/s]54737it [00:05, 10724.18it/s]55810it [00:05, 10696.94it/s]56885it [00:05, 10712.77it/s]57975it [00:05, 10767.25it/s]59066it [00:05, 10808.38it/s]60147it [00:05, 10806.24it/s]61241it [00:05, 10844.50it/s]61865it [00:05, 10519.37it/s]
Number of examples remaining: 157
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 450106.44it/s]
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4918.37it/s]
Number of tasks = 1
Splitting data with seed 5
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4482.16it/s]
Total scaffolds = 131 | train scaffolds = 102 | val scaffolds = 14 | test scaffolds = 15
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 65.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.81it/s]
Validation prc-auc = 1.000000
  3% 1/30 [00:00<00:03,  8.66it/s]Epoch 1

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 99.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 203.33it/s]
Validation prc-auc = 1.000000
  7% 2/30 [00:00<00:05,  5.43it/s]Epoch 2

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.2087e-02, PNorm = 64.1483, GNorm = 1.7422, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 47.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 117.54it/s]
Validation prc-auc = 1.000000
 10% 3/30 [00:00<00:04,  6.16it/s]Epoch 3

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 64.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 149.87it/s]
Validation prc-auc = 1.000000
Epoch 4

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 79.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 176.17it/s]
Validation prc-auc = 1.000000
 17% 5/30 [00:00<00:03,  7.48it/s]Epoch 5

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1076e-02, PNorm = 64.1483, GNorm = 1.9114, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 88.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 194.45it/s]
Validation prc-auc = 1.000000
Epoch 6

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.45it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.09it/s]
Validation prc-auc = 0.250000
 23% 7/30 [00:00<00:02,  9.12it/s]Epoch 7

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0529e-02, PNorm = 64.1483, GNorm = 1.5691, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.89it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.93it/s]
Validation prc-auc = 0.166667
Epoch 8

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.97it/s]
Validation prc-auc = 0.166667
Epoch 9

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 99.04it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.62it/s]
Validation prc-auc = 0.166667
 33% 10/30 [00:00<00:01, 10.91it/s]Epoch 10

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0555e-02, PNorm = 64.1483, GNorm = 1.1628, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 96.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.50it/s]
Validation prc-auc = 0.166667
Epoch 11

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.42it/s]
Validation prc-auc = 0.166667
 40% 12/30 [00:01<00:01, 12.57it/s]Epoch 12

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9671e-02, PNorm = 64.1483, GNorm = 1.7613, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.36it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.75it/s]
Validation prc-auc = 0.166667
Epoch 13

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.58it/s]
Validation prc-auc = 0.166667
 47% 14/30 [00:01<00:01, 14.04it/s]Epoch 14

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.15it/s]
Validation prc-auc = 0.166667
Epoch 15

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8689e-02, PNorm = 64.1484, GNorm = 1.4250, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.91it/s]
Validation prc-auc = 0.166667
 53% 16/30 [00:01<00:00, 15.36it/s]Epoch 16

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.47it/s]
Validation prc-auc = 0.166667
Epoch 17

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8734e-02, PNorm = 64.1484, GNorm = 1.5530, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.68it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.53it/s]
Validation prc-auc = 0.166667
 60% 18/30 [00:01<00:00, 16.42it/s]Epoch 18

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.68it/s]
Validation prc-auc = 0.166667
Epoch 19

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 46.86it/s]
Validation prc-auc = 0.125000
 67% 20/30 [00:01<00:00, 16.60it/s]Epoch 20

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7314e-02, PNorm = 64.1484, GNorm = 1.7164, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 76.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.34it/s]
Validation prc-auc = 0.100000
Epoch 21

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.11it/s]
Validation prc-auc = 0.100000
 73% 22/30 [00:01<00:00, 16.89it/s]Epoch 22

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 100.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.31it/s]
Validation prc-auc = 0.100000
Epoch 23

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6836e-02, PNorm = 64.1484, GNorm = 1.3818, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 88.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 194.18it/s]
Validation prc-auc = 0.100000
 80% 24/30 [00:01<00:00, 17.53it/s]Epoch 24

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 194.56it/s]
Validation prc-auc = 0.083333
Epoch 25

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6200e-02, PNorm = 64.1485, GNorm = 1.4018, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 93.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.20it/s]
Validation prc-auc = 0.071429
 87% 26/30 [00:01<00:00, 17.92it/s]Epoch 26

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.57it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.98it/s]
Validation prc-auc = 0.071429
Epoch 27

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 91.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.21it/s]
Validation prc-auc = 0.071429
 93% 28/30 [00:01<00:00, 18.26it/s]Epoch 28

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6547e-02, PNorm = 64.1485, GNorm = 1.3133, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.30it/s]
Validation prc-auc = 0.071429
Epoch 29

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.90it/s]
Validation prc-auc = 0.071429
100% 30/30 [00:02<00:00, 18.54it/s]100% 30/30 [00:02<00:00, 14.85it/s]
Model 0 best validation prc-auc = 1.000000 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 143.04it/s]
Model 0 test prc-auc = 0.416667
Ensemble test prc-auc = 0.416667
Fold 2
Command line
python chemprop/finetune.py --seeds 4 5 6 7 9 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323364.1.gpu.q/tmpq51qke6_/fold_2',
 'save_smiles_splits': False,
 'seed': 6,
 'seeds': [4, 5, 6, 7, 9],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]975it [00:00, 9747.71it/s]1970it [00:00, 9806.49it/s]2959it [00:00, 9828.37it/s]4005it [00:00, 10007.57it/s]5106it [00:00, 10286.56it/s]6213it [00:00, 10507.45it/s]7318it [00:00, 10662.68it/s]8417it [00:00, 10758.16it/s]9518it [00:00, 10832.20it/s]10623it [00:01, 10894.47it/s]11728it [00:01, 10938.96it/s]12836it [00:01, 10980.24it/s]13945it [00:01, 11012.87it/s]15049it [00:01, 11018.78it/s]16149it [00:01, 11010.97it/s]17246it [00:01, 10991.19it/s]18343it [00:01, 10977.54it/s]19439it [00:01, 10966.17it/s]20537it [00:01, 10966.98it/s]21643it [00:02, 10992.58it/s]22742it [00:02, 10989.03it/s]23841it [00:02, 10988.33it/s]24940it [00:02, 10986.51it/s]26042it [00:02, 10994.37it/s]27146it [00:02, 11004.99it/s]28247it [00:02, 10984.31it/s]29346it [00:02, 10931.54it/s]30452it [00:02, 10967.22it/s]31554it [00:02, 10981.23it/s]32653it [00:03, 10830.41it/s]33748it [00:03, 10865.54it/s]34854it [00:03, 10922.24it/s]35958it [00:03, 10955.09it/s]37064it [00:03, 10983.61it/s]38163it [00:03, 10889.04it/s]39266it [00:03, 10929.76it/s]40372it [00:03, 10967.48it/s]41474it [00:03, 10982.23it/s]42573it [00:03, 10961.34it/s]43682it [00:04, 10996.94it/s]44782it [00:04, 10971.39it/s]45887it [00:04, 10994.24it/s]46990it [00:04, 11004.49it/s]48094it [00:04, 11012.47it/s]49197it [00:04, 11015.90it/s]50299it [00:04, 10985.42it/s]51398it [00:04, 10984.40it/s]52497it [00:04, 10958.91it/s]53593it [00:04, 10938.69it/s]54687it [00:05, 10896.72it/s]55777it [00:05, 10881.80it/s]56866it [00:05, 10863.02it/s]57971it [00:05, 10918.33it/s]59074it [00:05, 10950.51it/s]60172it [00:05, 10956.86it/s]61284it [00:05, 11003.76it/s]61865it [00:05, 10907.60it/s]
Number of examples remaining: 157
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 508891.60it/s]
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 5016.80it/s]
Number of tasks = 1
Splitting data with seed 6
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4549.73it/s]
Total scaffolds = 131 | train scaffolds = 107 | val scaffolds = 11 | test scaffolds = 13
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 84.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 208.57it/s]
Validation prc-auc = 1.000000
Epoch 1

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 107.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 212.47it/s]
Validation prc-auc = 1.000000
  7% 2/30 [00:00<00:01, 14.65it/s]Epoch 2

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1975e-02, PNorm = 64.1483, GNorm = 1.9218, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 102.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.21it/s]
Validation prc-auc = 1.000000
Epoch 3

  0% 0/4 [00:00<?, ?it/s][A
100% 4/4 [00:00<00:00, 26.23it/s][A100% 4/4 [00:00<00:00, 26.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 183.38it/s]
Validation prc-auc = 1.000000
 13% 4/30 [00:00<00:02, 12.50it/s]Epoch 4

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.90it/s]
Validation prc-auc = 1.000000
Epoch 5

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0970e-02, PNorm = 64.1483, GNorm = 1.9525, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.35it/s]
Validation prc-auc = 1.000000
 20% 6/30 [00:00<00:01, 13.89it/s]Epoch 6

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.04it/s]
Validation prc-auc = 1.000000
Epoch 7

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0766e-02, PNorm = 64.1483, GNorm = 2.0607, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 91.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.74it/s]
Validation prc-auc = 1.000000
 27% 8/30 [00:00<00:01, 15.06it/s]Epoch 8

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.88it/s]
Validation prc-auc = 1.000000
Epoch 9

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.77it/s]
Validation prc-auc = 1.000000
 33% 10/30 [00:00<00:01, 16.05it/s]Epoch 10

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9550e-02, PNorm = 64.1483, GNorm = 1.7300, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.82it/s]
Validation prc-auc = 1.000000
Epoch 11

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.68it/s]
Validation prc-auc = 1.000000
 40% 12/30 [00:00<00:01, 16.81it/s]Epoch 12

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9535e-02, PNorm = 64.1483, GNorm = 1.8303, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.62it/s]
Validation prc-auc = 0.250000
Epoch 13

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.76it/s]
Validation prc-auc = 0.250000
 47% 14/30 [00:00<00:00, 17.42it/s]Epoch 14

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.86it/s]
Validation prc-auc = 0.250000
Epoch 15

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8264e-02, PNorm = 64.1484, GNorm = 1.9554, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 93.25it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.91it/s]
Validation prc-auc = 0.250000
 53% 16/30 [00:00<00:00, 17.92it/s]Epoch 16

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.26it/s]
Validation prc-auc = 0.250000
Epoch 17

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8477e-02, PNorm = 64.1484, GNorm = 1.6467, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.86it/s]
Validation prc-auc = 0.250000
 60% 18/30 [00:01<00:00, 18.20it/s]Epoch 18

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.05it/s]
Validation prc-auc = 0.250000
Epoch 19

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 63.28it/s]
Validation prc-auc = 0.250000
 67% 20/30 [00:01<00:00, 17.87it/s]Epoch 20

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7479e-02, PNorm = 64.1484, GNorm = 1.6077, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 96.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.71it/s]
Validation prc-auc = 0.250000
Epoch 21

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 104.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 207.93it/s]
Validation prc-auc = 0.250000
Epoch 22

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 107.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.47it/s]
Validation prc-auc = 0.250000
 77% 23/30 [00:01<00:00, 18.62it/s]Epoch 23

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7112e-02, PNorm = 64.1484, GNorm = 1.1783, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 104.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 210.68it/s]
Validation prc-auc = 0.166667
Epoch 24

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 196.04it/s]
Validation prc-auc = 0.166667
Epoch 25

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6454e-02, PNorm = 64.1485, GNorm = 1.3396, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 192.88it/s]
Validation prc-auc = 0.125000
 87% 26/30 [00:01<00:00, 18.90it/s]Epoch 26

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.56it/s]
Validation prc-auc = 0.125000
Epoch 27

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 189.99it/s]
Validation prc-auc = 0.125000
 93% 28/30 [00:01<00:00, 18.94it/s]Epoch 28

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.5681e-02, PNorm = 64.1485, GNorm = 1.1291, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 191.25it/s]
Validation prc-auc = 0.125000
Epoch 29

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 190.62it/s]
Validation prc-auc = 0.125000
100% 30/30 [00:01<00:00, 18.57it/s]100% 30/30 [00:01<00:00, 17.40it/s]
Model 0 best validation prc-auc = 1.000000 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 176.89it/s]
Model 0 test prc-auc = 0.280823
Ensemble test prc-auc = 0.280823
Fold 3
Command line
python chemprop/finetune.py --seeds 4 5 6 7 9 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323364.1.gpu.q/tmpq51qke6_/fold_3',
 'save_smiles_splits': False,
 'seed': 7,
 'seeds': [4, 5, 6, 7, 9],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]909it [00:00, 9083.34it/s]1844it [00:00, 9159.46it/s]2781it [00:00, 9221.57it/s]3725it [00:00, 9285.19it/s]4666it [00:00, 9321.15it/s]5615it [00:00, 9368.67it/s]6568it [00:00, 9414.18it/s]7538it [00:00, 9497.41it/s]8580it [00:00, 9755.74it/s]9621it [00:01, 9942.83it/s]10675it [00:01, 10114.44it/s]11737it [00:01, 10259.54it/s]12800it [00:01, 10366.18it/s]13862it [00:01, 10438.71it/s]14916it [00:01, 10467.65it/s]15975it [00:01, 10501.97it/s]17033it [00:01, 10523.60it/s]18091it [00:01, 10537.54it/s]19144it [00:01, 10523.23it/s]20196it [00:02, 10511.24it/s]21247it [00:02, 10503.99it/s]22298it [00:02, 10505.77it/s]23354it [00:02, 10520.97it/s]24412it [00:02, 10537.99it/s]25466it [00:02, 10517.45it/s]26520it [00:02, 10522.84it/s]27573it [00:02, 10501.63it/s]28631it [00:02, 10523.14it/s]29688it [00:02, 10535.16it/s]30746it [00:03, 10546.30it/s]31805it [00:03, 10557.83it/s]32864it [00:03, 10565.73it/s]33925it [00:03, 10577.11it/s]34985it [00:03, 10581.45it/s]36044it [00:03, 10573.07it/s]37102it [00:03, 10568.61it/s]38161it [00:03, 10574.48it/s]39219it [00:03, 10544.82it/s]40274it [00:03, 10540.79it/s]41329it [00:04, 10517.55it/s]42384it [00:04, 10525.43it/s]43437it [00:04, 10507.76it/s]44492it [00:04, 10518.85it/s]45551it [00:04, 10538.25it/s]46607it [00:04, 10542.73it/s]47664it [00:04, 10549.73it/s]48723it [00:04, 10560.88it/s]49780it [00:04, 10561.58it/s]50837it [00:04, 10560.84it/s]51894it [00:05, 10536.59it/s]52948it [00:05, 10522.17it/s]54001it [00:05, 10489.40it/s]55050it [00:05, 10468.20it/s]56097it [00:05, 10434.65it/s]57145it [00:05, 10447.52it/s]58195it [00:05, 10460.90it/s]59245it [00:05, 10471.17it/s]60294it [00:05, 10475.83it/s]61350it [00:05, 10498.57it/s]61865it [00:05, 10378.43it/s]
Number of examples remaining: 157
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 454141.88it/s]
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4922.93it/s]
Number of tasks = 1
Splitting data with seed 7
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4450.36it/s]
Total scaffolds = 131 | train scaffolds = 105 | val scaffolds = 12 | test scaffolds = 14
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.33333333]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 76.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 179.08it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.35it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 195.92it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7% 2/30 [00:00<00:01, 17.73it/s]Epoch 2

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1806e-02, PNorm = 64.1483, GNorm = 1.5275, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 96.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 197.15it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 99.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13% 4/30 [00:00<00:01, 18.33it/s]Epoch 4

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 98.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 200.59it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1006e-02, PNorm = 64.1483, GNorm = 1.9861, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20% 6/30 [00:00<00:01, 18.71it/s]Epoch 6

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.40it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0588e-02, PNorm = 64.1483, GNorm = 1.7836, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27% 8/30 [00:00<00:01, 18.88it/s]Epoch 8

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33% 10/30 [00:00<00:01, 19.06it/s]Epoch 10

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0364e-02, PNorm = 64.1483, GNorm = 1.8266, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.66it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 197.80it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40% 12/30 [00:00<00:00, 19.20it/s]Epoch 12

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0019e-02, PNorm = 64.1483, GNorm = 1.4081, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.91it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47% 14/30 [00:00<00:00, 19.33it/s]Epoch 14

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.12it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.84it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8981e-02, PNorm = 64.1484, GNorm = 1.6032, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 94.90it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.86it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53% 16/30 [00:00<00:00, 19.38it/s]Epoch 16

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 199.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8687e-02, PNorm = 64.1484, GNorm = 1.3858, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.75it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60% 18/30 [00:00<00:00, 19.43it/s]Epoch 18

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 64.96it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67% 20/30 [00:01<00:00, 18.90it/s]Epoch 20

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8235e-02, PNorm = 64.1484, GNorm = 0.9835, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 103.23it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 214.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 108.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 219.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 22

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 108.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 219.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 77% 23/30 [00:01<00:00, 19.61it/s]Epoch 23

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7226e-02, PNorm = 64.1484, GNorm = 1.1720, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 106.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 219.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 24

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 99.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 208.31it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 83% 25/30 [00:01<00:00, 19.67it/s]Epoch 25

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6996e-02, PNorm = 64.1485, GNorm = 1.0393, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 99.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 208.25it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 26

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 101.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 100.55it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 208.10it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93% 28/30 [00:01<00:00, 19.82it/s]Epoch 28

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.6146e-02, PNorm = 64.1485, GNorm = 1.2739, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 97.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 203.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 97.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 198.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100% 30/30 [00:01<00:00, 19.70it/s]100% 30/30 [00:01<00:00, 19.54it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 176.59it/s]
Model 0 test prc-auc = 0.341667
Ensemble test prc-auc = 0.341667
Fold 4
Command line
python chemprop/finetune.py --seeds 4 5 6 7 9 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL3215176 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL3215176_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL3215176_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323364.1.gpu.q/tmpq51qke6_/fold_4',
 'save_smiles_splits': False,
 'seed': 9,
 'seeds': [4, 5, 6, 7, 9],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL3215176'],
 'task_names': ['CHEMBL3215176'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 125,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]555it [00:00, 5545.31it/s]1385it [00:00, 6158.45it/s]2368it [00:00, 6935.26it/s]3346it [00:00, 7597.71it/s]4321it [00:00, 8135.60it/s]5285it [00:00, 8533.54it/s]6254it [00:00, 8849.49it/s]7226it [00:00, 9091.64it/s]8200it [00:00, 9275.38it/s]9177it [00:01, 9416.14it/s]10161it [00:01, 9537.79it/s]11235it [00:01, 9867.82it/s]12326it [00:01, 10156.43it/s]13421it [00:01, 10381.89it/s]14515it [00:01, 10543.02it/s]15602it [00:01, 10636.95it/s]16694it [00:01, 10718.56it/s]17789it [00:01, 10786.52it/s]18877it [00:01, 10813.25it/s]19967it [00:02, 10838.86it/s]21059it [00:02, 10860.94it/s]22146it [00:02, 10859.46it/s]23237it [00:02, 10872.94it/s]24336it [00:02, 10905.23it/s]25430it [00:02, 10912.93it/s]26523it [00:02, 10915.57it/s]27615it [00:02, 10914.18it/s]28708it [00:02, 10918.71it/s]29801it [00:02, 10919.79it/s]30894it [00:03, 10868.53it/s]31982it [00:03, 10871.29it/s]33071it [00:03, 10876.06it/s]34164it [00:03, 10889.86it/s]35254it [00:03, 10877.79it/s]36342it [00:03, 10849.51it/s]37427it [00:03, 10799.72it/s]38508it [00:03, 10787.20it/s]39587it [00:03, 10782.92it/s]40667it [00:03, 10786.98it/s]41746it [00:04, 10745.28it/s]42821it [00:04, 10730.25it/s]43899it [00:04, 10742.03it/s]44974it [00:04, 10740.24it/s]46049it [00:04, 10734.83it/s]47124it [00:04, 10736.58it/s]48198it [00:04, 10725.63it/s]49271it [00:04, 10675.46it/s]50339it [00:04, 10616.10it/s]51409it [00:04, 10640.55it/s]52487it [00:05, 10680.73it/s]53563it [00:05, 10701.73it/s]54634it [00:05, 10694.73it/s]55704it [00:05, 10694.05it/s]56785it [00:05, 10728.49it/s]57870it [00:05, 10764.11it/s]58964it [00:05, 10814.94it/s]60046it [00:05, 10814.19it/s]61134it [00:05, 10833.24it/s]61865it [00:05, 10518.80it/s]
Number of examples remaining: 157
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 473064.46it/s]
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 5033.91it/s]
Number of tasks = 1
Splitting data with seed 9
  0% 0/157 [00:00<?, ?it/s]100% 157/157 [00:00<00:00, 4503.50it/s]
Total scaffolds = 131 | train scaffolds = 106 | val scaffolds = 11 | test scaffolds = 14
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL3215176 0: 91.72%, 1: 8.28%
Total size = 157 | train size = 125 | val size = 15 | test size = 17
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 88.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 222.73it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 105.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 226.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7% 2/30 [00:00<00:01, 19.83it/s]Epoch 2

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1952e-02, PNorm = 64.1483, GNorm = 1.9890, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 104.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 226.22it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 101.87it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 215.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 4

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 100.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 212.02it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 17% 5/30 [00:00<00:01, 20.04it/s]Epoch 5

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.1652e-02, PNorm = 64.1483, GNorm = 2.1008, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 95.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 6

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 23% 7/30 [00:00<00:01, 19.51it/s]Epoch 7

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0513e-02, PNorm = 64.1483, GNorm = 1.7878, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 8

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.68it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 30% 9/30 [00:00<00:01, 19.34it/s]Epoch 9

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 10

  0% 0/4 [00:00<?, ?it/s][ALoss = 2.0768e-02, PNorm = 64.1483, GNorm = 1.7447, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 91.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 37% 11/30 [00:00<00:00, 19.15it/s]Epoch 11

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 12

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9836e-02, PNorm = 64.1483, GNorm = 1.4199, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.04it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 43% 13/30 [00:00<00:00, 18.96it/s]Epoch 13

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.96it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 14

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.54it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 50% 15/30 [00:00<00:00, 18.98it/s]Epoch 15

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8802e-02, PNorm = 64.1483, GNorm = 1.7730, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 93.54it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 16

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 57% 17/30 [00:00<00:00, 18.92it/s]Epoch 17

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.9027e-02, PNorm = 64.1484, GNorm = 1.3913, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 92.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 18

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.61it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 63% 19/30 [00:00<00:00, 18.93it/s]Epoch 19

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.33it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 66.24it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 20

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8051e-02, PNorm = 64.1484, GNorm = 1.5234, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 96.58it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 209.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 70% 21/30 [00:01<00:00, 18.01it/s]Epoch 21

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 96.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 213.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 22

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 103.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 222.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 77% 23/30 [00:01<00:00, 18.56it/s]Epoch 23

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.8810e-02, PNorm = 64.1484, GNorm = 1.1283, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 101.63it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 211.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 24

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 95.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 209.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 83% 25/30 [00:01<00:00, 18.83it/s]Epoch 25

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.7234e-02, PNorm = 64.1485, GNorm = 1.0270, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 93.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.53it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 26

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.04it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 90% 27/30 [00:01<00:00, 18.71it/s]Epoch 27

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 94.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 28

  0% 0/4 [00:00<?, ?it/s][ALoss = 1.5528e-02, PNorm = 64.1485, GNorm = 1.3526, lr_0 = 1.0000e-04
100% 4/4 [00:00<00:00, 91.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 204.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 97% 29/30 [00:01<00:00, 18.27it/s]Epoch 29

  0% 0/4 [00:00<?, ?it/s][A100% 4/4 [00:00<00:00, 93.42it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 205.58it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100% 30/30 [00:01<00:00, 18.79it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 177.85it/s]
Model 0 test prc-auc = 0.518849
Ensemble test prc-auc = 0.518849
5-fold cross validation
Seed 0 ==> test prc-auc = 0.250000
Seed 1 ==> test prc-auc = 0.416667
Seed 2 ==> test prc-auc = 0.280823
Seed 3 ==> test prc-auc = 0.341667
Seed 4 ==> test prc-auc = 0.518849
Overall test prc-auc = 0.361601 +/- 0.097094

wandb: Waiting for W&B process to finish, PID 3031
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                                  _step 154
wandb:                                             _timestamp 1596864896.8349679
wandb:                                               _runtime 46.15077352523804
wandb:                                     validation_prc-auc nan
wandb:                                           test_prc-auc 0.5188492063492063
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb: \ 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb: | 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL3215176_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/23d6kv8y
