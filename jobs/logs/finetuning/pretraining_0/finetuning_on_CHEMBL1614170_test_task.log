wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200807_183554-1lqhkjb1
wandb: Syncing run finetuning_finetuning_on_CHEMBL1614170_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/1lqhkjb1
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614170 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1614170_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1614170_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmpg8p63a3a/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614170'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]952it [00:00, 9510.78it/s]1898it [00:00, 9494.51it/s]2903it [00:00, 9651.43it/s]3843it [00:00, 9573.48it/s]4788it [00:00, 9534.17it/s]5713it [00:00, 9446.45it/s]6732it [00:00, 9657.18it/s]7768it [00:00, 9856.03it/s]8874it [00:00, 10186.54it/s]9977it [00:01, 10424.89it/s]11086it [00:01, 10615.16it/s]12193it [00:01, 10747.58it/s]13293it [00:01, 10821.70it/s]14370it [00:01, 10805.68it/s]15465it [00:01, 10847.62it/s]16586it [00:01, 10953.40it/s]17680it [00:01, 10909.69it/s]18790it [00:01, 10964.35it/s]19886it [00:01, 10954.45it/s]20991it [00:02, 10981.49it/s]22102it [00:02, 11017.97it/s]23204it [00:02, 10996.44it/s]24312it [00:02, 11018.63it/s]25414it [00:02, 10977.50it/s]26512it [00:02, 10957.84it/s]27618it [00:02, 10985.85it/s]28724it [00:02, 11006.19it/s]29837it [00:02, 11041.11it/s]30942it [00:02, 10875.70it/s]32034it [00:03, 10888.20it/s]33137it [00:03, 10928.98it/s]34240it [00:03, 10958.14it/s]35337it [00:03, 10944.55it/s]36454it [00:03, 11009.23it/s]37563it [00:03, 11032.49it/s]38672it [00:03, 11048.32it/s]39777it [00:03, 11037.32it/s]40887it [00:03, 11054.99it/s]41993it [00:03, 10978.44it/s]43097it [00:04, 10995.64it/s]44203it [00:04, 11013.19it/s]45309it [00:04, 11025.83it/s]46412it [00:04, 10994.49it/s]47512it [00:04, 10952.84it/s]48619it [00:04, 10986.00it/s]49724it [00:04, 11002.81it/s]50829it [00:04, 11014.19it/s]51933it [00:04, 11020.23it/s]53038it [00:04, 11027.51it/s]54141it [00:05, 10957.89it/s]55237it [00:05, 10867.02it/s]56330it [00:05, 10885.58it/s]57438it [00:05, 10941.95it/s]58549it [00:05, 10989.48it/s]59654it [00:05, 11007.04it/s]60760it [00:05, 11022.31it/s]61865it [00:05, 11030.39it/s]61865it [00:05, 10811.25it/s]
Number of examples remaining: 546
  0% 0/546 [00:00<?, ?it/s]100% 546/546 [00:00<00:00, 174962.94it/s]
  0% 0/546 [00:00<?, ?it/s] 86% 470/546 [00:00<00:00, 4692.96it/s]100% 546/546 [00:00<00:00, 4686.01it/s]
Number of tasks = 1
Splitting data with seed 0
  0% 0/546 [00:00<?, ?it/s] 78% 426/546 [00:00<00:00, 4255.06it/s]100% 546/546 [00:00<00:00, 4268.46it/s]
Total scaffolds = 448 | train scaffolds = 357 | val scaffolds = 40 | test scaffolds = 51
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.5]), array([2])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.5]), array([2])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614170 0: 68.86%, 1: 31.14%
Total size = 546 | train size = 436 | val size = 54 | test size = 56
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/14 [00:00<?, ?it/s][A
  7% 1/14 [00:00<00:02,  4.98it/s][A
 29% 4/14 [00:00<00:01,  6.54it/s][A
 50% 7/14 [00:00<00:00,  8.40it/s][ALoss = 2.1719e-02, PNorm = 64.1483, GNorm = 1.4435, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 10.51it/s][A
 86% 12/14 [00:00<00:00, 10.12it/s][A100% 14/14 [00:00<00:00, 16.59it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 27.07it/s]
Validation prc-auc = 0.341213
  3% 1/30 [00:00<00:27,  1.04it/s]Epoch 1

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1566e-02, PNorm = 64.1483, GNorm = 0.5963, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.28it/s][A100% 14/14 [00:00<00:00, 99.85it/s] 

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 126.54it/s]
Validation prc-auc = 0.337495
  7% 2/30 [00:01<00:20,  1.39it/s]Epoch 2

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1275e-02, PNorm = 64.1483, GNorm = 0.6878, lr_0 = 1.0000e-04

 43% 6/14 [00:00<00:00, 52.47it/s][ALoss = 2.1365e-02, PNorm = 64.1483, GNorm = 0.7090, lr_0 = 1.0000e-04
Loss = 3.3157e-02, PNorm = 64.1483, GNorm = 1.3536, lr_0 = 1.0000e-04

100% 14/14 [00:00<00:00, 57.64it/s][A100% 14/14 [00:00<00:00, 63.23it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 109.46it/s]
Validation prc-auc = 0.335881
 10% 3/30 [00:01<00:15,  1.73it/s]Epoch 3

  0% 0/14 [00:00<?, ?it/s][A
 64% 9/14 [00:00<00:00, 87.64it/s][ALoss = 2.1095e-02, PNorm = 64.1483, GNorm = 0.6249, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 89.16it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 115.47it/s]
Validation prc-auc = 0.340923
 13% 4/30 [00:01<00:11,  2.19it/s]Epoch 4

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0958e-02, PNorm = 64.1483, GNorm = 0.6712, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 87.80it/s][A100% 14/14 [00:00<00:00, 90.06it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 114.73it/s]
Validation prc-auc = 0.340469
 17% 5/30 [00:01<00:09,  2.68it/s]Epoch 5

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0588e-02, PNorm = 64.1483, GNorm = 0.8123, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 89.62it/s][ALoss = 2.0741e-02, PNorm = 64.1483, GNorm = 0.5417, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 91.05it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 115.04it/s]
Validation prc-auc = 0.343079
 20% 6/30 [00:01<00:07,  3.08it/s]Epoch 6

  0% 0/14 [00:00<?, ?it/s][A
 50% 7/14 [00:00<00:00, 57.47it/s][ALoss = 2.0497e-02, PNorm = 64.1483, GNorm = 0.9488, lr_0 = 1.0000e-04

 93% 13/14 [00:00<00:00, 56.92it/s][A100% 14/14 [00:00<00:00, 57.88it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 83.14it/s]
Validation prc-auc = 0.342380
 23% 7/30 [00:02<00:07,  3.24it/s]Epoch 7

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9967e-02, PNorm = 64.1483, GNorm = 0.5438, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 86.43it/s][A100% 14/14 [00:00<00:00, 88.82it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 114.95it/s]
Validation prc-auc = 0.343526
 27% 8/30 [00:02<00:06,  3.56it/s]Epoch 8

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9528e-02, PNorm = 64.1483, GNorm = 0.8214, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 85.62it/s][ALoss = 2.0319e-02, PNorm = 64.1484, GNorm = 1.0649, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 87.79it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 114.82it/s]
Validation prc-auc = 0.344732
 30% 9/30 [00:02<00:05,  3.81it/s]Epoch 9

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0547e-02, PNorm = 64.1484, GNorm = 0.7008, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 92.82it/s][A
 93% 13/14 [00:00<00:00, 43.10it/s][A100% 14/14 [00:00<00:00, 51.48it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 128.07it/s]
Validation prc-auc = 0.347790
 33% 10/30 [00:02<00:05,  3.55it/s]Epoch 10

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0126e-02, PNorm = 64.1484, GNorm = 0.6311, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 96.46it/s][A100% 14/14 [00:00<00:00, 99.59it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.22it/s]
Validation prc-auc = 0.354549
 37% 11/30 [00:03<00:04,  3.92it/s]Epoch 11

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0256e-02, PNorm = 64.1484, GNorm = 0.5342, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.46it/s][ALoss = 1.9970e-02, PNorm = 64.1484, GNorm = 0.6147, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.83it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.75it/s]
Validation prc-auc = 0.356570
 40% 12/30 [00:03<00:04,  4.20it/s]Epoch 12

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0398e-02, PNorm = 64.1484, GNorm = 0.6739, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 79.91it/s][A100% 14/14 [00:00<00:00, 86.29it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 120.85it/s]
Validation prc-auc = 0.365830
 43% 13/30 [00:03<00:04,  4.18it/s]Epoch 13

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9046e-02, PNorm = 64.1484, GNorm = 0.5157, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.36it/s][ALoss = 2.0102e-02, PNorm = 64.1485, GNorm = 0.5690, lr_0 = 1.0000e-04
Loss = 3.2007e-02, PNorm = 64.1485, GNorm = 0.6290, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 97.71it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 126.61it/s]
Validation prc-auc = 0.373531
 47% 14/30 [00:03<00:03,  4.42it/s]Epoch 14

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9792e-02, PNorm = 64.1485, GNorm = 0.6604, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 94.52it/s][A100% 14/14 [00:00<00:00, 97.78it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.68it/s]
Validation prc-auc = 0.380516
 50% 15/30 [00:03<00:03,  4.59it/s]Epoch 15

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0317e-02, PNorm = 64.1485, GNorm = 0.6802, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.80it/s][A100% 14/14 [00:00<00:00, 100.06it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.04it/s]
Validation prc-auc = 0.388086
 53% 16/30 [00:04<00:02,  4.75it/s]Epoch 16

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0021e-02, PNorm = 64.1485, GNorm = 0.5576, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 96.80it/s][ALoss = 1.9368e-02, PNorm = 64.1485, GNorm = 0.4449, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 98.75it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 128.03it/s]
Validation prc-auc = 0.391112
 57% 17/30 [00:04<00:02,  4.85it/s]Epoch 17

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9647e-02, PNorm = 64.1485, GNorm = 0.6561, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 96.87it/s][A100% 14/14 [00:00<00:00, 99.74it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.63it/s]
Validation prc-auc = 0.398791
 60% 18/30 [00:04<00:02,  4.94it/s]Epoch 18

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8915e-02, PNorm = 64.1485, GNorm = 0.6749, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 91.71it/s][A100% 14/14 [00:00<00:00, 88.17it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 123.62it/s]
Validation prc-auc = 0.406756
 63% 19/30 [00:04<00:02,  4.82it/s]Epoch 19

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8475e-02, PNorm = 64.1486, GNorm = 0.5450, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.21it/s][ALoss = 1.9527e-02, PNorm = 64.1486, GNorm = 0.6504, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 101.68it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.65it/s]
Validation prc-auc = 0.412302
 67% 20/30 [00:04<00:02,  4.93it/s]Epoch 20

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0461e-02, PNorm = 64.1486, GNorm = 0.5601, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.84it/s][A100% 14/14 [00:00<00:00, 101.40it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.47it/s]
Validation prc-auc = 0.414074
 70% 21/30 [00:05<00:01,  5.01it/s]Epoch 21

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9278e-02, PNorm = 64.1486, GNorm = 0.6013, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 96.18it/s][A100% 14/14 [00:00<00:00, 98.93it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.39it/s]
Validation prc-auc = 0.416562
 73% 22/30 [00:05<00:01,  5.01it/s]Epoch 22

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1694e-02, PNorm = 64.1486, GNorm = 0.6547, lr_0 = 1.0000e-04
Loss = 1.9005e-02, PNorm = 64.1486, GNorm = 0.4379, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 99.51it/s][A100% 14/14 [00:00<00:00, 101.15it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.96it/s]
Validation prc-auc = 0.415497
 77% 23/30 [00:05<00:01,  5.34it/s]Epoch 23

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9075e-02, PNorm = 64.1486, GNorm = 0.5171, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.31it/s][A100% 14/14 [00:00<00:00, 101.65it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.07it/s]
Validation prc-auc = 0.420678
 80% 24/30 [00:05<00:01,  5.31it/s]Epoch 24

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9444e-02, PNorm = 64.1487, GNorm = 0.6379, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.31it/s][ALoss = 1.9359e-02, PNorm = 64.1487, GNorm = 0.5601, lr_0 = 1.0000e-04
Loss = 2.6008e-02, PNorm = 64.1487, GNorm = 0.7612, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 98.95it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 76.13it/s]
Validation prc-auc = 0.427307
 83% 25/30 [00:05<00:00,  5.16it/s]Epoch 25

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8930e-02, PNorm = 64.1487, GNorm = 0.5113, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.57it/s][A100% 14/14 [00:00<00:00, 102.59it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.17it/s]
Validation prc-auc = 0.435042
 87% 26/30 [00:06<00:00,  5.19it/s]Epoch 26

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8834e-02, PNorm = 64.1487, GNorm = 0.4552, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.17it/s][A100% 14/14 [00:00<00:00, 101.86it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.22it/s]
Validation prc-auc = 0.447486
 90% 27/30 [00:06<00:00,  5.20it/s]Epoch 27

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9261e-02, PNorm = 64.1487, GNorm = 0.4742, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 100.00it/s][ALoss = 1.9335e-02, PNorm = 64.1487, GNorm = 0.5802, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 100.86it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.85it/s]
Validation prc-auc = 0.448252
 93% 28/30 [00:06<00:00,  5.19it/s]Epoch 28

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9469e-02, PNorm = 64.1488, GNorm = 0.6909, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.09it/s][A100% 14/14 [00:00<00:00, 99.56it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.63it/s]
Validation prc-auc = 0.448654
 97% 29/30 [00:06<00:00,  5.18it/s]Epoch 29

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0241e-02, PNorm = 64.1488, GNorm = 0.8655, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.66it/s][A100% 14/14 [00:00<00:00, 100.94it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 127.16it/s]
Validation prc-auc = 0.450619
100% 30/30 [00:06<00:00,  5.19it/s]100% 30/30 [00:06<00:00,  4.35it/s]
Model 0 best validation prc-auc = 0.450619 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/2 [00:00<?, ?it/s]100% 2/2 [00:00<00:00, 28.59it/s]
Model 0 test prc-auc = 0.356408
Ensemble test prc-auc = 0.356408
Fold 1
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614170 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1614170_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1614170_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmpg8p63a3a/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614170'],
 'task_names': ['CHEMBL1614170'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 436,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]797it [00:00, 7966.38it/s]1789it [00:00, 8465.16it/s]2778it [00:00, 8846.49it/s]3742it [00:00, 9069.88it/s]4726it [00:00, 9286.05it/s]5721it [00:00, 9475.57it/s]6717it [00:00, 9613.94it/s]7710it [00:00, 9704.89it/s]8698it [00:00, 9756.25it/s]9735it [00:01, 9931.14it/s]10831it [00:01, 10217.40it/s]11922it [00:01, 10413.61it/s]13015it [00:01, 10562.69it/s]14111it [00:01, 10676.97it/s]15215it [00:01, 10781.78it/s]16307it [00:01, 10822.11it/s]17388it [00:01, 10756.05it/s]18463it [00:01, 10687.93it/s]19567it [00:01, 10790.78it/s]20673it [00:02, 10869.08it/s]21760it [00:02, 10796.09it/s]22853it [00:02, 10835.88it/s]23941it [00:02, 10847.89it/s]25038it [00:02, 10883.15it/s]26127it [00:02, 10847.92it/s]27220it [00:02, 10870.27it/s]28310it [00:02, 10879.15it/s]29415it [00:02, 10927.46it/s]30508it [00:02, 10908.28it/s]31599it [00:03, 10889.00it/s]32698it [00:03, 10918.74it/s]33791it [00:03, 10921.45it/s]34884it [00:03, 10771.23it/s]35979it [00:03, 10821.78it/s]37080it [00:03, 10875.40it/s]38179it [00:03, 10907.70it/s]39271it [00:03, 10877.81it/s]40359it [00:03, 10865.11it/s]41452it [00:03, 10884.09it/s]42551it [00:04, 10915.58it/s]43643it [00:04, 10896.51it/s]44738it [00:04, 10910.13it/s]45830it [00:04, 10889.59it/s]46920it [00:04, 10878.43it/s]48008it [00:04, 10865.94it/s]49095it [00:04, 10858.55it/s]50181it [00:04, 10843.46it/s]51277it [00:04, 10876.69it/s]52376it [00:04, 10909.24it/s]53468it [00:05, 10911.82it/s]54560it [00:05, 10872.85it/s]55648it [00:05, 10831.35it/s]56732it [00:05, 10827.11it/s]57827it [00:05, 10863.64it/s]58914it [00:05, 10774.44it/s]59995it [00:05, 10785.04it/s]61084it [00:05, 10814.92it/s]61865it [00:05, 10672.82it/s]
Number of examples remaining: 546
  0% 0/546 [00:00<?, ?it/s]100% 546/546 [00:00<00:00, 84598.82it/s]
  0% 0/546 [00:00<?, ?it/s] 42% 227/546 [00:00<00:00, 2265.53it/s]100% 546/546 [00:00<00:00, 2798.61it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/546 [00:00<?, ?it/s] 73% 397/546 [00:00<00:00, 3966.04it/s]100% 546/546 [00:00<00:00, 3975.77it/s]
Total scaffolds = 448 | train scaffolds = 353 | val scaffolds = 42 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.33333333]), array([3]))]
Class sizes
CHEMBL1614170 0: 68.86%, 1: 31.14%
Total size = 546 | train size = 436 | val size = 54 | test size = 56
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/14 [00:00<?, ?it/s][A
 43% 6/14 [00:00<00:00, 17.12it/s][ALoss = 2.1715e-02, PNorm = 64.1483, GNorm = 0.6642, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 31.80it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 124.95it/s]
Validation prc-auc = 0.236681
  3% 1/30 [00:00<00:14,  2.01it/s]Epoch 1

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1560e-02, PNorm = 64.1483, GNorm = 0.6281, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 84.96it/s][A100% 14/14 [00:00<00:00, 88.42it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.34it/s]
Validation prc-auc = 0.236523
  7% 2/30 [00:00<00:11,  2.49it/s]Epoch 2

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1768e-02, PNorm = 64.1483, GNorm = 1.0207, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 85.81it/s][ALoss = 2.1244e-02, PNorm = 64.1483, GNorm = 0.8711, lr_0 = 1.0000e-04
Loss = 3.5499e-02, PNorm = 64.1483, GNorm = 1.1668, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 87.37it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.49it/s]
Validation prc-auc = 0.231902
 10% 3/30 [00:00<00:09,  2.98it/s]Epoch 3

  0% 0/14 [00:00<?, ?it/s][A
 64% 9/14 [00:00<00:00, 85.73it/s][ALoss = 2.1221e-02, PNorm = 64.1483, GNorm = 0.6804, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 88.29it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.79it/s]
Validation prc-auc = 0.226132
 13% 4/30 [00:01<00:07,  3.47it/s]Epoch 4

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1111e-02, PNorm = 64.1483, GNorm = 0.7087, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.51it/s][A100% 14/14 [00:00<00:00, 89.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.49it/s]
Validation prc-auc = 0.209855
 17% 5/30 [00:01<00:06,  3.92it/s]Epoch 5

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0573e-02, PNorm = 64.1483, GNorm = 0.5552, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.91it/s][ALoss = 2.0771e-02, PNorm = 64.1483, GNorm = 0.5603, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 89.52it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 125.75it/s]
Validation prc-auc = 0.200465
 20% 6/30 [00:01<00:05,  4.32it/s]Epoch 6

  0% 0/14 [00:00<?, ?it/s][A
 57% 8/14 [00:00<00:00, 79.54it/s][ALoss = 2.0542e-02, PNorm = 64.1483, GNorm = 0.7436, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 84.62it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 76.79it/s]
Validation prc-auc = 0.199520
 23% 7/30 [00:01<00:05,  4.51it/s]Epoch 7

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0094e-02, PNorm = 64.1483, GNorm = 0.7411, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 83.78it/s][A100% 14/14 [00:00<00:00, 89.46it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.84it/s]
Validation prc-auc = 0.198051
 27% 8/30 [00:01<00:04,  4.72it/s]Epoch 8

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0958e-02, PNorm = 64.1483, GNorm = 0.5922, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.85it/s][ALoss = 2.0183e-02, PNorm = 64.1484, GNorm = 0.6592, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 98.32it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 139.08it/s]
Validation prc-auc = 0.194197
 30% 9/30 [00:01<00:04,  5.08it/s]Epoch 9

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0214e-02, PNorm = 64.1484, GNorm = 0.8393, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.77it/s][A100% 14/14 [00:00<00:00, 98.10it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 139.90it/s]
Validation prc-auc = 0.189512
 33% 10/30 [00:02<00:03,  5.37it/s]Epoch 10

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9952e-02, PNorm = 64.1484, GNorm = 0.6622, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.64it/s][A100% 14/14 [00:00<00:00, 98.28it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.60it/s]
Validation prc-auc = 0.192096
 37% 11/30 [00:02<00:03,  5.59it/s]Epoch 11

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9245e-02, PNorm = 64.1484, GNorm = 0.6087, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 93.53it/s][ALoss = 1.9965e-02, PNorm = 64.1484, GNorm = 0.4690, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 94.80it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 138.49it/s]
Validation prc-auc = 0.197459
 40% 12/30 [00:02<00:03,  5.70it/s]Epoch 12

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9764e-02, PNorm = 64.1484, GNorm = 0.4566, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 85.44it/s][A100% 14/14 [00:00<00:00, 90.51it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.86it/s]
Validation prc-auc = 0.202077
 43% 13/30 [00:02<00:02,  5.71it/s]Epoch 13

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0344e-02, PNorm = 64.1484, GNorm = 0.5159, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 95.37it/s][ALoss = 1.9932e-02, PNorm = 64.1484, GNorm = 0.5785, lr_0 = 1.0000e-04
Loss = 2.8634e-02, PNorm = 64.1484, GNorm = 0.7106, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 96.98it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.86it/s]
Validation prc-auc = 0.212592
 47% 14/30 [00:02<00:02,  5.82it/s]Epoch 14

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0009e-02, PNorm = 64.1485, GNorm = 0.5750, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.02it/s][A100% 14/14 [00:00<00:00, 100.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 140.45it/s]
Validation prc-auc = 0.223581
 50% 15/30 [00:02<00:02,  5.97it/s]Epoch 15

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8893e-02, PNorm = 64.1485, GNorm = 0.5260, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.54it/s][A100% 14/14 [00:00<00:00, 101.96it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 139.40it/s]
Validation prc-auc = 0.227139
 53% 16/30 [00:03<00:02,  6.09it/s]Epoch 16

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9774e-02, PNorm = 64.1485, GNorm = 0.5524, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.67it/s][ALoss = 1.9346e-02, PNorm = 64.1485, GNorm = 0.6235, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 101.54it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 139.84it/s]
Validation prc-auc = 0.245065
 57% 17/30 [00:03<00:02,  5.80it/s]Epoch 17

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9390e-02, PNorm = 64.1485, GNorm = 0.7784, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.15it/s][A100% 14/14 [00:00<00:00, 88.95it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 114.00it/s]
Validation prc-auc = 0.250621
 60% 18/30 [00:03<00:02,  5.35it/s]Epoch 18

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9860e-02, PNorm = 64.1485, GNorm = 0.5549, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 89.69it/s][A100% 14/14 [00:00<00:00, 83.65it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.72it/s]
Validation prc-auc = 0.318949
 63% 19/30 [00:03<00:02,  5.04it/s]Epoch 19

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0606e-02, PNorm = 64.1485, GNorm = 0.5199, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 94.74it/s][ALoss = 1.9166e-02, PNorm = 64.1486, GNorm = 0.6361, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 96.85it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 138.38it/s]
Validation prc-auc = 0.320094
 67% 20/30 [00:03<00:01,  5.05it/s]Epoch 20

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9164e-02, PNorm = 64.1486, GNorm = 0.6345, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.79it/s][A100% 14/14 [00:00<00:00, 100.68it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.69it/s]
Validation prc-auc = 0.326735
 70% 21/30 [00:04<00:01,  5.10it/s]Epoch 21

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9983e-02, PNorm = 64.1486, GNorm = 0.4734, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.61it/s][A100% 14/14 [00:00<00:00, 101.54it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 140.24it/s]
Validation prc-auc = 0.326988
 73% 22/30 [00:04<00:01,  5.14it/s]Epoch 22

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9035e-02, PNorm = 64.1486, GNorm = 0.4641, lr_0 = 1.0000e-04
Loss = 1.9279e-02, PNorm = 64.1486, GNorm = 0.6378, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.00it/s][A100% 14/14 [00:00<00:00, 102.27it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 140.98it/s]
Validation prc-auc = 0.325215
 77% 23/30 [00:04<00:01,  5.47it/s]Epoch 23

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9288e-02, PNorm = 64.1486, GNorm = 0.5481, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.18it/s][A100% 14/14 [00:00<00:00, 100.31it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.14it/s]
Validation prc-auc = 0.328092
 80% 24/30 [00:04<00:01,  5.38it/s]Epoch 24

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9927e-02, PNorm = 64.1486, GNorm = 0.4455, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.69it/s][ALoss = 1.9212e-02, PNorm = 64.1487, GNorm = 0.5150, lr_0 = 1.0000e-04
Loss = 2.5775e-02, PNorm = 64.1487, GNorm = 0.7611, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 98.73it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 80.55it/s]
Validation prc-auc = 0.331530
 83% 25/30 [00:04<00:00,  5.15it/s]Epoch 25

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9154e-02, PNorm = 64.1487, GNorm = 0.4851, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.88it/s][A100% 14/14 [00:00<00:00, 101.03it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.23it/s]
Validation prc-auc = 0.348097
 87% 26/30 [00:05<00:00,  5.17it/s]Epoch 26

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9197e-02, PNorm = 64.1487, GNorm = 0.5785, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.92it/s][A100% 14/14 [00:00<00:00, 104.07it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.91it/s]
Validation prc-auc = 0.350301
 90% 27/30 [00:05<00:00,  5.22it/s]Epoch 27

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9087e-02, PNorm = 64.1487, GNorm = 0.6432, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.70it/s][ALoss = 1.9118e-02, PNorm = 64.1487, GNorm = 0.4729, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 102.45it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 139.99it/s]
Validation prc-auc = 0.350672
 93% 28/30 [00:05<00:00,  5.25it/s]Epoch 28

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9644e-02, PNorm = 64.1487, GNorm = 0.6533, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 96.80it/s][A
 93% 13/14 [00:00<00:00, 40.74it/s][A100% 14/14 [00:00<00:00, 49.35it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.42it/s]
Validation prc-auc = 0.353427
 97% 29/30 [00:05<00:00,  4.27it/s]Epoch 29

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8702e-02, PNorm = 64.1488, GNorm = 0.6058, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.77it/s][A100% 14/14 [00:00<00:00, 103.25it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 141.10it/s]
Validation prc-auc = 0.352437
100% 30/30 [00:05<00:00,  4.71it/s]100% 30/30 [00:05<00:00,  5.06it/s]
Model 0 best validation prc-auc = 0.353427 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/2 [00:00<?, ?it/s]100% 2/2 [00:00<00:00, 123.38it/s]
Model 0 test prc-auc = 0.579328
Ensemble test prc-auc = 0.579328
Fold 2
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614170 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1614170_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1614170_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmpg8p63a3a/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614170'],
 'task_names': ['CHEMBL1614170'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 436,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]1023it [00:00, 10223.48it/s]2091it [00:00, 10356.01it/s]3151it [00:00, 10427.09it/s]4219it [00:00, 10499.07it/s]5287it [00:00, 10552.04it/s]6364it [00:00, 10614.16it/s]7430it [00:00, 10627.64it/s]8499it [00:00, 10645.05it/s]9572it [00:00, 10667.58it/s]10640it [00:01, 10670.61it/s]11697it [00:01, 10638.01it/s]12765it [00:01, 10648.76it/s]13826it [00:01, 10637.01it/s]14890it [00:01, 10637.30it/s]15947it [00:01, 10609.23it/s]17011it [00:01, 10615.48it/s]18073it [00:01, 10614.36it/s]19133it [00:01, 10601.95it/s]20192it [00:01, 10597.51it/s]21256it [00:02, 10610.05it/s]22317it [00:02, 10586.47it/s]23380it [00:02, 10597.02it/s]24440it [00:02, 10539.05it/s]25500it [00:02, 10554.11it/s]26563it [00:02, 10573.98it/s]27621it [00:02, 10551.62it/s]28679it [00:02, 10559.75it/s]29739it [00:02, 10569.36it/s]30796it [00:02, 10532.90it/s]31850it [00:03, 10528.79it/s]32903it [00:03, 10513.99it/s]33965it [00:03, 10542.93it/s]35020it [00:03, 10382.66it/s]36059it [00:03, 10363.39it/s]37127it [00:03, 10454.36it/s]38180it [00:03, 10476.16it/s]39228it [00:03, 10449.69it/s]40282it [00:03, 10476.42it/s]41341it [00:03, 10509.93it/s]42395it [00:04, 10518.68it/s]43447it [00:04, 10455.92it/s]44495it [00:04, 10462.45it/s]45560it [00:04, 10516.24it/s]46613it [00:04, 10519.45it/s]47666it [00:04, 10510.16it/s]48735it [00:04, 10561.57it/s]49804it [00:04, 10597.15it/s]50871it [00:04, 10617.74it/s]51933it [00:04, 10556.96it/s]52998it [00:05, 10583.19it/s]54057it [00:05, 10447.71it/s]55103it [00:05, 10450.51it/s]56155it [00:05, 10470.61it/s]57226it [00:05, 10540.42it/s]58300it [00:05, 10597.54it/s]59361it [00:05, 10551.31it/s]60428it [00:05, 10585.80it/s]61487it [00:05, 10583.65it/s]61865it [00:05, 10552.96it/s]
Number of examples remaining: 546
  0% 0/546 [00:00<?, ?it/s]100% 546/546 [00:00<00:00, 154235.59it/s]
  0% 0/546 [00:00<?, ?it/s] 83% 454/546 [00:00<00:00, 4537.73it/s]100% 546/546 [00:00<00:00, 4543.85it/s]
Number of tasks = 1
Splitting data with seed 2
  0% 0/546 [00:00<?, ?it/s] 78% 424/546 [00:00<00:00, 4231.91it/s]100% 546/546 [00:00<00:00, 4253.01it/s]
Total scaffolds = 448 | train scaffolds = 356 | val scaffolds = 47 | test scaffolds = 45
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1]))]
Class sizes
CHEMBL1614170 0: 68.86%, 1: 31.14%
Total size = 546 | train size = 436 | val size = 54 | test size = 56
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/14 [00:00<?, ?it/s][A
 57% 8/14 [00:00<00:00, 78.86it/s][ALoss = 2.2068e-02, PNorm = 64.1483, GNorm = 1.2423, lr_0 = 1.0000e-04

100% 14/14 [00:00<00:00, 70.67it/s][A100% 14/14 [00:00<00:00, 67.58it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 80.52it/s]
Validation prc-auc = 0.338405
  3% 1/30 [00:00<00:08,  3.47it/s]Epoch 1

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1550e-02, PNorm = 64.1483, GNorm = 1.1571, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 84.24it/s][A100% 14/14 [00:00<00:00, 90.95it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.38it/s]
Validation prc-auc = 0.332733
  7% 2/30 [00:00<00:07,  3.94it/s]Epoch 2

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1986e-02, PNorm = 64.1483, GNorm = 0.7220, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.56it/s][ALoss = 2.1193e-02, PNorm = 64.1483, GNorm = 0.9513, lr_0 = 1.0000e-04
Loss = 3.3080e-02, PNorm = 64.1483, GNorm = 1.0607, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 101.19it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.32it/s]
Validation prc-auc = 0.325418
 10% 3/30 [00:00<00:06,  4.45it/s]Epoch 3

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1006e-02, PNorm = 64.1483, GNorm = 0.9931, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.50it/s][A100% 14/14 [00:00<00:00, 101.96it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.21it/s]
Validation prc-auc = 0.318321
 13% 4/30 [00:00<00:05,  4.90it/s]Epoch 4

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1173e-02, PNorm = 64.1483, GNorm = 0.8040, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.96it/s][A100% 14/14 [00:00<00:00, 100.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.66it/s]
Validation prc-auc = 0.313621
 17% 5/30 [00:00<00:04,  5.25it/s]Epoch 5

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0376e-02, PNorm = 64.1483, GNorm = 0.6837, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.57it/s][ALoss = 2.0707e-02, PNorm = 64.1483, GNorm = 0.6845, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.63it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.89it/s]
Validation prc-auc = 0.309657
 20% 6/30 [00:01<00:04,  5.52it/s]Epoch 6

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0396e-02, PNorm = 64.1483, GNorm = 0.6861, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.96it/s][A100% 14/14 [00:00<00:00, 93.91it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.54it/s]
Validation prc-auc = 0.304282
 23% 7/30 [00:01<00:04,  5.63it/s]Epoch 7

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0198e-02, PNorm = 64.1483, GNorm = 0.6045, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 96.70it/s][A100% 14/14 [00:00<00:00, 99.85it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.80it/s]
Validation prc-auc = 0.300548
 27% 8/30 [00:01<00:03,  5.80it/s]Epoch 8

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0750e-02, PNorm = 64.1483, GNorm = 0.5962, lr_0 = 1.0000e-04
Loss = 2.0157e-02, PNorm = 64.1484, GNorm = 0.5691, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.35it/s][A100% 14/14 [00:00<00:00, 102.93it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.23it/s]
Validation prc-auc = 0.301262
 30% 9/30 [00:01<00:03,  5.97it/s]Epoch 9

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0221e-02, PNorm = 64.1484, GNorm = 0.5850, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.92it/s][A100% 14/14 [00:00<00:00, 103.82it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.85it/s]
Validation prc-auc = 0.302640
 33% 10/30 [00:01<00:03,  6.12it/s]Epoch 10

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0028e-02, PNorm = 64.1484, GNorm = 0.6411, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.09it/s][A100% 14/14 [00:00<00:00, 103.27it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.12it/s]
Validation prc-auc = 0.302292
 37% 11/30 [00:01<00:03,  6.21it/s]Epoch 11

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1611e-02, PNorm = 64.1484, GNorm = 0.6806, lr_0 = 1.0000e-04
Loss = 1.9984e-02, PNorm = 64.1484, GNorm = 0.6357, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.25it/s][A100% 14/14 [00:00<00:00, 103.12it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.95it/s]
Validation prc-auc = 0.300844
 40% 12/30 [00:02<00:02,  6.26it/s]Epoch 12

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9513e-02, PNorm = 64.1484, GNorm = 0.5355, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.60it/s][A100% 14/14 [00:00<00:00, 93.69it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.06it/s]
Validation prc-auc = 0.299553
 43% 13/30 [00:02<00:02,  6.13it/s]Epoch 13

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9126e-02, PNorm = 64.1484, GNorm = 0.6502, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.70it/s][ALoss = 1.9754e-02, PNorm = 64.1485, GNorm = 0.6732, lr_0 = 1.0000e-04
Loss = 3.3981e-02, PNorm = 64.1485, GNorm = 0.6685, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 102.08it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.68it/s]
Validation prc-auc = 0.298334
 47% 14/30 [00:02<00:02,  6.20it/s]Epoch 14

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9714e-02, PNorm = 64.1485, GNorm = 0.7201, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.37it/s][A100% 14/14 [00:00<00:00, 103.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.64it/s]
Validation prc-auc = 0.297933
 50% 15/30 [00:02<00:02,  6.28it/s]Epoch 15

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9551e-02, PNorm = 64.1485, GNorm = 0.5751, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.98it/s][A100% 14/14 [00:00<00:00, 104.79it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.41it/s]
Validation prc-auc = 0.298053
 53% 16/30 [00:02<00:02,  6.36it/s]Epoch 16

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9870e-02, PNorm = 64.1485, GNorm = 0.6375, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.26it/s][ALoss = 1.9796e-02, PNorm = 64.1485, GNorm = 0.4868, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 103.65it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.30it/s]
Validation prc-auc = 0.299175
 57% 17/30 [00:02<00:02,  6.39it/s]Epoch 17

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9241e-02, PNorm = 64.1485, GNorm = 0.6217, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.63it/s][A100% 14/14 [00:00<00:00, 104.74it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.23it/s]
Validation prc-auc = 0.298554
 60% 18/30 [00:02<00:01,  6.43it/s]Epoch 18

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9663e-02, PNorm = 64.1485, GNorm = 0.5521, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 103.20it/s][A100% 14/14 [00:00<00:00, 97.73it/s] 

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.14it/s]
Validation prc-auc = 0.348380
 63% 19/30 [00:03<00:01,  5.94it/s]Epoch 19

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.7903e-02, PNorm = 64.1486, GNorm = 0.7758, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.25it/s][ALoss = 1.9553e-02, PNorm = 64.1486, GNorm = 0.6349, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 102.79it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.64it/s]
Validation prc-auc = 0.346649
 67% 20/30 [00:03<00:01,  6.08it/s]Epoch 20

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9645e-02, PNorm = 64.1486, GNorm = 1.1739, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 103.54it/s][A100% 14/14 [00:00<00:00, 105.02it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.68it/s]
Validation prc-auc = 0.343270
 70% 21/30 [00:03<00:01,  6.21it/s]Epoch 21

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8877e-02, PNorm = 64.1486, GNorm = 0.5480, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 38.87it/s][A100% 14/14 [00:00<00:00, 47.52it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.34it/s]
Validation prc-auc = 0.343180
 73% 22/30 [00:03<00:01,  4.83it/s]Epoch 22

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9428e-02, PNorm = 64.1486, GNorm = 0.4556, lr_0 = 1.0000e-04
Loss = 1.9005e-02, PNorm = 64.1486, GNorm = 0.6076, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 99.20it/s][A100% 14/14 [00:00<00:00, 101.23it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.14it/s]
Validation prc-auc = 0.348051
 77% 23/30 [00:03<00:01,  5.20it/s]Epoch 23

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8936e-02, PNorm = 64.1486, GNorm = 0.6607, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.20it/s][A100% 14/14 [00:00<00:00, 100.06it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.36it/s]
Validation prc-auc = 0.349136
 80% 24/30 [00:04<00:01,  5.19it/s]Epoch 24

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9394e-02, PNorm = 64.1487, GNorm = 0.5036, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.48it/s][ALoss = 1.8799e-02, PNorm = 64.1487, GNorm = 0.5752, lr_0 = 1.0000e-04
Loss = 3.0754e-02, PNorm = 64.1487, GNorm = 0.4725, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.53it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 81.32it/s]
Validation prc-auc = 0.348961
 83% 25/30 [00:04<00:00,  5.36it/s]Epoch 25

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9001e-02, PNorm = 64.1487, GNorm = 0.8134, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.52it/s][A100% 14/14 [00:00<00:00, 101.15it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.66it/s]
Validation prc-auc = 0.348536
 87% 26/30 [00:04<00:00,  5.62it/s]Epoch 26

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8941e-02, PNorm = 64.1487, GNorm = 0.6798, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.45it/s][A100% 14/14 [00:00<00:00, 103.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 130.49it/s]
Validation prc-auc = 0.348141
 90% 27/30 [00:04<00:00,  5.85it/s]Epoch 27

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9481e-02, PNorm = 64.1487, GNorm = 0.5136, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.03it/s][ALoss = 1.9142e-02, PNorm = 64.1487, GNorm = 0.4876, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 103.75it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.22it/s]
Validation prc-auc = 0.348953
 93% 28/30 [00:04<00:00,  6.02it/s]Epoch 28

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9067e-02, PNorm = 64.1488, GNorm = 0.5503, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.19it/s][A100% 14/14 [00:00<00:00, 102.58it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.00it/s]
Validation prc-auc = 0.347686
 97% 29/30 [00:04<00:00,  6.12it/s]Epoch 29

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8336e-02, PNorm = 64.1488, GNorm = 0.5000, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.91it/s][A100% 14/14 [00:00<00:00, 104.23it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.92it/s]
Validation prc-auc = 0.347667
100% 30/30 [00:05<00:00,  6.23it/s]100% 30/30 [00:05<00:00,  5.87it/s]
Model 0 best validation prc-auc = 0.349136 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/2 [00:00<?, ?it/s]100% 2/2 [00:00<00:00, 126.98it/s]
Model 0 test prc-auc = 0.327677
Ensemble test prc-auc = 0.327677
Fold 3
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614170 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1614170_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1614170_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmpg8p63a3a/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614170'],
 'task_names': ['CHEMBL1614170'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 436,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]969it [00:00, 9687.98it/s]2027it [00:00, 9938.05it/s]3096it [00:00, 10150.51it/s]4162it [00:00, 10296.83it/s]5223it [00:00, 10386.49it/s]6296it [00:00, 10485.12it/s]7371it [00:00, 10561.85it/s]8452it [00:00, 10634.15it/s]9526it [00:00, 10665.56it/s]10592it [00:01, 10661.27it/s]11644it [00:01, 10618.07it/s]12704it [00:01, 10610.06it/s]13766it [00:01, 10610.63it/s]14824it [00:01, 10599.79it/s]15878it [00:01, 10566.06it/s]16937it [00:01, 10572.71it/s]17997it [00:01, 10580.73it/s]19053it [00:01, 10572.03it/s]20119it [00:01, 10597.68it/s]21178it [00:02, 10594.57it/s]22237it [00:02, 10527.19it/s]23290it [00:02, 10517.95it/s]24342it [00:02, 10511.33it/s]25393it [00:02, 10487.10it/s]26442it [00:02, 10472.59it/s]27493it [00:02, 10481.84it/s]28551it [00:02, 10508.73it/s]29613it [00:02, 10540.40it/s]30676it [00:02, 10563.94it/s]31738it [00:03, 10577.94it/s]32797it [00:03, 10579.62it/s]33855it [00:03, 10560.90it/s]34912it [00:03, 10381.88it/s]35974it [00:03, 10451.63it/s]37020it [00:03, 10427.72it/s]38081it [00:03, 10481.25it/s]39147it [00:03, 10533.82it/s]40201it [00:03, 10514.27it/s]41255it [00:03, 10520.63it/s]42308it [00:04, 10454.12it/s]43354it [00:04, 10433.90it/s]44409it [00:04, 10466.02it/s]45464it [00:04, 10489.28it/s]46516it [00:04, 10498.46it/s]47566it [00:04, 10493.86it/s]48623it [00:04, 10515.86it/s]49681it [00:04, 10534.85it/s]50743it [00:04, 10559.90it/s]51802it [00:04, 10566.50it/s]52859it [00:05, 10558.50it/s]53915it [00:05, 10511.98it/s]54967it [00:05, 10463.08it/s]56014it [00:05, 10435.67it/s]57061it [00:05, 10444.35it/s]58112it [00:05, 10463.81it/s]59159it [00:05, 10440.90it/s]60204it [00:05, 10396.23it/s]61244it [00:05, 10350.47it/s]61865it [00:05, 10512.82it/s]
Number of examples remaining: 546
  0% 0/546 [00:00<?, ?it/s]100% 546/546 [00:00<00:00, 182535.47it/s]
  0% 0/546 [00:00<?, ?it/s] 84% 456/546 [00:00<00:00, 4551.55it/s]100% 546/546 [00:00<00:00, 4575.38it/s]
Number of tasks = 1
Splitting data with seed 3
  0% 0/546 [00:00<?, ?it/s] 79% 430/546 [00:00<00:00, 4294.51it/s]100% 546/546 [00:00<00:00, 4324.37it/s]
Total scaffolds = 448 | train scaffolds = 356 | val scaffolds = 47 | test scaffolds = 45
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.66666667]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([0.]), array([2])), (array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1614170 0: 68.86%, 1: 31.14%
Total size = 546 | train size = 436 | val size = 54 | test size = 56
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/14 [00:00<?, ?it/s][A
 50% 7/14 [00:00<00:00, 69.89it/s][ALoss = 2.1928e-02, PNorm = 64.1483, GNorm = 1.0169, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 78.55it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 111.62it/s]
Validation prc-auc = 0.311361
  3% 1/30 [00:00<00:06,  4.15it/s]Epoch 1

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1942e-02, PNorm = 64.1483, GNorm = 0.7111, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 92.01it/s][A100% 14/14 [00:00<00:00, 94.16it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 119.77it/s]
Validation prc-auc = 0.312664
  7% 2/30 [00:00<00:06,  4.33it/s]Epoch 2

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1776e-02, PNorm = 64.1483, GNorm = 1.1125, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 92.59it/s][ALoss = 2.1436e-02, PNorm = 64.1483, GNorm = 0.6705, lr_0 = 1.0000e-04
Loss = 3.4597e-02, PNorm = 64.1483, GNorm = 0.7031, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 93.23it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 124.64it/s]
Validation prc-auc = 0.311022
 10% 3/30 [00:00<00:05,  4.69it/s]Epoch 3

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1335e-02, PNorm = 64.1483, GNorm = 0.8765, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.27it/s][A100% 14/14 [00:00<00:00, 104.95it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.77it/s]
Validation prc-auc = 0.309354
 13% 4/30 [00:00<00:05,  5.12it/s]Epoch 4

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1285e-02, PNorm = 64.1483, GNorm = 0.8828, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 104.25it/s][A100% 14/14 [00:00<00:00, 106.36it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.80it/s]
Validation prc-auc = 0.311286
 17% 5/30 [00:00<00:04,  5.45it/s]Epoch 5

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0481e-02, PNorm = 64.1483, GNorm = 0.8123, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 103.53it/s][ALoss = 2.0854e-02, PNorm = 64.1483, GNorm = 0.6530, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 105.23it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 130.97it/s]
Validation prc-auc = 0.313295
 20% 6/30 [00:01<00:04,  5.42it/s]Epoch 6

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0575e-02, PNorm = 64.1483, GNorm = 0.5858, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 93.28it/s][A100% 14/14 [00:00<00:00, 97.44it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 130.53it/s]
Validation prc-auc = 0.309645
 23% 7/30 [00:01<00:04,  5.60it/s]Epoch 7

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0766e-02, PNorm = 64.1483, GNorm = 0.8387, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.97it/s][A100% 14/14 [00:00<00:00, 103.93it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.03it/s]
Validation prc-auc = 0.312173
 27% 8/30 [00:01<00:03,  5.83it/s]Epoch 8

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0836e-02, PNorm = 64.1483, GNorm = 0.5601, lr_0 = 1.0000e-04
Loss = 1.9857e-02, PNorm = 64.1483, GNorm = 0.6988, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 103.09it/s][A100% 14/14 [00:00<00:00, 105.79it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.46it/s]
Validation prc-auc = 0.312716
 30% 9/30 [00:01<00:03,  6.03it/s]Epoch 9

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0048e-02, PNorm = 64.1484, GNorm = 0.5465, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 103.08it/s][A100% 14/14 [00:00<00:00, 105.52it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.84it/s]
Validation prc-auc = 0.318454
 33% 10/30 [00:01<00:03,  5.81it/s]Epoch 10

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0113e-02, PNorm = 64.1484, GNorm = 0.7102, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 104.20it/s][A100% 14/14 [00:00<00:00, 106.00it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.19it/s]
Validation prc-auc = 0.319287
 37% 11/30 [00:01<00:03,  5.67it/s]Epoch 11

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1102e-02, PNorm = 64.1484, GNorm = 0.5114, lr_0 = 1.0000e-04
Loss = 1.9791e-02, PNorm = 64.1484, GNorm = 0.7223, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.52it/s][A100% 14/14 [00:00<00:00, 105.00it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.99it/s]
Validation prc-auc = 0.322253
 40% 12/30 [00:02<00:03,  5.56it/s]Epoch 12

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9914e-02, PNorm = 64.1484, GNorm = 0.6332, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 93.04it/s][A100% 14/14 [00:00<00:00, 97.88it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.06it/s]
Validation prc-auc = 0.322188
 43% 13/30 [00:02<00:02,  5.71it/s]Epoch 13

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0302e-02, PNorm = 64.1484, GNorm = 0.6943, lr_0 = 1.0000e-04

 21% 3/14 [00:00<00:00, 16.47it/s][ALoss = 1.9612e-02, PNorm = 64.1484, GNorm = 0.4091, lr_0 = 1.0000e-04
Loss = 3.1718e-02, PNorm = 64.1484, GNorm = 0.6811, lr_0 = 1.0000e-04

100% 14/14 [00:00<00:00, 22.03it/s][A100% 14/14 [00:00<00:00, 48.60it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.48it/s]
Validation prc-auc = 0.329574
 47% 14/30 [00:02<00:03,  4.43it/s]Epoch 14

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9744e-02, PNorm = 64.1484, GNorm = 0.6050, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.17it/s][A100% 14/14 [00:00<00:00, 104.03it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.10it/s]
Validation prc-auc = 0.334091
 50% 15/30 [00:02<00:03,  4.66it/s]Epoch 15

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9006e-02, PNorm = 64.1485, GNorm = 0.5451, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.85it/s][A100% 14/14 [00:00<00:00, 105.07it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.95it/s]
Validation prc-auc = 0.337531
 53% 16/30 [00:03<00:02,  4.83it/s]Epoch 16

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9068e-02, PNorm = 64.1485, GNorm = 0.7608, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.97it/s][ALoss = 1.9368e-02, PNorm = 64.1485, GNorm = 0.7048, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 104.05it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.69it/s]
Validation prc-auc = 0.339611
 57% 17/30 [00:03<00:02,  4.97it/s]Epoch 17

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9619e-02, PNorm = 64.1485, GNorm = 0.5870, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.10it/s][A100% 14/14 [00:00<00:00, 104.78it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.69it/s]
Validation prc-auc = 0.351292
 60% 18/30 [00:03<00:02,  5.07it/s]Epoch 18

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0059e-02, PNorm = 64.1485, GNorm = 0.6025, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.41it/s][A100% 14/14 [00:00<00:00, 95.28it/s] 

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 122.41it/s]
Validation prc-auc = 0.359777
 63% 19/30 [00:03<00:02,  5.01it/s]Epoch 19

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0182e-02, PNorm = 64.1485, GNorm = 0.7291, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.01it/s][ALoss = 1.8887e-02, PNorm = 64.1485, GNorm = 0.6580, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 98.57it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.22it/s]
Validation prc-auc = 0.370505
 67% 20/30 [00:03<00:01,  5.03it/s]Epoch 20

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9833e-02, PNorm = 64.1486, GNorm = 0.4985, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.92it/s][A100% 14/14 [00:00<00:00, 104.90it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.64it/s]
Validation prc-auc = 0.388048
 70% 21/30 [00:04<00:01,  5.12it/s]Epoch 21

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8489e-02, PNorm = 64.1486, GNorm = 0.5961, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.88it/s][A100% 14/14 [00:00<00:00, 103.21it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 132.64it/s]
Validation prc-auc = 0.399514
 73% 22/30 [00:04<00:01,  5.16it/s]Epoch 22

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9866e-02, PNorm = 64.1486, GNorm = 0.5597, lr_0 = 1.0000e-04
Loss = 1.9160e-02, PNorm = 64.1486, GNorm = 0.7868, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.75it/s][A100% 14/14 [00:00<00:00, 103.96it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.26it/s]
Validation prc-auc = 0.412029
 77% 23/30 [00:04<00:01,  5.20it/s]Epoch 23

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8717e-02, PNorm = 64.1486, GNorm = 0.6528, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.42it/s][A100% 14/14 [00:00<00:00, 104.50it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.78it/s]
Validation prc-auc = 0.418926
 80% 24/30 [00:04<00:01,  5.20it/s]Epoch 24

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9556e-02, PNorm = 64.1486, GNorm = 0.8325, lr_0 = 1.0000e-04

 43% 6/14 [00:00<00:00, 58.76it/s][ALoss = 1.8647e-02, PNorm = 64.1486, GNorm = 0.5521, lr_0 = 1.0000e-04
Loss = 3.6701e-02, PNorm = 64.1486, GNorm = 1.0157, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 69.81it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 72.59it/s]
Validation prc-auc = 0.435162
 83% 25/30 [00:04<00:01,  4.61it/s]Epoch 25

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8814e-02, PNorm = 64.1487, GNorm = 0.5305, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 92.76it/s][A100% 14/14 [00:00<00:00, 94.93it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 121.56it/s]
Validation prc-auc = 0.449978
 87% 26/30 [00:05<00:00,  4.67it/s]Epoch 26

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8043e-02, PNorm = 64.1487, GNorm = 0.6390, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.74it/s][A100% 14/14 [00:00<00:00, 91.65it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 117.63it/s]
Validation prc-auc = 0.517235
 90% 27/30 [00:05<00:00,  4.68it/s]Epoch 27

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0016e-02, PNorm = 64.1487, GNorm = 0.6106, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 89.88it/s][ALoss = 1.8657e-02, PNorm = 64.1487, GNorm = 0.5558, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 90.70it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 117.92it/s]
Validation prc-auc = 0.520267
 93% 28/30 [00:05<00:00,  4.66it/s]Epoch 28

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8756e-02, PNorm = 64.1487, GNorm = 0.4853, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 84.02it/s][A100% 14/14 [00:00<00:00, 87.40it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 117.64it/s]
Validation prc-auc = 0.512781
 97% 29/30 [00:05<00:00,  4.87it/s]Epoch 29

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8177e-02, PNorm = 64.1487, GNorm = 0.4911, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 89.07it/s][A100% 14/14 [00:00<00:00, 92.94it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 130.79it/s]
Validation prc-auc = 0.496337
100% 30/30 [00:05<00:00,  5.12it/s]100% 30/30 [00:05<00:00,  5.14it/s]
Model 0 best validation prc-auc = 0.520267 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/2 [00:00<?, ?it/s]100% 2/2 [00:00<00:00, 122.66it/s]
Model 0 test prc-auc = 0.309257
Ensemble test prc-auc = 0.309257
Fold 4
Command line
python chemprop/finetune.py --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1614170 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1614170_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1614170_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323212.1.gpu.q/tmpg8p63a3a/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1614170'],
 'task_names': ['CHEMBL1614170'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 436,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]897it [00:00, 8962.96it/s]1843it [00:00, 9105.72it/s]2788it [00:00, 9204.11it/s]3744it [00:00, 9307.09it/s]4698it [00:00, 9374.11it/s]5695it [00:00, 9543.49it/s]6752it [00:00, 9827.48it/s]7803it [00:00, 10021.52it/s]8860it [00:00, 10177.02it/s]9901it [00:01, 10244.11it/s]10968it [00:01, 10367.30it/s]12033it [00:01, 10448.50it/s]13067it [00:01, 10382.85it/s]14101it [00:01, 10367.50it/s]15161it [00:01, 10434.15it/s]16222it [00:01, 10485.88it/s]17269it [00:01, 10477.45it/s]18316it [00:01, 9316.63it/s] 19271it [00:01, 8475.05it/s]20203it [00:02, 8709.80it/s]21140it [00:02, 8897.47it/s]22081it [00:02, 9042.58it/s]23021it [00:02, 9145.56it/s]23955it [00:02, 9200.24it/s]24887it [00:02, 9234.13it/s]25822it [00:02, 9266.18it/s]26805it [00:02, 9426.17it/s]27839it [00:02, 9680.58it/s]28874it [00:02, 9870.72it/s]29910it [00:03, 10011.85it/s]30942it [00:03, 10100.01it/s]31982it [00:03, 10186.75it/s]33030it [00:03, 10272.38it/s]34079it [00:03, 10336.16it/s]35114it [00:03, 10267.59it/s]36169it [00:03, 10349.75it/s]37221it [00:03, 10399.14it/s]38263it [00:03, 10403.86it/s]39304it [00:03, 10378.34it/s]40344it [00:04, 10382.88it/s]41388it [00:04, 10398.61it/s]42438it [00:04, 10426.38it/s]43481it [00:04, 10398.82it/s]44531it [00:04, 10428.52it/s]45575it [00:04, 10429.68it/s]46619it [00:04, 10381.37it/s]47658it [00:04, 10362.03it/s]48710it [00:04, 10407.75it/s]49761it [00:04, 10435.48it/s]50816it [00:05, 10467.32it/s]51867it [00:05, 10479.68it/s]52922it [00:05, 10497.82it/s]53972it [00:05, 10350.76it/s]55008it [00:05, 10333.30it/s]56043it [00:05, 10335.41it/s]57093it [00:05, 10382.66it/s]58145it [00:05, 10421.89it/s]59199it [00:05, 10456.90it/s]60249it [00:05, 10469.43it/s]61297it [00:06, 10201.36it/s]61865it [00:06, 10047.85it/s]
Number of examples remaining: 546
  0% 0/546 [00:00<?, ?it/s]100% 546/546 [00:00<00:00, 201823.39it/s]
  0% 0/546 [00:00<?, ?it/s] 85% 462/546 [00:00<00:00, 4612.93it/s]100% 546/546 [00:00<00:00, 4646.11it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/546 [00:00<?, ?it/s] 80% 437/546 [00:00<00:00, 4364.00it/s]100% 546/546 [00:00<00:00, 4385.88it/s]
Total scaffolds = 448 | train scaffolds = 360 | val scaffolds = 45 | test scaffolds = 43
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([1.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1]))]
Class sizes
CHEMBL1614170 0: 68.86%, 1: 31.14%
Total size = 546 | train size = 436 | val size = 54 | test size = 56
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/14 [00:00<?, ?it/s][A
 36% 5/14 [00:00<00:00, 48.45it/s][ALoss = 2.2035e-02, PNorm = 64.1483, GNorm = 0.7192, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 69.82it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 119.92it/s]
Validation prc-auc = 0.494017
  3% 1/30 [00:00<00:07,  3.83it/s]Epoch 1

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1817e-02, PNorm = 64.1483, GNorm = 0.7301, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 90.61it/s][A100% 14/14 [00:00<00:00, 92.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 122.44it/s]
Validation prc-auc = 0.500780
  7% 2/30 [00:00<00:06,  4.07it/s]Epoch 2

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1030e-02, PNorm = 64.1483, GNorm = 0.6235, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 89.21it/s][ALoss = 2.1168e-02, PNorm = 64.1483, GNorm = 0.7041, lr_0 = 1.0000e-04
Loss = 3.4719e-02, PNorm = 64.1483, GNorm = 0.7285, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 91.11it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 122.09it/s]
Validation prc-auc = 0.506045
 10% 3/30 [00:00<00:06,  4.24it/s]Epoch 3

  0% 0/14 [00:00<?, ?it/s][A
 64% 9/14 [00:00<00:00, 89.66it/s][ALoss = 2.1005e-02, PNorm = 64.1483, GNorm = 0.9136, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 92.34it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.55it/s]
Validation prc-auc = 0.517414
 13% 4/30 [00:00<00:05,  4.40it/s]Epoch 4

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.1136e-02, PNorm = 64.1483, GNorm = 0.5374, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 92.89it/s][A100% 14/14 [00:00<00:00, 95.49it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 129.81it/s]
Validation prc-auc = 0.515163
 17% 5/30 [00:01<00:05,  4.78it/s]Epoch 5

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0925e-02, PNorm = 64.1483, GNorm = 0.5727, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.35it/s][ALoss = 2.0750e-02, PNorm = 64.1483, GNorm = 0.5212, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.99it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.84it/s]
Validation prc-auc = 0.476436
 20% 6/30 [00:01<00:04,  5.13it/s]Epoch 6

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0523e-02, PNorm = 64.1483, GNorm = 0.5826, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.99it/s][A100% 14/14 [00:00<00:00, 94.84it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.94it/s]
Validation prc-auc = 0.446076
 23% 7/30 [00:01<00:04,  5.35it/s]Epoch 7

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0173e-02, PNorm = 64.1483, GNorm = 0.9504, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.91it/s][A100% 14/14 [00:00<00:00, 102.55it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.70it/s]
Validation prc-auc = 0.459125
 27% 8/30 [00:01<00:03,  5.62it/s]Epoch 8

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0273e-02, PNorm = 64.1483, GNorm = 0.7069, lr_0 = 1.0000e-04
Loss = 2.0202e-02, PNorm = 64.1483, GNorm = 0.6293, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.14it/s][A100% 14/14 [00:00<00:00, 104.42it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.98it/s]
Validation prc-auc = 0.475111
 30% 9/30 [00:01<00:03,  5.85it/s]Epoch 9

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9902e-02, PNorm = 64.1484, GNorm = 1.1787, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.92it/s][A100% 14/14 [00:00<00:00, 102.74it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.60it/s]
Validation prc-auc = 0.462408
 33% 10/30 [00:01<00:03,  6.00it/s]Epoch 10

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0449e-02, PNorm = 64.1484, GNorm = 0.7263, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.03it/s][A100% 14/14 [00:00<00:00, 103.37it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 137.01it/s]
Validation prc-auc = 0.453366
 37% 11/30 [00:02<00:03,  6.12it/s]Epoch 11

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.2145e-02, PNorm = 64.1484, GNorm = 0.5066, lr_0 = 1.0000e-04
Loss = 1.9712e-02, PNorm = 64.1484, GNorm = 0.7269, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.85it/s][A100% 14/14 [00:00<00:00, 102.50it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.76it/s]
Validation prc-auc = 0.445753
 40% 12/30 [00:02<00:02,  6.19it/s]Epoch 12

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9771e-02, PNorm = 64.1484, GNorm = 0.5252, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 88.44it/s][A100% 14/14 [00:00<00:00, 93.58it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.02it/s]
Validation prc-auc = 0.430326
 43% 13/30 [00:02<00:02,  6.03it/s]Epoch 13

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0751e-02, PNorm = 64.1484, GNorm = 0.5284, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.07it/s][ALoss = 1.9703e-02, PNorm = 64.1484, GNorm = 0.4711, lr_0 = 1.0000e-04
Loss = 3.0152e-02, PNorm = 64.1484, GNorm = 0.7911, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.92it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.31it/s]
Validation prc-auc = 0.437199
 47% 14/30 [00:02<00:02,  6.03it/s]Epoch 14

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0012e-02, PNorm = 64.1484, GNorm = 0.4133, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.00it/s][A100% 14/14 [00:00<00:00, 103.79it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 136.80it/s]
Validation prc-auc = 0.438256
 50% 15/30 [00:02<00:02,  6.14it/s]Epoch 15

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9669e-02, PNorm = 64.1485, GNorm = 0.6101, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 102.48it/s][A100% 14/14 [00:00<00:00, 104.51it/s]

  0% 0/2 [00:00<?, ?it/s][A
 50% 1/2 [00:00<00:00,  6.24it/s][A100% 2/2 [00:00<00:00, 11.97it/s]
Validation prc-auc = 0.425433
 53% 16/30 [00:02<00:02,  4.85it/s]Epoch 16

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9093e-02, PNorm = 64.1485, GNorm = 0.5028, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.14it/s][ALoss = 1.9937e-02, PNorm = 64.1485, GNorm = 0.5738, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 100.52it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.76it/s]
Validation prc-auc = 0.424299
 57% 17/30 [00:03<00:02,  5.19it/s]Epoch 17

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9667e-02, PNorm = 64.1485, GNorm = 0.4796, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 100.49it/s][A100% 14/14 [00:00<00:00, 101.82it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.90it/s]
Validation prc-auc = 0.416126
 60% 18/30 [00:03<00:02,  5.45it/s]Epoch 18

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9147e-02, PNorm = 64.1485, GNorm = 0.6979, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.24it/s][A100% 14/14 [00:00<00:00, 93.66it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.56it/s]
Validation prc-auc = 0.422360
 63% 19/30 [00:03<00:01,  5.56it/s]Epoch 19

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9697e-02, PNorm = 64.1485, GNorm = 0.5471, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.93it/s][ALoss = 1.9263e-02, PNorm = 64.1485, GNorm = 0.7833, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 101.66it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 131.44it/s]
Validation prc-auc = 0.404418
 67% 20/30 [00:03<00:01,  5.76it/s]Epoch 20

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9498e-02, PNorm = 64.1486, GNorm = 0.6802, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.78it/s][A100% 14/14 [00:00<00:00, 104.05it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.94it/s]
Validation prc-auc = 0.405909
 70% 21/30 [00:03<00:01,  5.56it/s]Epoch 21

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9976e-02, PNorm = 64.1486, GNorm = 0.5868, lr_0 = 1.0000e-04

 64% 9/14 [00:00<00:00, 85.99it/s][A100% 14/14 [00:00<00:00, 91.32it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.81it/s]
Validation prc-auc = 0.397571
 73% 22/30 [00:03<00:01,  5.61it/s]Epoch 22

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8303e-02, PNorm = 64.1486, GNorm = 0.5994, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.37it/s][ALoss = 1.9353e-02, PNorm = 64.1486, GNorm = 0.5196, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.96it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.58it/s]
Validation prc-auc = 0.376231
 77% 23/30 [00:04<00:01,  5.78it/s]Epoch 23

  0% 0/14 [00:00<?, ?it/s][ALoss = 2.0001e-02, PNorm = 64.1486, GNorm = 0.5044, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 97.89it/s][A100% 14/14 [00:00<00:00, 100.91it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 133.68it/s]
Validation prc-auc = 0.375026
 80% 24/30 [00:04<00:01,  5.91it/s]Epoch 24

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8591e-02, PNorm = 64.1486, GNorm = 0.7324, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.26it/s][ALoss = 1.9496e-02, PNorm = 64.1486, GNorm = 0.4718, lr_0 = 1.0000e-04
Loss = 3.0832e-02, PNorm = 64.1486, GNorm = 0.6316, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 99.67it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 82.31it/s]
Validation prc-auc = 0.367158
 83% 25/30 [00:04<00:00,  5.88it/s]Epoch 25

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8935e-02, PNorm = 64.1487, GNorm = 0.5708, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.46it/s][A100% 14/14 [00:00<00:00, 100.82it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 130.85it/s]
Validation prc-auc = 0.417158
 87% 26/30 [00:04<00:00,  5.85it/s]Epoch 26

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9314e-02, PNorm = 64.1487, GNorm = 0.5034, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.57it/s][A100% 14/14 [00:00<00:00, 103.64it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.89it/s]
Validation prc-auc = 0.422622
 90% 27/30 [00:04<00:00,  6.01it/s]Epoch 27

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.8051e-02, PNorm = 64.1487, GNorm = 0.6142, lr_0 = 1.0000e-04

 79% 11/14 [00:00<00:00, 101.18it/s][ALoss = 1.9631e-02, PNorm = 64.1487, GNorm = 0.5750, lr_0 = 1.0000e-04
100% 14/14 [00:00<00:00, 102.22it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.48it/s]
Validation prc-auc = 0.419752
 93% 28/30 [00:04<00:00,  6.10it/s]Epoch 28

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9013e-02, PNorm = 64.1487, GNorm = 0.5155, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 98.97it/s][A100% 14/14 [00:00<00:00, 101.12it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 135.17it/s]
Validation prc-auc = 0.369906
 97% 29/30 [00:05<00:00,  6.15it/s]Epoch 29

  0% 0/14 [00:00<?, ?it/s][ALoss = 1.9691e-02, PNorm = 64.1487, GNorm = 0.4621, lr_0 = 1.0000e-04

 71% 10/14 [00:00<00:00, 99.76it/s][A100% 14/14 [00:00<00:00, 101.88it/s]

  0% 0/2 [00:00<?, ?it/s][A100% 2/2 [00:00<00:00, 134.57it/s]
Validation prc-auc = 0.352116
100% 30/30 [00:05<00:00,  6.16it/s]100% 30/30 [00:05<00:00,  5.66it/s]
Model 0 best validation prc-auc = 0.517414 on epoch 3
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/2 [00:00<?, ?it/s]100% 2/2 [00:00<00:00, 123.51it/s]
Model 0 test prc-auc = 0.226040
Ensemble test prc-auc = 0.226040
5-fold cross validation
Seed 0 ==> test prc-auc = 0.356408
Seed 1 ==> test prc-auc = 0.579328
Seed 2 ==> test prc-auc = 0.327677
Seed 3 ==> test prc-auc = 0.309257
Seed 4 ==> test prc-auc = 0.226040
Overall test prc-auc = 0.359742 +/- 0.118053

wandb: Waiting for W&B process to finish, PID 31441
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                             _timestamp 1596821821.400834
wandb:                                                  _step 154
wandb:                                     validation_prc-auc 0.3521164184574099
wandb:                                               _runtime 68.62650322914124
wandb:                                           test_prc-auc 0.22603974762252899
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.19MB of 0.19MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL1614170_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/1lqhkjb1
