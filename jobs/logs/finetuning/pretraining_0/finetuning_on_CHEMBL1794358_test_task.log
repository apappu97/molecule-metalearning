wandb: Tracking run with wandb version 0.9.3
wandb: Wandb version 0.9.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Run data is saved locally in wandb/run-20200808_054156-nzz15b45
wandb: Syncing run finetuning_finetuning_on_CHEMBL1794358_test_task
wandb: ‚≠êÔ∏è View project at https://app.wandb.ai/apappu97/molecule-metalearning
wandb: üöÄ View run at https://app.wandb.ai/apappu97/molecule-metalearning/runs/nzz15b45
wandb: Run `wandb off` to turn off syncing.

Fold 0
Command line
python chemprop/finetune.py --seeds 1 4 5 6 7 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323361.1.gpu.q/tmpbpzo3xoz/fold_0',
 'save_smiles_splits': False,
 'seed': 1,
 'seeds': [1, 4, 5, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]505it [00:00, 5049.15it/s]1295it [00:00, 5661.60it/s]2300it [00:00, 6513.90it/s]3310it [00:00, 7289.90it/s]4315it [00:00, 7943.61it/s]5323it [00:00, 8481.64it/s]6337it [00:00, 8917.72it/s]7347it [00:00, 9241.27it/s]8351it [00:00, 9464.59it/s]9364it [00:01, 9653.33it/s]10462it [00:01, 10014.30it/s]11573it [00:01, 10317.88it/s]12674it [00:01, 10513.55it/s]13782it [00:01, 10677.08it/s]14891it [00:01, 10795.02it/s]16003it [00:01, 10888.99it/s]17115it [00:01, 10956.70it/s]18216it [00:01, 10970.57it/s]19322it [00:01, 10996.31it/s]20431it [00:02, 11022.60it/s]21534it [00:02, 10976.55it/s]22633it [00:02, 10965.59it/s]23742it [00:02, 11001.29it/s]24843it [00:02, 11003.63it/s]25957it [00:02, 11041.86it/s]27069it [00:02, 11064.80it/s]28180it [00:02, 11076.19it/s]29288it [00:02, 11077.25it/s]30403it [00:02, 11097.12it/s]31513it [00:03, 11040.13it/s]32628it [00:03, 11071.61it/s]33736it [00:03, 11066.44it/s]34843it [00:03, 11052.11it/s]35949it [00:03, 11042.09it/s]37057it [00:03, 11053.26it/s]38168it [00:03, 11067.29it/s]39275it [00:03, 11022.25it/s]40378it [00:03, 11013.96it/s]41489it [00:03, 11039.76it/s]42600it [00:04, 11058.00it/s]43706it [00:04, 10925.55it/s]44814it [00:04, 10970.52it/s]45924it [00:04, 11008.87it/s]47038it [00:04, 11045.83it/s]48150it [00:04, 11067.40it/s]49261it [00:04, 11078.90it/s]50370it [00:04, 11079.29it/s]51479it [00:04, 11057.74it/s]52591it [00:04, 11074.99it/s]53699it [00:05, 11043.07it/s]54804it [00:05, 11002.98it/s]55905it [00:05, 10966.14it/s]57012it [00:05, 10994.64it/s]58124it [00:05, 11029.05it/s]59236it [00:05, 11056.07it/s]60352it [00:05, 11084.88it/s]61468it [00:05, 11104.50it/s]61865it [00:05, 10753.43it/s]
Number of examples remaining: 222
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 69565.59it/s]
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 4125.36it/s]
Number of tasks = 1
Splitting data with seed 1
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 3395.96it/s]
Total scaffolds = 182 | train scaffolds = 154 | val scaffolds = 8 | test scaffolds = 20
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A
 17% 1/6 [00:00<00:00,  5.28it/s][A
 67% 4/6 [00:00<00:00,  6.93it/s][A100% 6/6 [00:00<00:00, 16.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 15.54it/s]
Validation prc-auc = 0.240634
  3% 1/30 [00:00<00:13,  2.10it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1271e-02, PNorm = 64.1483, GNorm = 1.6912, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 101.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 95.96it/s]
Validation prc-auc = 0.235153
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A
 50% 3/6 [00:00<00:00, 25.50it/s][A100% 6/6 [00:00<00:00, 41.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.34it/s]
Validation prc-auc = 0.230604
 10% 3/30 [00:00<00:09,  2.72it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0380e-02, PNorm = 64.1483, GNorm = 1.6487, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 110.01it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 96.86it/s]
Validation prc-auc = 0.225028
Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 110.46it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 96.20it/s]
Validation prc-auc = 0.227121
 17% 5/30 [00:00<00:06,  3.58it/s]Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9291e-02, PNorm = 64.1483, GNorm = 1.7330, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.03it/s]
Validation prc-auc = 0.224617
Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.21it/s]
Validation prc-auc = 0.222406
 23% 7/30 [00:00<00:04,  4.63it/s]Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9280e-02, PNorm = 64.1483, GNorm = 1.5009, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.10it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.18it/s]
Validation prc-auc = 0.222406
Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.77it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.42it/s]
Validation prc-auc = 0.219837
 30% 9/30 [00:01<00:03,  5.82it/s]Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7320e-02, PNorm = 64.1483, GNorm = 1.6497, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 110.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.13it/s]
Validation prc-auc = 0.215324
Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7623e-02, PNorm = 64.1484, GNorm = 1.3948, lr_0 = 1.0000e-04
Loss = 3.0121e-02, PNorm = 64.1484, GNorm = 2.0435, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 107.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 96.53it/s]
Validation prc-auc = 0.213592
 37% 11/30 [00:01<00:02,  6.99it/s]Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 111.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 96.98it/s]
Validation prc-auc = 0.210424
Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6927e-02, PNorm = 64.1484, GNorm = 1.4613, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.19it/s]
Validation prc-auc = 0.210424
 43% 13/30 [00:01<00:02,  8.29it/s]Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 110.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 97.27it/s]
Validation prc-auc = 0.210424
Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6194e-02, PNorm = 64.1484, GNorm = 1.3395, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 93.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 94.93it/s]
Validation prc-auc = 0.210424
 50% 15/30 [00:01<00:01,  9.39it/s]Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 113.43it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 94.80it/s]
Validation prc-auc = 0.210424
Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5533e-02, PNorm = 64.1485, GNorm = 1.1860, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.18it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 93.79it/s]
Validation prc-auc = 0.207161
 57% 17/30 [00:01<00:01, 10.53it/s]Epoch 17

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 108.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 89.12it/s]
Validation prc-auc = 0.207161
Epoch 18

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4607e-02, PNorm = 64.1485, GNorm = 1.4361, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.54it/s]
Validation prc-auc = 0.207161
 63% 19/30 [00:01<00:00, 11.32it/s]Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4302e-02, PNorm = 64.1485, GNorm = 1.2589, lr_0 = 1.0000e-04
Loss = 3.2744e-02, PNorm = 64.1485, GNorm = 0.9969, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.56it/s]
Validation prc-auc = 0.205919
Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.34it/s]
Validation prc-auc = 0.204927
 70% 21/30 [00:02<00:00, 11.74it/s]Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4088e-02, PNorm = 64.1486, GNorm = 1.1734, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.84it/s]
Validation prc-auc = 0.202608
Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.64it/s]
Validation prc-auc = 0.201815
 77% 23/30 [00:02<00:00, 12.04it/s]Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3239e-02, PNorm = 64.1486, GNorm = 1.1220, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.32it/s]
Validation prc-auc = 0.199642
Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.70it/s]
Validation prc-auc = 0.202691
 83% 25/30 [00:02<00:00, 12.27it/s]Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.2964e-02, PNorm = 64.1487, GNorm = 1.0784, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.40it/s]
Validation prc-auc = 0.202691
Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.99it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.60it/s]
Validation prc-auc = 0.202656
 90% 27/30 [00:02<00:00, 12.47it/s]Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3683e-02, PNorm = 64.1487, GNorm = 0.9968, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.83it/s]
Validation prc-auc = 0.202656
Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3345e-02, PNorm = 64.1488, GNorm = 1.0749, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 82.75it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.41it/s]
Validation prc-auc = 0.206206
 97% 29/30 [00:02<00:00, 12.24it/s]Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 77.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 60.92it/s]
Validation prc-auc = 0.206206
100% 30/30 [00:02<00:00, 10.96it/s]
Model 0 best validation prc-auc = 0.240634 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 32.18it/s]
Model 0 test prc-auc = 0.551190
Ensemble test prc-auc = 0.551190
Fold 1
Command line
python chemprop/finetune.py --seeds 1 4 5 6 7 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323361.1.gpu.q/tmpbpzo3xoz/fold_1',
 'save_smiles_splits': False,
 'seed': 4,
 'seeds': [1, 4, 5, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]495it [00:00, 4945.61it/s]1266it [00:00, 5541.60it/s]2260it [00:00, 6388.93it/s]3269it [00:00, 7178.65it/s]4279it [00:00, 7859.37it/s]5300it [00:00, 8441.64it/s]6316it [00:00, 8891.15it/s]7329it [00:00, 9228.80it/s]8343it [00:00, 9484.36it/s]9362it [00:01, 9684.90it/s]10401it [00:01, 9884.72it/s]11518it [00:01, 10237.52it/s]12641it [00:01, 10515.92it/s]13766it [00:01, 10723.55it/s]14884it [00:01, 10853.47it/s]16012it [00:01, 10976.98it/s]17140it [00:01, 11065.05it/s]18260it [00:01, 11102.40it/s]19373it [00:01, 11070.39it/s]20502it [00:02, 11134.76it/s]21617it [00:02, 11095.10it/s]22744it [00:02, 11146.00it/s]23870it [00:02, 11179.81it/s]24996it [00:02, 11202.11it/s]26123it [00:02, 11221.07it/s]27252it [00:02, 11240.76it/s]28377it [00:02, 11098.21it/s]29488it [00:02, 11075.63it/s]30609it [00:02, 11115.27it/s]31721it [00:03, 11116.53it/s]32849it [00:03, 11163.34it/s]33970it [00:03, 11174.66it/s]35088it [00:03, 11144.68it/s]36203it [00:03, 11138.48it/s]37326it [00:03, 11163.35it/s]38455it [00:03, 11198.63it/s]39583it [00:03, 11220.97it/s]40706it [00:03, 11178.43it/s]41836it [00:03, 11212.62it/s]42969it [00:04, 11246.15it/s]44097it [00:04, 11256.26it/s]45223it [00:04, 11221.36it/s]46346it [00:04, 11195.19it/s]47466it [00:04, 11156.38it/s]48582it [00:04, 11135.78it/s]49696it [00:04, 11103.99it/s]50816it [00:04, 11132.20it/s]51930it [00:04, 11091.37it/s]53055it [00:04, 11135.71it/s]54169it [00:05, 11129.21it/s]55282it [00:05, 11120.69it/s]56395it [00:05, 10995.02it/s]57526it [00:05, 11086.98it/s]58647it [00:05, 11123.19it/s]59783it [00:05, 11190.44it/s]60919it [00:05, 11238.39it/s]61865it [00:05, 10841.82it/s]
Number of examples remaining: 222
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 89403.31it/s]
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 4117.61it/s]
Number of tasks = 1
Splitting data with seed 4
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 3391.90it/s]
Total scaffolds = 182 | train scaffolds = 143 | val scaffolds = 20 | test scaffolds = 19
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([2]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.69it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 165.57it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1402e-02, PNorm = 64.1483, GNorm = 1.5704, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 101.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7% 2/30 [00:00<00:02, 13.65it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.74it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 160.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0797e-02, PNorm = 64.1483, GNorm = 1.6114, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.87it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13% 4/30 [00:00<00:01, 13.66it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 92.86it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.04it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0025e-02, PNorm = 64.1483, GNorm = 1.8561, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.67it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.42it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20% 6/30 [00:00<00:01, 13.53it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.97it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.85it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0192e-02, PNorm = 64.1483, GNorm = 1.4700, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.39it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27% 8/30 [00:00<00:01, 13.45it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 93.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7914e-02, PNorm = 64.1483, GNorm = 1.6462, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.93it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.32it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33% 10/30 [00:00<00:01, 13.41it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8164e-02, PNorm = 64.1484, GNorm = 1.4403, lr_0 = 1.0000e-04
Loss = 3.0735e-02, PNorm = 64.1484, GNorm = 1.7071, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 93.47it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.63it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40% 12/30 [00:00<00:01, 13.32it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][A
 17% 1/6 [00:00<00:00,  8.79it/s][ALoss = 1.6957e-02, PNorm = 64.1484, GNorm = 1.6038, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 36.48it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 172.59it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 101.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 173.50it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47% 14/30 [00:01<00:01, 11.27it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7024e-02, PNorm = 64.1484, GNorm = 1.3161, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 86.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 102.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 169.96it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53% 16/30 [00:01<00:01, 11.86it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6527e-02, PNorm = 64.1484, GNorm = 1.1218, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 169.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60% 18/30 [00:01<00:00, 12.39it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5008e-02, PNorm = 64.1485, GNorm = 1.1595, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.96it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5515e-02, PNorm = 64.1485, GNorm = 1.0472, lr_0 = 1.0000e-04
Loss = 2.6645e-02, PNorm = 64.1485, GNorm = 1.4157, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.40it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67% 20/30 [00:01<00:00, 12.55it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.07it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5000e-02, PNorm = 64.1486, GNorm = 1.2610, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73% 22/30 [00:01<00:00, 12.68it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.59it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5309e-02, PNorm = 64.1486, GNorm = 1.2600, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.24it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.42it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80% 24/30 [00:01<00:00, 12.66it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 90.30it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4857e-02, PNorm = 64.1486, GNorm = 0.9700, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 88.85it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.29it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87% 26/30 [00:02<00:00, 12.72it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 90.53it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.42it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.1600e-02, PNorm = 64.1487, GNorm = 1.1696, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.59it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93% 28/30 [00:02<00:00, 12.76it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5169e-02, PNorm = 64.1487, GNorm = 0.8512, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 79.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 94.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100% 30/30 [00:02<00:00, 12.64it/s]100% 30/30 [00:02<00:00, 12.65it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 137.88it/s]
Model 0 test prc-auc = 1.000000
Ensemble test prc-auc = 1.000000
Fold 2
Command line
python chemprop/finetune.py --seeds 1 4 5 6 7 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323361.1.gpu.q/tmpbpzo3xoz/fold_2',
 'save_smiles_splits': False,
 'seed': 5,
 'seeds': [1, 4, 5, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]939it [00:00, 9388.13it/s]1896it [00:00, 9440.54it/s]2842it [00:00, 9444.45it/s]3799it [00:00, 9478.99it/s]4751it [00:00, 9490.48it/s]5706it [00:00, 9506.45it/s]6712it [00:00, 9663.55it/s]7768it [00:00, 9914.23it/s]8833it [00:00, 10122.13it/s]9894it [00:01, 10260.63it/s]10969it [00:01, 10401.82it/s]12033it [00:01, 10472.02it/s]13104it [00:01, 10541.15it/s]14161it [00:01, 10548.43it/s]15228it [00:01, 10582.85it/s]16285it [00:01, 10578.03it/s]17364it [00:01, 10638.00it/s]18427it [00:01, 10634.31it/s]19501it [00:01, 10664.92it/s]20567it [00:02, 10644.37it/s]21642it [00:02, 10673.61it/s]22709it [00:02, 10671.14it/s]23776it [00:02, 10661.09it/s]24842it [00:02, 10651.66it/s]25916it [00:02, 10676.20it/s]26991it [00:02, 10696.17it/s]28071it [00:02, 10726.28it/s]29145it [00:02, 10728.72it/s]30221it [00:02, 10735.51it/s]31297it [00:03, 10742.16it/s]32379it [00:03, 10762.51it/s]33456it [00:03, 10759.55it/s]34532it [00:03, 10744.59it/s]35607it [00:03, 10745.52it/s]36682it [00:03, 10721.21it/s]37759it [00:03, 10733.16it/s]38837it [00:03, 10744.59it/s]39912it [00:03, 10718.39it/s]40986it [00:03, 10723.41it/s]42061it [00:04, 10729.60it/s]43134it [00:04, 10705.71it/s]44206it [00:04, 10707.24it/s]45278it [00:04, 10710.67it/s]46353it [00:04, 10721.29it/s]47428it [00:04, 10728.88it/s]48501it [00:04, 10715.02it/s]49575it [00:04, 10721.63it/s]50648it [00:04, 10715.59it/s]51725it [00:04, 10729.75it/s]52799it [00:05, 10730.57it/s]53873it [00:05, 10691.19it/s]54943it [00:05, 10636.91it/s]56007it [00:05, 10599.17it/s]57074it [00:05, 10618.92it/s]58145it [00:05, 10644.26it/s]59219it [00:05, 10670.96it/s]60287it [00:05, 10636.38it/s]61353it [00:05, 10642.67it/s]61865it [00:05, 10555.35it/s]
Number of examples remaining: 222
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 90975.62it/s]
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 4103.44it/s]
Number of tasks = 1
Splitting data with seed 5
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 3379.50it/s]
Total scaffolds = 182 | train scaffolds = 150 | val scaffolds = 20 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 92.06it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 154.55it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1162e-02, PNorm = 64.1483, GNorm = 2.1920, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 101.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.03it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7% 2/30 [00:00<00:02, 13.92it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 103.92it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.74it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0176e-02, PNorm = 64.1483, GNorm = 1.6051, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13% 4/30 [00:00<00:01, 13.92it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9197e-02, PNorm = 64.1483, GNorm = 1.6781, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.95it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20% 6/30 [00:00<00:01, 13.46it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.05it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.65it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8739e-02, PNorm = 64.1483, GNorm = 1.5934, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27% 8/30 [00:00<00:01, 13.38it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.61it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8023e-02, PNorm = 64.1483, GNorm = 1.5978, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.90it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33% 10/30 [00:00<00:01, 13.42it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7356e-02, PNorm = 64.1484, GNorm = 1.5048, lr_0 = 1.0000e-04
Loss = 3.0847e-02, PNorm = 64.1484, GNorm = 1.4011, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.03it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.37it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40% 12/30 [00:00<00:01, 13.45it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6865e-02, PNorm = 64.1484, GNorm = 1.4254, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 95.88it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.20it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 155.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47% 14/30 [00:01<00:01, 13.52it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6294e-02, PNorm = 64.1484, GNorm = 1.4003, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 84.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 157.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 101.44it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53% 16/30 [00:01<00:01, 13.24it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5150e-02, PNorm = 64.1485, GNorm = 1.2877, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.51it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 156.68it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 169.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60% 18/30 [00:01<00:00, 13.40it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4984e-02, PNorm = 64.1485, GNorm = 1.3446, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.14it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.85it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4422e-02, PNorm = 64.1485, GNorm = 1.2455, lr_0 = 1.0000e-04
Loss = 2.8666e-02, PNorm = 64.1485, GNorm = 1.4405, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 109.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67% 20/30 [00:01<00:00, 13.88it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 112.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.48it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4009e-02, PNorm = 64.1486, GNorm = 1.1521, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 111.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 176.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73% 22/30 [00:01<00:00, 14.36it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 113.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 176.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3492e-02, PNorm = 64.1486, GNorm = 1.1024, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 112.27it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.86it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80% 24/30 [00:01<00:00, 14.77it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 113.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 175.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3003e-02, PNorm = 64.1487, GNorm = 1.1726, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 111.87it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 176.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87% 26/30 [00:01<00:00, 15.06it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 113.80it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.12it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3055e-02, PNorm = 64.1487, GNorm = 1.1650, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 112.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 174.93it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93% 28/30 [00:01<00:00, 15.27it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3516e-02, PNorm = 64.1488, GNorm = 1.0669, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 95.08it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 171.76it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A
 67% 4/6 [00:00<00:00, 32.10it/s][A100% 6/6 [00:00<00:00, 42.60it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 170.28it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100% 30/30 [00:02<00:00, 12.58it/s]100% 30/30 [00:02<00:00, 13.58it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 84.55it/s]
Model 0 test prc-auc = 0.264821
Ensemble test prc-auc = 0.264821
Fold 3
Command line
python chemprop/finetune.py --seeds 1 4 5 6 7 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323361.1.gpu.q/tmpbpzo3xoz/fold_3',
 'save_smiles_splits': False,
 'seed': 6,
 'seeds': [1, 4, 5, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]489it [00:00, 4884.38it/s]1237it [00:00, 5451.13it/s]2192it [00:00, 6255.82it/s]3166it [00:00, 7007.60it/s]4144it [00:00, 7658.30it/s]5131it [00:00, 8208.71it/s]6116it [00:00, 8638.55it/s]7098it [00:00, 8959.85it/s]8085it [00:00, 9213.10it/s]9068it [00:01, 9388.76it/s]10053it [00:01, 9522.24it/s]11071it [00:01, 9709.05it/s]12153it [00:01, 10017.01it/s]13238it [00:01, 10251.08it/s]14330it [00:01, 10440.92it/s]15416it [00:01, 10562.88it/s]16496it [00:01, 10630.77it/s]17581it [00:01, 10694.85it/s]18667it [00:01, 10741.09it/s]19753it [00:02, 10773.98it/s]20836it [00:02, 10788.42it/s]21921it [00:02, 10806.36it/s]23010it [00:02, 10828.87it/s]24094it [00:02, 10831.25it/s]25182it [00:02, 10844.23it/s]26270it [00:02, 10853.16it/s]27357it [00:02, 10856.20it/s]28443it [00:02, 10833.56it/s]29527it [00:02, 10825.88it/s]30615it [00:03, 10841.77it/s]31704it [00:03, 10855.64it/s]32790it [00:03, 10852.92it/s]33877it [00:03, 10858.01it/s]34963it [00:03, 10846.21it/s]36052it [00:03, 10859.27it/s]37138it [00:03, 10850.27it/s]38225it [00:03, 10853.94it/s]39311it [00:03, 10780.21it/s]40390it [00:03, 10669.97it/s]41479it [00:04, 10733.29it/s]42572it [00:04, 10790.02it/s]43652it [00:04, 10705.52it/s]44742it [00:04, 10762.96it/s]45832it [00:04, 10803.27it/s]46913it [00:04, 10795.30it/s]48000it [00:04, 10815.01it/s]49082it [00:04, 10816.16it/s]50165it [00:04, 10817.67it/s]51247it [00:04, 10786.35it/s]52327it [00:05, 10788.99it/s]53406it [00:05, 10741.40it/s]54481it [00:05, 10691.47it/s]55551it [00:05, 10661.04it/s]56618it [00:05, 10648.29it/s]57683it [00:05, 10623.91it/s]58766it [00:05, 10682.73it/s]59835it [00:05, 10682.79it/s]60908it [00:05, 10696.85it/s]61865it [00:05, 10468.14it/s]
Number of examples remaining: 222
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 87176.81it/s]
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 4090.42it/s]
Number of tasks = 1
Splitting data with seed 6
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 3390.04it/s]
Total scaffolds = 182 | train scaffolds = 142 | val scaffolds = 20 | test scaffolds = 20
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([3])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 84.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 152.56it/s]
Warning: Found a task with targets all 0s or all 1s
/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/chemprop/chemprop/train/run_finetuning.py:202: RuntimeWarning: Mean of empty slice
  avg_val_score = np.nanmean(val_scores)
Validation prc-auc = nan
Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1259e-02, PNorm = 64.1483, GNorm = 1.3629, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 102.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 161.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
  7% 2/30 [00:00<00:02, 13.29it/s]Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.84it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 150.60it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0493e-02, PNorm = 64.1483, GNorm = 1.6045, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.29it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 13% 4/30 [00:00<00:01, 13.34it/s]Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 92.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 5

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.9953e-02, PNorm = 64.1483, GNorm = 1.2995, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.96it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 20% 6/30 [00:00<00:01, 13.07it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 93.31it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.59it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8601e-02, PNorm = 64.1483, GNorm = 1.6926, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 92.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.53it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 27% 8/30 [00:00<00:01, 13.06it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 93.19it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7924e-02, PNorm = 64.1483, GNorm = 1.3763, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.96it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.35it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 33% 10/30 [00:00<00:01, 13.06it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7812e-02, PNorm = 64.1484, GNorm = 1.2100, lr_0 = 1.0000e-04
Loss = 3.4068e-02, PNorm = 64.1484, GNorm = 2.0518, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.00it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.72it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 72.73it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 133.66it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 40% 12/30 [00:00<00:01, 11.55it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7799e-02, PNorm = 64.1484, GNorm = 1.5051, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 88.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 92.87it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 47% 14/30 [00:01<00:01, 11.91it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6642e-02, PNorm = 64.1484, GNorm = 1.4874, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 80.41it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.37it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 94.56it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.03it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 53% 16/30 [00:01<00:01, 12.03it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5051e-02, PNorm = 64.1484, GNorm = 1.2010, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.32it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.27it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 17

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 93.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.91it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 60% 18/30 [00:01<00:00, 12.29it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5484e-02, PNorm = 64.1485, GNorm = 1.0922, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.82it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.5254e-02, PNorm = 64.1485, GNorm = 1.1497, lr_0 = 1.0000e-04
Loss = 3.0162e-02, PNorm = 64.1485, GNorm = 1.0842, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 148.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 67% 20/30 [00:01<00:00, 12.41it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.34it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.07it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4634e-02, PNorm = 64.1486, GNorm = 1.2789, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.15it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 73% 22/30 [00:01<00:00, 12.51it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 92.07it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4318e-02, PNorm = 64.1486, GNorm = 1.2127, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.58it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 80% 24/30 [00:01<00:00, 12.63it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.38it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.2113e-02, PNorm = 64.1487, GNorm = 1.1183, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 89.94it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.17it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 87% 26/30 [00:02<00:00, 12.65it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 91.64it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 147.55it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3384e-02, PNorm = 64.1487, GNorm = 1.0497, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 90.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 146.74it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
 93% 28/30 [00:02<00:00, 12.68it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4835e-02, PNorm = 64.1487, GNorm = 0.9216, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 76.61it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 143.70it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 159.55it/s]
Warning: Found a task with targets all 0s or all 1s
Validation prc-auc = nan
100% 30/30 [00:02<00:00, 12.48it/s]100% 30/30 [00:02<00:00, 12.46it/s]
Model 0 best validation prc-auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 147.00it/s]
Model 0 test prc-auc = 0.159632
Ensemble test prc-auc = 0.159632
Fold 4
Command line
python chemprop/finetune.py --seeds 1 4 5 6 7 --data_path /home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv --target_columns CHEMBL1794358 --dataset_type classification --split_type scaffold_balanced --checkpoint_paths /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt --num_folds 5 --epochs 30 --results_save_dir results/finetuning/ --experiment_name finetuning_on_CHEMBL1794358_test_task
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': ['/home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt'],
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': '/home/apappu/thesis/molecule-metalearning/filtered_chembl/chembl_less_1024_more_128_645_tasks.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'experiment_name': 'finetuning_on_CHEMBL1794358_test_task',
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'results_save_dir': 'results/finetuning/',
 'save_dir': '/tmp/2323361.1.gpu.q/tmpbpzo3xoz/fold_4',
 'save_smiles_splits': False,
 'seed': 7,
 'seeds': [1, 4, 5, 6, 7],
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['CHEMBL1794358'],
 'task_names': ['CHEMBL1794358'],
 'test': False,
 'test_fold_index': None,
 'test_time_lr': 0.0001,
 'train_data_size': 177,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]662it [00:00, 6617.23it/s]1584it [00:00, 7228.82it/s]2581it [00:00, 7878.62it/s]3578it [00:00, 8406.90it/s]4568it [00:00, 8804.75it/s]5564it [00:00, 9120.12it/s]6557it [00:00, 9346.91it/s]7553it [00:00, 9521.11it/s]8539it [00:00, 9619.38it/s]9554it [00:01, 9772.31it/s]10649it [00:01, 10095.74it/s]11755it [00:01, 10365.52it/s]12863it [00:01, 10568.14it/s]13963it [00:01, 10692.12it/s]15066it [00:01, 10789.45it/s]16179it [00:01, 10888.19it/s]17287it [00:01, 10943.10it/s]18389it [00:01, 10964.75it/s]19496it [00:01, 10993.42it/s]20599it [00:02, 11001.47it/s]21700it [00:02, 10957.13it/s]22804it [00:02, 10981.19it/s]23912it [00:02, 11009.21it/s]25021it [00:02, 11032.98it/s]26130it [00:02, 11049.59it/s]27239it [00:02, 11059.12it/s]28345it [00:02, 11046.02it/s]29454it [00:02, 11056.81it/s]30560it [00:02, 11047.32it/s]31665it [00:03, 10969.28it/s]32777it [00:03, 11011.49it/s]33883it [00:03, 11023.33it/s]34987it [00:03, 11027.97it/s]36091it [00:03, 11030.99it/s]37200it [00:03, 11045.79it/s]38305it [00:03, 11036.05it/s]39409it [00:03, 11021.07it/s]40512it [00:03, 10968.84it/s]41614it [00:03, 10982.24it/s]42724it [00:04, 11015.80it/s]43826it [00:04, 10933.82it/s]44922it [00:04, 10939.13it/s]46023it [00:04, 10958.26it/s]47125it [00:04, 10973.90it/s]48223it [00:04, 10968.88it/s]49325it [00:04, 10982.11it/s]50424it [00:04, 10976.17it/s]51522it [00:04, 10879.13it/s]52613it [00:04, 10886.30it/s]53702it [00:05, 10856.51it/s]54788it [00:05, 10823.78it/s]55871it [00:05, 10809.75it/s]56961it [00:05, 10836.35it/s]58063it [00:05, 10890.55it/s]59166it [00:05, 10929.67it/s]60272it [00:05, 10967.62it/s]61378it [00:05, 10993.09it/s]61865it [00:05, 10736.48it/s]
Number of examples remaining: 222
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 98127.88it/s]
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 4126.70it/s]
Number of tasks = 1
Splitting data with seed 7
  0% 0/222 [00:00<?, ?it/s]100% 222/222 [00:00<00:00, 3402.91it/s]
Total scaffolds = 182 | train scaffolds = 150 | val scaffolds = 11 | test scaffolds = 21
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([0.]), array([2])), (array([0.]), array([1]))]
Class sizes
CHEMBL1794358 0: 94.14%, 1: 5.86%
Total size = 222 | train size = 177 | val size = 22 | test size = 23
Loading model 0 from /home/apappu/thesis/molecule-metalearning-finetuning/molecule-metalearning/outputs/pretraining/fold_0/model_0/pretraining_0.pt
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=300, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 401
Moving model to cuda
  0% 0/30 [00:00<?, ?it/s]Epoch 0

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.13it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 92.36it/s]
Validation prc-auc = 0.485269
  3% 1/30 [00:00<00:03,  8.81it/s]Epoch 1

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.1642e-02, PNorm = 64.1483, GNorm = 1.8641, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 110.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.64it/s]
Validation prc-auc = 0.450802
Epoch 2

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 100.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 88.20it/s]
Validation prc-auc = 0.441372
 10% 3/30 [00:00<00:02,  9.33it/s]Epoch 3

  0% 0/6 [00:00<?, ?it/s][ALoss = 2.0415e-02, PNorm = 64.1483, GNorm = 1.5743, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.50it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 87.63it/s]
Validation prc-auc = 0.425139
Epoch 4

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.09it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.75it/s]
Validation prc-auc = 0.425387
 17% 5/30 [00:00<00:02,  9.93it/s]Epoch 5

  0% 0/6 [00:00<?, ?it/s][A
 17% 1/6 [00:00<00:00,  7.30it/s][ALoss = 1.9574e-02, PNorm = 64.1483, GNorm = 1.5700, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 31.72it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 84.77it/s]
Validation prc-auc = 0.422505
 20% 6/30 [00:00<00:03,  7.55it/s]Epoch 6

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 97.98it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.92it/s]
Validation prc-auc = 0.413776
Epoch 7

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.8830e-02, PNorm = 64.1483, GNorm = 1.9147, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.79it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.05it/s]
Validation prc-auc = 0.408661
 27% 8/30 [00:00<00:02,  8.45it/s]Epoch 8

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.13it/s]
Validation prc-auc = 0.402770
Epoch 9

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7879e-02, PNorm = 64.1483, GNorm = 1.6402, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 96.65it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.66it/s]
Validation prc-auc = 0.388202
 33% 10/30 [00:01<00:02,  9.37it/s]Epoch 10

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7177e-02, PNorm = 64.1484, GNorm = 1.7553, lr_0 = 1.0000e-04
Loss = 3.2528e-02, PNorm = 64.1484, GNorm = 1.4197, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 95.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.10it/s]
Validation prc-auc = 0.388202
Epoch 11

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.78it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.19it/s]
Validation prc-auc = 0.388641
 40% 12/30 [00:01<00:01, 10.15it/s]Epoch 12

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.7082e-02, PNorm = 64.1484, GNorm = 1.3510, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.21it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.14it/s]
Validation prc-auc = 0.379582
Epoch 13

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 101.62it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 93.16it/s]
Validation prc-auc = 0.379582
 47% 14/30 [00:01<00:01, 10.83it/s]Epoch 14

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.6061e-02, PNorm = 64.1484, GNorm = 1.4431, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 91.71it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 93.57it/s]
Validation prc-auc = 0.379582
Epoch 15

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 112.52it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 93.86it/s]
Validation prc-auc = 0.375698
 53% 16/30 [00:01<00:01, 11.41it/s]Epoch 16

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4660e-02, PNorm = 64.1485, GNorm = 1.3104, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 108.26it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 93.71it/s]
Validation prc-auc = 0.372391
Epoch 17

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 105.83it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.08it/s]
Validation prc-auc = 0.372391
 60% 18/30 [00:01<00:01, 11.96it/s]Epoch 18

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4966e-02, PNorm = 64.1485, GNorm = 1.3514, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 99.37it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.68it/s]
Validation prc-auc = 0.372391
Epoch 19

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4647e-02, PNorm = 64.1485, GNorm = 1.2270, lr_0 = 1.0000e-04
Loss = 2.5110e-02, PNorm = 64.1485, GNorm = 1.3850, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.49it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.91it/s]
Validation prc-auc = 0.372391
 67% 20/30 [00:01<00:00, 11.87it/s]Epoch 20

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 98.16it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.95it/s]
Validation prc-auc = 0.367849
Epoch 21

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.4029e-02, PNorm = 64.1486, GNorm = 1.1846, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 97.81it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.00it/s]
Validation prc-auc = 0.282888
 73% 22/30 [00:01<00:00, 12.04it/s]Epoch 22

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 99.91it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.09it/s]
Validation prc-auc = 0.282888
Epoch 23

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3230e-02, PNorm = 64.1486, GNorm = 1.3224, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 98.70it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 84.93it/s]
Validation prc-auc = 0.273629
 80% 24/30 [00:02<00:00, 12.17it/s]Epoch 24

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 100.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.33it/s]
Validation prc-auc = 0.272601
Epoch 25

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.2455e-02, PNorm = 64.1487, GNorm = 1.1021, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 99.82it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.28it/s]
Validation prc-auc = 0.272601
 87% 26/30 [00:02<00:00, 12.35it/s]Epoch 26

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 101.28it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.96it/s]
Validation prc-auc = 0.270519
Epoch 27

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.2016e-02, PNorm = 64.1487, GNorm = 1.0659, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 100.02it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 85.92it/s]
Validation prc-auc = 0.272467
 93% 28/30 [00:02<00:00, 12.49it/s]Epoch 28

  0% 0/6 [00:00<?, ?it/s][ALoss = 1.3278e-02, PNorm = 64.1488, GNorm = 1.2324, lr_0 = 1.0000e-04
100% 6/6 [00:00<00:00, 85.76it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 86.98it/s]
Validation prc-auc = 0.274377
Epoch 29

  0% 0/6 [00:00<?, ?it/s][A100% 6/6 [00:00<00:00, 107.96it/s]

  0% 0/1 [00:00<?, ?it/s][A100% 1/1 [00:00<00:00, 92.60it/s]
Validation prc-auc = 0.276666
100% 30/30 [00:02<00:00, 12.41it/s]100% 30/30 [00:02<00:00, 11.58it/s]
Model 0 best validation prc-auc = 0.485269 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0% 0/1 [00:00<?, ?it/s]100% 1/1 [00:00<00:00, 136.10it/s]
Model 0 test prc-auc = 0.100000
Ensemble test prc-auc = 0.100000
5-fold cross validation
Seed 0 ==> test prc-auc = 0.551190
Seed 1 ==> test prc-auc = 1.000000
Seed 2 ==> test prc-auc = 0.264821
Seed 3 ==> test prc-auc = 0.159632
Seed 4 ==> test prc-auc = 0.100000
Overall test prc-auc = 0.415129 +/- 0.330988

wandb: Waiting for W&B process to finish, PID 29860
wandb: Program ended successfully.
wandb: Run summary:
wandb:                                                  _step 154
wandb:                                     validation_prc-auc 0.276666072480056
wandb:                                               _runtime 49.03813719749451
wandb:                                             _timestamp 1596861763.5811923
wandb:                                           test_prc-auc 0.1
wandb: Syncing 5 W&B file(s), 5 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: - 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb: \ 0.17MB of 0.17MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Synced finetuning_finetuning_on_CHEMBL1794358_test_task: https://app.wandb.ai/apappu97/molecule-metalearning/runs/nzz15b45
