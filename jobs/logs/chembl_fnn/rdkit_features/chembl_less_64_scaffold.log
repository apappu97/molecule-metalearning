Fold 0
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 108397.10it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 3770.00it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 57%|█████▋    | 196/343 [00:00<00:00, 1833.14it/s]100%|██████████| 343/343 [00:00<00:00, 1724.84it/s]
Number of tasks = 8
Splitting data with seed 0
  0%|          | 0/343 [00:00<?, ?it/s] 48%|████▊     | 165/343 [00:00<00:00, 1620.59it/s] 94%|█████████▍| 322/343 [00:00<00:00, 1584.42it/s]100%|██████████| 343/343 [00:00<00:00, 1552.02it/s]
Total scaffolds = 230 | train scaffolds = 170 | val scaffolds = 28 | test scaffolds = 32
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan, nan, nan, nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan, nan, nan, nan,  1., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan, nan, nan, nan, nan, nan,  1.]), array([0, 0, 0, 0, 0, 0, 0, 1])), (array([ 0., nan, nan, nan, nan, nan, nan, nan]), array([1, 0, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:07<00:37,  7.49s/it][A
 33%|███▎      | 2/6 [00:07<00:21,  5.30s/it][A
 50%|█████     | 3/6 [00:07<00:11,  3.77s/it][A
 67%|██████▋   | 4/6 [00:08<00:05,  2.68s/it][A
 83%|████████▎ | 5/6 [00:08<00:01,  1.92s/it][A100%|██████████| 6/6 [00:08<00:00,  1.37s/it]

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:00<00:00,  9.44it/s][A100%|██████████| 1/1 [00:00<00:00,  9.42it/s]
Validation auc = 0.468750
  2%|▏         | 1/50 [00:08<06:53,  8.44s/it]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.64it/s][ALoss = 1.1827e-02, PNorm = 35.2674, GNorm = 1.4813, lr_0 = 9.8099e-04
Loss = 2.5626e-02, PNorm = 35.2718, GNorm = 1.9864, lr_0 = 9.7163e-04

100%|██████████| 6/6 [00:00<00:00, 23.55it/s][A100%|██████████| 6/6 [00:00<00:00, 24.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 51.00it/s]
Validation auc = 0.572917
  4%|▍         | 2/50 [00:08<04:49,  6.02s/it]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.45it/s][A100%|██████████| 6/6 [00:00<00:00, 27.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.64it/s]
Validation auc = 0.489583
  6%|▌         | 3/50 [00:09<03:21,  4.29s/it]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.77it/s][ALoss = 7.4647e-03, PNorm = 35.3219, GNorm = 0.6969, lr_0 = 8.8274e-04

 83%|████████▎ | 5/6 [00:00<00:00, 14.49it/s][A100%|██████████| 6/6 [00:00<00:00, 14.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.28it/s]
Validation auc = 0.552083
  8%|▊         | 4/50 [00:09<02:24,  3.14s/it]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.16it/s][A100%|██████████| 6/6 [00:00<00:00, 33.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.84it/s]
Validation auc = 0.593750
 10%|█         | 5/50 [00:09<01:43,  2.29s/it]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.6512e-03, PNorm = 35.3859, GNorm = 0.5472, lr_0 = 7.9433e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.39it/s][A100%|██████████| 6/6 [00:00<00:00, 43.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.40it/s]
Validation auc = 0.593750
 12%|█▏        | 6/50 [00:10<01:12,  1.65s/it]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.05it/s][A100%|██████████| 6/6 [00:00<00:00, 44.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.42it/s]
Validation auc = 0.593750
 14%|█▍        | 7/50 [00:10<00:51,  1.21s/it]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.4686e-03, PNorm = 35.4494, GNorm = 0.4322, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.73it/s][A100%|██████████| 6/6 [00:00<00:00, 43.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.15it/s]
Validation auc = 0.635417
 16%|█▌        | 8/50 [00:10<00:38,  1.10it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.09it/s][A100%|██████████| 6/6 [00:00<00:00, 41.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.97it/s]
Validation auc = 0.635417
 18%|█▊        | 9/50 [00:10<00:28,  1.46it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.4926e-03, PNorm = 35.5107, GNorm = 0.4227, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.21it/s][A100%|██████████| 6/6 [00:00<00:00, 41.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.42it/s]
Validation auc = 0.635417
 20%|██        | 10/50 [00:10<00:21,  1.89it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 38.40it/s][ALoss = 3.5183e-03, PNorm = 35.5741, GNorm = 0.5438, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 34.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 27.13it/s]
Validation auc = 0.510417
 22%|██▏       | 11/50 [00:10<00:17,  2.25it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.52it/s][A100%|██████████| 6/6 [00:00<00:00, 29.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.03it/s]
Validation auc = 0.510417
 24%|██▍       | 12/50 [00:11<00:14,  2.64it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.64it/s][ALoss = 2.6992e-03, PNorm = 35.6344, GNorm = 0.3993, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 38.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.14it/s]
Validation auc = 0.479167
 26%|██▌       | 13/50 [00:11<00:11,  3.14it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.70it/s][A100%|██████████| 6/6 [00:00<00:00, 43.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.03it/s]
Validation auc = 0.479167
 28%|██▊       | 14/50 [00:11<00:09,  3.69it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.3105e-03, PNorm = 35.6964, GNorm = 0.3703, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.56it/s][A100%|██████████| 6/6 [00:00<00:00, 42.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.76it/s]
Validation auc = 0.479167
 30%|███       | 15/50 [00:11<00:08,  4.19it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.30it/s][A100%|██████████| 6/6 [00:00<00:00, 43.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.52it/s]
Validation auc = 0.479167
 32%|███▏      | 16/50 [00:11<00:07,  4.64it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1584e-03, PNorm = 35.7524, GNorm = 0.4936, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.71it/s][A100%|██████████| 6/6 [00:00<00:00, 42.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.06it/s]
Validation auc = 0.479167
 34%|███▍      | 17/50 [00:12<00:06,  5.00it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.46it/s][A100%|██████████| 6/6 [00:00<00:00, 43.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.31it/s]
Validation auc = 0.479167
 36%|███▌      | 18/50 [00:12<00:06,  5.31it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7537e-03, PNorm = 35.8042, GNorm = 0.3049, lr_0 = 3.7946e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.77it/s][A100%|██████████| 6/6 [00:00<00:00, 43.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.38it/s]
Validation auc = 0.479167
 38%|███▊      | 19/50 [00:12<00:05,  5.57it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.17it/s][A100%|██████████| 6/6 [00:00<00:00, 44.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.08it/s]
Validation auc = 0.479167
 40%|████      | 20/50 [00:12<00:05,  5.77it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9458e-03, PNorm = 35.8537, GNorm = 0.2952, lr_0 = 3.4145e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.86it/s][A100%|██████████| 6/6 [00:00<00:00, 43.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.52it/s]
Validation auc = 0.479167
 42%|████▏     | 21/50 [00:12<00:04,  5.91it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5561e-03, PNorm = 35.8922, GNorm = 0.4791, lr_0 = 3.1022e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.42it/s][ALoss = 2.7428e-03, PNorm = 35.8956, GNorm = 0.3130, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 42.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.60it/s]
Validation auc = 0.479167
 44%|████▍     | 22/50 [00:12<00:04,  5.97it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 24.89it/s][A100%|██████████| 6/6 [00:00<00:00, 30.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.72it/s]
Validation auc = 0.479167
 46%|████▌     | 23/50 [00:13<00:04,  5.45it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4512e-03, PNorm = 35.9322, GNorm = 0.2224, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.56it/s][A100%|██████████| 6/6 [00:00<00:00, 37.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.11it/s]
Validation auc = 0.479167
 48%|████▊     | 24/50 [00:13<00:04,  5.29it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.49it/s][A100%|██████████| 6/6 [00:00<00:00, 27.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.91it/s]
Validation auc = 0.479167
 50%|█████     | 25/50 [00:13<00:05,  4.72it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2884e-03, PNorm = 35.9676, GNorm = 0.3975, lr_0 = 2.5119e-04

 50%|█████     | 3/6 [00:00<00:00, 24.67it/s][A100%|██████████| 6/6 [00:00<00:00, 27.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.35it/s]
Validation auc = 0.479167
 52%|█████▏    | 26/50 [00:13<00:05,  4.33it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.51it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.91it/s][A100%|██████████| 6/6 [00:00<00:00, 26.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.50it/s]
Validation auc = 0.479167
 54%|█████▍    | 27/50 [00:14<00:05,  4.08it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0989e-03, PNorm = 36.0041, GNorm = 0.2452, lr_0 = 2.2387e-04

 50%|█████     | 3/6 [00:00<00:00, 21.26it/s][A
100%|██████████| 6/6 [00:00<00:00, 22.71it/s][A100%|██████████| 6/6 [00:00<00:00, 23.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.86it/s]
Validation auc = 0.479167
 56%|█████▌    | 28/50 [00:14<00:05,  3.82it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.19it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.36it/s][A100%|██████████| 6/6 [00:00<00:00, 24.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.15it/s]
Validation auc = 0.479167
 58%|█████▊    | 29/50 [00:14<00:05,  3.68it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2055e-03, PNorm = 36.0312, GNorm = 0.2900, lr_0 = 2.0145e-04

 50%|█████     | 3/6 [00:00<00:00, 20.71it/s][A
100%|██████████| 6/6 [00:00<00:00, 22.16it/s][A100%|██████████| 6/6 [00:00<00:00, 23.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.40it/s]
Validation auc = 0.479167
 60%|██████    | 30/50 [00:14<00:05,  3.61it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.30it/s][A100%|██████████| 6/6 [00:00<00:00, 41.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.18it/s]
Validation auc = 0.479167
 62%|██████▏   | 31/50 [00:15<00:04,  4.08it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.1273e-04, PNorm = 36.0564, GNorm = 0.1764, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.88it/s][A100%|██████████| 6/6 [00:00<00:00, 39.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.80it/s]
Validation auc = 0.479167
 64%|██████▍   | 32/50 [00:15<00:04,  4.44it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.33it/s][ALoss = 9.9578e-04, PNorm = 36.0767, GNorm = 0.4326, lr_0 = 1.6469e-04
Loss = 2.1678e-03, PNorm = 36.0787, GNorm = 0.2958, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 39.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.28it/s]
Validation auc = 0.479167
 66%|██████▌   | 33/50 [00:15<00:03,  4.76it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.77it/s][A100%|██████████| 6/6 [00:00<00:00, 43.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.29it/s]
Validation auc = 0.479167
 68%|██████▊   | 34/50 [00:15<00:03,  5.12it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.6795e-04, PNorm = 36.0971, GNorm = 0.2997, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.79it/s][A100%|██████████| 6/6 [00:00<00:00, 42.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.50it/s]
Validation auc = 0.479167
 70%|███████   | 35/50 [00:15<00:02,  5.36it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.12it/s][A100%|██████████| 6/6 [00:00<00:00, 43.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.40it/s]
Validation auc = 0.479167
 72%|███████▏  | 36/50 [00:15<00:02,  5.59it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  7.33it/s][ALoss = 9.2498e-04, PNorm = 36.1151, GNorm = 0.1888, lr_0 = 1.3335e-04

 83%|████████▎ | 5/6 [00:00<00:00,  9.69it/s][A100%|██████████| 6/6 [00:00<00:00, 23.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.52it/s]
Validation auc = 0.479167
 74%|███████▍  | 37/50 [00:16<00:02,  4.81it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.99it/s][A100%|██████████| 6/6 [00:00<00:00, 44.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.21it/s]
Validation auc = 0.479167
 76%|███████▌  | 38/50 [00:16<00:02,  5.17it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2420e-04, PNorm = 36.1303, GNorm = 0.1719, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.18it/s][A100%|██████████| 6/6 [00:00<00:00, 41.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.45it/s]
Validation auc = 0.479167
 78%|███████▊  | 39/50 [00:16<00:02,  5.40it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.67it/s][A100%|██████████| 6/6 [00:00<00:00, 43.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.00it/s]
Validation auc = 0.479167
 80%|████████  | 40/50 [00:16<00:01,  5.62it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5104e-04, PNorm = 36.1440, GNorm = 0.2158, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.03it/s][A100%|██████████| 6/6 [00:00<00:00, 36.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 57.93it/s]
Validation auc = 0.479167
 82%|████████▏ | 41/50 [00:16<00:01,  5.43it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.72it/s][ALoss = 8.9342e-04, PNorm = 36.1571, GNorm = 0.4038, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 22.46it/s][A100%|██████████| 6/6 [00:00<00:00, 22.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 38.80it/s]
Validation auc = 0.479167
 84%|████████▍ | 42/50 [00:17<00:01,  4.51it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.20it/s][A100%|██████████| 6/6 [00:00<00:00, 35.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.75it/s]
Validation auc = 0.479167
 86%|████████▌ | 43/50 [00:17<00:01,  4.69it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2569e-04, PNorm = 36.1693, GNorm = 0.2166, lr_0 = 1.0000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 39.73it/s][A100%|██████████| 6/6 [00:00<00:00, 42.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 66.07it/s]
Validation auc = 0.479167
 88%|████████▊ | 44/50 [00:17<00:01,  5.01it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.01it/s][A100%|██████████| 6/6 [00:00<00:00, 36.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.58it/s]
Validation auc = 0.479167
 90%|█████████ | 45/50 [00:17<00:00,  5.08it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.8852e-04, PNorm = 36.1820, GNorm = 0.2148, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 27.00it/s][A100%|██████████| 6/6 [00:00<00:00, 28.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 52.49it/s]
Validation auc = 0.479167
 92%|█████████▏| 46/50 [00:18<00:00,  4.70it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 17.36it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 19.67it/s][A100%|██████████| 6/6 [00:00<00:00, 24.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 56.59it/s]
Validation auc = 0.479167
 94%|█████████▍| 47/50 [00:18<00:00,  4.36it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.3561e-04, PNorm = 36.1942, GNorm = 0.1504, lr_0 = 1.0000e-04

 50%|█████     | 3/6 [00:00<00:00, 25.39it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.64it/s][A100%|██████████| 6/6 [00:00<00:00, 25.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 49.03it/s]
Validation auc = 0.479167
 96%|█████████▌| 48/50 [00:18<00:00,  4.17it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.38it/s][A100%|██████████| 6/6 [00:00<00:00, 31.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.68it/s]
Validation auc = 0.479167
 98%|█████████▊| 49/50 [00:18<00:00,  4.31it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.5154e-04, PNorm = 36.2062, GNorm = 0.1734, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.98it/s][A100%|██████████| 6/6 [00:00<00:00, 41.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.57it/s]
Validation auc = 0.479167
100%|██████████| 50/50 [00:18<00:00,  4.69it/s]100%|██████████| 50/50 [00:18<00:00,  2.64it/s]
Model 0 best validation auc = 0.635417 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.87it/s]100%|██████████| 1/1 [00:00<00:00,  8.84it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.708333
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.708333
Fold 1
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 121589.44it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 119073.52it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 47%|████▋     | 160/343 [00:00<00:00, 1598.41it/s]100%|██████████| 343/343 [00:00<00:00, 2193.48it/s]
Number of tasks = 8
Splitting data with seed 1
  0%|          | 0/343 [00:00<?, ?it/s] 93%|█████████▎| 320/343 [00:00<00:00, 3193.75it/s]100%|██████████| 343/343 [00:00<00:00, 3159.49it/s]
Total scaffolds = 230 | train scaffolds = 173 | val scaffolds = 31 | test scaffolds = 26
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 2, 0])), (array([ 0., nan, nan, nan, nan, nan, nan, nan]), array([1, 0, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan,  1., nan, nan, nan, nan]), array([0, 0, 0, 1, 0, 0, 0, 0])), (array([nan, nan,  1., nan, nan, nan, nan, nan]), array([0, 0, 1, 0, 0, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.56it/s][A100%|██████████| 6/6 [00:00<00:00, 38.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.462963
  2%|▏         | 1/50 [00:00<00:11,  4.44it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.34it/s][ALoss = 1.1243e-02, PNorm = 35.2657, GNorm = 1.2573, lr_0 = 9.8099e-04
Loss = 2.2172e-02, PNorm = 35.2702, GNorm = 1.6273, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 33.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.474537
  4%|▍         | 2/50 [00:00<00:11,  4.30it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.63it/s][A100%|██████████| 6/6 [00:00<00:00, 42.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.456019
  6%|▌         | 3/50 [00:00<00:09,  4.74it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1098e-03, PNorm = 35.3195, GNorm = 0.7513, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.35it/s][A100%|██████████| 6/6 [00:00<00:00, 42.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
  8%|▊         | 4/50 [00:00<00:09,  5.08it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.65it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.11it/s][A100%|██████████| 6/6 [00:00<00:00, 27.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 17.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.518519
 10%|█         | 5/50 [00:01<00:12,  3.73it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 12.95it/s][ALoss = 5.4152e-03, PNorm = 35.3835, GNorm = 0.5434, lr_0 = 7.9433e-04

 50%|█████     | 3/6 [00:00<00:00,  7.60it/s][A100%|██████████| 6/6 [00:00<00:00, 12.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.476852
 12%|█▏        | 6/50 [00:01<00:15,  2.93it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.73it/s][A100%|██████████| 6/6 [00:00<00:00, 41.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.497685
 14%|█▍        | 7/50 [00:01<00:12,  3.45it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.0026e-03, PNorm = 35.4500, GNorm = 0.5018, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.63it/s][A100%|██████████| 6/6 [00:00<00:00, 42.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.555556
 16%|█▌        | 8/50 [00:02<00:11,  3.77it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.32it/s][A100%|██████████| 6/6 [00:00<00:00, 42.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.513889
 18%|█▊        | 9/50 [00:02<00:09,  4.27it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.9380e-03, PNorm = 35.5149, GNorm = 0.4047, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.39it/s][A100%|██████████| 6/6 [00:00<00:00, 42.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.546296
 20%|██        | 10/50 [00:02<00:08,  4.69it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.79it/s][ALoss = 3.3279e-03, PNorm = 35.5808, GNorm = 0.6627, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 42.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.504630
 22%|██▏       | 11/50 [00:02<00:07,  5.04it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.14it/s][A100%|██████████| 6/6 [00:00<00:00, 43.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 24%|██▍       | 12/50 [00:02<00:07,  5.36it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.16it/s][ALoss = 2.5136e-03, PNorm = 35.6428, GNorm = 0.5018, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 30.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.467593
 26%|██▌       | 13/50 [00:03<00:07,  4.94it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.97it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.36it/s][A100%|██████████| 6/6 [00:00<00:00, 24.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 57.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.467593
 28%|██▊       | 14/50 [00:03<00:08,  4.41it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.11it/s][ALoss = 2.0791e-03, PNorm = 35.7022, GNorm = 0.4158, lr_0 = 4.6863e-04

 83%|████████▎ | 5/6 [00:00<00:00, 22.66it/s][A100%|██████████| 6/6 [00:00<00:00, 24.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 58.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.467593
 30%|███       | 15/50 [00:03<00:08,  4.08it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.68it/s][A100%|██████████| 6/6 [00:00<00:00, 28.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.34it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.467593
 32%|███▏      | 16/50 [00:03<00:08,  4.01it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8773e-03, PNorm = 35.7549, GNorm = 0.3432, lr_0 = 4.2170e-04

 50%|█████     | 3/6 [00:00<00:00, 24.31it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.67it/s][A100%|██████████| 6/6 [00:00<00:00, 26.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.30it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.467593
 34%|███▍      | 17/50 [00:04<00:08,  3.91it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.88it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.05it/s][A100%|██████████| 6/6 [00:00<00:00, 25.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 36%|███▌      | 18/50 [00:04<00:08,  3.81it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6106e-03, PNorm = 35.8029, GNorm = 0.4141, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 22.58it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.39it/s][A100%|██████████| 6/6 [00:00<00:00, 25.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 38%|███▊      | 19/50 [00:04<00:08,  3.76it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.66it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.33it/s][A100%|██████████| 6/6 [00:00<00:00, 24.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 40%|████      | 20/50 [00:04<00:08,  3.69it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4490e-03, PNorm = 35.8477, GNorm = 0.3413, lr_0 = 3.4145e-04

 50%|█████     | 3/6 [00:00<00:00, 24.82it/s][A100%|██████████| 6/6 [00:00<00:00, 27.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 42%|████▏     | 21/50 [00:05<00:07,  3.74it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.74it/s][ALoss = 1.4452e-03, PNorm = 35.8846, GNorm = 0.2258, lr_0 = 3.1022e-04
Loss = 2.5202e-03, PNorm = 35.8878, GNorm = 0.3767, lr_0 = 3.0726e-04

100%|██████████| 6/6 [00:00<00:00, 25.96it/s][A100%|██████████| 6/6 [00:00<00:00, 26.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 44%|████▍     | 22/50 [00:05<00:07,  3.75it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.35it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 18.98it/s][A100%|██████████| 6/6 [00:00<00:00, 21.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.79it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 46%|████▌     | 23/50 [00:05<00:07,  3.51it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3448e-03, PNorm = 35.9222, GNorm = 0.3072, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.74it/s][A100%|██████████| 6/6 [00:00<00:00, 39.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 48%|████▊     | 24/50 [00:05<00:06,  3.92it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.68it/s][A100%|██████████| 6/6 [00:00<00:00, 41.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.34it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 50%|█████     | 25/50 [00:06<00:05,  4.37it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 14.38it/s][ALoss = 1.1737e-03, PNorm = 35.9534, GNorm = 0.3353, lr_0 = 2.5119e-04
100%|██████████| 6/6 [00:00<00:00, 26.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 52%|█████▏    | 26/50 [00:06<00:05,  4.23it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.56it/s][A100%|██████████| 6/6 [00:00<00:00, 38.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 58.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.495370
 54%|█████▍    | 27/50 [00:06<00:05,  4.54it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1389e-03, PNorm = 35.9843, GNorm = 0.2830, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 29.85it/s][A100%|██████████| 6/6 [00:00<00:00, 30.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 38.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 56%|█████▌    | 28/50 [00:06<00:04,  4.43it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.76it/s][A100%|██████████| 6/6 [00:00<00:00, 32.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 58%|█████▊    | 29/50 [00:07<00:04,  4.43it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0250e-03, PNorm = 36.0071, GNorm = 0.1753, lr_0 = 2.0145e-04

 50%|█████     | 3/6 [00:00<00:00, 23.72it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.83it/s][A100%|██████████| 6/6 [00:00<00:00, 25.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 60.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 60%|██████    | 30/50 [00:07<00:04,  4.15it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 14.70it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 14.91it/s][A100%|██████████| 6/6 [00:00<00:00, 19.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 62%|██████▏   | 31/50 [00:07<00:05,  3.71it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.9217e-04, PNorm = 36.0306, GNorm = 0.2046, lr_0 = 1.8127e-04

 50%|█████     | 3/6 [00:00<00:00, 28.35it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.58it/s][A100%|██████████| 6/6 [00:00<00:00, 25.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 64%|██████▍   | 32/50 [00:07<00:04,  3.65it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.77it/s][ALoss = 9.4604e-04, PNorm = 36.0489, GNorm = 0.2940, lr_0 = 1.6469e-04

 83%|████████▎ | 5/6 [00:00<00:00, 20.67it/s][ALoss = 2.4265e-03, PNorm = 36.0507, GNorm = 0.4034, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 23.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 66%|██████▌   | 33/50 [00:08<00:04,  3.65it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 18.38it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 18.50it/s][A100%|██████████| 6/6 [00:00<00:00, 20.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 32.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 68%|██████▊   | 34/50 [00:08<00:04,  3.40it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.98it/s][ALoss = 8.9616e-04, PNorm = 36.0682, GNorm = 0.2176, lr_0 = 1.4819e-04
100%|██████████| 6/6 [00:00<00:00, 29.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 70%|███████   | 35/50 [00:08<00:04,  3.65it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.92it/s][A100%|██████████| 6/6 [00:00<00:00, 30.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 72%|███████▏  | 36/50 [00:09<00:03,  3.80it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.3152e-04, PNorm = 36.0839, GNorm = 0.1914, lr_0 = 1.3335e-04

 50%|█████     | 3/6 [00:00<00:00, 23.52it/s][A100%|██████████| 6/6 [00:00<00:00, 26.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 63.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 74%|███████▍  | 37/50 [00:09<00:03,  3.84it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.58it/s][A100%|██████████| 6/6 [00:00<00:00, 37.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 76%|███████▌  | 38/50 [00:09<00:02,  4.21it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.1556e-04, PNorm = 36.1000, GNorm = 0.2675, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 26.17it/s][A100%|██████████| 6/6 [00:00<00:00, 28.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 59.57it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 78%|███████▊  | 39/50 [00:09<00:02,  4.20it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.90it/s][A
 50%|█████     | 3/6 [00:00<00:00,  8.53it/s][A100%|██████████| 6/6 [00:00<00:00, 13.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 80%|████████  | 40/50 [00:10<00:03,  3.27it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.8307e-04, PNorm = 36.1129, GNorm = 0.1993, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.65it/s][A100%|██████████| 6/6 [00:00<00:00, 38.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 61.24it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 82%|████████▏ | 41/50 [00:10<00:02,  3.72it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.21it/s][ALoss = 8.6106e-04, PNorm = 36.1250, GNorm = 0.2254, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 40.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 84%|████████▍ | 42/50 [00:10<00:01,  4.19it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.67it/s][A100%|██████████| 6/6 [00:00<00:00, 42.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 86%|████████▌ | 43/50 [00:10<00:01,  4.63it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.73it/s][ALoss = 7.5611e-04, PNorm = 36.1371, GNorm = 0.1961, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 24.90it/s][A100%|██████████| 6/6 [00:00<00:00, 25.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 88%|████████▊ | 44/50 [00:10<00:01,  4.39it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.51it/s][A100%|██████████| 6/6 [00:00<00:00, 42.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.09it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 90%|█████████ | 45/50 [00:11<00:01,  4.81it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5509e-04, PNorm = 36.1483, GNorm = 0.1272, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.66it/s][A100%|██████████| 6/6 [00:00<00:00, 42.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 92%|█████████▏| 46/50 [00:11<00:00,  5.14it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.83it/s][A100%|██████████| 6/6 [00:00<00:00, 42.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 94%|█████████▍| 47/50 [00:11<00:00,  5.41it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.9459e-04, PNorm = 36.1601, GNorm = 0.1489, lr_0 = 1.0000e-04

 50%|█████     | 3/6 [00:00<00:00, 27.38it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.88it/s][A100%|██████████| 6/6 [00:00<00:00, 26.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.537037
 96%|█████████▌| 48/50 [00:11<00:00,  4.85it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.00it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.47it/s][A100%|██████████| 6/6 [00:00<00:00, 28.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.546296
 98%|█████████▊| 49/50 [00:11<00:00,  4.65it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.3406e-04, PNorm = 36.1719, GNorm = 0.1840, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.09it/s][A100%|██████████| 6/6 [00:00<00:00, 42.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.546296
100%|██████████| 50/50 [00:12<00:00,  5.01it/s]100%|██████████| 50/50 [00:12<00:00,  4.14it/s]
Model 0 best validation auc = 0.555556 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 45.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Model 0 test auc = 0.430556
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Ensemble test auc = 0.430556
Fold 2
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 120318.33it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 107034.17it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 96%|█████████▌| 330/343 [00:00<00:00, 3292.82it/s]100%|██████████| 343/343 [00:00<00:00, 3291.64it/s]
Number of tasks = 8
Splitting data with seed 2
  0%|          | 0/343 [00:00<?, ?it/s] 44%|████▍     | 152/343 [00:00<00:00, 1444.01it/s] 78%|███████▊  | 268/343 [00:00<00:00, 1324.29it/s]100%|██████████| 343/343 [00:00<00:00, 1399.83it/s]
Total scaffolds = 230 | train scaffolds = 189 | val scaffolds = 24 | test scaffolds = 17
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([nan, nan, nan,  1., nan, nan, nan, nan]), array([0, 0, 0, 1, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  1., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan,  0., nan, nan, nan, nan, nan, nan]), array([0, 1, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan, nan,  0.]), array([0, 0, 0, 0, 0, 0, 0, 1])), (array([nan, nan, nan, nan, nan, 0.5, nan, nan]), array([0, 0, 0, 0, 0, 2, 0, 0])), (array([nan, nan,  1.,  1., nan, nan, nan, nan]), array([0, 0, 1, 1, 0, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.81it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.04it/s][A100%|██████████| 6/6 [00:00<00:00, 24.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
  2%|▏         | 1/50 [00:00<00:19,  2.49it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 14.26it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 13.90it/s][ALoss = 1.2200e-02, PNorm = 35.2643, GNorm = 1.0902, lr_0 = 9.8099e-04
Loss = 1.8740e-02, PNorm = 35.2691, GNorm = 1.3545, lr_0 = 9.7163e-04

100%|██████████| 6/6 [00:00<00:00, 15.24it/s][A100%|██████████| 6/6 [00:00<00:00, 15.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 49.37it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.354167
  4%|▍         | 2/50 [00:00<00:20,  2.32it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.72it/s][A100%|██████████| 6/6 [00:00<00:00, 43.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.354167
  6%|▌         | 3/50 [00:01<00:16,  2.87it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 14.73it/s][ALoss = 7.5304e-03, PNorm = 35.3210, GNorm = 0.7109, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 12.02it/s][A
100%|██████████| 6/6 [00:00<00:00, 13.53it/s][A100%|██████████| 6/6 [00:00<00:00, 14.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 34.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.250000
  8%|▊         | 4/50 [00:01<00:17,  2.61it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.68it/s][A100%|██████████| 6/6 [00:00<00:00, 42.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
 10%|█         | 5/50 [00:01<00:14,  3.16it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.5797e-03, PNorm = 35.3924, GNorm = 0.6061, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.00it/s][A100%|██████████| 6/6 [00:00<00:00, 42.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
 12%|█▏        | 6/50 [00:01<00:11,  3.71it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.66it/s][A100%|██████████| 6/6 [00:00<00:00, 42.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
 14%|█▍        | 7/50 [00:02<00:10,  4.21it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.1053e-03, PNorm = 35.4604, GNorm = 0.4964, lr_0 = 7.1477e-04

 33%|███▎      | 2/6 [00:00<00:00, 12.52it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 14.59it/s][A100%|██████████| 6/6 [00:00<00:00, 18.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 32.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 16%|█▌        | 8/50 [00:02<00:12,  3.31it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.87it/s][A100%|██████████| 6/6 [00:00<00:00, 41.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 18%|█▊        | 9/50 [00:02<00:10,  3.84it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.8707e-03, PNorm = 35.5326, GNorm = 0.4224, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.72it/s][A100%|██████████| 6/6 [00:00<00:00, 41.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.416667
 20%|██        | 10/50 [00:02<00:09,  4.33it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.95it/s][ALoss = 3.4844e-03, PNorm = 35.6061, GNorm = 0.7003, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 40.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.479167
 22%|██▏       | 11/50 [00:02<00:08,  4.42it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.20it/s][A100%|██████████| 6/6 [00:00<00:00, 31.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 20.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.520833
 24%|██▍       | 12/50 [00:03<00:10,  3.76it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 18.35it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 17.35it/s][ALoss = 2.6422e-03, PNorm = 35.6774, GNorm = 0.3426, lr_0 = 5.2079e-04

100%|██████████| 6/6 [00:00<00:00, 16.92it/s][A100%|██████████| 6/6 [00:00<00:00, 16.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 34.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.562500
 26%|██▌       | 13/50 [00:03<00:12,  3.02it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.67it/s][A100%|██████████| 6/6 [00:00<00:00, 41.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 28%|██▊       | 14/50 [00:04<00:10,  3.56it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1181e-03, PNorm = 35.7440, GNorm = 0.4080, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.87it/s][A100%|██████████| 6/6 [00:00<00:00, 42.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 34.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 30%|███       | 15/50 [00:04<00:08,  3.96it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.23it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 20.71it/s][A100%|██████████| 6/6 [00:00<00:00, 24.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 51.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.562500
 32%|███▏      | 16/50 [00:04<00:08,  3.87it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7456e-03, PNorm = 35.8046, GNorm = 0.3372, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.18it/s][A100%|██████████| 6/6 [00:00<00:00, 37.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 34%|███▍      | 17/50 [00:04<00:07,  4.26it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.65it/s][A100%|██████████| 6/6 [00:00<00:00, 40.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 36%|███▌      | 18/50 [00:04<00:06,  4.65it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5309e-03, PNorm = 35.8634, GNorm = 0.2950, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 25.56it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.12it/s][A100%|██████████| 6/6 [00:00<00:00, 24.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 38%|███▊      | 19/50 [00:05<00:07,  4.37it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.23it/s][A100%|██████████| 6/6 [00:00<00:00, 41.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 40%|████      | 20/50 [00:05<00:06,  4.77it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5819e-03, PNorm = 35.9136, GNorm = 0.3932, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.69it/s][A100%|██████████| 6/6 [00:00<00:00, 40.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.19it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 42%|████▏     | 21/50 [00:05<00:05,  5.08it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.96it/s][ALoss = 1.3885e-03, PNorm = 35.9522, GNorm = 0.4517, lr_0 = 3.1022e-04
Loss = 3.6456e-03, PNorm = 35.9559, GNorm = 0.5333, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 40.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 44%|████▍     | 22/50 [00:05<00:05,  5.30it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.20it/s][A100%|██████████| 6/6 [00:00<00:00, 28.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.82it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 46%|████▌     | 23/50 [00:05<00:05,  4.78it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3973e-03, PNorm = 35.9929, GNorm = 0.1789, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.09it/s][A100%|██████████| 6/6 [00:00<00:00, 37.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 48%|████▊     | 24/50 [00:06<00:05,  4.98it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.85it/s][A100%|██████████| 6/6 [00:00<00:00, 41.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.69it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 50%|█████     | 25/50 [00:06<00:04,  5.29it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1080e-03, PNorm = 36.0291, GNorm = 0.2346, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.45it/s][A100%|██████████| 6/6 [00:00<00:00, 40.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 52%|█████▏    | 26/50 [00:06<00:04,  5.48it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.86it/s][A100%|██████████| 6/6 [00:00<00:00, 41.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 54%|█████▍    | 27/50 [00:06<00:04,  5.65it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0678e-03, PNorm = 36.0653, GNorm = 0.2153, lr_0 = 2.2387e-04

 50%|█████     | 3/6 [00:00<00:00, 26.31it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.91it/s][A100%|██████████| 6/6 [00:00<00:00, 25.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.29it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 56%|█████▌    | 28/50 [00:06<00:04,  5.01it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.32it/s][A100%|██████████| 6/6 [00:00<00:00, 27.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.86it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 58%|█████▊    | 29/50 [00:07<00:04,  4.63it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  5.32it/s][ALoss = 9.1151e-04, PNorm = 36.0948, GNorm = 0.1682, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00,  7.01it/s][A100%|██████████| 6/6 [00:00<00:00, 17.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 60%|██████    | 30/50 [00:07<00:05,  3.81it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 27.93it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 23.46it/s][A100%|██████████| 6/6 [00:00<00:00, 23.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 62%|██████▏   | 31/50 [00:07<00:05,  3.73it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1332e-03, PNorm = 36.1219, GNorm = 0.2141, lr_0 = 1.8127e-04

 50%|█████     | 3/6 [00:00<00:00, 28.21it/s][A100%|██████████| 6/6 [00:00<00:00, 30.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 64%|██████▍   | 32/50 [00:07<00:04,  3.97it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.84it/s][ALoss = 8.8118e-04, PNorm = 36.1427, GNorm = 0.1284, lr_0 = 1.6469e-04
Loss = 2.8817e-03, PNorm = 36.1451, GNorm = 0.4766, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 39.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 66%|██████▌   | 33/50 [00:08<00:03,  4.39it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.91it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.51it/s][A100%|██████████| 6/6 [00:00<00:00, 24.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 68%|██████▊   | 34/50 [00:08<00:03,  4.20it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.8665e-04, PNorm = 36.1667, GNorm = 0.2502, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 27.48it/s][A100%|██████████| 6/6 [00:00<00:00, 27.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 70%|███████   | 35/50 [00:08<00:03,  4.08it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.68it/s][A100%|██████████| 6/6 [00:00<00:00, 41.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 72%|███████▏  | 36/50 [00:08<00:03,  4.53it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2588e-04, PNorm = 36.1853, GNorm = 0.2812, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.25it/s][A100%|██████████| 6/6 [00:00<00:00, 41.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 74%|███████▍  | 37/50 [00:08<00:02,  4.90it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.95it/s][A100%|██████████| 6/6 [00:00<00:00, 41.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 76%|███████▌  | 38/50 [00:09<00:02,  5.19it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.3331e-04, PNorm = 36.2022, GNorm = 0.1856, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 28.64it/s][A100%|██████████| 6/6 [00:00<00:00, 28.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 29.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 78%|███████▊  | 39/50 [00:09<00:02,  4.60it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.64it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 18.32it/s][A100%|██████████| 6/6 [00:00<00:00, 22.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 39.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 80%|████████  | 40/50 [00:09<00:02,  4.11it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.1865e-04, PNorm = 36.2175, GNorm = 0.1568, lr_0 = 1.0798e-04

 50%|█████     | 3/6 [00:00<00:00, 20.67it/s][A100%|██████████| 6/6 [00:00<00:00, 26.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 82%|████████▏ | 41/50 [00:09<00:02,  4.06it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.49it/s][ALoss = 8.2774e-04, PNorm = 36.2309, GNorm = 0.2871, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 35.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 51.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 84%|████████▍ | 42/50 [00:10<00:01,  4.32it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 20.45it/s][A
100%|██████████| 6/6 [00:00<00:00, 22.47it/s][A100%|██████████| 6/6 [00:00<00:00, 24.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 86%|████████▌ | 43/50 [00:10<00:01,  4.10it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.55it/s][ALoss = 7.5211e-04, PNorm = 36.2435, GNorm = 0.2430, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 24.66it/s][A100%|██████████| 6/6 [00:00<00:00, 25.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 88%|████████▊ | 44/50 [00:10<00:01,  3.95it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.09it/s][A100%|██████████| 6/6 [00:00<00:00, 26.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 27.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 90%|█████████ | 45/50 [00:10<00:01,  3.83it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.61it/s][ALoss = 6.6705e-04, PNorm = 36.2569, GNorm = 0.1963, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 29.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 92%|█████████▏| 46/50 [00:11<00:01,  3.97it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.37it/s][A100%|██████████| 6/6 [00:00<00:00, 40.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 94%|█████████▍| 47/50 [00:11<00:00,  4.42it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.7879e-04, PNorm = 36.2695, GNorm = 0.1566, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 31.99it/s][A100%|██████████| 6/6 [00:00<00:00, 32.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 96%|█████████▌| 48/50 [00:11<00:00,  4.45it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 11.80it/s][A100%|██████████| 6/6 [00:00<00:00, 17.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 49.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 98%|█████████▊| 49/50 [00:11<00:00,  3.66it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.4369e-04, PNorm = 36.2816, GNorm = 0.1730, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.18it/s][A100%|██████████| 6/6 [00:00<00:00, 42.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
100%|██████████| 50/50 [00:12<00:00,  4.18it/s]100%|██████████| 50/50 [00:12<00:00,  4.14it/s]
Model 0 best validation auc = 0.562500 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 27.84it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.062500
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.062500
Fold 3
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 88028.29it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 61999.93it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 64%|██████▎   | 218/343 [00:00<00:00, 2172.57it/s]100%|██████████| 343/343 [00:00<00:00, 1923.37it/s]
Number of tasks = 8
Splitting data with seed 3
  0%|          | 0/343 [00:00<?, ?it/s] 58%|█████▊    | 199/343 [00:00<00:00, 1989.36it/s]100%|██████████| 343/343 [00:00<00:00, 2286.48it/s]
Total scaffolds = 230 | train scaffolds = 172 | val scaffolds = 31 | test scaffolds = 27
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([nan, nan, nan, nan, nan, nan, nan,  0.]), array([0, 0, 0, 0, 0, 0, 0, 1])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 2, 0])), (array([ 0., nan, nan, nan, nan, nan, nan, nan]), array([1, 0, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan,  1., nan, nan, nan, nan, nan, nan]), array([0, 1, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 2, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.14it/s][A100%|██████████| 6/6 [00:00<00:00, 27.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.71it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.780556
  2%|▏         | 1/50 [00:00<00:13,  3.52it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.68it/s][ALoss = 1.0871e-02, PNorm = 35.2723, GNorm = 1.5709, lr_0 = 9.8099e-04
Loss = 2.3420e-02, PNorm = 35.2788, GNorm = 2.1513, lr_0 = 9.7163e-04

100%|██████████| 6/6 [00:00<00:00, 26.73it/s][A100%|██████████| 6/6 [00:00<00:00, 26.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.636111
  4%|▍         | 2/50 [00:00<00:13,  3.61it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 12.55it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 14.74it/s][A100%|██████████| 6/6 [00:00<00:00, 20.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.19it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.655556
  6%|▌         | 3/50 [00:00<00:13,  3.47it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.6816e-03, PNorm = 35.3317, GNorm = 0.9507, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.42it/s][A100%|██████████| 6/6 [00:00<00:00, 40.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663889
  8%|▊         | 4/50 [00:01<00:11,  3.96it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.83it/s][A100%|██████████| 6/6 [00:00<00:00, 42.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663889
 10%|█         | 5/50 [00:01<00:10,  4.44it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.0925e-03, PNorm = 35.3840, GNorm = 0.6158, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.20it/s][A100%|██████████| 6/6 [00:00<00:00, 41.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.686111
 12%|█▏        | 6/50 [00:01<00:09,  4.59it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 15.33it/s][A
100%|██████████| 6/6 [00:00<00:00, 18.59it/s][A100%|██████████| 6/6 [00:00<00:00, 25.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.677778
 14%|█▍        | 7/50 [00:01<00:09,  4.34it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.7981e-03, PNorm = 35.4464, GNorm = 0.4602, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.53it/s][A100%|██████████| 6/6 [00:00<00:00, 41.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 16%|█▌        | 8/50 [00:01<00:08,  4.75it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.20it/s][A100%|██████████| 6/6 [00:00<00:00, 41.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 18%|█▊        | 9/50 [00:01<00:08,  5.06it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.7885e-03, PNorm = 35.5003, GNorm = 0.3580, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.93it/s][A100%|██████████| 6/6 [00:00<00:00, 39.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 20%|██        | 10/50 [00:02<00:07,  5.27it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 27.32it/s][ALoss = 3.4646e-03, PNorm = 35.5576, GNorm = 0.7993, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 27.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 22%|██▏       | 11/50 [00:02<00:08,  4.68it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.24it/s][A100%|██████████| 6/6 [00:00<00:00, 39.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 62.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.691667
 24%|██▍       | 12/50 [00:02<00:07,  4.88it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.46it/s][ALoss = 2.6898e-03, PNorm = 35.6139, GNorm = 0.4556, lr_0 = 5.2079e-04

100%|██████████| 6/6 [00:00<00:00, 25.01it/s][A100%|██████████| 6/6 [00:00<00:00, 26.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.683333
 26%|██▌       | 13/50 [00:02<00:08,  4.44it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.24it/s][A100%|██████████| 6/6 [00:00<00:00, 26.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.683333
 28%|██▊       | 14/50 [00:03<00:08,  4.31it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.4204e-03, PNorm = 35.6682, GNorm = 0.3974, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.52it/s][A100%|██████████| 6/6 [00:00<00:00, 42.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.683333
 30%|███       | 15/50 [00:03<00:07,  4.75it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.41it/s][A100%|██████████| 6/6 [00:00<00:00, 43.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:00<00:00,  8.61it/s][A100%|██████████| 1/1 [00:00<00:00,  8.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 32%|███▏      | 16/50 [00:03<00:07,  4.42it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9655e-03, PNorm = 35.7229, GNorm = 0.4096, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.03it/s][A100%|██████████| 6/6 [00:00<00:00, 41.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 34%|███▍      | 17/50 [00:03<00:06,  4.82it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 39.97it/s][A100%|██████████| 6/6 [00:00<00:00, 43.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 36%|███▌      | 18/50 [00:03<00:06,  5.18it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6652e-03, PNorm = 35.7705, GNorm = 0.2451, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.45it/s][A100%|██████████| 6/6 [00:00<00:00, 40.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 38%|███▊      | 19/50 [00:04<00:05,  5.36it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.82it/s][A100%|██████████| 6/6 [00:00<00:00, 39.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 40%|████      | 20/50 [00:04<00:05,  5.50it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6538e-03, PNorm = 35.8138, GNorm = 0.3386, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.97it/s][A100%|██████████| 6/6 [00:00<00:00, 39.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 42%|████▏     | 21/50 [00:04<00:05,  5.57it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.11it/s][ALoss = 1.5561e-03, PNorm = 35.8534, GNorm = 0.3187, lr_0 = 3.1022e-04
Loss = 3.2844e-03, PNorm = 35.8567, GNorm = 0.4373, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 38.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 44%|████▍     | 22/50 [00:04<00:04,  5.62it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.32it/s][A100%|██████████| 6/6 [00:00<00:00, 38.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 46%|████▌     | 23/50 [00:04<00:04,  5.64it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4208e-03, PNorm = 35.8919, GNorm = 0.3010, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.73it/s][A100%|██████████| 6/6 [00:00<00:00, 38.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 62.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.466667
 48%|████▊     | 24/50 [00:04<00:04,  5.61it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.47it/s][A100%|██████████| 6/6 [00:00<00:00, 39.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.72it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.466667
 50%|█████     | 25/50 [00:05<00:04,  5.66it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3967e-03, PNorm = 35.9291, GNorm = 0.4471, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.48it/s][A100%|██████████| 6/6 [00:00<00:00, 41.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.466667
 52%|█████▏    | 26/50 [00:05<00:04,  5.77it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.65it/s][A100%|██████████| 6/6 [00:00<00:00, 25.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 23.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 54%|█████▍    | 27/50 [00:05<00:04,  4.69it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 15.87it/s][ALoss = 1.2536e-03, PNorm = 35.9604, GNorm = 0.2059, lr_0 = 2.2387e-04

100%|██████████| 6/6 [00:00<00:00, 18.93it/s][A100%|██████████| 6/6 [00:00<00:00, 24.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 56.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 56%|█████▌    | 28/50 [00:05<00:05,  4.22it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.73it/s][A100%|██████████| 6/6 [00:00<00:00, 28.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.56it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 58%|█████▊    | 29/50 [00:06<00:05,  4.14it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1420e-03, PNorm = 35.9905, GNorm = 0.2330, lr_0 = 2.0145e-04

 50%|█████     | 3/6 [00:00<00:00, 24.59it/s][A100%|██████████| 6/6 [00:00<00:00, 27.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 60%|██████    | 30/50 [00:06<00:04,  4.04it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.21it/s][A
 67%|██████▋   | 4/6 [00:00<00:00,  9.05it/s][A100%|██████████| 6/6 [00:00<00:00, 12.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 29.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.486111
 62%|██████▏   | 31/50 [00:06<00:06,  2.98it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1986e-03, PNorm = 36.0160, GNorm = 0.2714, lr_0 = 1.8127e-04

 33%|███▎      | 2/6 [00:00<00:00, 19.20it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 19.56it/s][A100%|██████████| 6/6 [00:00<00:00, 21.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.92it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.486111
 64%|██████▍   | 32/50 [00:07<00:05,  3.01it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.00it/s][ALoss = 1.0835e-03, PNorm = 36.0365, GNorm = 0.2913, lr_0 = 1.6469e-04
Loss = 2.1746e-03, PNorm = 36.0384, GNorm = 0.6243, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 36.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.486111
 66%|██████▌   | 33/50 [00:07<00:04,  3.48it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.80it/s][A100%|██████████| 6/6 [00:00<00:00, 43.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.477778
 68%|██████▊   | 34/50 [00:07<00:03,  4.03it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0544e-03, PNorm = 36.0573, GNorm = 0.2161, lr_0 = 1.4819e-04

 83%|████████▎ | 5/6 [00:00<00:00, 39.86it/s][A100%|██████████| 6/6 [00:00<00:00, 42.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.477778
 70%|███████   | 35/50 [00:07<00:03,  4.51it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.41it/s][A100%|██████████| 6/6 [00:00<00:00, 43.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.477778
 72%|███████▏  | 36/50 [00:07<00:02,  4.94it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0242e-03, PNorm = 36.0755, GNorm = 0.2343, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.61it/s][A100%|██████████| 6/6 [00:00<00:00, 43.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.49it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.477778
 74%|███████▍  | 37/50 [00:08<00:02,  5.28it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.50it/s][A100%|██████████| 6/6 [00:00<00:00, 42.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.26it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 76%|███████▌  | 38/50 [00:08<00:02,  5.54it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2536e-04, PNorm = 36.0923, GNorm = 0.1591, lr_0 = 1.2000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.60it/s][A100%|██████████| 6/6 [00:00<00:00, 43.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 78%|███████▊  | 39/50 [00:08<00:01,  5.76it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.85it/s][A100%|██████████| 6/6 [00:00<00:00, 44.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 80%|████████  | 40/50 [00:08<00:01,  5.94it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.2451e-04, PNorm = 36.1069, GNorm = 0.2061, lr_0 = 1.0798e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.50it/s][A100%|██████████| 6/6 [00:00<00:00, 43.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.79it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 82%|████████▏ | 41/50 [00:08<00:01,  6.06it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 27.91it/s][ALoss = 9.4503e-04, PNorm = 36.1201, GNorm = 0.2200, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 25.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 84%|████████▍ | 42/50 [00:08<00:01,  5.09it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.14it/s][A100%|██████████| 6/6 [00:00<00:00, 44.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 86%|████████▌ | 43/50 [00:09<00:01,  5.43it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.4887e-04, PNorm = 36.1332, GNorm = 0.2440, lr_0 = 1.0000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.65it/s][A100%|██████████| 6/6 [00:00<00:00, 43.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 88%|████████▊ | 44/50 [00:09<00:01,  5.68it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.79it/s][A100%|██████████| 6/6 [00:00<00:00, 43.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 90%|█████████ | 45/50 [00:09<00:00,  5.88it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 17.02it/s][ALoss = 8.2354e-04, PNorm = 36.1462, GNorm = 0.2171, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 20.06it/s][A100%|██████████| 6/6 [00:00<00:00, 25.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 38.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.488889
 92%|█████████▏| 46/50 [00:09<00:00,  4.94it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.87it/s][A100%|██████████| 6/6 [00:00<00:00, 32.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.497222
 94%|█████████▍| 47/50 [00:09<00:00,  4.93it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.4413e-04, PNorm = 36.1588, GNorm = 0.1536, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.46it/s][A100%|██████████| 6/6 [00:00<00:00, 29.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 36.29it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.497222
 96%|█████████▌| 48/50 [00:10<00:00,  4.62it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.93it/s][A100%|██████████| 6/6 [00:00<00:00, 30.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.497222
 98%|█████████▊| 49/50 [00:10<00:00,  4.59it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.3282e-04, PNorm = 36.1719, GNorm = 0.1743, lr_0 = 1.0000e-04

 50%|█████     | 3/6 [00:00<00:00, 27.21it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.12it/s][A100%|██████████| 6/6 [00:00<00:00, 25.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 41.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.497222
100%|██████████| 50/50 [00:10<00:00,  4.29it/s]100%|██████████| 50/50 [00:10<00:00,  4.70it/s]
Model 0 best validation auc = 0.780556 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 21.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.487500
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.487500
Fold 4
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 118543.69it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 110741.77it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 59%|█████▉    | 203/343 [00:00<00:00, 1971.03it/s]100%|██████████| 343/343 [00:00<00:00, 1814.69it/s]
Number of tasks = 8
Splitting data with seed 4
  0%|          | 0/343 [00:00<?, ?it/s] 42%|████▏     | 145/343 [00:00<00:00, 1448.37it/s] 75%|███████▌  | 258/343 [00:00<00:00, 1308.50it/s]100%|██████████| 343/343 [00:00<00:00, 1209.54it/s]
Total scaffolds = 230 | train scaffolds = 180 | val scaffolds = 22 | test scaffolds = 28
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([nan, nan, nan, nan, nan, nan,  1., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 2, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan, nan,  0.]), array([0, 0, 0, 0, 0, 0, 0, 3])), (array([nan,  1., nan, nan, nan, nan, nan, nan]), array([0, 1, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan,  1., nan, nan, nan, nan]), array([0, 0, 0, 1, 0, 0, 0, 0])), (array([nan, nan,  1.,  1., nan, nan, nan, nan]), array([0, 0, 1, 1, 0, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.86it/s][A100%|██████████| 6/6 [00:00<00:00, 29.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.86it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.236364
  2%|▏         | 1/50 [00:00<00:15,  3.13it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 19.66it/s][ALoss = 1.0995e-02, PNorm = 35.2689, GNorm = 1.3155, lr_0 = 9.8099e-04

 83%|████████▎ | 5/6 [00:00<00:00, 18.76it/s][ALoss = 1.9625e-02, PNorm = 35.2750, GNorm = 1.8026, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 19.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.34it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.393939
  4%|▍         | 2/50 [00:00<00:16,  2.95it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.81it/s][A100%|██████████| 6/6 [00:00<00:00, 34.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 54.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.366667
  6%|▌         | 3/50 [00:00<00:13,  3.38it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1633e-03, PNorm = 35.3316, GNorm = 0.9554, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 28.08it/s][A100%|██████████| 6/6 [00:00<00:00, 30.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 15.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.357576
  8%|▊         | 4/50 [00:01<00:13,  3.46it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 11.74it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 12.92it/s][A100%|██████████| 6/6 [00:00<00:00, 17.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.348485
 10%|█         | 5/50 [00:01<00:14,  3.05it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.2468e-03, PNorm = 35.3938, GNorm = 0.9228, lr_0 = 7.9433e-04

 50%|█████     | 3/6 [00:00<00:00, 22.53it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.60it/s][A100%|██████████| 6/6 [00:00<00:00, 24.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.339394
 12%|█▏        | 6/50 [00:01<00:13,  3.18it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.15it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.16it/s][A100%|██████████| 6/6 [00:00<00:00, 24.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.348485
 14%|█▍        | 7/50 [00:02<00:13,  3.31it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.3965e-03, PNorm = 35.4548, GNorm = 0.4723, lr_0 = 7.1477e-04

 33%|███▎      | 2/6 [00:00<00:00, 12.92it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 14.40it/s][A100%|██████████| 6/6 [00:00<00:00, 18.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.515152
 16%|█▌        | 8/50 [00:02<00:14,  2.91it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.95it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.27it/s][A100%|██████████| 6/6 [00:00<00:00, 27.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.24it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.515152
 18%|█▊        | 9/50 [00:02<00:13,  3.15it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.9889e-03, PNorm = 35.5202, GNorm = 0.4323, lr_0 = 6.4318e-04

 50%|█████     | 3/6 [00:00<00:00, 24.75it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 13.58it/s][A100%|██████████| 6/6 [00:00<00:00, 13.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 34.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 20%|██        | 10/50 [00:03<00:15,  2.51it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.90it/s][ALoss = 3.2813e-03, PNorm = 35.5833, GNorm = 1.0767, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 37.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.515152
 22%|██▏       | 11/50 [00:03<00:12,  3.01it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 27.84it/s][A100%|██████████| 6/6 [00:00<00:00, 28.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 24%|██▍       | 12/50 [00:03<00:12,  3.17it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.84it/s][ALoss = 2.4829e-03, PNorm = 35.6493, GNorm = 0.4151, lr_0 = 5.2079e-04

100%|██████████| 6/6 [00:00<00:00, 27.22it/s][A100%|██████████| 6/6 [00:00<00:00, 27.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 26%|██▌       | 13/50 [00:04<00:10,  3.43it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.87it/s][A100%|██████████| 6/6 [00:00<00:00, 36.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 59.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 28%|██▊       | 14/50 [00:04<00:09,  3.85it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 27.14it/s][ALoss = 2.2007e-03, PNorm = 35.7144, GNorm = 0.5403, lr_0 = 4.6863e-04
100%|██████████| 6/6 [00:00<00:00, 30.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 30%|███       | 15/50 [00:04<00:08,  4.05it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.24it/s][A100%|██████████| 6/6 [00:00<00:00, 33.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 52.12it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 32%|███▏      | 16/50 [00:04<00:08,  4.25it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8454e-03, PNorm = 35.7759, GNorm = 0.2863, lr_0 = 4.2170e-04

 50%|█████     | 3/6 [00:00<00:00, 28.86it/s][A100%|██████████| 6/6 [00:00<00:00, 34.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 34%|███▍      | 17/50 [00:04<00:07,  4.49it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.81it/s][A100%|██████████| 6/6 [00:00<00:00, 39.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 36%|███▌      | 18/50 [00:05<00:06,  4.84it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7704e-03, PNorm = 35.8356, GNorm = 0.4031, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.60it/s][A100%|██████████| 6/6 [00:00<00:00, 42.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 38%|███▊      | 19/50 [00:05<00:05,  5.22it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 39.92it/s][A100%|██████████| 6/6 [00:00<00:00, 42.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.681818
 40%|████      | 20/50 [00:05<00:05,  5.52it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1973e-03, PNorm = 35.8874, GNorm = 0.2029, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.95it/s][A100%|██████████| 6/6 [00:00<00:00, 41.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 42%|████▏     | 21/50 [00:05<00:05,  5.72it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.10it/s][ALoss = 1.3888e-03, PNorm = 35.9304, GNorm = 0.6435, lr_0 = 3.1022e-04
Loss = 3.9326e-03, PNorm = 35.9337, GNorm = 0.6305, lr_0 = 3.0726e-04

100%|██████████| 6/6 [00:00<00:00, 25.62it/s][A100%|██████████| 6/6 [00:00<00:00, 25.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 44%|████▍     | 22/50 [00:05<00:05,  5.04it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.69it/s][A100%|██████████| 6/6 [00:00<00:00, 43.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 46%|████▌     | 23/50 [00:05<00:04,  5.41it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2568e-03, PNorm = 35.9704, GNorm = 0.2563, lr_0 = 2.7915e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.46it/s][A100%|██████████| 6/6 [00:00<00:00, 43.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.71it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 48%|████▊     | 24/50 [00:06<00:04,  5.69it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.91it/s][A100%|██████████| 6/6 [00:00<00:00, 43.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 50%|█████     | 25/50 [00:06<00:04,  5.92it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1811e-03, PNorm = 36.0075, GNorm = 0.2841, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.10it/s][A100%|██████████| 6/6 [00:00<00:00, 42.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.71it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 52%|█████▏    | 26/50 [00:06<00:03,  6.02it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 17.57it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 18.12it/s][A100%|██████████| 6/6 [00:00<00:00, 21.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.71it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 54%|█████▍    | 27/50 [00:06<00:04,  4.78it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1057e-03, PNorm = 36.0443, GNorm = 0.3697, lr_0 = 2.2387e-04

 50%|█████     | 3/6 [00:00<00:00, 24.80it/s][A100%|██████████| 6/6 [00:00<00:00, 27.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 41.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 56%|█████▌    | 28/50 [00:06<00:04,  4.53it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.14it/s][A100%|██████████| 6/6 [00:00<00:00, 26.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 29.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 58%|█████▊    | 29/50 [00:07<00:04,  4.23it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0932e-03, PNorm = 36.0721, GNorm = 0.2281, lr_0 = 2.0145e-04

 33%|███▎      | 2/6 [00:00<00:00, 15.24it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 16.79it/s][A100%|██████████| 6/6 [00:00<00:00, 20.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 60%|██████    | 30/50 [00:07<00:05,  3.84it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.85it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 19.46it/s][A100%|██████████| 6/6 [00:00<00:00, 20.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 55.56it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 62%|██████▏   | 31/50 [00:07<00:05,  3.57it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.8647e-04, PNorm = 36.0984, GNorm = 0.2776, lr_0 = 1.8127e-04

 50%|█████     | 3/6 [00:00<00:00, 22.90it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.62it/s][A100%|██████████| 6/6 [00:00<00:00, 25.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.82it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 64%|██████▍   | 32/50 [00:08<00:04,  3.66it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.24it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 16.60it/s][ALoss = 9.2536e-04, PNorm = 36.1180, GNorm = 0.1924, lr_0 = 1.6469e-04
Loss = 1.7731e-03, PNorm = 36.1199, GNorm = 0.4008, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 20.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 56.56it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 66%|██████▌   | 33/50 [00:08<00:04,  3.47it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 27.46it/s][A
100%|██████████| 6/6 [00:00<00:00, 27.88it/s][A100%|██████████| 6/6 [00:00<00:00, 28.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.672727
 68%|██████▊   | 34/50 [00:08<00:04,  3.64it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.5522e-04, PNorm = 36.1379, GNorm = 0.2094, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.27it/s][A100%|██████████| 6/6 [00:00<00:00, 41.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 70%|███████   | 35/50 [00:08<00:03,  4.15it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.95it/s][A100%|██████████| 6/6 [00:00<00:00, 42.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 72%|███████▏  | 36/50 [00:09<00:03,  4.63it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 15.34it/s][ALoss = 8.4468e-04, PNorm = 36.1554, GNorm = 0.2929, lr_0 = 1.3335e-04

100%|██████████| 6/6 [00:00<00:00, 18.55it/s][A100%|██████████| 6/6 [00:00<00:00, 24.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 74%|███████▍  | 37/50 [00:09<00:03,  4.22it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.44it/s][A100%|██████████| 6/6 [00:00<00:00, 43.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 76%|███████▌  | 38/50 [00:09<00:02,  4.71it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.8619e-04, PNorm = 36.1716, GNorm = 0.2054, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.06it/s][A100%|██████████| 6/6 [00:00<00:00, 42.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 78%|███████▊  | 39/50 [00:09<00:02,  5.10it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.51it/s][A100%|██████████| 6/6 [00:00<00:00, 42.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 80%|████████  | 40/50 [00:09<00:01,  5.15it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.0033e-04, PNorm = 36.1863, GNorm = 0.2353, lr_0 = 1.0798e-04

 33%|███▎      | 2/6 [00:00<00:00, 15.08it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 17.06it/s][A100%|██████████| 6/6 [00:00<00:00, 22.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 82%|████████▏ | 41/50 [00:10<00:02,  4.38it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.43it/s][ALoss = 8.0398e-04, PNorm = 36.1980, GNorm = 0.2824, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 26.35it/s][A100%|██████████| 6/6 [00:00<00:00, 26.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.47it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 84%|████████▍ | 42/50 [00:10<00:01,  4.26it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.90it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.64it/s][A100%|██████████| 6/6 [00:00<00:00, 27.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 15.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 86%|████████▌ | 43/50 [00:10<00:01,  3.84it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 17.42it/s][ALoss = 7.0584e-04, PNorm = 36.2093, GNorm = 0.1591, lr_0 = 1.0000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 19.35it/s][A100%|██████████| 6/6 [00:00<00:00, 23.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 88%|████████▊ | 44/50 [00:11<00:01,  3.71it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.56it/s][A100%|██████████| 6/6 [00:00<00:00, 28.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 48.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 90%|█████████ | 45/50 [00:11<00:01,  3.82it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.70it/s][ALoss = 6.8937e-04, PNorm = 36.2209, GNorm = 0.3415, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 27.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 22.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 92%|█████████▏| 46/50 [00:11<00:01,  3.77it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 17.05it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 18.65it/s][A100%|██████████| 6/6 [00:00<00:00, 22.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 61.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 94%|█████████▍| 47/50 [00:11<00:00,  3.66it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0832e-04, PNorm = 36.2330, GNorm = 0.1923, lr_0 = 1.0000e-04

 50%|█████     | 3/6 [00:00<00:00, 25.94it/s][A100%|██████████| 6/6 [00:00<00:00, 29.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 96%|█████████▌| 48/50 [00:12<00:00,  3.86it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.17it/s][A100%|██████████| 6/6 [00:00<00:00, 34.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 63.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
 98%|█████████▊| 49/50 [00:12<00:00,  4.17it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.9207e-04, PNorm = 36.2448, GNorm = 0.2151, lr_0 = 1.0000e-04

 50%|█████     | 3/6 [00:00<00:00, 28.53it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.76it/s][A100%|██████████| 6/6 [00:00<00:00, 28.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 57.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.663636
100%|██████████| 50/50 [00:12<00:00,  4.22it/s]100%|██████████| 50/50 [00:12<00:00,  4.01it/s]
Model 0 best validation auc = 0.681818 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 24.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.555556
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.555556
Fold 5
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_5',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 107562.34it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 44072.12it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 79%|███████▊  | 270/343 [00:00<00:00, 2695.13it/s]100%|██████████| 343/343 [00:00<00:00, 2473.65it/s]
Number of tasks = 8
Splitting data with seed 5
  0%|          | 0/343 [00:00<?, ?it/s] 31%|███▏      | 108/343 [00:00<00:00, 1079.20it/s] 69%|██████▉   | 238/343 [00:00<00:00, 1122.51it/s]100%|██████████| 343/343 [00:00<00:00, 1164.43it/s]
Total scaffolds = 230 | train scaffolds = 184 | val scaffolds = 18 | test scaffolds = 28
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan,  0., nan, nan, nan, nan, nan, nan]), array([0, 1, 0, 0, 0, 0, 0, 0])), (array([nan, nan,  1., nan, nan, nan, nan, nan]), array([0, 0, 1, 0, 0, 0, 0, 0])), (array([nan, nan,  1.,  1., nan, nan, nan, nan]), array([0, 0, 1, 1, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan, nan,  1., nan, nan, nan, nan]), array([0, 0, 0, 1, 0, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.45it/s][A100%|██████████| 6/6 [00:00<00:00, 32.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.444444
  2%|▏         | 1/50 [00:00<00:15,  3.16it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.14it/s][ALoss = 1.1265e-02, PNorm = 35.2666, GNorm = 1.3702, lr_0 = 9.8099e-04
Loss = 2.7174e-02, PNorm = 35.2708, GNorm = 1.9777, lr_0 = 9.7163e-04

100%|██████████| 6/6 [00:00<00:00, 28.21it/s][A100%|██████████| 6/6 [00:00<00:00, 28.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.277778
  4%|▍         | 2/50 [00:00<00:13,  3.44it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.61it/s][A100%|██████████| 6/6 [00:00<00:00, 30.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.287037
  6%|▌         | 3/50 [00:00<00:12,  3.71it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.59it/s][ALoss = 7.4274e-03, PNorm = 35.3199, GNorm = 0.7406, lr_0 = 8.8274e-04

100%|██████████| 6/6 [00:00<00:00, 28.60it/s][A100%|██████████| 6/6 [00:00<00:00, 27.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.287037
  8%|▊         | 4/50 [00:01<00:11,  3.86it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 27.99it/s][A100%|██████████| 6/6 [00:00<00:00, 28.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 56.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.287037
 10%|█         | 5/50 [00:01<00:11,  3.92it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  8.79it/s][A
 33%|███▎      | 2/6 [00:00<00:00,  8.95it/s][ALoss = 5.7638e-03, PNorm = 35.3884, GNorm = 0.7505, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 10.16it/s][A100%|██████████| 6/6 [00:00<00:00, 15.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.273148
 12%|█▏        | 6/50 [00:01<00:13,  3.32it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.85it/s][A100%|██████████| 6/6 [00:00<00:00, 42.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.46it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 14%|█▍        | 7/50 [00:01<00:11,  3.88it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.9367e-03, PNorm = 35.4520, GNorm = 0.6435, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 16.50it/s][A100%|██████████| 6/6 [00:00<00:00, 19.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 37.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.277778
 16%|█▌        | 8/50 [00:02<00:12,  3.49it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.29it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 15.42it/s][A100%|██████████| 6/6 [00:00<00:00, 18.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.22it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.314815
 18%|█▊        | 9/50 [00:02<00:12,  3.30it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.3620e-03, PNorm = 35.5111, GNorm = 0.5011, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.11it/s][A100%|██████████| 6/6 [00:00<00:00, 36.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 20%|██        | 10/50 [00:02<00:10,  3.75it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.19it/s][ALoss = 3.3484e-03, PNorm = 35.5731, GNorm = 0.6506, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 31.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 22%|██▏       | 11/50 [00:02<00:09,  3.93it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 20.83it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 17.39it/s][A100%|██████████| 6/6 [00:00<00:00, 17.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 24%|██▍       | 12/50 [00:03<00:10,  3.48it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.32it/s][ALoss = 2.5773e-03, PNorm = 35.6284, GNorm = 0.3499, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 40.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.79it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 26%|██▌       | 13/50 [00:03<00:09,  4.00it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.24it/s][A100%|██████████| 6/6 [00:00<00:00, 41.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.32it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 28%|██▊       | 14/50 [00:03<00:08,  4.48it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.18it/s][ALoss = 2.2148e-03, PNorm = 35.6853, GNorm = 0.3298, lr_0 = 4.6863e-04

 83%|████████▎ | 5/6 [00:00<00:00, 21.02it/s][A100%|██████████| 6/6 [00:00<00:00, 21.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 27.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 30%|███       | 15/50 [00:03<00:08,  3.95it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.09it/s][A100%|██████████| 6/6 [00:00<00:00, 35.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.56it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.296296
 32%|███▏      | 16/50 [00:04<00:07,  4.27it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9196e-03, PNorm = 35.7373, GNorm = 0.3249, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.33it/s][A100%|██████████| 6/6 [00:00<00:00, 39.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.314815
 34%|███▍      | 17/50 [00:04<00:07,  4.67it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.40it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.28it/s][A100%|██████████| 6/6 [00:00<00:00, 28.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.02it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.314815
 36%|███▌      | 18/50 [00:04<00:06,  4.58it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0172e-03, PNorm = 35.7884, GNorm = 0.3442, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 22.71it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 21.55it/s][A100%|██████████| 6/6 [00:00<00:00, 23.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
 38%|███▊      | 19/50 [00:04<00:07,  4.24it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.72it/s][A100%|██████████| 6/6 [00:00<00:00, 34.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
 40%|████      | 20/50 [00:04<00:06,  4.51it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4594e-03, PNorm = 35.8341, GNorm = 0.2569, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.86it/s][A100%|██████████| 6/6 [00:00<00:00, 37.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.333333
 42%|████▏     | 21/50 [00:05<00:06,  4.80it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.64it/s][ALoss = 1.4417e-03, PNorm = 35.8742, GNorm = 0.2953, lr_0 = 3.1022e-04
Loss = 2.7730e-03, PNorm = 35.8778, GNorm = 0.3152, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 39.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.328704
 44%|████▍     | 22/50 [00:05<00:05,  5.10it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.88it/s][A100%|██████████| 6/6 [00:00<00:00, 34.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 39.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.342593
 46%|████▌     | 23/50 [00:05<00:05,  5.02it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 20.55it/s][ALoss = 1.2094e-03, PNorm = 35.9137, GNorm = 0.3399, lr_0 = 2.7915e-04
100%|██████████| 6/6 [00:00<00:00, 25.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.342593
 48%|████▊     | 24/50 [00:05<00:05,  4.65it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 21.52it/s][A100%|██████████| 6/6 [00:00<00:00, 25.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.342593
 50%|█████     | 25/50 [00:06<00:05,  4.41it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2019e-03, PNorm = 35.9509, GNorm = 0.2258, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.66it/s][A100%|██████████| 6/6 [00:00<00:00, 39.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.92it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 52%|█████▏    | 26/50 [00:06<00:05,  4.78it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.38it/s][A100%|██████████| 6/6 [00:00<00:00, 37.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.11it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.310185
 54%|█████▍    | 27/50 [00:06<00:04,  4.89it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0189e-03, PNorm = 35.9830, GNorm = 0.2372, lr_0 = 2.2387e-04

 50%|█████     | 3/6 [00:00<00:00, 21.27it/s][A100%|██████████| 6/6 [00:00<00:00, 28.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 56%|█████▌    | 28/50 [00:06<00:04,  4.74it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.82it/s][A100%|██████████| 6/6 [00:00<00:00, 36.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 58%|█████▊    | 29/50 [00:06<00:04,  4.94it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0050e-03, PNorm = 36.0118, GNorm = 0.2612, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.77it/s][A100%|██████████| 6/6 [00:00<00:00, 41.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 60%|██████    | 30/50 [00:06<00:03,  5.27it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.06it/s][A100%|██████████| 6/6 [00:00<00:00, 39.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 62%|██████▏   | 31/50 [00:07<00:03,  5.45it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7568e-04, PNorm = 36.0362, GNorm = 0.1586, lr_0 = 1.8127e-04

 50%|█████     | 3/6 [00:00<00:00, 23.96it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 22.56it/s][A100%|██████████| 6/6 [00:00<00:00, 24.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 64%|██████▍   | 32/50 [00:07<00:03,  4.87it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.48it/s][ALoss = 9.6392e-04, PNorm = 36.0565, GNorm = 0.1959, lr_0 = 1.6469e-04
Loss = 1.7092e-03, PNorm = 36.0584, GNorm = 0.3251, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 41.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 66%|██████▌   | 33/50 [00:07<00:03,  5.21it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.73it/s][A100%|██████████| 6/6 [00:00<00:00, 42.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 68%|██████▊   | 34/50 [00:07<00:02,  5.51it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.4094e-04, PNorm = 36.0755, GNorm = 0.2053, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.70it/s][A100%|██████████| 6/6 [00:00<00:00, 41.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 70%|███████   | 35/50 [00:07<00:02,  5.71it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.16it/s][A100%|██████████| 6/6 [00:00<00:00, 42.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.63it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 72%|███████▏  | 36/50 [00:08<00:02,  5.88it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.48it/s][ALoss = 9.7514e-04, PNorm = 36.0931, GNorm = 0.2754, lr_0 = 1.3335e-04

 83%|████████▎ | 5/6 [00:00<00:00, 20.84it/s][A100%|██████████| 6/6 [00:00<00:00, 25.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 74%|███████▍  | 37/50 [00:08<00:02,  5.12it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.63it/s][A100%|██████████| 6/6 [00:00<00:00, 41.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 76%|███████▌  | 38/50 [00:08<00:02,  5.39it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.9473e-04, PNorm = 36.1092, GNorm = 0.1551, lr_0 = 1.2000e-04

 50%|█████     | 3/6 [00:00<00:00, 23.98it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.95it/s][A100%|██████████| 6/6 [00:00<00:00, 23.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 78%|███████▊  | 39/50 [00:08<00:02,  4.65it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.80it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 19.54it/s][A100%|██████████| 6/6 [00:00<00:00, 19.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 26.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 80%|████████  | 40/50 [00:09<00:02,  3.91it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.0988e-04, PNorm = 36.1231, GNorm = 0.1961, lr_0 = 1.0798e-04

 50%|█████     | 3/6 [00:00<00:00, 25.21it/s][A100%|██████████| 6/6 [00:00<00:00, 32.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 82%|████████▏ | 41/50 [00:09<00:02,  4.18it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.30it/s][ALoss = 8.7203e-04, PNorm = 36.1359, GNorm = 0.4100, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 41.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 84%|████████▍ | 42/50 [00:09<00:01,  4.65it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.29it/s][A100%|██████████| 6/6 [00:00<00:00, 40.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 86%|████████▌ | 43/50 [00:09<00:01,  5.01it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.79it/s][ALoss = 7.6899e-04, PNorm = 36.1484, GNorm = 0.1367, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 26.84it/s][A100%|██████████| 6/6 [00:00<00:00, 25.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 32.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 88%|████████▊ | 44/50 [00:09<00:01,  4.41it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.35it/s][A
100%|██████████| 6/6 [00:00<00:00, 19.81it/s][A100%|██████████| 6/6 [00:00<00:00, 26.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 90%|█████████ | 45/50 [00:10<00:01,  4.29it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  8.85it/s][ALoss = 6.6756e-04, PNorm = 36.1607, GNorm = 0.2042, lr_0 = 1.0000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 11.52it/s][A100%|██████████| 6/6 [00:00<00:00, 25.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.38it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 92%|█████████▏| 46/50 [00:10<00:00,  4.21it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.94it/s][A100%|██████████| 6/6 [00:00<00:00, 40.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.11it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 94%|█████████▍| 47/50 [00:10<00:00,  4.65it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0365e-04, PNorm = 36.1727, GNorm = 0.2314, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.33it/s][A100%|██████████| 6/6 [00:00<00:00, 39.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 96%|█████████▌| 48/50 [00:10<00:00,  4.96it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.63it/s][A100%|██████████| 6/6 [00:00<00:00, 39.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.68it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
 98%|█████████▊| 49/50 [00:10<00:00,  5.21it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.3308e-04, PNorm = 36.1849, GNorm = 0.1228, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.60it/s][A100%|██████████| 6/6 [00:00<00:00, 41.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.324074
100%|██████████| 50/50 [00:11<00:00,  5.49it/s]100%|██████████| 50/50 [00:11<00:00,  4.53it/s]
Model 0 best validation auc = 0.444444 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 26.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.386667
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.386667
Fold 6
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_6',
 'save_smiles_splits': False,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 115433.38it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 106290.82it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 79%|███████▊  | 270/343 [00:00<00:00, 2699.17it/s]100%|██████████| 343/343 [00:00<00:00, 2643.83it/s]
Number of tasks = 8
Splitting data with seed 6
  0%|          | 0/343 [00:00<?, ?it/s] 87%|████████▋ | 298/343 [00:00<00:00, 2974.51it/s]100%|██████████| 343/343 [00:00<00:00, 2883.35it/s]
Total scaffolds = 230 | train scaffolds = 167 | val scaffolds = 32 | test scaffolds = 31
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([nan, nan, nan, nan, nan, nan,  1., nan]), array([0, 0, 0, 0, 0, 0, 2, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 3, 0])), (array([nan, nan,  0.,  0., nan, nan, nan,  1.]), array([0, 0, 1, 1, 0, 0, 0, 1])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan, nan, nan, nan,  0.]), array([0, 0, 0, 0, 0, 0, 0, 1])), (array([nan, nan,  1.,  1., nan, nan, nan, nan]), array([0, 0, 1, 1, 0, 0, 0, 0])), (array([nan,  0., nan, nan, nan, nan, nan, nan]), array([0, 1, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.04it/s][A100%|██████████| 6/6 [00:00<00:00, 25.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.468571
  2%|▏         | 1/50 [00:00<00:18,  2.72it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.91it/s][ALoss = 1.1574e-02, PNorm = 35.2663, GNorm = 1.4085, lr_0 = 9.8099e-04
Loss = 1.7642e-02, PNorm = 35.2715, GNorm = 1.4515, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 26.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.462857
  4%|▍         | 2/50 [00:00<00:16,  2.95it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.22it/s][A100%|██████████| 6/6 [00:00<00:00, 28.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.12it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.442857
  6%|▌         | 3/50 [00:00<00:14,  3.19it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.15it/s][ALoss = 7.1610e-03, PNorm = 35.3223, GNorm = 0.7413, lr_0 = 8.8274e-04
100%|██████████| 6/6 [00:00<00:00, 29.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.63it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.413333
  8%|▊         | 4/50 [00:01<00:13,  3.42it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.68it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 16.62it/s][A
100%|██████████| 6/6 [00:00<00:00, 17.25it/s][A100%|██████████| 6/6 [00:00<00:00, 17.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 40.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.418095
 10%|█         | 5/50 [00:01<00:14,  3.12it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.2824e-03, PNorm = 35.3866, GNorm = 0.4991, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.22it/s][A100%|██████████| 6/6 [00:00<00:00, 33.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 58.37it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.451429
 12%|█▏        | 6/50 [00:01<00:12,  3.51it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.27it/s][A100%|██████████| 6/6 [00:00<00:00, 29.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 39.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.461905
 14%|█▍        | 7/50 [00:01<00:11,  3.67it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.6703e-03, PNorm = 35.4529, GNorm = 0.5604, lr_0 = 7.1477e-04

 50%|█████     | 3/6 [00:00<00:00, 21.73it/s][A
100%|██████████| 6/6 [00:00<00:00, 22.58it/s][A100%|██████████| 6/6 [00:00<00:00, 23.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.30it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.448571
 16%|█▌        | 8/50 [00:02<00:11,  3.54it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.67it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 13.68it/s][A100%|██████████| 6/6 [00:00<00:00, 13.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.481905
 18%|█▊        | 9/50 [00:02<00:14,  2.85it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.3679e-03, PNorm = 35.5206, GNorm = 0.5847, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.59it/s][A100%|██████████| 6/6 [00:00<00:00, 41.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.45it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.481905
 20%|██        | 10/50 [00:02<00:11,  3.39it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.01it/s][ALoss = 3.3315e-03, PNorm = 35.5840, GNorm = 0.7505, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 40.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.36it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.281905
 22%|██▏       | 11/50 [00:03<00:10,  3.89it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.46it/s][A100%|██████████| 6/6 [00:00<00:00, 42.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.281905
 24%|██▍       | 12/50 [00:03<00:08,  4.38it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.4970e-03, PNorm = 35.6486, GNorm = 0.4716, lr_0 = 5.2079e-04

 83%|████████▎ | 5/6 [00:00<00:00, 39.71it/s][A100%|██████████| 6/6 [00:00<00:00, 42.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.277143
 26%|██▌       | 13/50 [00:03<00:08,  4.62it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 14.85it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 16.50it/s][A100%|██████████| 6/6 [00:00<00:00, 20.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 36.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.277143
 28%|██▊       | 14/50 [00:03<00:09,  3.92it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 17.40it/s][ALoss = 2.0822e-03, PNorm = 35.7084, GNorm = 0.3112, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 17.16it/s][A100%|██████████| 6/6 [00:00<00:00, 20.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.302143
 30%|███       | 15/50 [00:04<00:09,  3.59it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.49it/s][A100%|██████████| 6/6 [00:00<00:00, 27.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.297381
 32%|███▏      | 16/50 [00:04<00:09,  3.71it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7134e-03, PNorm = 35.7680, GNorm = 0.5310, lr_0 = 4.2170e-04

 50%|█████     | 3/6 [00:00<00:00, 29.92it/s][A
100%|██████████| 6/6 [00:00<00:00, 29.83it/s][A100%|██████████| 6/6 [00:00<00:00, 29.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.26it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.297381
 34%|███▍      | 17/50 [00:04<00:08,  3.83it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.47it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 20.04it/s][A100%|██████████| 6/6 [00:00<00:00, 21.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.297381
 36%|███▌      | 18/50 [00:04<00:08,  3.60it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9169e-03, PNorm = 35.8184, GNorm = 0.2830, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 21.99it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.74it/s][A100%|██████████| 6/6 [00:00<00:00, 25.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.297381
 38%|███▊      | 19/50 [00:05<00:08,  3.57it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.97it/s][A100%|██████████| 6/6 [00:00<00:00, 27.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 42.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.292619
 40%|████      | 20/50 [00:05<00:08,  3.62it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6321e-03, PNorm = 35.8699, GNorm = 0.3671, lr_0 = 3.4145e-04

 50%|█████     | 3/6 [00:00<00:00, 24.28it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.68it/s][A100%|██████████| 6/6 [00:00<00:00, 26.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.72it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.292619
 42%|████▏     | 21/50 [00:05<00:07,  3.66it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00,  8.43it/s][ALoss = 1.3559e-03, PNorm = 35.9077, GNorm = 0.1847, lr_0 = 3.1022e-04

 83%|████████▎ | 5/6 [00:00<00:00, 10.60it/s][ALoss = 3.3071e-03, PNorm = 35.9111, GNorm = 0.4140, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 15.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 45.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 44%|████▍     | 22/50 [00:06<00:08,  3.16it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 19.16it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 17.70it/s][A100%|██████████| 6/6 [00:00<00:00, 19.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 37.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 46%|████▌     | 23/50 [00:06<00:08,  3.06it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1702e-03, PNorm = 35.9459, GNorm = 0.1880, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.60it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.00it/s][A100%|██████████| 6/6 [00:00<00:00, 25.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 42.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.297381
 48%|████▊     | 24/50 [00:06<00:08,  3.14it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 15.33it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 15.55it/s][A100%|██████████| 6/6 [00:00<00:00, 18.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 36.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 50%|█████     | 25/50 [00:07<00:08,  3.01it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 14.81it/s][ALoss = 1.0854e-03, PNorm = 35.9782, GNorm = 0.2545, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 15.64it/s][A100%|██████████| 6/6 [00:00<00:00, 19.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 40.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.297381
 52%|█████▏    | 26/50 [00:07<00:08,  2.97it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 21.68it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.13it/s][A100%|██████████| 6/6 [00:00<00:00, 24.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 35.47it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 54%|█████▍    | 27/50 [00:07<00:07,  3.08it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0691e-03, PNorm = 36.0091, GNorm = 0.2180, lr_0 = 2.2387e-04

 50%|█████     | 3/6 [00:00<00:00, 24.18it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.66it/s][A100%|██████████| 6/6 [00:00<00:00, 26.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.73it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 56%|█████▌    | 28/50 [00:08<00:06,  3.24it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.65it/s][A100%|██████████| 6/6 [00:00<00:00, 30.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 66.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 58%|█████▊    | 29/50 [00:08<00:05,  3.53it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0858e-03, PNorm = 36.0349, GNorm = 0.2806, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.34it/s][A100%|██████████| 6/6 [00:00<00:00, 41.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 60%|██████    | 30/50 [00:08<00:04,  4.04it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.37it/s][A100%|██████████| 6/6 [00:00<00:00, 43.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 62%|██████▏   | 31/50 [00:08<00:04,  4.52it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.3671e-04, PNorm = 36.0572, GNorm = 0.2357, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.89it/s][A100%|██████████| 6/6 [00:00<00:00, 42.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 64%|██████▍   | 32/50 [00:08<00:03,  4.91it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.95it/s][ALoss = 8.9248e-04, PNorm = 36.0753, GNorm = 0.2829, lr_0 = 1.6469e-04
Loss = 1.3870e-03, PNorm = 36.0770, GNorm = 0.2871, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 40.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 66%|██████▌   | 33/50 [00:08<00:03,  5.18it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.65it/s][A100%|██████████| 6/6 [00:00<00:00, 34.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 63.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 68%|██████▊   | 34/50 [00:09<00:03,  5.13it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.08it/s][ALoss = 8.0545e-04, PNorm = 36.0936, GNorm = 0.2057, lr_0 = 1.4819e-04
100%|██████████| 6/6 [00:00<00:00, 30.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 41.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 70%|███████   | 35/50 [00:09<00:03,  4.82it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.19it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 21.25it/s][A100%|██████████| 6/6 [00:00<00:00, 21.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 35.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 72%|███████▏  | 36/50 [00:09<00:03,  4.10it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2697e-04, PNorm = 36.1103, GNorm = 0.1316, lr_0 = 1.3335e-04

 50%|█████     | 3/6 [00:00<00:00, 27.38it/s][A
100%|██████████| 6/6 [00:00<00:00, 26.83it/s][A100%|██████████| 6/6 [00:00<00:00, 26.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 35.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 74%|███████▍  | 37/50 [00:10<00:03,  3.92it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.03it/s][A100%|██████████| 6/6 [00:00<00:00, 25.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.86it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 76%|███████▌  | 38/50 [00:10<00:03,  3.93it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.3725e-04, PNorm = 36.1240, GNorm = 0.1764, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.27it/s][A100%|██████████| 6/6 [00:00<00:00, 41.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 78%|███████▊  | 39/50 [00:10<00:02,  4.37it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.14it/s][A100%|██████████| 6/6 [00:00<00:00, 29.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 37.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.347381
 80%|████████  | 40/50 [00:10<00:02,  4.25it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.1817e-04, PNorm = 36.1370, GNorm = 0.1852, lr_0 = 1.0798e-04

 50%|█████     | 3/6 [00:00<00:00, 29.79it/s][A100%|██████████| 6/6 [00:00<00:00, 36.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.78it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 82%|████████▏ | 41/50 [00:10<00:01,  4.53it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.77it/s][ALoss = 7.8957e-04, PNorm = 36.1491, GNorm = 0.3109, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 40.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 84%|████████▍ | 42/50 [00:11<00:01,  4.88it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.23it/s][A100%|██████████| 6/6 [00:00<00:00, 41.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 65.45it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 86%|████████▌ | 43/50 [00:11<00:01,  5.16it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.67it/s][ALoss = 7.1165e-04, PNorm = 36.1598, GNorm = 0.1912, lr_0 = 1.0000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 23.92it/s][A100%|██████████| 6/6 [00:00<00:00, 24.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 21.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 88%|████████▊ | 44/50 [00:11<00:01,  4.29it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.24it/s][A100%|██████████| 6/6 [00:00<00:00, 32.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.322381
 90%|█████████ | 45/50 [00:11<00:01,  4.44it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.2845e-04, PNorm = 36.1715, GNorm = 0.2414, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.29it/s][A100%|██████████| 6/6 [00:00<00:00, 41.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.82it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.302381
 92%|█████████▏| 46/50 [00:11<00:00,  4.82it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.68it/s][A100%|██████████| 6/6 [00:00<00:00, 32.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 36.22it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.302381
 94%|█████████▍| 47/50 [00:12<00:00,  4.65it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 19.05it/s][ALoss = 6.4075e-04, PNorm = 36.1823, GNorm = 0.1681, lr_0 = 1.0000e-04

 83%|████████▎ | 5/6 [00:00<00:00, 19.48it/s][A100%|██████████| 6/6 [00:00<00:00, 22.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.302381
 96%|█████████▌| 48/50 [00:12<00:00,  4.22it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.45it/s][A100%|██████████| 6/6 [00:00<00:00, 40.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.302381
 98%|█████████▊| 49/50 [00:12<00:00,  4.62it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.5972e-04, PNorm = 36.1937, GNorm = 0.1786, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.69it/s][A100%|██████████| 6/6 [00:00<00:00, 41.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.307143
100%|██████████| 50/50 [00:12<00:00,  4.96it/s]100%|██████████| 50/50 [00:12<00:00,  3.91it/s]
Model 0 best validation auc = 0.481905 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 49.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.444444
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.444444
Fold 7
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_7',
 'save_smiles_splits': False,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 114078.68it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 103865.88it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 62%|██████▏   | 214/343 [00:00<00:00, 2085.82it/s]100%|██████████| 343/343 [00:00<00:00, 1874.91it/s]
Number of tasks = 8
Splitting data with seed 7
  0%|          | 0/343 [00:00<?, ?it/s] 48%|████▊     | 164/343 [00:00<00:00, 1605.98it/s]100%|██████████| 343/343 [00:00<00:00, 2012.99it/s]
Total scaffolds = 230 | train scaffolds = 170 | val scaffolds = 28 | test scaffolds = 32
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([nan, nan,  1.,  1., nan, nan, nan, nan]), array([0, 0, 2, 1, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan, nan,  1.]), array([0, 0, 0, 0, 0, 0, 0, 1])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  1., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan,  0.,  0., nan, nan, nan, nan]), array([0, 0, 1, 1, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  1., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 16.35it/s][A100%|██████████| 6/6 [00:00<00:00, 23.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.355000
  2%|▏         | 1/50 [00:00<00:15,  3.07it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.54it/s][ALoss = 1.1388e-02, PNorm = 35.2657, GNorm = 0.9756, lr_0 = 9.8099e-04
Loss = 2.4757e-02, PNorm = 35.2709, GNorm = 1.8138, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 29.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.69it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.345000
  4%|▍         | 2/50 [00:00<00:14,  3.33it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.12it/s][A100%|██████████| 6/6 [00:00<00:00, 42.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.416667
  6%|▌         | 3/50 [00:00<00:12,  3.68it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.4365e-03, PNorm = 35.3221, GNorm = 0.8529, lr_0 = 8.8274e-04

 83%|████████▎ | 5/6 [00:00<00:00, 42.09it/s][A100%|██████████| 6/6 [00:00<00:00, 45.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 99.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.490833
  8%|▊         | 4/50 [00:00<00:11,  4.05it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.28it/s][A100%|██████████| 6/6 [00:00<00:00, 40.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.480833
 10%|█         | 5/50 [00:01<00:10,  4.48it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.3779e-03, PNorm = 35.3856, GNorm = 0.7020, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.62it/s][A100%|██████████| 6/6 [00:00<00:00, 42.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 105.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.493333
 12%|█▏        | 6/50 [00:01<00:09,  4.67it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.07it/s][A100%|██████████| 6/6 [00:00<00:00, 44.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 100.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.503333
 14%|█▍        | 7/50 [00:01<00:08,  4.83it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.7774e-03, PNorm = 35.4473, GNorm = 0.5553, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.08it/s][A100%|██████████| 6/6 [00:00<00:00, 36.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.00it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.503333
 16%|█▌        | 8/50 [00:01<00:08,  4.91it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.60it/s][A100%|██████████| 6/6 [00:00<00:00, 27.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.76it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.490833
 18%|█▊        | 9/50 [00:01<00:08,  4.65it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.3440e-03, PNorm = 35.5122, GNorm = 0.4568, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.35it/s][A100%|██████████| 6/6 [00:00<00:00, 32.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 51.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.490833
 20%|██        | 10/50 [00:02<00:08,  4.65it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.61it/s][ALoss = 3.4636e-03, PNorm = 35.5771, GNorm = 0.5967, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 35.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.500833
 22%|██▏       | 11/50 [00:02<00:08,  4.83it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.15it/s][A100%|██████████| 6/6 [00:00<00:00, 39.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.500833
 24%|██▍       | 12/50 [00:02<00:07,  5.08it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.04it/s][ALoss = 2.7987e-03, PNorm = 35.6392, GNorm = 0.3752, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 37.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.500833
 26%|██▌       | 13/50 [00:02<00:07,  5.20it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.17it/s][A100%|██████████| 6/6 [00:00<00:00, 37.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 50.72it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.520833
 28%|██▊       | 14/50 [00:02<00:07,  4.75it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.55it/s][ALoss = 2.4804e-03, PNorm = 35.7014, GNorm = 0.4667, lr_0 = 4.6863e-04
100%|██████████| 6/6 [00:00<00:00, 28.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.520833
 30%|███       | 15/50 [00:03<00:07,  4.59it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.55it/s][A100%|██████████| 6/6 [00:00<00:00, 38.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.543333
 32%|███▏      | 16/50 [00:03<00:07,  4.51it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9785e-03, PNorm = 35.7578, GNorm = 0.4730, lr_0 = 4.2170e-04

 50%|█████     | 3/6 [00:00<00:00, 25.58it/s][A100%|██████████| 6/6 [00:00<00:00, 29.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.71it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.543333
 34%|███▍      | 17/50 [00:03<00:07,  4.47it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 27.01it/s][A
100%|██████████| 6/6 [00:00<00:00, 27.80it/s][A100%|██████████| 6/6 [00:00<00:00, 28.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 36%|███▌      | 18/50 [00:03<00:07,  4.01it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8217e-03, PNorm = 35.8132, GNorm = 0.3021, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 27.07it/s][A100%|██████████| 6/6 [00:00<00:00, 31.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 38%|███▊      | 19/50 [00:04<00:07,  4.21it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 15.36it/s][A100%|██████████| 6/6 [00:00<00:00, 26.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 40%|████      | 20/50 [00:04<00:07,  4.16it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2925e-03, PNorm = 35.8625, GNorm = 0.2319, lr_0 = 3.4145e-04

 50%|█████     | 3/6 [00:00<00:00, 21.66it/s][A
100%|██████████| 6/6 [00:00<00:00, 23.23it/s][A100%|██████████| 6/6 [00:00<00:00, 24.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 42%|████▏     | 21/50 [00:04<00:07,  4.05it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6372e-03, PNorm = 35.9043, GNorm = 0.2209, lr_0 = 3.1022e-04

 83%|████████▎ | 5/6 [00:00<00:00, 44.85it/s][ALoss = 2.3056e-03, PNorm = 35.9084, GNorm = 0.3439, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 47.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 106.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 44%|████▍     | 22/50 [00:04<00:06,  4.64it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.61it/s][A100%|██████████| 6/6 [00:00<00:00, 41.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 51.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 46%|████▌     | 23/50 [00:05<00:05,  4.92it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.29it/s][ALoss = 1.4411e-03, PNorm = 35.9488, GNorm = 0.3214, lr_0 = 2.7915e-04
100%|██████████| 6/6 [00:00<00:00, 32.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 48%|████▊     | 24/50 [00:05<00:05,  4.77it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.36it/s][A100%|██████████| 6/6 [00:00<00:00, 34.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 50%|█████     | 25/50 [00:05<00:05,  4.86it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5109e-03, PNorm = 35.9856, GNorm = 0.2735, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 31.66it/s][A100%|██████████| 6/6 [00:00<00:00, 34.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 52%|█████▏    | 26/50 [00:05<00:04,  4.92it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.67it/s][A100%|██████████| 6/6 [00:00<00:00, 31.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.610000
 54%|█████▍    | 27/50 [00:05<00:04,  4.75it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2004e-03, PNorm = 36.0229, GNorm = 0.3039, lr_0 = 2.2387e-04

 50%|█████     | 3/6 [00:00<00:00, 25.87it/s][A100%|██████████| 6/6 [00:00<00:00, 31.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 56.34it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.620000
 56%|█████▌    | 28/50 [00:06<00:05,  4.33it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.30it/s][A100%|██████████| 6/6 [00:00<00:00, 39.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.620000
 58%|█████▊    | 29/50 [00:06<00:04,  4.68it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1518e-03, PNorm = 36.0540, GNorm = 0.2015, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.23it/s][A100%|██████████| 6/6 [00:00<00:00, 38.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.620000
 60%|██████    | 30/50 [00:06<00:04,  4.94it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.57it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.94it/s][A100%|██████████| 6/6 [00:00<00:00, 29.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 103.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.620000
 62%|██████▏   | 31/50 [00:06<00:03,  4.80it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1586e-03, PNorm = 36.0820, GNorm = 0.2775, lr_0 = 1.8127e-04

 83%|████████▎ | 5/6 [00:00<00:00, 45.70it/s][A100%|██████████| 6/6 [00:00<00:00, 49.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 103.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.620000
 64%|██████▍   | 32/50 [00:06<00:03,  5.34it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.95it/s][ALoss = 1.0491e-03, PNorm = 36.1041, GNorm = 0.2300, lr_0 = 1.6469e-04
Loss = 2.2828e-03, PNorm = 36.1063, GNorm = 0.4189, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 32.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.630000
 66%|██████▌   | 33/50 [00:07<00:03,  4.87it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.15it/s][A100%|██████████| 6/6 [00:00<00:00, 27.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.37it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.630000
 68%|██████▊   | 34/50 [00:07<00:03,  4.66it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.6808e-04, PNorm = 36.1271, GNorm = 0.2196, lr_0 = 1.4819e-04

 83%|████████▎ | 5/6 [00:00<00:00, 41.66it/s][A100%|██████████| 6/6 [00:00<00:00, 44.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.630000
 70%|███████   | 35/50 [00:07<00:02,  5.11it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.43it/s][A100%|██████████| 6/6 [00:00<00:00, 41.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.630000
 72%|███████▏  | 36/50 [00:07<00:02,  5.39it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.3904e-04, PNorm = 36.1474, GNorm = 0.3916, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.06it/s][A100%|██████████| 6/6 [00:00<00:00, 33.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 30.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.630000
 74%|███████▍  | 37/50 [00:07<00:02,  5.07it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.94it/s][A
 50%|█████     | 3/6 [00:00<00:00, 13.81it/s][A100%|██████████| 6/6 [00:00<00:00, 20.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.630000
 76%|███████▌  | 38/50 [00:08<00:02,  4.34it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0237e-03, PNorm = 36.1650, GNorm = 0.2982, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.49it/s][A100%|██████████| 6/6 [00:00<00:00, 39.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.24it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 78%|███████▊  | 39/50 [00:08<00:02,  4.36it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.49it/s][A100%|██████████| 6/6 [00:00<00:00, 39.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 80%|████████  | 40/50 [00:08<00:02,  4.70it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.6773e-04, PNorm = 36.1811, GNorm = 0.2558, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.39it/s][A100%|██████████| 6/6 [00:00<00:00, 40.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 82%|████████▏ | 41/50 [00:08<00:01,  5.00it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.89it/s][ALoss = 9.4769e-04, PNorm = 36.1954, GNorm = 0.2608, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 39.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.37it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 84%|████████▍ | 42/50 [00:08<00:01,  5.23it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.36it/s][A100%|██████████| 6/6 [00:00<00:00, 38.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.88it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 86%|████████▌ | 43/50 [00:09<00:01,  5.37it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.76it/s][ALoss = 8.2716e-04, PNorm = 36.2086, GNorm = 0.1480, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 26.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.00it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 88%|████████▊ | 44/50 [00:09<00:01,  4.86it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.41it/s][A100%|██████████| 6/6 [00:00<00:00, 34.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.78it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 90%|█████████ | 45/50 [00:09<00:01,  4.95it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.8839e-04, PNorm = 36.2228, GNorm = 0.2156, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 29.36it/s][A100%|██████████| 6/6 [00:00<00:00, 29.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 65.11it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.642500
 92%|█████████▏| 46/50 [00:09<00:00,  4.78it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.81it/s][A100%|██████████| 6/6 [00:00<00:00, 38.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.09it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.442500
 94%|█████████▍| 47/50 [00:09<00:00,  4.99it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.6584e-04, PNorm = 36.2363, GNorm = 0.2166, lr_0 = 1.0000e-04

 50%|█████     | 3/6 [00:00<00:00, 29.11it/s][A100%|██████████| 6/6 [00:00<00:00, 34.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.442500
 96%|█████████▌| 48/50 [00:10<00:00,  5.04it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.99it/s][A100%|██████████| 6/6 [00:00<00:00, 44.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.455000
 98%|█████████▊| 49/50 [00:10<00:00,  5.41it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.3769e-04, PNorm = 36.2494, GNorm = 0.1428, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.23it/s][A100%|██████████| 6/6 [00:00<00:00, 42.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with predictions all 0s or all 1s
Validation auc = 0.455000
100%|██████████| 50/50 [00:10<00:00,  5.64it/s]100%|██████████| 50/50 [00:10<00:00,  4.79it/s]
Model 0 best validation auc = 0.642500 on epoch 38
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 76.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.544444
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.544444
Fold 8
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_8',
 'save_smiles_splits': False,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 102140.31it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 108160.76it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 69%|██████▊   | 235/343 [00:00<00:00, 2327.30it/s]100%|██████████| 343/343 [00:00<00:00, 2383.86it/s]
Number of tasks = 8
Splitting data with seed 8
  0%|          | 0/343 [00:00<?, ?it/s] 86%|████████▋ | 296/343 [00:00<00:00, 2955.34it/s]100%|██████████| 343/343 [00:00<00:00, 2919.73it/s]
Total scaffolds = 230 | train scaffolds = 177 | val scaffolds = 24 | test scaffolds = 29
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([nan, nan, nan, nan, nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan,  1., nan, nan, nan, nan]), array([0, 0, 0, 1, 0, 0, 0, 0])), (array([nan,  0., nan, nan, nan, nan, nan, nan]), array([0, 1, 0, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.57it/s][A100%|██████████| 6/6 [00:00<00:00, 39.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.63it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
  2%|▏         | 1/50 [00:00<00:13,  3.77it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.67it/s][ALoss = 1.1125e-02, PNorm = 35.2688, GNorm = 0.8366, lr_0 = 9.8099e-04
Loss = 1.5431e-02, PNorm = 35.2762, GNorm = 1.3179, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 32.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.04it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.434524
  4%|▍         | 2/50 [00:00<00:12,  3.81it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.80it/s][A100%|██████████| 6/6 [00:00<00:00, 40.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.511905
  6%|▌         | 3/50 [00:00<00:11,  4.02it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2367e-03, PNorm = 35.3262, GNorm = 0.5833, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.22it/s][A100%|██████████| 6/6 [00:00<00:00, 39.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.51it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.494048
  8%|▊         | 4/50 [00:00<00:10,  4.41it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.21it/s][A100%|██████████| 6/6 [00:00<00:00, 35.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.494048
 10%|█         | 5/50 [00:01<00:09,  4.64it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.7313e-03, PNorm = 35.3920, GNorm = 0.5555, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.07it/s][A100%|██████████| 6/6 [00:00<00:00, 42.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 12%|█▏        | 6/50 [00:01<00:09,  4.69it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.52it/s][A100%|██████████| 6/6 [00:00<00:00, 40.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.31it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 14%|█▍        | 7/50 [00:01<00:08,  5.00it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.7493e-03, PNorm = 35.4647, GNorm = 0.4689, lr_0 = 7.1477e-04

 50%|█████     | 3/6 [00:00<00:00, 23.92it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.43it/s][A100%|██████████| 6/6 [00:00<00:00, 24.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 16%|█▌        | 8/50 [00:01<00:09,  4.55it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.53it/s][A100%|██████████| 6/6 [00:00<00:00, 37.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.48it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.589286
 18%|█▊        | 9/50 [00:01<00:09,  4.47it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.9739e-03, PNorm = 35.5298, GNorm = 0.4809, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.82it/s][A100%|██████████| 6/6 [00:00<00:00, 38.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.55it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.589286
 20%|██        | 10/50 [00:02<00:08,  4.76it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.09it/s][ALoss = 3.5193e-03, PNorm = 35.5995, GNorm = 0.7659, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 39.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.85it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.589286
 22%|██▏       | 11/50 [00:02<00:07,  4.88it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.55it/s][A100%|██████████| 6/6 [00:00<00:00, 38.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.18it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.589286
 24%|██▍       | 12/50 [00:02<00:07,  5.03it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.51it/s][ALoss = 2.7221e-03, PNorm = 35.6687, GNorm = 0.3853, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 40.16it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.84it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.589286
 26%|██▌       | 13/50 [00:02<00:07,  5.25it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.76it/s][A100%|██████████| 6/6 [00:00<00:00, 39.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.595238
 28%|██▊       | 14/50 [00:02<00:07,  5.01it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1663e-03, PNorm = 35.7358, GNorm = 0.3508, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.44it/s][A100%|██████████| 6/6 [00:00<00:00, 37.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:00<00:00,  9.51it/s][A100%|██████████| 1/1 [00:00<00:00,  9.49it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.595238
 30%|███       | 15/50 [00:03<00:07,  4.48it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.47it/s][A100%|██████████| 6/6 [00:00<00:00, 39.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.66it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.595238
 32%|███▏      | 16/50 [00:03<00:07,  4.78it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0352e-03, PNorm = 35.7957, GNorm = 0.4810, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.18it/s][A100%|██████████| 6/6 [00:00<00:00, 39.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.35it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.595238
 34%|███▍      | 17/50 [00:03<00:06,  5.01it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.22it/s][A100%|██████████| 6/6 [00:00<00:00, 26.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 60.26it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.577381
 36%|███▌      | 18/50 [00:03<00:06,  4.64it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6500e-03, PNorm = 35.8518, GNorm = 0.4396, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.42it/s][A100%|██████████| 6/6 [00:00<00:00, 40.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.565476
 38%|███▊      | 19/50 [00:03<00:06,  4.91it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.32it/s][A100%|██████████| 6/6 [00:00<00:00, 38.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.68it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.583333
 40%|████      | 20/50 [00:04<00:05,  5.09it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4496e-03, PNorm = 35.8978, GNorm = 0.2758, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.90it/s][A100%|██████████| 6/6 [00:00<00:00, 38.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.52it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.565476
 42%|████▏     | 21/50 [00:04<00:05,  5.21it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.41it/s][ALoss = 1.4491e-03, PNorm = 35.9400, GNorm = 0.3403, lr_0 = 3.1022e-04
Loss = 2.4287e-03, PNorm = 35.9441, GNorm = 0.3351, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 32.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.81it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.547619
 44%|████▍     | 22/50 [00:04<00:05,  5.10it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.89it/s][A100%|██████████| 6/6 [00:00<00:00, 42.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.49it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.547619
 46%|████▌     | 23/50 [00:04<00:05,  5.38it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3383e-03, PNorm = 35.9797, GNorm = 0.2340, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.88it/s][A100%|██████████| 6/6 [00:00<00:00, 41.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.33it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 48%|████▊     | 24/50 [00:04<00:04,  5.56it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.78it/s][A100%|██████████| 6/6 [00:00<00:00, 30.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 47.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 50%|█████     | 25/50 [00:05<00:04,  5.07it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2452e-03, PNorm = 36.0178, GNorm = 0.3001, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.08it/s][A100%|██████████| 6/6 [00:00<00:00, 37.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 52%|█████▏    | 26/50 [00:05<00:04,  5.15it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.20it/s][A100%|██████████| 6/6 [00:00<00:00, 41.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 54%|█████▍    | 27/50 [00:05<00:04,  5.40it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1566e-03, PNorm = 36.0507, GNorm = 0.1881, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.50it/s][A100%|██████████| 6/6 [00:00<00:00, 36.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.08it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 56%|█████▌    | 28/50 [00:05<00:04,  5.39it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.86it/s][A100%|██████████| 6/6 [00:00<00:00, 43.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.87it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 58%|█████▊    | 29/50 [00:05<00:03,  5.62it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.7714e-04, PNorm = 36.0810, GNorm = 0.2362, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.10it/s][A100%|██████████| 6/6 [00:00<00:00, 41.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.45it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 60%|██████    | 30/50 [00:05<00:03,  5.72it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.58it/s][A100%|██████████| 6/6 [00:00<00:00, 42.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.65it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 62%|██████▏   | 31/50 [00:06<00:03,  5.80it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1086e-03, PNorm = 36.1018, GNorm = 0.2326, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.17it/s][A100%|██████████| 6/6 [00:00<00:00, 41.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.51it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 64%|██████▍   | 32/50 [00:06<00:03,  5.85it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.13it/s][ALoss = 9.1739e-04, PNorm = 36.1236, GNorm = 0.1691, lr_0 = 1.6469e-04
Loss = 2.3246e-03, PNorm = 36.1256, GNorm = 0.2795, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 39.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 49.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.559524
 66%|██████▌   | 33/50 [00:06<00:02,  5.67it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.92it/s][A100%|██████████| 6/6 [00:00<00:00, 37.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.14it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 68%|██████▊   | 34/50 [00:06<00:02,  5.59it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.6259e-04, PNorm = 36.1438, GNorm = 0.1936, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.14it/s][A100%|██████████| 6/6 [00:00<00:00, 42.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.92it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 70%|███████   | 35/50 [00:06<00:02,  5.73it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.00it/s][A100%|██████████| 6/6 [00:00<00:00, 43.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 72%|███████▏  | 36/50 [00:07<00:02,  5.86it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.3912e-04, PNorm = 36.1618, GNorm = 0.2079, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 28.40it/s][A100%|██████████| 6/6 [00:00<00:00, 27.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 74%|███████▍  | 37/50 [00:07<00:02,  5.25it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.83it/s][A100%|██████████| 6/6 [00:00<00:00, 43.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.19it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 76%|███████▌  | 38/50 [00:07<00:02,  5.51it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.8554e-04, PNorm = 36.1781, GNorm = 0.1358, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.72it/s][A100%|██████████| 6/6 [00:00<00:00, 40.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 66.69it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 78%|███████▊  | 39/50 [00:07<00:01,  5.57it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.94it/s][A100%|██████████| 6/6 [00:00<00:00, 42.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.70it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 80%|████████  | 40/50 [00:07<00:01,  5.71it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.4527e-04, PNorm = 36.1919, GNorm = 0.1795, lr_0 = 1.0798e-04

 33%|███▎      | 2/6 [00:00<00:00, 11.04it/s][A100%|██████████| 6/6 [00:00<00:00, 21.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.73it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 82%|████████▏ | 41/50 [00:08<00:01,  4.62it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.67it/s][ALoss = 8.4861e-04, PNorm = 36.2048, GNorm = 0.3287, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 43.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.02it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 84%|████████▍ | 42/50 [00:08<00:01,  5.01it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.50it/s][A100%|██████████| 6/6 [00:00<00:00, 42.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.91it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.541667
 86%|████████▌ | 43/50 [00:08<00:01,  5.30it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.62it/s][ALoss = 7.3957e-04, PNorm = 36.2169, GNorm = 0.1974, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 30.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.20it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.470238
 88%|████████▊ | 44/50 [00:08<00:01,  5.06it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.10it/s][A100%|██████████| 6/6 [00:00<00:00, 44.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.97it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.470238
 90%|█████████ | 45/50 [00:08<00:00,  5.38it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2538e-04, PNorm = 36.2290, GNorm = 0.2327, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.89it/s][A100%|██████████| 6/6 [00:00<00:00, 42.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.54it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.446429
 92%|█████████▏| 46/50 [00:08<00:00,  5.59it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.99it/s][A100%|██████████| 6/6 [00:00<00:00, 40.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.09it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.446429
 94%|█████████▍| 47/50 [00:09<00:00,  5.67it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.8539e-04, PNorm = 36.2415, GNorm = 0.1393, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.91it/s][A100%|██████████| 6/6 [00:00<00:00, 38.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.11it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.470238
 96%|█████████▌| 48/50 [00:09<00:00,  5.63it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.15it/s][A100%|██████████| 6/6 [00:00<00:00, 39.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.17it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.446429
 98%|█████████▊| 49/50 [00:09<00:00,  5.66it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.9533e-04, PNorm = 36.2534, GNorm = 0.1179, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.92it/s][A100%|██████████| 6/6 [00:00<00:00, 39.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.446429
100%|██████████| 50/50 [00:09<00:00,  5.69it/s]100%|██████████| 50/50 [00:09<00:00,  5.19it/s]
Model 0 best validation auc = 0.595238 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 75.68it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.353333
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.353333
Fold 9
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --split_type scaffold_balanced --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.6.gpu.q/tmpchddlfom/fold_9',
 'save_smiles_splits': False,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 118076.68it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 110291.80it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 3600.04it/s]
Number of tasks = 8
Splitting data with seed 9
  0%|          | 0/343 [00:00<?, ?it/s] 96%|█████████▌| 328/343 [00:00<00:00, 3270.01it/s]100%|██████████| 343/343 [00:00<00:00, 3250.72it/s]
Total scaffolds = 230 | train scaffolds = 186 | val scaffolds = 25 | test scaffolds = 19
/home/apappu/thesis/molecule-metalearning/chemprop/chemprop/data/scaffold.py:150: RuntimeWarning: Mean of empty slice
  target_avgs.append(np.nanmean(targets, axis=0))
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([ nan,  nan,  nan,  nan,  nan, 0.52,  nan,  nan]), array([ 0,  0,  0,  0,  0, 25,  0,  0])), (array([       nan, 0.66666667,        nan,        nan,        nan,
              nan,        nan,        nan]), array([ 0, 18,  0,  0,  0,  0,  0,  0])), (array([ 0., nan, nan, nan, nan, nan, nan, nan]), array([17,  0,  0,  0,  0,  0,  0,  0])), (array([nan, nan, nan, nan,  1., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan, nan,  0.]), array([0, 0, 0, 0, 0, 0, 0, 1])), (array([nan, nan, nan, nan,  0., nan, nan, nan]), array([0, 0, 0, 0, 1, 0, 0, 0])), (array([nan, nan, nan, nan, nan,  1., nan, nan]), array([0, 0, 0, 0, 0, 1, 0, 0])), (array([nan, nan,  1., nan, nan, nan, nan, nan]), array([0, 0, 1, 0, 0, 0, 0, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0])), (array([nan, nan, nan, nan, nan, nan,  0., nan]), array([0, 0, 0, 0, 0, 0, 1, 0]))]
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.36it/s][A
100%|██████████| 6/6 [00:00<00:00, 24.51it/s][A100%|██████████| 6/6 [00:00<00:00, 25.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.32it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.583333
  2%|▏         | 1/50 [00:00<00:15,  3.24it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.70it/s][ALoss = 1.1390e-02, PNorm = 35.2634, GNorm = 0.9423, lr_0 = 9.8099e-04
Loss = 1.9160e-02, PNorm = 35.2690, GNorm = 1.5627, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 39.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.625000
  4%|▍         | 2/50 [00:00<00:13,  3.55it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.71it/s][A100%|██████████| 6/6 [00:00<00:00, 39.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 31.71it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
  6%|▌         | 3/50 [00:00<00:11,  3.93it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 20.81it/s][ALoss = 7.9054e-03, PNorm = 35.3192, GNorm = 0.6420, lr_0 = 8.8274e-04
100%|██████████| 6/6 [00:00<00:00, 28.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
  8%|▊         | 4/50 [00:00<00:11,  4.06it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.76it/s][A100%|██████████| 6/6 [00:00<00:00, 38.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.26it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 10%|█         | 5/50 [00:01<00:10,  4.45it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.8495e-03, PNorm = 35.3874, GNorm = 0.6199, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.14it/s][A100%|██████████| 6/6 [00:00<00:00, 37.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 12%|█▏        | 6/50 [00:01<00:09,  4.73it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.43it/s][A100%|██████████| 6/6 [00:00<00:00, 36.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 14%|█▍        | 7/50 [00:01<00:08,  4.92it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.9955e-03, PNorm = 35.4548, GNorm = 0.4350, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.21it/s][A100%|██████████| 6/6 [00:00<00:00, 40.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 16%|█▌        | 8/50 [00:01<00:08,  5.21it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.11it/s][A100%|██████████| 6/6 [00:00<00:00, 39.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 18%|█▊        | 9/50 [00:01<00:07,  5.39it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.7208e-03, PNorm = 35.5233, GNorm = 0.3724, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.36it/s][A100%|██████████| 6/6 [00:00<00:00, 42.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 20%|██        | 10/50 [00:01<00:07,  5.60it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.73it/s][ALoss = 3.5986e-03, PNorm = 35.5979, GNorm = 0.7311, lr_0 = 5.7876e-04

100%|██████████| 6/6 [00:00<00:00, 26.85it/s][A100%|██████████| 6/6 [00:00<00:00, 27.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 56.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 22%|██▏       | 11/50 [00:02<00:07,  5.07it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.94it/s][A100%|██████████| 6/6 [00:00<00:00, 40.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 24%|██▍       | 12/50 [00:02<00:07,  5.31it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.60it/s][ALoss = 2.6684e-03, PNorm = 35.6699, GNorm = 0.4508, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 40.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 26%|██▌       | 13/50 [00:02<00:06,  5.48it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.60it/s][A100%|██████████| 6/6 [00:00<00:00, 36.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 46.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 28%|██▊       | 14/50 [00:02<00:06,  5.39it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.4411e-03, PNorm = 35.7385, GNorm = 0.4353, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.25it/s][A100%|██████████| 6/6 [00:00<00:00, 38.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 30%|███       | 15/50 [00:02<00:06,  5.44it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.73it/s][A100%|██████████| 6/6 [00:00<00:00, 33.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.86it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 32%|███▏      | 16/50 [00:03<00:06,  5.30it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0365e-03, PNorm = 35.7971, GNorm = 0.3340, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.63it/s][A100%|██████████| 6/6 [00:00<00:00, 42.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.37it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 34%|███▍      | 17/50 [00:03<00:05,  5.56it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.89it/s][A100%|██████████| 6/6 [00:00<00:00, 42.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.88it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 36%|███▌      | 18/50 [00:03<00:05,  5.72it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4652e-03, PNorm = 35.8537, GNorm = 0.2114, lr_0 = 3.7946e-04

 33%|███▎      | 2/6 [00:00<00:00, 12.91it/s][A100%|██████████| 6/6 [00:00<00:00, 24.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 38%|███▊      | 19/50 [00:03<00:06,  4.96it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.01it/s][A100%|██████████| 6/6 [00:00<00:00, 42.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 40%|████      | 20/50 [00:03<00:05,  5.29it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6676e-03, PNorm = 35.9021, GNorm = 0.3822, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.09it/s][A100%|██████████| 6/6 [00:00<00:00, 38.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 38.46it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 42%|████▏     | 21/50 [00:04<00:05,  5.21it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 22.28it/s][ALoss = 1.5298e-03, PNorm = 35.9387, GNorm = 0.2537, lr_0 = 3.1022e-04
Loss = 2.4011e-03, PNorm = 35.9426, GNorm = 0.2938, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 28.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 44%|████▍     | 22/50 [00:04<00:05,  4.87it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.95it/s][A100%|██████████| 6/6 [00:00<00:00, 40.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.72it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 46%|████▌     | 23/50 [00:04<00:05,  5.16it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3210e-03, PNorm = 35.9803, GNorm = 0.2632, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.35it/s][A100%|██████████| 6/6 [00:00<00:00, 40.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 63.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 48%|████▊     | 24/50 [00:04<00:04,  5.33it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.88it/s][A100%|██████████| 6/6 [00:00<00:00, 31.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 29.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 50%|█████     | 25/50 [00:04<00:05,  4.98it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0979e-03, PNorm = 36.0152, GNorm = 0.2215, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.97it/s][A100%|██████████| 6/6 [00:00<00:00, 40.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 52%|█████▏    | 26/50 [00:05<00:04,  5.15it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.07it/s][A100%|██████████| 6/6 [00:00<00:00, 38.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 54%|█████▍    | 27/50 [00:05<00:04,  5.31it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0874e-03, PNorm = 36.0500, GNorm = 0.2665, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.76it/s][A100%|██████████| 6/6 [00:00<00:00, 41.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 56%|█████▌    | 28/50 [00:05<00:03,  5.52it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.74it/s][A100%|██████████| 6/6 [00:00<00:00, 33.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 58%|█████▊    | 29/50 [00:05<00:03,  5.33it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1302e-03, PNorm = 36.0793, GNorm = 0.2266, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.54it/s][A100%|██████████| 6/6 [00:00<00:00, 35.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 60%|██████    | 30/50 [00:05<00:03,  5.32it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.34it/s][A100%|██████████| 6/6 [00:00<00:00, 40.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 62%|██████▏   | 31/50 [00:05<00:03,  5.49it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4114e-03, PNorm = 36.1044, GNorm = 0.2026, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.90it/s][A100%|██████████| 6/6 [00:00<00:00, 34.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 44.86it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 64%|██████▍   | 32/50 [00:06<00:03,  5.19it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.79it/s][ALoss = 1.0502e-03, PNorm = 36.1264, GNorm = 0.2884, lr_0 = 1.6469e-04
Loss = 1.0860e-03, PNorm = 36.1284, GNorm = 0.2042, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 30.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 66%|██████▌   | 33/50 [00:06<00:03,  5.02it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.74it/s][A100%|██████████| 6/6 [00:00<00:00, 40.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 68%|██████▊   | 34/50 [00:06<00:03,  5.27it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.1525e-04, PNorm = 36.1464, GNorm = 0.2188, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.11it/s][A100%|██████████| 6/6 [00:00<00:00, 39.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.56it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.208333
 70%|███████   | 35/50 [00:06<00:02,  5.40it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 25.00it/s][A100%|██████████| 6/6 [00:00<00:00, 28.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.250000
 72%|███████▏  | 36/50 [00:06<00:02,  5.02it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.4570e-04, PNorm = 36.1647, GNorm = 0.2106, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.29it/s][A100%|██████████| 6/6 [00:00<00:00, 41.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.250000
 74%|███████▍  | 37/50 [00:07<00:02,  5.29it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.30it/s][A100%|██████████| 6/6 [00:00<00:00, 42.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 76%|███████▌  | 38/50 [00:07<00:02,  5.52it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5998e-04, PNorm = 36.1805, GNorm = 0.1706, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.70it/s][A100%|██████████| 6/6 [00:00<00:00, 38.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 78%|███████▊  | 39/50 [00:07<00:01,  5.57it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.90it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 15.83it/s][A100%|██████████| 6/6 [00:00<00:00, 20.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 53.24it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 80%|████████  | 40/50 [00:07<00:02,  4.48it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.9727e-04, PNorm = 36.1947, GNorm = 0.1343, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.83it/s][A100%|██████████| 6/6 [00:00<00:00, 39.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 82%|████████▏ | 41/50 [00:07<00:01,  4.82it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.42it/s][ALoss = 8.8802e-04, PNorm = 36.2076, GNorm = 0.2269, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 39.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 84%|████████▍ | 42/50 [00:08<00:01,  5.07it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.17it/s][A100%|██████████| 6/6 [00:00<00:00, 42.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 86%|████████▌ | 43/50 [00:08<00:01,  5.36it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.81it/s][ALoss = 8.0346e-04, PNorm = 36.2203, GNorm = 0.1226, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 41.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 88%|████████▊ | 44/50 [00:08<00:01,  5.54it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.50it/s][A100%|██████████| 6/6 [00:00<00:00, 35.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.78it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 90%|█████████ | 45/50 [00:08<00:00,  5.47it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5275e-04, PNorm = 36.2323, GNorm = 0.1685, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.17it/s][A100%|██████████| 6/6 [00:00<00:00, 42.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.08it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 92%|█████████▏| 46/50 [00:08<00:00,  5.65it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.43it/s][A100%|██████████| 6/6 [00:00<00:00, 30.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 94%|█████████▍| 47/50 [00:09<00:00,  5.29it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.4731e-04, PNorm = 36.2440, GNorm = 0.2472, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.20it/s][A100%|██████████| 6/6 [00:00<00:00, 41.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 96%|█████████▌| 48/50 [00:09<00:00,  5.51it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.11it/s][A100%|██████████| 6/6 [00:00<00:00, 42.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
 98%|█████████▊| 49/50 [00:09<00:00,  5.71it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.4475e-04, PNorm = 36.2567, GNorm = 0.1506, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.05it/s][A100%|██████████| 6/6 [00:00<00:00, 36.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.22it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.291667
100%|██████████| 50/50 [00:09<00:00,  5.55it/s]100%|██████████| 50/50 [00:09<00:00,  5.23it/s]
Model 0 best validation auc = 0.625000 on epoch 1
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 67.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.360417
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.360417
10-fold cross validation
Seed 0 ==> test auc = 0.708333
Seed 1 ==> test auc = 0.430556
Seed 2 ==> test auc = 0.062500
Seed 3 ==> test auc = 0.487500
Seed 4 ==> test auc = 0.555556
Seed 5 ==> test auc = 0.386667
Seed 6 ==> test auc = 0.444444
Seed 7 ==> test auc = 0.544444
Seed 8 ==> test auc = 0.353333
Seed 9 ==> test auc = 0.360417
Overall test auc = 0.433375 +/- 0.160433
