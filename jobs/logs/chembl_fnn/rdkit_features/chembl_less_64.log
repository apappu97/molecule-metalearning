Fold 0
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': None,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': None,
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 77584.33it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 6110.09it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 92%|█████████▏| 316/343 [00:00<00:00, 3154.39it/s]100%|██████████| 343/343 [00:00<00:00, 3124.84it/s]
Number of tasks = 8
Splitting data with seed 0
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:09<00:45,  9.11s/it][A
 50%|█████     | 3/6 [00:09<00:19,  6.41s/it][A
 83%|████████▎ | 5/6 [00:09<00:04,  4.51s/it][A100%|██████████| 6/6 [00:09<00:00,  1.59s/it]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 17.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
  2%|▏         | 1/50 [00:09<07:53,  9.66s/it]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 23.36it/s][ALoss = 1.2405e-02, PNorm = 35.2646, GNorm = 1.3700, lr_0 = 9.8099e-04
Loss = 1.9554e-02, PNorm = 35.2691, GNorm = 1.8585, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 27.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.725000
  4%|▍         | 2/50 [00:09<05:28,  6.85s/it]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.18it/s][A100%|██████████| 6/6 [00:00<00:00, 33.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.725000
  6%|▌         | 3/50 [00:10<03:48,  4.86s/it]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.1912e-03, PNorm = 35.3171, GNorm = 0.6609, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.60it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 16.95it/s][A100%|██████████| 6/6 [00:00<00:00, 22.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.525000
  8%|▊         | 4/50 [00:10<02:40,  3.49s/it]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.80it/s][A100%|██████████| 6/6 [00:00<00:00, 39.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.38it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.450000
 10%|█         | 5/50 [00:10<01:52,  2.49s/it]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.8987e-03, PNorm = 35.3837, GNorm = 0.6101, lr_0 = 7.9433e-04

 50%|█████     | 3/6 [00:00<00:00, 29.82it/s][A100%|██████████| 6/6 [00:00<00:00, 34.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.11it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.475000
 12%|█▏        | 6/50 [00:10<01:19,  1.80s/it]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.01it/s][A100%|██████████| 6/6 [00:00<00:00, 37.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.57it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.575000
 14%|█▍        | 7/50 [00:10<00:56,  1.31s/it]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.5747e-03, PNorm = 35.4515, GNorm = 0.5807, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.19it/s][A100%|██████████| 6/6 [00:00<00:00, 38.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.625000
 16%|█▌        | 8/50 [00:11<00:40,  1.03it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.44it/s][A100%|██████████| 6/6 [00:00<00:00, 36.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.725000
 18%|█▊        | 9/50 [00:11<00:30,  1.36it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.3990e-03, PNorm = 35.5207, GNorm = 0.5237, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.29it/s][A100%|██████████| 6/6 [00:00<00:00, 37.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.88it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.750000
 20%|██        | 10/50 [00:11<00:23,  1.72it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.65it/s][ALoss = 3.8058e-03, PNorm = 35.5907, GNorm = 0.6170, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 38.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.750000
 22%|██▏       | 11/50 [00:11<00:17,  2.17it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.02it/s][A100%|██████████| 6/6 [00:00<00:00, 39.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 24%|██▍       | 12/50 [00:11<00:14,  2.68it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.92it/s][ALoss = 3.0408e-03, PNorm = 35.6578, GNorm = 0.3643, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 38.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.775000
 26%|██▌       | 13/50 [00:12<00:12,  3.06it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.43it/s][A100%|██████████| 6/6 [00:00<00:00, 38.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 28%|██▊       | 14/50 [00:12<00:10,  3.56it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.6335e-03, PNorm = 35.7242, GNorm = 0.4035, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.85it/s][A100%|██████████| 6/6 [00:00<00:00, 36.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 30%|███       | 15/50 [00:12<00:08,  3.98it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.30it/s][A100%|██████████| 6/6 [00:00<00:00, 41.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675000
 32%|███▏      | 16/50 [00:12<00:07,  4.45it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.4484e-03, PNorm = 35.7873, GNorm = 0.4830, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.58it/s][A100%|██████████| 6/6 [00:00<00:00, 38.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.84it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 34%|███▍      | 17/50 [00:12<00:07,  4.50it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.61it/s][A100%|██████████| 6/6 [00:00<00:00, 38.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 36%|███▌      | 18/50 [00:13<00:06,  4.82it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8590e-03, PNorm = 35.8443, GNorm = 0.2549, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.95it/s][A100%|██████████| 6/6 [00:00<00:00, 38.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.09it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 38%|███▊      | 19/50 [00:13<00:06,  5.02it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.49it/s][A100%|██████████| 6/6 [00:00<00:00, 38.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 40%|████      | 20/50 [00:13<00:05,  5.22it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9294e-03, PNorm = 35.8999, GNorm = 0.3949, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.93it/s][A100%|██████████| 6/6 [00:00<00:00, 38.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 42%|████▏     | 21/50 [00:13<00:05,  5.37it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.15it/s][ALoss = 1.6804e-03, PNorm = 35.9432, GNorm = 0.3130, lr_0 = 3.1022e-04
Loss = 3.8343e-03, PNorm = 35.9481, GNorm = 0.4805, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 37.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 44%|████▍     | 22/50 [00:13<00:05,  5.45it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.55it/s][A100%|██████████| 6/6 [00:00<00:00, 39.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.57it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 46%|████▌     | 23/50 [00:13<00:04,  5.54it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5420e-03, PNorm = 35.9908, GNorm = 0.2703, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.57it/s][A100%|██████████| 6/6 [00:00<00:00, 40.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 48%|████▊     | 24/50 [00:14<00:04,  5.67it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.39it/s][A100%|██████████| 6/6 [00:00<00:00, 40.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 50%|█████     | 25/50 [00:14<00:04,  5.76it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4471e-03, PNorm = 36.0321, GNorm = 0.2638, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.50it/s][A100%|██████████| 6/6 [00:00<00:00, 38.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.49it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 52%|█████▏    | 26/50 [00:14<00:04,  5.76it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.89it/s][A100%|██████████| 6/6 [00:00<00:00, 39.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 54%|█████▍    | 27/50 [00:14<00:03,  5.81it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 16.50it/s][ALoss = 1.1602e-03, PNorm = 36.0728, GNorm = 0.2359, lr_0 = 2.2387e-04
100%|██████████| 6/6 [00:00<00:00, 27.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 56%|█████▌    | 28/50 [00:14<00:04,  5.22it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.36it/s][A100%|██████████| 6/6 [00:00<00:00, 39.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.22it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 58%|█████▊    | 29/50 [00:15<00:03,  5.38it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3784e-03, PNorm = 36.1037, GNorm = 0.2449, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.16it/s][A100%|██████████| 6/6 [00:00<00:00, 36.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 60%|██████    | 30/50 [00:15<00:03,  5.42it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.77it/s][A100%|██████████| 6/6 [00:00<00:00, 39.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.34it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 62%|██████▏   | 31/50 [00:15<00:03,  5.52it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0253e-03, PNorm = 36.1322, GNorm = 0.2517, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.81it/s][A100%|██████████| 6/6 [00:00<00:00, 37.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 64%|██████▍   | 32/50 [00:15<00:03,  5.55it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.96it/s][ALoss = 1.0933e-03, PNorm = 36.1544, GNorm = 0.1828, lr_0 = 1.6469e-04
Loss = 2.5223e-03, PNorm = 36.1566, GNorm = 0.5605, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 39.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 66%|██████▌   | 33/50 [00:15<00:03,  5.61it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.66it/s][A100%|██████████| 6/6 [00:00<00:00, 41.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 68%|██████▊   | 34/50 [00:15<00:02,  5.76it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1151e-03, PNorm = 36.1783, GNorm = 0.2304, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.21it/s][A100%|██████████| 6/6 [00:00<00:00, 41.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 70%|███████   | 35/50 [00:16<00:02,  5.86it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.64it/s][A100%|██████████| 6/6 [00:00<00:00, 42.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.30it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 72%|███████▏  | 36/50 [00:16<00:02,  5.98it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.4376e-04, PNorm = 36.1976, GNorm = 0.2161, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.83it/s][A100%|██████████| 6/6 [00:00<00:00, 43.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.82it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 74%|███████▍  | 37/50 [00:16<00:02,  6.08it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.25it/s][A100%|██████████| 6/6 [00:00<00:00, 43.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 76%|███████▌  | 38/50 [00:16<00:01,  6.15it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.8965e-04, PNorm = 36.2157, GNorm = 0.2169, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.68it/s][A100%|██████████| 6/6 [00:00<00:00, 41.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 78%|███████▊  | 39/50 [00:16<00:01,  6.14it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 28.26it/s][A100%|██████████| 6/6 [00:00<00:00, 30.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 80%|████████  | 40/50 [00:16<00:01,  5.54it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0667e-03, PNorm = 36.2315, GNorm = 0.3071, lr_0 = 1.0798e-04

 50%|█████     | 3/6 [00:00<00:00, 28.87it/s][A100%|██████████| 6/6 [00:00<00:00, 31.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 65.36it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 82%|████████▏ | 41/50 [00:17<00:01,  5.22it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.58it/s][ALoss = 1.0016e-03, PNorm = 36.2448, GNorm = 0.3412, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 32.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 64.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 84%|████████▍ | 42/50 [00:17<00:01,  5.08it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.93it/s][A100%|██████████| 6/6 [00:00<00:00, 31.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 86%|████████▌ | 43/50 [00:17<00:01,  5.00it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.25it/s][ALoss = 8.6119e-04, PNorm = 36.2585, GNorm = 0.2218, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 38.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.05it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 88%|████████▊ | 44/50 [00:17<00:01,  5.20it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 19.39it/s][A100%|██████████| 6/6 [00:00<00:00, 26.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 90%|█████████ | 45/50 [00:17<00:01,  4.81it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.4259e-04, PNorm = 36.2717, GNorm = 0.2652, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.69it/s][A100%|██████████| 6/6 [00:00<00:00, 39.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.30it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 92%|█████████▏| 46/50 [00:18<00:00,  5.09it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.08it/s][A100%|██████████| 6/6 [00:00<00:00, 39.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 94%|█████████▍| 47/50 [00:18<00:00,  5.31it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.6065e-04, PNorm = 36.2848, GNorm = 0.2279, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.21it/s][A100%|██████████| 6/6 [00:00<00:00, 37.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.99it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 96%|█████████▌| 48/50 [00:18<00:00,  5.38it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.60it/s][A100%|██████████| 6/6 [00:00<00:00, 37.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 98%|█████████▊| 49/50 [00:18<00:00,  5.46it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.5903e-04, PNorm = 36.2974, GNorm = 0.2687, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.19it/s][A100%|██████████| 6/6 [00:00<00:00, 38.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
100%|██████████| 50/50 [00:18<00:00,  5.55it/s]100%|██████████| 50/50 [00:18<00:00,  2.66it/s]
Model 0 best validation auc = 0.800000 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 19.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.353333
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.353333
Fold 1
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 126752.98it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 137643.16it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 3894.90it/s]
Number of tasks = 8
Splitting data with seed 1
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.12it/s][A100%|██████████| 6/6 [00:00<00:00, 31.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 55.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.513333
  2%|▏         | 1/50 [00:00<00:13,  3.62it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.70it/s][ALoss = 1.1421e-02, PNorm = 35.2662, GNorm = 1.7820, lr_0 = 9.8099e-04
Loss = 2.8382e-02, PNorm = 35.2705, GNorm = 2.1457, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 32.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.573333
  4%|▍         | 2/50 [00:00<00:12,  3.70it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.48it/s][A100%|██████████| 6/6 [00:00<00:00, 34.71it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.506667
  6%|▌         | 3/50 [00:00<00:11,  4.04it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5095e-03, PNorm = 35.3168, GNorm = 0.6917, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 31.20it/s][A100%|██████████| 6/6 [00:00<00:00, 33.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.22it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.473333
  8%|▊         | 4/50 [00:00<00:10,  4.28it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.48it/s][A100%|██████████| 6/6 [00:00<00:00, 32.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.490000
 10%|█         | 5/50 [00:01<00:10,  4.43it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.5683e-03, PNorm = 35.3815, GNorm = 0.6108, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 18.50it/s][A100%|██████████| 6/6 [00:00<00:00, 22.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.490000
 12%|█▏        | 6/50 [00:01<00:10,  4.11it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.99it/s][A100%|██████████| 6/6 [00:00<00:00, 39.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.70it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.523333
 14%|█▍        | 7/50 [00:01<00:09,  4.51it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.9888e-03, PNorm = 35.4496, GNorm = 0.4578, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.47it/s][A100%|██████████| 6/6 [00:00<00:00, 39.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.506667
 16%|█▌        | 8/50 [00:01<00:08,  4.84it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.09it/s][A100%|██████████| 6/6 [00:00<00:00, 40.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.546667
 18%|█▊        | 9/50 [00:01<00:08,  5.12it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.5670e-03, PNorm = 35.5184, GNorm = 0.4734, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.32it/s][A100%|██████████| 6/6 [00:00<00:00, 39.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.521667
 20%|██        | 10/50 [00:02<00:07,  5.33it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.14it/s][ALoss = 3.6489e-03, PNorm = 35.5909, GNorm = 0.5643, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 39.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.496667
 22%|██▏       | 11/50 [00:02<00:07,  5.47it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.82it/s][A100%|██████████| 6/6 [00:00<00:00, 37.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.24it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.496667
 24%|██▍       | 12/50 [00:02<00:06,  5.52it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.42it/s][ALoss = 2.7901e-03, PNorm = 35.6594, GNorm = 0.3190, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 36.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.76it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.496667
 26%|██▌       | 13/50 [00:02<00:06,  5.47it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.22it/s][A100%|██████████| 6/6 [00:00<00:00, 40.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 28%|██▊       | 14/50 [00:02<00:06,  5.59it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2796e-03, PNorm = 35.7278, GNorm = 0.3055, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.46it/s][A100%|██████████| 6/6 [00:00<00:00, 40.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 30%|███       | 15/50 [00:02<00:06,  5.71it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.38it/s][A100%|██████████| 6/6 [00:00<00:00, 42.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 32%|███▏      | 16/50 [00:03<00:05,  5.85it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1038e-03, PNorm = 35.7906, GNorm = 0.4325, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.52it/s][A100%|██████████| 6/6 [00:00<00:00, 41.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 34%|███▍      | 17/50 [00:03<00:05,  5.92it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.11it/s][A100%|██████████| 6/6 [00:00<00:00, 38.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.57it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 36%|███▌      | 18/50 [00:03<00:05,  5.85it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7432e-03, PNorm = 35.8517, GNorm = 0.3410, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.70it/s][A100%|██████████| 6/6 [00:00<00:00, 43.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.09it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 38%|███▊      | 19/50 [00:03<00:05,  6.00it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.78it/s][A100%|██████████| 6/6 [00:00<00:00, 39.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.47it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 40%|████      | 20/50 [00:03<00:05,  5.97it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.8235e-03, PNorm = 35.9075, GNorm = 0.3470, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.12it/s][A100%|██████████| 6/6 [00:00<00:00, 38.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 42%|████▏     | 21/50 [00:03<00:04,  5.90it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5581e-03, PNorm = 35.9529, GNorm = 0.4188, lr_0 = 3.1022e-04

 83%|████████▎ | 5/6 [00:00<00:00, 41.01it/s][ALoss = 3.1971e-03, PNorm = 35.9572, GNorm = 0.3692, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 43.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 44%|████▍     | 22/50 [00:04<00:04,  6.01it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.15it/s][A100%|██████████| 6/6 [00:00<00:00, 37.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.576667
 46%|████▌     | 23/50 [00:04<00:04,  5.43it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3454e-03, PNorm = 35.9983, GNorm = 0.3524, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.06it/s][A100%|██████████| 6/6 [00:00<00:00, 36.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.68it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.536667
 48%|████▊     | 24/50 [00:04<00:04,  5.43it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.37it/s][A100%|██████████| 6/6 [00:00<00:00, 41.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.576667
 50%|█████     | 25/50 [00:04<00:04,  5.63it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3188e-03, PNorm = 36.0409, GNorm = 0.2055, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.11it/s][A100%|██████████| 6/6 [00:00<00:00, 39.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.610000
 52%|█████▏    | 26/50 [00:04<00:04,  5.28it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 42.75it/s][A100%|██████████| 6/6 [00:00<00:00, 46.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.576667
 54%|█████▍    | 27/50 [00:05<00:04,  5.66it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1189e-03, PNorm = 36.0817, GNorm = 0.2369, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.05it/s][A100%|██████████| 6/6 [00:00<00:00, 39.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 56%|█████▌    | 28/50 [00:05<00:04,  5.37it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.22it/s][A100%|██████████| 6/6 [00:00<00:00, 39.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 58%|█████▊    | 29/50 [00:05<00:03,  5.49it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0746e-03, PNorm = 36.1166, GNorm = 0.2884, lr_0 = 2.0145e-04

 50%|█████     | 3/6 [00:00<00:00, 27.18it/s][A100%|██████████| 6/6 [00:00<00:00, 31.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.38it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 60%|██████    | 30/50 [00:05<00:03,  5.26it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.06it/s][A100%|██████████| 6/6 [00:00<00:00, 40.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 11.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 62%|██████▏   | 31/50 [00:05<00:03,  4.87it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.8124e-04, PNorm = 36.1469, GNorm = 0.2297, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 28.63it/s][A100%|██████████| 6/6 [00:00<00:00, 29.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 55.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 64%|██████▍   | 32/50 [00:06<00:03,  4.69it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.73it/s][ALoss = 1.0458e-03, PNorm = 36.1702, GNorm = 0.2522, lr_0 = 1.6469e-04
Loss = 1.5364e-03, PNorm = 36.1726, GNorm = 0.3355, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 33.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.45it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 66%|██████▌   | 33/50 [00:06<00:03,  4.76it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.14it/s][A100%|██████████| 6/6 [00:00<00:00, 34.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 68%|██████▊   | 34/50 [00:06<00:03,  4.84it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0713e-03, PNorm = 36.1954, GNorm = 0.2123, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.83it/s][A100%|██████████| 6/6 [00:00<00:00, 36.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.19it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 70%|███████   | 35/50 [00:06<00:03,  4.98it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.44it/s][A100%|██████████| 6/6 [00:00<00:00, 33.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 72%|███████▏  | 36/50 [00:06<00:02,  4.96it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.9607e-04, PNorm = 36.2171, GNorm = 0.2331, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.61it/s][A100%|██████████| 6/6 [00:00<00:00, 32.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 74%|███████▍  | 37/50 [00:07<00:02,  4.93it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.99it/s][A100%|██████████| 6/6 [00:00<00:00, 32.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 76%|███████▌  | 38/50 [00:07<00:02,  4.91it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.9123e-04, PNorm = 36.2366, GNorm = 0.2537, lr_0 = 1.2000e-04

 50%|█████     | 3/6 [00:00<00:00, 28.47it/s][A100%|██████████| 6/6 [00:00<00:00, 29.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 41.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 78%|███████▊  | 39/50 [00:07<00:02,  4.66it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 27.69it/s][A100%|██████████| 6/6 [00:00<00:00, 31.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 80%|████████  | 40/50 [00:07<00:02,  4.65it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.2478e-04, PNorm = 36.2536, GNorm = 0.1927, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 26.95it/s][A100%|██████████| 6/6 [00:00<00:00, 28.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 57.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 82%|████████▏ | 41/50 [00:08<00:01,  4.51it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.86it/s][ALoss = 9.4169e-04, PNorm = 36.2695, GNorm = 0.4340, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 32.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.45it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 84%|████████▍ | 42/50 [00:08<00:01,  4.61it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.21it/s][A100%|██████████| 6/6 [00:00<00:00, 33.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.650000
 86%|████████▌ | 43/50 [00:08<00:01,  4.70it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.11it/s][ALoss = 8.0598e-04, PNorm = 36.2843, GNorm = 0.1718, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 32.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.666667
 88%|████████▊ | 44/50 [00:08<00:01,  4.42it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.75it/s][A100%|██████████| 6/6 [00:00<00:00, 38.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.666667
 90%|█████████ | 45/50 [00:08<00:01,  4.76it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.6324e-04, PNorm = 36.2997, GNorm = 0.2621, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.30it/s][A100%|██████████| 6/6 [00:00<00:00, 42.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.666667
 92%|█████████▏| 46/50 [00:09<00:00,  5.13it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.90it/s][A100%|██████████| 6/6 [00:00<00:00, 38.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.00it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 94%|█████████▍| 47/50 [00:09<00:00,  4.97it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2116e-04, PNorm = 36.3144, GNorm = 0.3373, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.82it/s][A100%|██████████| 6/6 [00:00<00:00, 41.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 96%|█████████▌| 48/50 [00:09<00:00,  5.27it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.83it/s][A100%|██████████| 6/6 [00:00<00:00, 43.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
 98%|█████████▊| 49/50 [00:09<00:00,  5.56it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.6633e-04, PNorm = 36.3293, GNorm = 0.2044, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.06it/s][A
100%|██████████| 6/6 [00:00<00:00, 27.06it/s][A100%|██████████| 6/6 [00:00<00:00, 26.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.700000
100%|██████████| 50/50 [00:09<00:00,  5.00it/s]100%|██████████| 50/50 [00:09<00:00,  5.10it/s]
Model 0 best validation auc = 0.700000 on epoch 46
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 81.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.676667
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.676667
Fold 2
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 67022.89it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 81913.47it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 90%|████████▉ | 307/343 [00:00<00:00, 3067.76it/s]100%|██████████| 343/343 [00:00<00:00, 3036.53it/s]
Number of tasks = 8
Splitting data with seed 2
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.61it/s][A100%|██████████| 6/6 [00:00<00:00, 29.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 52.88it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.562500
  2%|▏         | 1/50 [00:00<00:14,  3.45it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.83it/s][ALoss = 1.1425e-02, PNorm = 35.2641, GNorm = 0.9335, lr_0 = 9.8099e-04
Loss = 1.6017e-02, PNorm = 35.2699, GNorm = 1.3951, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 32.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.562500
  4%|▍         | 2/50 [00:00<00:12,  3.79it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.98it/s][A100%|██████████| 6/6 [00:00<00:00, 33.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
  6%|▌         | 3/50 [00:00<00:11,  4.09it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.7040e-03, PNorm = 35.3194, GNorm = 0.7882, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.18it/s][A100%|██████████| 6/6 [00:00<00:00, 33.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 51.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
  8%|▊         | 4/50 [00:00<00:10,  4.28it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.08it/s][A100%|██████████| 6/6 [00:00<00:00, 36.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 10%|█         | 5/50 [00:01<00:09,  4.58it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.4267e-03, PNorm = 35.3816, GNorm = 0.5350, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.13it/s][A100%|██████████| 6/6 [00:00<00:00, 36.65it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.92it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 12%|█▏        | 6/50 [00:01<00:09,  4.81it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.23it/s][A100%|██████████| 6/6 [00:00<00:00, 37.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 14%|█▍        | 7/50 [00:01<00:08,  5.01it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.6244e-03, PNorm = 35.4504, GNorm = 0.4652, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.01it/s][A100%|██████████| 6/6 [00:00<00:00, 37.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 16%|█▌        | 8/50 [00:01<00:08,  5.16it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.27it/s][A100%|██████████| 6/6 [00:00<00:00, 40.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 18%|█▊        | 9/50 [00:01<00:07,  5.38it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.8628e-03, PNorm = 35.5140, GNorm = 0.4658, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.25it/s][A100%|██████████| 6/6 [00:00<00:00, 40.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 20%|██        | 10/50 [00:01<00:07,  5.57it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.96it/s][ALoss = 3.5799e-03, PNorm = 35.5804, GNorm = 0.5358, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 43.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.69it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 22%|██▏       | 11/50 [00:02<00:06,  5.80it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.05it/s][A100%|██████████| 6/6 [00:00<00:00, 42.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 24%|██▍       | 12/50 [00:02<00:06,  5.92it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.8187e-03, PNorm = 35.6488, GNorm = 0.3766, lr_0 = 5.2079e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.70it/s][A100%|██████████| 6/6 [00:00<00:00, 44.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 102.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 26%|██▌       | 13/50 [00:02<00:06,  6.10it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.18it/s][A100%|██████████| 6/6 [00:00<00:00, 41.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 28%|██▊       | 14/50 [00:02<00:05,  6.09it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.3033e-03, PNorm = 35.7144, GNorm = 0.3576, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.84it/s][A100%|██████████| 6/6 [00:00<00:00, 39.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 30%|███       | 15/50 [00:02<00:05,  6.03it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.50it/s][A100%|██████████| 6/6 [00:00<00:00, 40.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 97.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 32%|███▏      | 16/50 [00:02<00:05,  6.06it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  8.28it/s][ALoss = 2.1696e-03, PNorm = 35.7744, GNorm = 0.2555, lr_0 = 4.2170e-04

 83%|████████▎ | 5/6 [00:00<00:00, 10.78it/s][A100%|██████████| 6/6 [00:00<00:00, 24.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 34%|███▍      | 17/50 [00:03<00:06,  5.15it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.30it/s][A100%|██████████| 6/6 [00:00<00:00, 30.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 59.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 36%|███▌      | 18/50 [00:03<00:06,  4.95it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.0989e-03, PNorm = 35.8313, GNorm = 0.3058, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 28.92it/s][A100%|██████████| 6/6 [00:00<00:00, 31.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 38%|███▊      | 19/50 [00:03<00:06,  4.89it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.22it/s][A100%|██████████| 6/6 [00:00<00:00, 36.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 40%|████      | 20/50 [00:03<00:05,  5.05it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3176e-03, PNorm = 35.8849, GNorm = 0.2357, lr_0 = 3.4145e-04

 50%|█████     | 3/6 [00:00<00:00, 29.16it/s][A100%|██████████| 6/6 [00:00<00:00, 31.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.500000
 42%|████▏     | 21/50 [00:04<00:05,  4.96it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.52it/s][ALoss = 1.4815e-03, PNorm = 35.9267, GNorm = 0.2254, lr_0 = 3.1022e-04
Loss = 4.0936e-03, PNorm = 35.9303, GNorm = 0.6502, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 34.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 44%|████▍     | 22/50 [00:04<00:05,  5.03it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.44it/s][A100%|██████████| 6/6 [00:00<00:00, 38.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.63it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 46%|████▌     | 23/50 [00:04<00:05,  5.24it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3669e-03, PNorm = 35.9682, GNorm = 0.2874, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.37it/s][A100%|██████████| 6/6 [00:00<00:00, 39.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 48%|████▊     | 24/50 [00:04<00:04,  5.42it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.88it/s][A100%|██████████| 6/6 [00:00<00:00, 39.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 50%|█████     | 25/50 [00:04<00:04,  5.55it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3466e-03, PNorm = 36.0078, GNorm = 0.2619, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.46it/s][A100%|██████████| 6/6 [00:00<00:00, 38.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 52%|█████▏    | 26/50 [00:04<00:04,  5.61it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.13it/s][A100%|██████████| 6/6 [00:00<00:00, 38.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.76it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 54%|█████▍    | 27/50 [00:05<00:04,  5.65it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2132e-03, PNorm = 36.0443, GNorm = 0.2749, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.21it/s][A100%|██████████| 6/6 [00:00<00:00, 40.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 56%|█████▌    | 28/50 [00:05<00:03,  5.78it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.51it/s][A100%|██████████| 6/6 [00:00<00:00, 42.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 58%|█████▊    | 29/50 [00:05<00:03,  5.92it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0067e-03, PNorm = 36.0727, GNorm = 0.2365, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.52it/s][A100%|██████████| 6/6 [00:00<00:00, 41.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 60%|██████    | 30/50 [00:05<00:03,  6.01it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.46it/s][A100%|██████████| 6/6 [00:00<00:00, 42.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 62%|██████▏   | 31/50 [00:05<00:03,  6.11it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.6649e-04, PNorm = 36.0996, GNorm = 0.2428, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.39it/s][A100%|██████████| 6/6 [00:00<00:00, 38.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.50it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 64%|██████▍   | 32/50 [00:05<00:02,  6.03it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.34it/s][ALoss = 1.0100e-03, PNorm = 36.1204, GNorm = 0.2265, lr_0 = 1.6469e-04
Loss = 1.5379e-03, PNorm = 36.1224, GNorm = 0.1844, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 38.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 66%|██████▌   | 33/50 [00:06<00:02,  5.92it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.20it/s][A100%|██████████| 6/6 [00:00<00:00, 38.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 68%|██████▊   | 34/50 [00:06<00:02,  5.86it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.3431e-04, PNorm = 36.1414, GNorm = 0.2785, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.34it/s][A100%|██████████| 6/6 [00:00<00:00, 37.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 70%|███████   | 35/50 [00:06<00:02,  5.79it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.42it/s][A100%|██████████| 6/6 [00:00<00:00, 39.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.29it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 72%|███████▏  | 36/50 [00:06<00:02,  5.82it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0413e-03, PNorm = 36.1599, GNorm = 0.2184, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.54it/s][A100%|██████████| 6/6 [00:00<00:00, 36.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.12it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 74%|███████▍  | 37/50 [00:06<00:02,  5.71it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 13.05it/s][A
100%|██████████| 6/6 [00:00<00:00, 16.30it/s][A100%|██████████| 6/6 [00:00<00:00, 23.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 76%|███████▌  | 38/50 [00:07<00:02,  4.88it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.9403e-04, PNorm = 36.1763, GNorm = 0.1946, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.95it/s][A100%|██████████| 6/6 [00:00<00:00, 39.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 78%|███████▊  | 39/50 [00:07<00:02,  5.14it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.36it/s][A100%|██████████| 6/6 [00:00<00:00, 40.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 80%|████████  | 40/50 [00:07<00:01,  5.38it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.4515e-04, PNorm = 36.1905, GNorm = 0.2164, lr_0 = 1.0798e-04

 50%|█████     | 3/6 [00:00<00:00, 27.99it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.43it/s][A100%|██████████| 6/6 [00:00<00:00, 28.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 64.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 82%|████████▏ | 41/50 [00:07<00:01,  5.00it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.86it/s][ALoss = 9.1663e-04, PNorm = 36.2025, GNorm = 0.3636, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 31.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 84%|████████▍ | 42/50 [00:07<00:01,  4.92it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.94it/s][A100%|██████████| 6/6 [00:00<00:00, 33.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.437500
 86%|████████▌ | 43/50 [00:08<00:01,  4.95it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.94it/s][ALoss = 8.3008e-04, PNorm = 36.2165, GNorm = 0.3431, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 32.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.70it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 88%|████████▊ | 44/50 [00:08<00:01,  4.89it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.47it/s][A100%|██████████| 6/6 [00:00<00:00, 31.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 90%|█████████ | 45/50 [00:08<00:01,  4.85it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2066e-04, PNorm = 36.2281, GNorm = 0.1842, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.12it/s][A100%|██████████| 6/6 [00:00<00:00, 38.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 92%|█████████▏| 46/50 [00:08<00:00,  5.10it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.37it/s][A100%|██████████| 6/6 [00:00<00:00, 41.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 94%|█████████▍| 47/50 [00:08<00:00,  5.37it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2063e-04, PNorm = 36.2406, GNorm = 0.1486, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.23it/s][A100%|██████████| 6/6 [00:00<00:00, 42.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.69it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 96%|█████████▌| 48/50 [00:08<00:00,  5.62it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.23it/s][A100%|██████████| 6/6 [00:00<00:00, 43.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
 98%|█████████▊| 49/50 [00:09<00:00,  5.84it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2852e-04, PNorm = 36.2532, GNorm = 0.1999, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.30it/s][A100%|██████████| 6/6 [00:00<00:00, 39.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.458333
100%|██████████| 50/50 [00:09<00:00,  5.86it/s]100%|██████████| 50/50 [00:09<00:00,  5.41it/s]
Model 0 best validation auc = 0.562500 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 46.19it/s]
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.341270
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.341270
Fold 3
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 91377.43it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 121599.72it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 3746.89it/s]
Number of tasks = 8
Splitting data with seed 3
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.97it/s][A100%|██████████| 6/6 [00:00<00:00, 31.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 61.54it/s]
Validation auc = 0.452083
  2%|▏         | 1/50 [00:00<00:13,  3.65it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.11it/s][ALoss = 1.0760e-02, PNorm = 35.2694, GNorm = 0.9418, lr_0 = 9.8099e-04
Loss = 3.1398e-02, PNorm = 35.2740, GNorm = 2.4409, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 37.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.21it/s]
Validation auc = 0.477083
  4%|▍         | 2/50 [00:00<00:12,  3.79it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.40it/s][A100%|██████████| 6/6 [00:00<00:00, 38.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.50it/s]
Validation auc = 0.335417
  6%|▌         | 3/50 [00:00<00:11,  4.19it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.3096e-03, PNorm = 35.3238, GNorm = 0.6936, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.34it/s][A100%|██████████| 6/6 [00:00<00:00, 35.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 40.83it/s]
Validation auc = 0.352083
  8%|▊         | 4/50 [00:00<00:10,  4.34it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.54it/s][A100%|██████████| 6/6 [00:00<00:00, 32.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.70it/s]
Validation auc = 0.352083
 10%|█         | 5/50 [00:01<00:10,  4.46it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.2634e-03, PNorm = 35.3934, GNorm = 0.6926, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 31.67it/s][A100%|██████████| 6/6 [00:00<00:00, 34.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.76it/s]
Validation auc = 0.352083
 12%|█▏        | 6/50 [00:01<00:09,  4.63it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  7.45it/s][A
 83%|████████▎ | 5/6 [00:00<00:00,  9.66it/s][A100%|██████████| 6/6 [00:00<00:00, 21.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 65.44it/s]
Validation auc = 0.485417
 14%|█▍        | 7/50 [00:01<00:11,  3.86it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.2513e-03, PNorm = 35.4621, GNorm = 0.4734, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.41it/s][A100%|██████████| 6/6 [00:00<00:00, 32.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.13it/s]
Validation auc = 0.479167
 16%|█▌        | 8/50 [00:01<00:10,  4.08it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.87it/s][A100%|██████████| 6/6 [00:00<00:00, 34.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.89it/s]
Validation auc = 0.470833
 18%|█▊        | 9/50 [00:02<00:09,  4.31it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.4954e-03, PNorm = 35.5256, GNorm = 0.4268, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 31.57it/s][A100%|██████████| 6/6 [00:00<00:00, 34.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.69it/s]
Validation auc = 0.479167
 20%|██        | 10/50 [00:02<00:08,  4.49it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.78it/s][ALoss = 3.1609e-03, PNorm = 35.5942, GNorm = 0.5627, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 35.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.71it/s]
Validation auc = 0.479167
 22%|██▏       | 11/50 [00:02<00:08,  4.67it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.01it/s][A100%|██████████| 6/6 [00:00<00:00, 30.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 64.95it/s]
Validation auc = 0.470833
 24%|██▍       | 12/50 [00:02<00:08,  4.60it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.99it/s][ALoss = 2.4545e-03, PNorm = 35.6552, GNorm = 0.3812, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 33.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.09it/s]
Validation auc = 0.470833
 26%|██▌       | 13/50 [00:02<00:07,  4.67it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.68it/s][A100%|██████████| 6/6 [00:00<00:00, 31.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.94it/s]
Validation auc = 0.470833
 28%|██▊       | 14/50 [00:03<00:07,  4.64it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1255e-03, PNorm = 35.7135, GNorm = 0.4485, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.67it/s][A100%|██████████| 6/6 [00:00<00:00, 32.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.18it/s]
Validation auc = 0.470833
 30%|███       | 15/50 [00:03<00:07,  4.70it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.97it/s][A100%|██████████| 6/6 [00:00<00:00, 40.42it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.60it/s]
Validation auc = 0.470833
 32%|███▏      | 16/50 [00:03<00:06,  5.01it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9460e-03, PNorm = 35.7687, GNorm = 0.3767, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.70it/s][A100%|██████████| 6/6 [00:00<00:00, 39.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.99it/s]
Validation auc = 0.468750
 34%|███▍      | 17/50 [00:03<00:06,  5.23it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.72it/s][A100%|██████████| 6/6 [00:00<00:00, 40.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.51it/s]
Validation auc = 0.468750
 36%|███▌      | 18/50 [00:03<00:05,  5.43it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9376e-03, PNorm = 35.8185, GNorm = 0.3978, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 16.48it/s][A100%|██████████| 6/6 [00:00<00:00, 19.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 57.73it/s]
Validation auc = 0.468750
 38%|███▊      | 19/50 [00:04<00:07,  4.35it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.86it/s][A100%|██████████| 6/6 [00:00<00:00, 34.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.04it/s]
Validation auc = 0.477083
 40%|████      | 20/50 [00:04<00:06,  4.53it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.6561e-03, PNorm = 35.8641, GNorm = 0.2495, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.66it/s][A100%|██████████| 6/6 [00:00<00:00, 35.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.95it/s]
Validation auc = 0.477083
 42%|████▏     | 21/50 [00:04<00:06,  4.71it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.21it/s][ALoss = 1.3390e-03, PNorm = 35.9012, GNorm = 0.2733, lr_0 = 3.1022e-04
Loss = 2.7489e-03, PNorm = 35.9044, GNorm = 0.3948, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 33.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.71it/s]
Validation auc = 0.477083
 44%|████▍     | 22/50 [00:04<00:05,  4.78it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.86it/s][A100%|██████████| 6/6 [00:00<00:00, 37.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.06it/s]
Validation auc = 0.477083
 46%|████▌     | 23/50 [00:04<00:05,  4.96it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2790e-03, PNorm = 35.9379, GNorm = 0.3801, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.06it/s][A100%|██████████| 6/6 [00:00<00:00, 41.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.72it/s]
Validation auc = 0.468750
 48%|████▊     | 24/50 [00:05<00:04,  5.22it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.75it/s][A100%|██████████| 6/6 [00:00<00:00, 38.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.19it/s]
Validation auc = 0.477083
 50%|█████     | 25/50 [00:05<00:04,  5.34it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1440e-03, PNorm = 35.9672, GNorm = 0.2422, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.72it/s][A100%|██████████| 6/6 [00:00<00:00, 38.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.19it/s]
Validation auc = 0.477083
 52%|█████▏    | 26/50 [00:05<00:04,  5.42it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.42it/s][A100%|██████████| 6/6 [00:00<00:00, 38.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.79it/s]
Validation auc = 0.477083
 54%|█████▍    | 27/50 [00:05<00:04,  5.49it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0013e-03, PNorm = 35.9994, GNorm = 0.2356, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.00it/s][A100%|██████████| 6/6 [00:00<00:00, 38.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.08it/s]
Validation auc = 0.470833
 56%|█████▌    | 28/50 [00:05<00:03,  5.54it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.30it/s][A100%|██████████| 6/6 [00:00<00:00, 39.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.91it/s]
Validation auc = 0.470833
 58%|█████▊    | 29/50 [00:06<00:03,  5.63it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1065e-03, PNorm = 36.0258, GNorm = 0.1779, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.02it/s][A100%|██████████| 6/6 [00:00<00:00, 38.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.37it/s]
Validation auc = 0.470833
 60%|██████    | 30/50 [00:06<00:03,  5.62it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.06it/s][A100%|██████████| 6/6 [00:00<00:00, 40.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 77.54it/s]
Validation auc = 0.470833
 62%|██████▏   | 31/50 [00:06<00:03,  5.69it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1010e-04, PNorm = 36.0496, GNorm = 0.1342, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.06it/s][A100%|██████████| 6/6 [00:00<00:00, 38.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.21it/s]
Validation auc = 0.512500
 64%|██████▍   | 32/50 [00:06<00:03,  5.24it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.66it/s][ALoss = 8.5297e-04, PNorm = 36.0684, GNorm = 0.1910, lr_0 = 1.6469e-04
Loss = 2.5583e-03, PNorm = 36.0703, GNorm = 0.4162, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 37.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.68it/s]
Validation auc = 0.470833
 66%|██████▌   | 33/50 [00:06<00:03,  5.32it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.82it/s][A100%|██████████| 6/6 [00:00<00:00, 38.14it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.23it/s]
Validation auc = 0.512500
 68%|██████▊   | 34/50 [00:06<00:02,  5.40it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.7608e-04, PNorm = 36.0887, GNorm = 0.2109, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.36it/s][A100%|██████████| 6/6 [00:00<00:00, 38.41it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.27it/s]
Validation auc = 0.512500
 70%|███████   | 35/50 [00:07<00:02,  5.46it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.92it/s][A100%|██████████| 6/6 [00:00<00:00, 38.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.04it/s]
Validation auc = 0.512500
 72%|███████▏  | 36/50 [00:07<00:02,  5.49it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.9384e-04, PNorm = 36.1052, GNorm = 0.2236, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.21it/s][A100%|██████████| 6/6 [00:00<00:00, 38.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.65it/s]
Validation auc = 0.512500
 74%|███████▍  | 37/50 [00:07<00:02,  5.51it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.71it/s][A100%|██████████| 6/6 [00:00<00:00, 39.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.31it/s]
Validation auc = 0.512500
 76%|███████▌  | 38/50 [00:07<00:02,  5.57it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.0365e-04, PNorm = 36.1206, GNorm = 0.2335, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.29it/s][A100%|██████████| 6/6 [00:00<00:00, 41.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.98it/s]
Validation auc = 0.512500
 78%|███████▊  | 39/50 [00:07<00:01,  5.68it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.90it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.78it/s][A100%|██████████| 6/6 [00:00<00:00, 27.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.81it/s]
Validation auc = 0.512500
 80%|████████  | 40/50 [00:08<00:01,  5.16it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.6429e-04, PNorm = 36.1335, GNorm = 0.1165, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.28it/s][A100%|██████████| 6/6 [00:00<00:00, 39.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.20it/s]
Validation auc = 0.512500
 82%|████████▏ | 41/50 [00:08<00:01,  5.33it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.33it/s][ALoss = 8.2651e-04, PNorm = 36.1465, GNorm = 0.2492, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 39.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.28it/s]
Validation auc = 0.512500
 84%|████████▍ | 42/50 [00:08<00:01,  5.44it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.52it/s][A100%|██████████| 6/6 [00:00<00:00, 40.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.33it/s]
Validation auc = 0.512500
 86%|████████▌ | 43/50 [00:08<00:01,  5.58it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.06it/s][ALoss = 7.4323e-04, PNorm = 36.1580, GNorm = 0.1498, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 37.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.15it/s]
Validation auc = 0.512500
 88%|████████▊ | 44/50 [00:08<00:01,  5.57it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.49it/s][A100%|██████████| 6/6 [00:00<00:00, 38.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.16it/s]
Validation auc = 0.512500
 90%|█████████ | 45/50 [00:08<00:00,  5.58it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.7547e-04, PNorm = 36.1702, GNorm = 0.1310, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.36it/s][A100%|██████████| 6/6 [00:00<00:00, 38.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.44it/s]
Validation auc = 0.512500
 92%|█████████▏| 46/50 [00:09<00:00,  5.58it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.06it/s][A100%|██████████| 6/6 [00:00<00:00, 38.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.33it/s]
Validation auc = 0.512500
 94%|█████████▍| 47/50 [00:09<00:00,  5.57it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.5904e-04, PNorm = 36.1822, GNorm = 0.1960, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.40it/s][A100%|██████████| 6/6 [00:00<00:00, 37.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.53it/s]
Validation auc = 0.512500
 96%|█████████▌| 48/50 [00:09<00:00,  5.54it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.92it/s][A100%|██████████| 6/6 [00:00<00:00, 42.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.26it/s]
Validation auc = 0.512500
 98%|█████████▊| 49/50 [00:09<00:00,  5.71it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5668e-04, PNorm = 36.1945, GNorm = 0.1809, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.64it/s][A100%|██████████| 6/6 [00:00<00:00, 39.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.84it/s]
Validation auc = 0.512500
100%|██████████| 50/50 [00:09<00:00,  5.74it/s]100%|██████████| 50/50 [00:09<00:00,  5.10it/s]
Model 0 best validation auc = 0.512500 on epoch 31
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 46.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.458333
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.458333
Fold 4
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_4',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 57714.38it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 53692.85it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 62%|██████▏   | 214/343 [00:00<00:00, 2130.42it/s]100%|██████████| 343/343 [00:00<00:00, 2210.98it/s]
Number of tasks = 8
Splitting data with seed 4
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.01it/s][A100%|██████████| 6/6 [00:00<00:00, 33.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 65.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.453571
  2%|▏         | 1/50 [00:00<00:12,  3.86it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.90it/s][ALoss = 1.1175e-02, PNorm = 35.2669, GNorm = 1.2158, lr_0 = 9.8099e-04
Loss = 1.9002e-02, PNorm = 35.2726, GNorm = 1.5352, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 32.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 61.99it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.652381
  4%|▍         | 2/50 [00:00<00:12,  3.84it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.60it/s][A100%|██████████| 6/6 [00:00<00:00, 39.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.626190
  6%|▌         | 3/50 [00:00<00:11,  4.27it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.0811e-03, PNorm = 35.3180, GNorm = 0.6947, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.58it/s][A100%|██████████| 6/6 [00:00<00:00, 38.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.67it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.579762
  8%|▊         | 4/50 [00:00<00:09,  4.62it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.63it/s][A100%|██████████| 6/6 [00:00<00:00, 38.39it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.91it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.579762
 10%|█         | 5/50 [00:01<00:09,  4.89it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.7177e-03, PNorm = 35.3849, GNorm = 0.6646, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.37it/s][A100%|██████████| 6/6 [00:00<00:00, 40.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.603571
 12%|█▏        | 6/50 [00:01<00:08,  5.16it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.82it/s][A100%|██████████| 6/6 [00:00<00:00, 40.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.95it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.603571
 14%|█▍        | 7/50 [00:01<00:08,  5.35it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.9969e-03, PNorm = 35.4502, GNorm = 0.5375, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.92it/s][A100%|██████████| 6/6 [00:00<00:00, 39.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.05it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.603571
 16%|█▌        | 8/50 [00:01<00:07,  5.48it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.52it/s][A100%|██████████| 6/6 [00:00<00:00, 39.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.10it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.603571
 18%|█▊        | 9/50 [00:01<00:07,  5.55it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.7824e-03, PNorm = 35.5059, GNorm = 0.6011, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 38.62it/s][A100%|██████████| 6/6 [00:00<00:00, 42.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.37it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.746429
 20%|██        | 10/50 [00:01<00:07,  5.34it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 41.19it/s][ALoss = 3.4069e-03, PNorm = 35.5699, GNorm = 0.4656, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 43.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.45it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.746429
 22%|██▏       | 11/50 [00:02<00:06,  5.62it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 16.27it/s][A100%|██████████| 6/6 [00:00<00:00, 23.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.34it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.764286
 24%|██▍       | 12/50 [00:02<00:08,  4.55it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.04it/s][ALoss = 2.6774e-03, PNorm = 35.6330, GNorm = 0.3753, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 33.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.764286
 26%|██▌       | 13/50 [00:02<00:07,  4.68it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.43it/s][A100%|██████████| 6/6 [00:00<00:00, 40.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.10it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 28%|██▊       | 14/50 [00:02<00:07,  4.71it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.2603e-03, PNorm = 35.6912, GNorm = 0.4673, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.56it/s][A100%|██████████| 6/6 [00:00<00:00, 38.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.30it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 30%|███       | 15/50 [00:02<00:07,  4.97it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.85it/s][A100%|██████████| 6/6 [00:00<00:00, 39.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 100.39it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 32%|███▏      | 16/50 [00:03<00:06,  5.22it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1264e-03, PNorm = 35.7466, GNorm = 0.3088, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.19it/s][A100%|██████████| 6/6 [00:00<00:00, 43.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.78it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 34%|███▍      | 17/50 [00:03<00:06,  5.50it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 43.01it/s][A100%|██████████| 6/6 [00:00<00:00, 46.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.36it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 36%|███▌      | 18/50 [00:03<00:05,  5.82it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9966e-03, PNorm = 35.8005, GNorm = 0.4186, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.31it/s][A100%|██████████| 6/6 [00:00<00:00, 41.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.38it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 38%|███▊      | 19/50 [00:03<00:05,  5.90it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.23it/s][A100%|██████████| 6/6 [00:00<00:00, 42.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.55it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.782143
 40%|████      | 20/50 [00:03<00:05,  5.98it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5441e-03, PNorm = 35.8496, GNorm = 0.2413, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.89it/s][A100%|██████████| 6/6 [00:00<00:00, 40.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.88it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 42%|████▏     | 21/50 [00:03<00:04,  5.97it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.53it/s][ALoss = 1.4603e-03, PNorm = 35.8939, GNorm = 0.3778, lr_0 = 3.1022e-04
Loss = 4.2364e-03, PNorm = 35.8977, GNorm = 0.6458, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 40.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.57it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 44%|████▍     | 22/50 [00:04<00:04,  5.96it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.45it/s][A100%|██████████| 6/6 [00:00<00:00, 38.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.98it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 46%|████▌     | 23/50 [00:04<00:04,  5.89it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3550e-03, PNorm = 35.9353, GNorm = 0.2902, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.33it/s][A100%|██████████| 6/6 [00:00<00:00, 40.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 48%|████▊     | 24/50 [00:04<00:04,  5.88it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.91it/s][A100%|██████████| 6/6 [00:00<00:00, 40.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.13it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 50%|█████     | 25/50 [00:04<00:04,  5.90it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3200e-03, PNorm = 35.9726, GNorm = 0.2573, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.02it/s][A100%|██████████| 6/6 [00:00<00:00, 38.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.71it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 52%|█████▏    | 26/50 [00:04<00:04,  5.79it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.12it/s][A100%|██████████| 6/6 [00:00<00:00, 38.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.800000
 54%|█████▍    | 27/50 [00:05<00:03,  5.75it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1052e-03, PNorm = 36.0100, GNorm = 0.3256, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 21.19it/s][A100%|██████████| 6/6 [00:00<00:00, 25.78it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 36.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.782143
 56%|█████▌    | 28/50 [00:05<00:04,  4.89it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.31it/s][A100%|██████████| 6/6 [00:00<00:00, 33.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 67.62it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.782143
 58%|█████▊    | 29/50 [00:05<00:04,  4.89it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1289e-03, PNorm = 36.0401, GNorm = 0.2554, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.22it/s][A100%|██████████| 6/6 [00:00<00:00, 33.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.78it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.782143
 60%|██████    | 30/50 [00:05<00:04,  4.91it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.70it/s][A100%|██████████| 6/6 [00:00<00:00, 35.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.46it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 62%|██████▏   | 31/50 [00:05<00:03,  4.97it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5818e-04, PNorm = 36.0664, GNorm = 0.2595, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.68it/s][A100%|██████████| 6/6 [00:00<00:00, 33.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.83it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.782143
 64%|██████▍   | 32/50 [00:06<00:03,  4.95it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.04it/s][ALoss = 9.6651e-04, PNorm = 36.0880, GNorm = 0.2191, lr_0 = 1.6469e-04
Loss = 2.5448e-03, PNorm = 36.0904, GNorm = 0.6575, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 39.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.00it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 66%|██████▌   | 33/50 [00:06<00:03,  5.17it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.21it/s][A100%|██████████| 6/6 [00:00<00:00, 40.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.02it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.782143
 68%|██████▊   | 34/50 [00:06<00:02,  5.38it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7899e-04, PNorm = 36.1106, GNorm = 0.2271, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.10it/s][A100%|██████████| 6/6 [00:00<00:00, 36.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.69it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 70%|███████   | 35/50 [00:06<00:02,  5.37it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.61it/s][A100%|██████████| 6/6 [00:00<00:00, 38.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.16it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 72%|███████▏  | 36/50 [00:06<00:02,  5.45it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.2212e-04, PNorm = 36.1296, GNorm = 0.3617, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.52it/s][A100%|██████████| 6/6 [00:00<00:00, 37.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.21it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 74%|███████▍  | 37/50 [00:06<00:02,  5.48it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.64it/s][A100%|██████████| 6/6 [00:00<00:00, 38.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.43it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 76%|███████▌  | 38/50 [00:07<00:02,  5.54it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.0493e-04, PNorm = 36.1478, GNorm = 0.1782, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.98it/s][A100%|██████████| 6/6 [00:00<00:00, 39.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.35it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 78%|███████▊  | 39/50 [00:07<00:01,  5.63it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.97it/s][A100%|██████████| 6/6 [00:00<00:00, 41.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.07it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 80%|████████  | 40/50 [00:07<00:01,  5.75it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5744e-04, PNorm = 36.1632, GNorm = 0.1928, lr_0 = 1.0798e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.93it/s][A100%|██████████| 6/6 [00:00<00:00, 44.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.84it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 82%|████████▏ | 41/50 [00:07<00:01,  5.93it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.37it/s][ALoss = 8.7400e-04, PNorm = 36.1773, GNorm = 0.3821, lr_0 = 1.0000e-04

100%|██████████| 6/6 [00:00<00:00, 28.35it/s][A100%|██████████| 6/6 [00:00<00:00, 27.47it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.64it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 84%|████████▍ | 42/50 [00:07<00:01,  5.27it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.29it/s][A100%|██████████| 6/6 [00:00<00:00, 38.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.41it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 86%|████████▌ | 43/50 [00:08<00:01,  5.37it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.04it/s][ALoss = 7.8232e-04, PNorm = 36.1904, GNorm = 0.1977, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 36.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.84it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 88%|████████▊ | 44/50 [00:08<00:01,  5.37it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.99it/s][A100%|██████████| 6/6 [00:00<00:00, 36.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.85it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 90%|█████████ | 45/50 [00:08<00:00,  5.40it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.6268e-04, PNorm = 36.2033, GNorm = 0.2479, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.97it/s][A100%|██████████| 6/6 [00:00<00:00, 38.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.68it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 92%|█████████▏| 46/50 [00:08<00:00,  5.46it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.10it/s][A100%|██████████| 6/6 [00:00<00:00, 41.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.74it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 94%|█████████▍| 47/50 [00:08<00:00,  5.62it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.9729e-04, PNorm = 36.2154, GNorm = 0.1160, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.64it/s][A100%|██████████| 6/6 [00:00<00:00, 36.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.56it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 96%|█████████▌| 48/50 [00:08<00:00,  5.56it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.54it/s][A100%|██████████| 6/6 [00:00<00:00, 39.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.94it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
 98%|█████████▊| 49/50 [00:09<00:00,  5.62it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.8430e-04, PNorm = 36.2293, GNorm = 0.1087, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.04it/s][A100%|██████████| 6/6 [00:00<00:00, 36.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.37it/s]
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.758333
100%|██████████| 50/50 [00:09<00:00,  5.56it/s]100%|██████████| 50/50 [00:09<00:00,  5.37it/s]
Model 0 best validation auc = 0.800000 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 77.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.394444
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.394444
Fold 5
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_5',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 86728.13it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 98342.08it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 94%|█████████▎| 321/343 [00:00<00:00, 3202.41it/s]100%|██████████| 343/343 [00:00<00:00, 3183.45it/s]
Number of tasks = 8
Splitting data with seed 5
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.32it/s][A100%|██████████| 6/6 [00:00<00:00, 31.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.222222
  2%|▏         | 1/50 [00:00<00:12,  3.80it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.51it/s][ALoss = 1.1106e-02, PNorm = 35.2669, GNorm = 1.1450, lr_0 = 9.8099e-04
Loss = 3.1453e-02, PNorm = 35.2710, GNorm = 2.1076, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 34.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 98.34it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.629630
  4%|▍         | 2/50 [00:00<00:12,  3.94it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.17it/s][A100%|██████████| 6/6 [00:00<00:00, 41.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 99.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.629630
  6%|▌         | 3/50 [00:00<00:10,  4.41it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 27.16it/s][ALoss = 7.3296e-03, PNorm = 35.3214, GNorm = 0.8049, lr_0 = 8.8274e-04
100%|██████████| 6/6 [00:00<00:00, 30.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.72it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.648148
  8%|▊         | 4/50 [00:00<00:11,  4.14it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.21it/s][A100%|██████████| 6/6 [00:00<00:00, 32.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.611111
 10%|█         | 5/50 [00:01<00:10,  4.32it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.5878e-03, PNorm = 35.3895, GNorm = 0.5641, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 29.97it/s][A100%|██████████| 6/6 [00:00<00:00, 32.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.68it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.611111
 12%|█▏        | 6/50 [00:01<00:09,  4.48it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.10it/s][A100%|██████████| 6/6 [00:00<00:00, 39.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.685185
 14%|█▍        | 7/50 [00:01<00:09,  4.53it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.2393e-03, PNorm = 35.4556, GNorm = 0.5036, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.09it/s][A100%|██████████| 6/6 [00:00<00:00, 40.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.620370
 16%|█▌        | 8/50 [00:01<00:08,  4.87it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.65it/s][A100%|██████████| 6/6 [00:00<00:00, 38.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 18%|█▊        | 9/50 [00:01<00:08,  4.78it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.0808e-03, PNorm = 35.5220, GNorm = 0.3819, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 31.90it/s][A100%|██████████| 6/6 [00:00<00:00, 34.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.638889
 20%|██        | 10/50 [00:02<00:08,  4.90it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.53it/s][ALoss = 3.3337e-03, PNorm = 35.5892, GNorm = 0.6152, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 38.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.657407
 22%|██▏       | 11/50 [00:02<00:07,  5.11it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.94it/s][A
100%|██████████| 6/6 [00:00<00:00, 25.89it/s][A100%|██████████| 6/6 [00:00<00:00, 24.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675926
 24%|██▍       | 12/50 [00:02<00:08,  4.65it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.80it/s][ALoss = 2.4653e-03, PNorm = 35.6508, GNorm = 0.3843, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 40.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.49it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.657407
 26%|██▌       | 13/50 [00:02<00:07,  4.99it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.60it/s][A100%|██████████| 6/6 [00:00<00:00, 42.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.675926
 28%|██▊       | 14/50 [00:02<00:06,  5.29it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1405e-03, PNorm = 35.7110, GNorm = 0.4467, lr_0 = 4.6863e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.04it/s][A100%|██████████| 6/6 [00:00<00:00, 43.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.80it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 30%|███       | 15/50 [00:03<00:06,  5.56it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.33it/s][A100%|██████████| 6/6 [00:00<00:00, 43.58it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 32%|███▏      | 16/50 [00:03<00:05,  5.78it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7250e-03, PNorm = 35.7665, GNorm = 0.3587, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.14it/s][A100%|██████████| 6/6 [00:00<00:00, 42.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.57it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 34%|███▍      | 17/50 [00:03<00:05,  5.92it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.21it/s][A100%|██████████| 6/6 [00:00<00:00, 42.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 36%|███▌      | 18/50 [00:03<00:05,  6.01it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9928e-03, PNorm = 35.8152, GNorm = 0.3369, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.58it/s][A100%|██████████| 6/6 [00:00<00:00, 38.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.73it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 38%|███▊      | 19/50 [00:03<00:05,  5.90it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.45it/s][A100%|██████████| 6/6 [00:00<00:00, 39.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.26it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 40%|████      | 20/50 [00:03<00:05,  5.86it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4457e-03, PNorm = 35.8628, GNorm = 0.2532, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.75it/s][A100%|██████████| 6/6 [00:00<00:00, 37.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 42%|████▏     | 21/50 [00:04<00:05,  5.77it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.07it/s][ALoss = 1.4103e-03, PNorm = 35.8940, GNorm = 0.2603, lr_0 = 3.1022e-04
Loss = 4.1529e-03, PNorm = 35.8977, GNorm = 0.5594, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 37.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 44%|████▍     | 22/50 [00:04<00:04,  5.69it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.17it/s][A100%|██████████| 6/6 [00:00<00:00, 37.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 46%|████▌     | 23/50 [00:04<00:04,  5.66it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4359e-03, PNorm = 35.9351, GNorm = 0.3629, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.06it/s][A100%|██████████| 6/6 [00:00<00:00, 33.36it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 43.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 48%|████▊     | 24/50 [00:04<00:04,  5.29it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 26.33it/s][A100%|██████████| 6/6 [00:00<00:00, 30.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 50%|█████     | 25/50 [00:04<00:04,  5.02it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3616e-03, PNorm = 35.9651, GNorm = 0.3501, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.34it/s][A100%|██████████| 6/6 [00:00<00:00, 32.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.77it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 52%|█████▏    | 26/50 [00:05<00:04,  4.98it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.76it/s][A100%|██████████| 6/6 [00:00<00:00, 32.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 65.47it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 54%|█████▍    | 27/50 [00:05<00:04,  4.92it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0718e-03, PNorm = 35.9969, GNorm = 0.2153, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.68it/s][A100%|██████████| 6/6 [00:00<00:00, 32.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.76it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 56%|█████▌    | 28/50 [00:05<00:04,  4.88it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.88it/s][A100%|██████████| 6/6 [00:00<00:00, 34.27it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.90it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 58%|█████▊    | 29/50 [00:05<00:04,  4.90it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.7361e-04, PNorm = 36.0224, GNorm = 0.1572, lr_0 = 2.0145e-04

 50%|█████     | 3/6 [00:00<00:00, 24.54it/s][A100%|██████████| 6/6 [00:00<00:00, 28.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 60%|██████    | 30/50 [00:05<00:04,  4.70it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.75it/s][A100%|██████████| 6/6 [00:00<00:00, 32.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 62%|██████▏   | 31/50 [00:06<00:04,  4.75it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1361e-03, PNorm = 36.0457, GNorm = 0.1949, lr_0 = 1.8127e-04

 50%|█████     | 3/6 [00:00<00:00, 29.87it/s][A100%|██████████| 6/6 [00:00<00:00, 31.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 64%|██████▍   | 32/50 [00:06<00:03,  4.74it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.94it/s][ALoss = 9.6555e-04, PNorm = 36.0669, GNorm = 0.2216, lr_0 = 1.6469e-04
Loss = 2.2159e-03, PNorm = 36.0686, GNorm = 0.4262, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 32.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 11.11it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 66%|██████▌   | 33/50 [00:06<00:03,  4.28it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.16it/s][A100%|██████████| 6/6 [00:00<00:00, 33.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 68%|██████▊   | 34/50 [00:06<00:03,  4.46it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.9018e-04, PNorm = 36.0848, GNorm = 0.2415, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.35it/s][A100%|██████████| 6/6 [00:00<00:00, 36.93it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.81it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 70%|███████   | 35/50 [00:07<00:03,  4.73it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.26it/s][A100%|██████████| 6/6 [00:00<00:00, 39.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.24it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 72%|███████▏  | 36/50 [00:07<00:02,  5.01it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7170e-04, PNorm = 36.1023, GNorm = 0.1794, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.01it/s][A100%|██████████| 6/6 [00:00<00:00, 38.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.46it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 74%|███████▍  | 37/50 [00:07<00:02,  5.20it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.43it/s][A100%|██████████| 6/6 [00:00<00:00, 38.97it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 76%|███████▌  | 38/50 [00:07<00:02,  5.36it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0646e-03, PNorm = 36.1172, GNorm = 0.2416, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.81it/s][A100%|██████████| 6/6 [00:00<00:00, 37.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 78%|███████▊  | 39/50 [00:07<00:02,  5.44it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.56it/s][A100%|██████████| 6/6 [00:00<00:00, 40.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 80%|████████  | 40/50 [00:07<00:01,  5.61it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.2147e-04, PNorm = 36.1309, GNorm = 0.1598, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 32.24it/s][A100%|██████████| 6/6 [00:00<00:00, 34.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 82%|████████▏ | 41/50 [00:08<00:01,  5.42it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.62it/s][ALoss = 8.8532e-04, PNorm = 36.1431, GNorm = 0.2821, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 34.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.74it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 84%|████████▍ | 42/50 [00:08<00:01,  5.29it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.12it/s][A100%|██████████| 6/6 [00:00<00:00, 31.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 61.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 86%|████████▌ | 43/50 [00:08<00:01,  5.06it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.64it/s][ALoss = 7.7535e-04, PNorm = 36.1544, GNorm = 0.1723, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 37.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 88%|████████▊ | 44/50 [00:08<00:01,  5.20it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.05it/s][A100%|██████████| 6/6 [00:00<00:00, 41.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.64it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 90%|█████████ | 45/50 [00:08<00:00,  5.44it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.6074e-04, PNorm = 36.1661, GNorm = 0.2998, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.86it/s][A100%|██████████| 6/6 [00:00<00:00, 39.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 92%|█████████▏| 46/50 [00:09<00:00,  5.56it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.15it/s][A100%|██████████| 6/6 [00:00<00:00, 39.81it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 94%|█████████▍| 47/50 [00:09<00:00,  5.66it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1580e-04, PNorm = 36.1777, GNorm = 0.1385, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.55it/s][A100%|██████████| 6/6 [00:00<00:00, 39.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 96%|█████████▌| 48/50 [00:09<00:00,  5.73it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  6.40it/s][A
 83%|████████▎ | 5/6 [00:00<00:00,  8.54it/s][A100%|██████████| 6/6 [00:00<00:00, 21.86it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
 98%|█████████▊| 49/50 [00:09<00:00,  4.76it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0180e-04, PNorm = 36.1889, GNorm = 0.1580, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.91it/s][A100%|██████████| 6/6 [00:00<00:00, 40.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.37it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.694444
100%|██████████| 50/50 [00:09<00:00,  5.07it/s]100%|██████████| 50/50 [00:09<00:00,  5.10it/s]
Model 0 best validation auc = 0.694444 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 62.49it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.426667
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.426667
Fold 6
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_6',
 'save_smiles_splits': False,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 103143.55it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 108691.92it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 95%|█████████▍| 325/343 [00:00<00:00, 3242.14it/s]100%|██████████| 343/343 [00:00<00:00, 3225.09it/s]
Number of tasks = 8
Splitting data with seed 6
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 29.75it/s][A100%|██████████| 6/6 [00:00<00:00, 32.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.38it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.493056
  2%|▏         | 1/50 [00:00<00:12,  3.85it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.23it/s][ALoss = 1.1104e-02, PNorm = 35.2646, GNorm = 1.2716, lr_0 = 9.8099e-04
Loss = 2.7767e-02, PNorm = 35.2693, GNorm = 1.8456, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 40.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.79it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.451389
  4%|▍         | 2/50 [00:00<00:11,  4.32it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.62it/s][A100%|██████████| 6/6 [00:00<00:00, 40.40it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.56it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.479167
  6%|▌         | 3/50 [00:00<00:09,  4.71it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.6906e-03, PNorm = 35.3195, GNorm = 0.7016, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.57it/s][A100%|██████████| 6/6 [00:00<00:00, 39.50it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.513889
  8%|▊         | 4/50 [00:00<00:09,  4.71it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.03it/s][A100%|██████████| 6/6 [00:00<00:00, 39.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.506944
 10%|█         | 5/50 [00:00<00:09,  4.99it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.3444e-03, PNorm = 35.3829, GNorm = 0.6968, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.87it/s][A100%|██████████| 6/6 [00:00<00:00, 39.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.506944
 12%|█▏        | 6/50 [00:01<00:08,  5.22it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.44it/s][A100%|██████████| 6/6 [00:00<00:00, 40.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.92it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.486111
 14%|█▍        | 7/50 [00:01<00:07,  5.43it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.5578e-03, PNorm = 35.4505, GNorm = 0.7141, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.03it/s][A100%|██████████| 6/6 [00:00<00:00, 40.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.29it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.486111
 16%|█▌        | 8/50 [00:01<00:07,  5.57it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.10it/s][A100%|██████████| 6/6 [00:00<00:00, 40.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.95it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.486111
 18%|█▊        | 9/50 [00:01<00:07,  5.68it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.1655e-03, PNorm = 35.5173, GNorm = 0.3768, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.37it/s][A100%|██████████| 6/6 [00:00<00:00, 39.57it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 103.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.451389
 20%|██        | 10/50 [00:01<00:06,  5.74it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.21it/s][ALoss = 3.1145e-03, PNorm = 35.5881, GNorm = 0.6118, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 38.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.451389
 22%|██▏       | 11/50 [00:01<00:06,  5.71it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.68it/s][A100%|██████████| 6/6 [00:00<00:00, 39.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.47it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.451389
 24%|██▍       | 12/50 [00:02<00:06,  5.76it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.39it/s][ALoss = 2.4239e-03, PNorm = 35.6553, GNorm = 0.6369, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 39.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.96it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.451389
 26%|██▌       | 13/50 [00:02<00:06,  5.79it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 16.91it/s][A100%|██████████| 6/6 [00:00<00:00, 23.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 28%|██▊       | 14/50 [00:02<00:07,  4.95it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.1098e-03, PNorm = 35.7164, GNorm = 0.3076, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.38it/s][A100%|██████████| 6/6 [00:00<00:00, 38.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 30%|███       | 15/50 [00:02<00:06,  5.15it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.45it/s][A100%|██████████| 6/6 [00:00<00:00, 38.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 32%|███▏      | 16/50 [00:02<00:06,  5.32it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7541e-03, PNorm = 35.7768, GNorm = 0.2650, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.48it/s][A100%|██████████| 6/6 [00:00<00:00, 38.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 34%|███▍      | 17/50 [00:03<00:06,  5.43it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.67it/s][A100%|██████████| 6/6 [00:00<00:00, 38.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 36%|███▌      | 18/50 [00:03<00:05,  5.52it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3846e-03, PNorm = 35.8286, GNorm = 0.2765, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.24it/s][A100%|██████████| 6/6 [00:00<00:00, 38.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 38%|███▊      | 19/50 [00:03<00:05,  5.56it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.24it/s][A100%|██████████| 6/6 [00:00<00:00, 38.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 40%|████      | 20/50 [00:03<00:05,  5.59it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3331e-03, PNorm = 35.8738, GNorm = 0.3412, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.83it/s][A100%|██████████| 6/6 [00:00<00:00, 38.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.70it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 42%|████▏     | 21/50 [00:03<00:05,  5.62it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.25it/s][ALoss = 1.3139e-03, PNorm = 35.9101, GNorm = 0.2844, lr_0 = 3.1022e-04
Loss = 2.6165e-03, PNorm = 35.9142, GNorm = 0.4363, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 39.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 44%|████▍     | 22/50 [00:04<00:04,  5.67it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.21it/s][A100%|██████████| 6/6 [00:00<00:00, 41.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 103.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 46%|████▌     | 23/50 [00:04<00:04,  5.80it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0499e-03, PNorm = 35.9476, GNorm = 0.2007, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.67it/s][A100%|██████████| 6/6 [00:00<00:00, 39.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.32it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 48%|████▊     | 24/50 [00:04<00:04,  5.79it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.62it/s][A100%|██████████| 6/6 [00:00<00:00, 38.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.09it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 50%|█████     | 25/50 [00:04<00:04,  5.79it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0828e-03, PNorm = 35.9828, GNorm = 0.2533, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.12it/s][A100%|██████████| 6/6 [00:00<00:00, 38.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.18it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 52%|█████▏    | 26/50 [00:04<00:04,  5.75it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.85it/s][A100%|██████████| 6/6 [00:00<00:00, 38.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 54%|█████▍    | 27/50 [00:04<00:04,  5.75it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0705e-03, PNorm = 36.0170, GNorm = 0.2737, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.04it/s][A100%|██████████| 6/6 [00:00<00:00, 39.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.91it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 56%|█████▌    | 28/50 [00:05<00:03,  5.77it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.05it/s][A100%|██████████| 6/6 [00:00<00:00, 40.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.60it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 58%|█████▊    | 29/50 [00:05<00:03,  5.83it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.0873e-04, PNorm = 36.0433, GNorm = 0.2076, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.60it/s][A100%|██████████| 6/6 [00:00<00:00, 38.98it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 60%|██████    | 30/50 [00:05<00:03,  5.81it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.81it/s][A100%|██████████| 6/6 [00:00<00:00, 39.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 62%|██████▏   | 31/50 [00:05<00:03,  5.83it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7413e-04, PNorm = 36.0663, GNorm = 0.2073, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.57it/s][A100%|██████████| 6/6 [00:00<00:00, 37.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.86it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 64%|██████▍   | 32/50 [00:05<00:03,  5.75it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.31it/s][ALoss = 8.3234e-04, PNorm = 36.0855, GNorm = 0.2511, lr_0 = 1.6469e-04
Loss = 1.9472e-03, PNorm = 36.0872, GNorm = 0.4336, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 36.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.22it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 66%|██████▌   | 33/50 [00:05<00:03,  5.66it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.56it/s][A100%|██████████| 6/6 [00:00<00:00, 38.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 68%|██████▊   | 34/50 [00:06<00:02,  5.66it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.9974e-04, PNorm = 36.1036, GNorm = 0.1425, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.22it/s][A100%|██████████| 6/6 [00:00<00:00, 36.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 70%|███████   | 35/50 [00:06<00:02,  5.57it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.34it/s][A100%|██████████| 6/6 [00:00<00:00, 38.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.75it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 72%|███████▏  | 36/50 [00:06<00:02,  5.60it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2382e-04, PNorm = 36.1209, GNorm = 0.1722, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 21.00it/s][A100%|██████████| 6/6 [00:00<00:00, 25.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 74%|███████▍  | 37/50 [00:06<00:02,  4.97it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.91it/s][A100%|██████████| 6/6 [00:00<00:00, 39.44it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 76%|███████▌  | 38/50 [00:06<00:02,  5.20it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.3287e-04, PNorm = 36.1368, GNorm = 0.1918, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.82it/s][A100%|██████████| 6/6 [00:00<00:00, 39.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 78%|███████▊  | 39/50 [00:07<00:02,  5.38it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.69it/s][A100%|██████████| 6/6 [00:00<00:00, 40.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.55it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 80%|████████  | 40/50 [00:07<00:01,  5.53it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.4891e-04, PNorm = 36.1503, GNorm = 0.1543, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.62it/s][A100%|██████████| 6/6 [00:00<00:00, 39.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 82%|████████▏ | 41/50 [00:07<00:01,  5.62it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.22it/s][ALoss = 7.5845e-04, PNorm = 36.1625, GNorm = 0.1726, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 37.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.84it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 84%|████████▍ | 42/50 [00:07<00:01,  5.61it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.80it/s][A100%|██████████| 6/6 [00:00<00:00, 38.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 86%|████████▌ | 43/50 [00:07<00:01,  5.64it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.34it/s][ALoss = 6.9101e-04, PNorm = 36.1741, GNorm = 0.1730, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 37.51it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.68it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 88%|████████▊ | 44/50 [00:07<00:01,  5.61it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.28it/s][A100%|██████████| 6/6 [00:00<00:00, 38.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 90%|█████████ | 45/50 [00:08<00:00,  5.63it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.6877e-04, PNorm = 36.1862, GNorm = 0.1599, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.14it/s][A100%|██████████| 6/6 [00:00<00:00, 38.11it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 92%|█████████▏| 46/50 [00:08<00:00,  5.63it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.61it/s][A100%|██████████| 6/6 [00:00<00:00, 38.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.93it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 94%|█████████▍| 47/50 [00:08<00:00,  5.67it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.5639e-04, PNorm = 36.1978, GNorm = 0.3028, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.98it/s][A100%|██████████| 6/6 [00:00<00:00, 37.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 96%|█████████▌| 48/50 [00:08<00:00,  5.66it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.09it/s][A100%|██████████| 6/6 [00:00<00:00, 38.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.70it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
 98%|█████████▊| 49/50 [00:08<00:00,  5.69it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.5002e-04, PNorm = 36.2094, GNorm = 0.1695, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.98it/s][A100%|██████████| 6/6 [00:00<00:00, 38.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.04it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.430556
100%|██████████| 50/50 [00:08<00:00,  5.71it/s]100%|██████████| 50/50 [00:08<00:00,  5.57it/s]
Model 0 best validation auc = 0.513889 on epoch 3
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 46.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.277778
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.277778
Fold 7
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_7',
 'save_smiles_splits': False,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 125361.30it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 134014.56it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 4044.58it/s]
Number of tasks = 8
Splitting data with seed 7
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.77it/s][A100%|██████████| 6/6 [00:00<00:00, 39.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.94it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.418750
  2%|▏         | 1/50 [00:00<00:10,  4.75it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.31it/s][ALoss = 1.1972e-02, PNorm = 35.2656, GNorm = 1.3427, lr_0 = 9.8099e-04
Loss = 1.8897e-02, PNorm = 35.2710, GNorm = 1.4693, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 39.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.325000
  4%|▍         | 2/50 [00:00<00:09,  5.05it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.76it/s][A100%|██████████| 6/6 [00:00<00:00, 40.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.325000
  6%|▌         | 3/50 [00:00<00:08,  5.31it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.8860e-03, PNorm = 35.3243, GNorm = 0.6466, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.64it/s][A100%|██████████| 6/6 [00:00<00:00, 37.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.57it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.387500
  8%|▊         | 4/50 [00:00<00:08,  5.39it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.74it/s][A100%|██████████| 6/6 [00:00<00:00, 37.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.470833
 10%|█         | 5/50 [00:00<00:08,  5.10it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.7267e-03, PNorm = 35.3926, GNorm = 0.6689, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.29it/s][A100%|██████████| 6/6 [00:00<00:00, 39.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.20it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.439583
 12%|█▏        | 6/50 [00:01<00:08,  5.30it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.64it/s][A100%|██████████| 6/6 [00:00<00:00, 38.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.41it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.460417
 14%|█▍        | 7/50 [00:01<00:07,  5.43it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.0768e-03, PNorm = 35.4618, GNorm = 0.5451, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.85it/s][A100%|██████████| 6/6 [00:00<00:00, 39.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.460417
 16%|█▌        | 8/50 [00:01<00:07,  5.55it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.04it/s][A100%|██████████| 6/6 [00:00<00:00, 39.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 80.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.460417
 18%|█▊        | 9/50 [00:01<00:07,  5.63it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.2634e-03, PNorm = 35.5287, GNorm = 0.4166, lr_0 = 6.4318e-04

 83%|████████▎ | 5/6 [00:00<00:00, 40.62it/s][A100%|██████████| 6/6 [00:00<00:00, 43.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.397917
 20%|██        | 10/50 [00:01<00:06,  5.84it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.78it/s][ALoss = 3.5821e-03, PNorm = 35.5979, GNorm = 0.4885, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 39.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.73it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.397917
 22%|██▏       | 11/50 [00:01<00:06,  5.86it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.70it/s][A100%|██████████| 6/6 [00:00<00:00, 40.00it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.68it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.397917
 24%|██▍       | 12/50 [00:02<00:06,  5.89it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.39it/s][ALoss = 2.6586e-03, PNorm = 35.6696, GNorm = 0.4386, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 39.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.397917
 26%|██▌       | 13/50 [00:02<00:06,  5.89it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.44it/s][A100%|██████████| 6/6 [00:00<00:00, 36.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.397917
 28%|██▊       | 14/50 [00:02<00:06,  5.75it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.3629e-03, PNorm = 35.7380, GNorm = 0.5296, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.99it/s][A100%|██████████| 6/6 [00:00<00:00, 38.77it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.397917
 30%|███       | 15/50 [00:02<00:06,  5.76it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.45it/s][A100%|██████████| 6/6 [00:00<00:00, 37.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.82it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.481250
 32%|███▏      | 16/50 [00:02<00:06,  5.35it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9732e-03, PNorm = 35.8022, GNorm = 0.4698, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.39it/s][A100%|██████████| 6/6 [00:00<00:00, 38.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.59it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.481250
 34%|███▍      | 17/50 [00:03<00:06,  5.47it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.98it/s][A100%|██████████| 6/6 [00:00<00:00, 39.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.84it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 36%|███▌      | 18/50 [00:03<00:06,  5.23it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5856e-03, PNorm = 35.8614, GNorm = 0.2582, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.76it/s][A100%|██████████| 6/6 [00:00<00:00, 38.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.89it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.481250
 38%|███▊      | 19/50 [00:03<00:05,  5.36it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 18.99it/s][A100%|██████████| 6/6 [00:00<00:00, 26.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.88it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 40%|████      | 20/50 [00:03<00:06,  4.90it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4447e-03, PNorm = 35.9121, GNorm = 0.3217, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.81it/s][A100%|██████████| 6/6 [00:00<00:00, 39.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.02it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 42%|████▏     | 21/50 [00:03<00:05,  5.16it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.22it/s][ALoss = 1.4289e-03, PNorm = 35.9561, GNorm = 0.3089, lr_0 = 3.1022e-04
Loss = 3.1737e-03, PNorm = 35.9594, GNorm = 0.6084, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 38.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 99.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 44%|████▍     | 22/50 [00:04<00:05,  5.32it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.43it/s][A100%|██████████| 6/6 [00:00<00:00, 41.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 46%|████▌     | 23/50 [00:04<00:04,  5.57it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3530e-03, PNorm = 35.9971, GNorm = 0.3326, lr_0 = 2.7915e-04

 67%|██████▋   | 4/6 [00:00<00:00, 39.63it/s][A100%|██████████| 6/6 [00:00<00:00, 42.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 48%|████▊     | 24/50 [00:04<00:04,  5.79it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 40.63it/s][A100%|██████████| 6/6 [00:00<00:00, 43.59it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.27it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.543750
 50%|█████     | 25/50 [00:04<00:04,  5.99it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.2079e-03, PNorm = 36.0352, GNorm = 0.3120, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.01it/s][A100%|██████████| 6/6 [00:00<00:00, 39.55it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.25it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.606250
 52%|█████▏    | 26/50 [00:04<00:04,  5.53it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.10it/s][A100%|██████████| 6/6 [00:00<00:00, 39.19it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.606250
 54%|█████▍    | 27/50 [00:04<00:04,  5.62it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1289e-03, PNorm = 36.0688, GNorm = 0.2425, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.96it/s][A100%|██████████| 6/6 [00:00<00:00, 39.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.606250
 56%|█████▌    | 28/50 [00:05<00:03,  5.68it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.42it/s][A100%|██████████| 6/6 [00:00<00:00, 39.37it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 58%|█████▊    | 29/50 [00:05<00:03,  5.34it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.4410e-04, PNorm = 36.0986, GNorm = 0.1978, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.38it/s][A100%|██████████| 6/6 [00:00<00:00, 38.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.79it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 60%|██████    | 30/50 [00:05<00:03,  5.47it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.72it/s][A100%|██████████| 6/6 [00:00<00:00, 36.85it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.06it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 62%|██████▏   | 31/50 [00:05<00:03,  5.49it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.6580e-04, PNorm = 36.1241, GNorm = 0.1595, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.16it/s][A100%|██████████| 6/6 [00:00<00:00, 37.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.32it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 64%|██████▍   | 32/50 [00:05<00:03,  5.50it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.09it/s][ALoss = 9.2267e-04, PNorm = 36.1447, GNorm = 0.2108, lr_0 = 1.6469e-04
Loss = 1.9586e-03, PNorm = 36.1465, GNorm = 0.4938, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 38.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 66%|██████▌   | 33/50 [00:05<00:03,  5.57it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.57it/s][A100%|██████████| 6/6 [00:00<00:00, 39.60it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 68%|██████▊   | 34/50 [00:06<00:02,  5.66it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.5161e-04, PNorm = 36.1640, GNorm = 0.2103, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.64it/s][A100%|██████████| 6/6 [00:00<00:00, 39.18it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.82it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 70%|███████   | 35/50 [00:06<00:02,  5.72it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.59it/s][A100%|██████████| 6/6 [00:00<00:00, 39.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 72%|███████▏  | 36/50 [00:06<00:02,  5.78it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7284e-04, PNorm = 36.1818, GNorm = 0.2239, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.62it/s][A100%|██████████| 6/6 [00:00<00:00, 38.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.78it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 74%|███████▍  | 37/50 [00:06<00:02,  5.79it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|█▋        | 1/6 [00:00<00:00,  8.96it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 11.57it/s][A100%|██████████| 6/6 [00:00<00:00, 25.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 76%|███████▌  | 38/50 [00:06<00:02,  5.06it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.5022e-04, PNorm = 36.1969, GNorm = 0.2272, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.71it/s][A100%|██████████| 6/6 [00:00<00:00, 38.07it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.44it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 78%|███████▊  | 39/50 [00:07<00:02,  5.23it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.57it/s][A100%|██████████| 6/6 [00:00<00:00, 36.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 76.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 80%|████████  | 40/50 [00:07<00:01,  5.29it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2059e-04, PNorm = 36.2114, GNorm = 0.1836, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.83it/s][A100%|██████████| 6/6 [00:00<00:00, 38.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.83it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 82%|████████▏ | 41/50 [00:07<00:01,  5.41it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.11it/s][ALoss = 8.0076e-04, PNorm = 36.2234, GNorm = 0.1373, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 38.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 84%|████████▍ | 42/50 [00:07<00:01,  5.51it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.61it/s][A100%|██████████| 6/6 [00:00<00:00, 39.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 86%|████████▌ | 43/50 [00:07<00:01,  5.61it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.61it/s][ALoss = 7.4624e-04, PNorm = 36.2356, GNorm = 0.2274, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 39.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.51it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 88%|████████▊ | 44/50 [00:07<00:01,  5.66it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.51it/s][A100%|██████████| 6/6 [00:00<00:00, 39.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 90%|█████████ | 45/50 [00:08<00:00,  5.72it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0956e-04, PNorm = 36.2470, GNorm = 0.1888, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.17it/s][A100%|██████████| 6/6 [00:00<00:00, 39.25it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 92%|█████████▏| 46/50 [00:08<00:00,  5.76it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.26it/s][A100%|██████████| 6/6 [00:00<00:00, 39.46it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.26it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 94%|█████████▍| 47/50 [00:08<00:00,  5.80it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0624e-04, PNorm = 36.2589, GNorm = 0.1543, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.81it/s][A100%|██████████| 6/6 [00:00<00:00, 39.72it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.52it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 96%|█████████▌| 48/50 [00:08<00:00,  5.83it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.09it/s][A100%|██████████| 6/6 [00:00<00:00, 39.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
 98%|█████████▊| 49/50 [00:08<00:00,  5.84it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1295e-04, PNorm = 36.2697, GNorm = 0.1418, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.26it/s][A100%|██████████| 6/6 [00:00<00:00, 38.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.637500
100%|██████████| 50/50 [00:08<00:00,  5.77it/s]100%|██████████| 50/50 [00:08<00:00,  5.56it/s]
Model 0 best validation auc = 0.637500 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 41.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.648148
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.648148
Fold 8
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_8',
 'save_smiles_splits': False,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 118827.64it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 123637.53it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 3911.65it/s]
Number of tasks = 8
Splitting data with seed 8
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 34.41it/s][A100%|██████████| 6/6 [00:00<00:00, 37.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.49it/s]
Validation auc = 0.437500
  2%|▏         | 1/50 [00:00<00:10,  4.50it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.30it/s][ALoss = 1.0285e-02, PNorm = 35.2713, GNorm = 1.0993, lr_0 = 9.8099e-04
Loss = 3.2486e-02, PNorm = 35.2762, GNorm = 2.1774, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 38.54it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.06it/s]
Validation auc = 0.473958
  4%|▍         | 2/50 [00:00<00:10,  4.53it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.95it/s][A100%|██████████| 6/6 [00:00<00:00, 40.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.15it/s]
Validation auc = 0.505208
  6%|▌         | 3/50 [00:00<00:10,  4.61it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1015e-03, PNorm = 35.3233, GNorm = 0.7099, lr_0 = 8.8274e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.83it/s][A100%|██████████| 6/6 [00:00<00:00, 39.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.37it/s]
Validation auc = 0.536458
  8%|▊         | 4/50 [00:00<00:09,  4.65it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.01it/s][A100%|██████████| 6/6 [00:00<00:00, 40.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.98it/s]
Validation auc = 0.442708
 10%|█         | 5/50 [00:01<00:09,  4.97it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 4.6305e-03, PNorm = 35.3894, GNorm = 0.5039, lr_0 = 7.9433e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.15it/s][A100%|██████████| 6/6 [00:00<00:00, 35.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.63it/s]
Validation auc = 0.473958
 12%|█▏        | 6/50 [00:01<00:08,  5.07it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.15it/s][A100%|██████████| 6/6 [00:00<00:00, 39.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.39it/s]
Validation auc = 0.494792
 14%|█▍        | 7/50 [00:01<00:08,  5.26it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.8115e-03, PNorm = 35.4557, GNorm = 0.5498, lr_0 = 7.1477e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.42it/s][A100%|██████████| 6/6 [00:00<00:00, 40.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 98.46it/s]
Validation auc = 0.494792
 16%|█▌        | 8/50 [00:01<00:07,  5.46it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.92it/s][A100%|██████████| 6/6 [00:00<00:00, 40.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.92it/s]
Validation auc = 0.494792
 18%|█▊        | 9/50 [00:01<00:07,  5.58it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.3772e-03, PNorm = 35.5106, GNorm = 0.3262, lr_0 = 6.4318e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.34it/s][A100%|██████████| 6/6 [00:00<00:00, 39.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 10.17it/s]
Validation auc = 0.463542
 20%|██        | 10/50 [00:01<00:08,  4.92it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.06it/s][ALoss = 3.0179e-03, PNorm = 35.5714, GNorm = 0.5819, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 38.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.19it/s]
Validation auc = 0.432292
 22%|██▏       | 11/50 [00:02<00:07,  5.13it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.70it/s][A100%|██████████| 6/6 [00:00<00:00, 39.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.45it/s]
Validation auc = 0.432292
 24%|██▍       | 12/50 [00:02<00:07,  5.31it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.53it/s][ALoss = 2.3485e-03, PNorm = 35.6281, GNorm = 0.4094, lr_0 = 5.2079e-04
100%|██████████| 6/6 [00:00<00:00, 39.31it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.71it/s]
Validation auc = 0.432292
 26%|██▌       | 13/50 [00:02<00:06,  5.44it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.57it/s][A100%|██████████| 6/6 [00:00<00:00, 38.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.48it/s]
Validation auc = 0.406250
 28%|██▊       | 14/50 [00:02<00:06,  5.46it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.9196e-03, PNorm = 35.6862, GNorm = 0.2386, lr_0 = 4.6863e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.35it/s][A100%|██████████| 6/6 [00:00<00:00, 36.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 83.78it/s]
Validation auc = 0.468750
 30%|███       | 15/50 [00:02<00:06,  5.41it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.78it/s][A100%|██████████| 6/6 [00:00<00:00, 39.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.34it/s]
Validation auc = 0.468750
 32%|███▏      | 16/50 [00:03<00:06,  5.53it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7852e-03, PNorm = 35.7392, GNorm = 0.4141, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.43it/s][A100%|██████████| 6/6 [00:00<00:00, 39.73it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.50it/s]
Validation auc = 0.458333
 34%|███▍      | 17/50 [00:03<00:05,  5.62it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.51it/s][A100%|██████████| 6/6 [00:00<00:00, 39.48it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.42it/s]
Validation auc = 0.468750
 36%|███▌      | 18/50 [00:03<00:05,  5.67it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.4257e-03, PNorm = 35.7890, GNorm = 0.3096, lr_0 = 3.7946e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.28it/s][A100%|██████████| 6/6 [00:00<00:00, 39.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.59it/s]
Validation auc = 0.468750
 38%|███▊      | 19/50 [00:03<00:05,  5.69it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.30it/s][A100%|██████████| 6/6 [00:00<00:00, 40.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.33it/s]
Validation auc = 0.458333
 40%|████      | 20/50 [00:03<00:05,  5.74it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.5830e-03, PNorm = 35.8327, GNorm = 0.3239, lr_0 = 3.4145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.38it/s][A100%|██████████| 6/6 [00:00<00:00, 38.84it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.28it/s]
Validation auc = 0.458333
 42%|████▏     | 21/50 [00:03<00:05,  5.74it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.75it/s][ALoss = 1.2835e-03, PNorm = 35.8676, GNorm = 0.2751, lr_0 = 3.1022e-04
Loss = 4.2505e-03, PNorm = 35.8716, GNorm = 0.6794, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 39.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.23it/s]
Validation auc = 0.458333
 44%|████▍     | 22/50 [00:04<00:04,  5.73it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.21it/s][A100%|██████████| 6/6 [00:00<00:00, 38.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.70it/s]
Validation auc = 0.458333
 46%|████▌     | 23/50 [00:04<00:04,  5.67it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 19.22it/s][ALoss = 1.1737e-03, PNorm = 35.9072, GNorm = 0.2268, lr_0 = 2.7915e-04
100%|██████████| 6/6 [00:00<00:00, 25.94it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.71it/s]
Validation auc = 0.458333
 48%|████▊     | 24/50 [00:04<00:05,  5.02it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.32it/s][A100%|██████████| 6/6 [00:00<00:00, 38.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.16it/s]
Validation auc = 0.458333
 50%|█████     | 25/50 [00:04<00:04,  5.21it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0864e-03, PNorm = 35.9410, GNorm = 0.2257, lr_0 = 2.5119e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.69it/s][A100%|██████████| 6/6 [00:00<00:00, 38.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.52it/s]
Validation auc = 0.458333
 52%|█████▏    | 26/50 [00:04<00:04,  5.35it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.32it/s][A100%|██████████| 6/6 [00:00<00:00, 39.24it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.85it/s]
Validation auc = 0.489583
 54%|█████▍    | 27/50 [00:05<00:04,  5.46it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0177e-03, PNorm = 35.9714, GNorm = 0.2173, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.12it/s][A100%|██████████| 6/6 [00:00<00:00, 39.15it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.15it/s]
Validation auc = 0.489583
 56%|█████▌    | 28/50 [00:05<00:03,  5.54it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.69it/s][A100%|██████████| 6/6 [00:00<00:00, 38.90it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.76it/s]
Validation auc = 0.489583
 58%|█████▊    | 29/50 [00:05<00:03,  5.59it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.1341e-04, PNorm = 35.9988, GNorm = 0.2615, lr_0 = 2.0145e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.06it/s][A100%|██████████| 6/6 [00:00<00:00, 39.30it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 100.13it/s]
Validation auc = 0.489583
 60%|██████    | 30/50 [00:05<00:03,  5.65it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 33.08it/s][A100%|██████████| 6/6 [00:00<00:00, 36.05it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.53it/s]
Validation auc = 0.489583
 62%|██████▏   | 31/50 [00:05<00:03,  5.53it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 9.2335e-04, PNorm = 36.0220, GNorm = 0.1995, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.62it/s][A100%|██████████| 6/6 [00:00<00:00, 40.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.39it/s]
Validation auc = 0.489583
 64%|██████▍   | 32/50 [00:05<00:03,  5.65it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.49it/s][ALoss = 8.6611e-04, PNorm = 36.0418, GNorm = 0.1908, lr_0 = 1.6469e-04
Loss = 2.1195e-03, PNorm = 36.0435, GNorm = 0.2823, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 38.66it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 94.68it/s]
Validation auc = 0.489583
 66%|██████▌   | 33/50 [00:06<00:03,  5.67it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.88it/s][A100%|██████████| 6/6 [00:00<00:00, 38.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.29it/s]
Validation auc = 0.489583
 68%|██████▊   | 34/50 [00:06<00:02,  5.69it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.6306e-04, PNorm = 36.0624, GNorm = 0.2567, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.00it/s][A100%|██████████| 6/6 [00:00<00:00, 38.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.88it/s]
Validation auc = 0.520833
 70%|███████   | 35/50 [00:06<00:02,  5.70it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.09it/s][A100%|██████████| 6/6 [00:00<00:00, 41.03it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.06it/s]
Validation auc = 0.520833
 72%|███████▏  | 36/50 [00:06<00:02,  5.79it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.1906e-04, PNorm = 36.0787, GNorm = 0.1696, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.06it/s][A100%|██████████| 6/6 [00:00<00:00, 39.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.61it/s]
Validation auc = 0.520833
 74%|███████▍  | 37/50 [00:06<00:02,  5.78it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.94it/s][A100%|██████████| 6/6 [00:00<00:00, 40.12it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.03it/s]
Validation auc = 0.520833
 76%|███████▌  | 38/50 [00:06<00:02,  5.81it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.8767e-04, PNorm = 36.0944, GNorm = 0.1276, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.83it/s][A100%|██████████| 6/6 [00:00<00:00, 39.79it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.90it/s]
Validation auc = 0.520833
 78%|███████▊  | 39/50 [00:07<00:01,  5.81it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.69it/s][A100%|██████████| 6/6 [00:00<00:00, 36.13it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.52it/s]
Validation auc = 0.520833
 80%|████████  | 40/50 [00:07<00:01,  5.65it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7958e-04, PNorm = 36.1078, GNorm = 0.2467, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.92it/s][A100%|██████████| 6/6 [00:00<00:00, 37.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.70it/s]
Validation auc = 0.520833
 82%|████████▏ | 41/50 [00:07<00:01,  5.62it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.06it/s][ALoss = 7.9328e-04, PNorm = 36.1200, GNorm = 0.3029, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 39.45it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.81it/s]
Validation auc = 0.520833
 84%|████████▍ | 42/50 [00:07<00:01,  5.65it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.34it/s][A100%|██████████| 6/6 [00:00<00:00, 39.38it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.19it/s]
Validation auc = 0.520833
 86%|████████▌ | 43/50 [00:07<00:01,  5.69it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 33%|███▎      | 2/6 [00:00<00:00, 15.58it/s][ALoss = 7.0759e-04, PNorm = 36.1312, GNorm = 0.1782, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 26.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.65it/s]
Validation auc = 0.520833
 88%|████████▊ | 44/50 [00:08<00:01,  5.09it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.23it/s][A100%|██████████| 6/6 [00:00<00:00, 39.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.58it/s]
Validation auc = 0.520833
 90%|█████████ | 45/50 [00:08<00:00,  5.29it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.3637e-04, PNorm = 36.1435, GNorm = 0.1713, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.96it/s][A100%|██████████| 6/6 [00:00<00:00, 38.92it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.29it/s]
Validation auc = 0.520833
 92%|█████████▏| 46/50 [00:08<00:00,  5.41it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.80it/s][A100%|██████████| 6/6 [00:00<00:00, 37.09it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.55it/s]
Validation auc = 0.520833
 94%|█████████▍| 47/50 [00:08<00:00,  5.42it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1799e-04, PNorm = 36.1553, GNorm = 0.1852, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.26it/s][A100%|██████████| 6/6 [00:00<00:00, 38.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 88.48it/s]
Validation auc = 0.520833
 96%|█████████▌| 48/50 [00:08<00:00,  5.50it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.02it/s][A100%|██████████| 6/6 [00:00<00:00, 39.69it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.17it/s]
Validation auc = 0.520833
 98%|█████████▊| 49/50 [00:08<00:00,  5.58it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.3630e-04, PNorm = 36.1670, GNorm = 0.1578, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.70it/s][A100%|██████████| 6/6 [00:00<00:00, 38.99it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 95.77it/s]
Validation auc = 0.520833
100%|██████████| 50/50 [00:09<00:00,  5.63it/s]100%|██████████| 50/50 [00:09<00:00,  5.47it/s]
Model 0 best validation auc = 0.536458 on epoch 3
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 74.70it/s]
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.502381
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.502381
Fold 9
Command line
python chemprop/train.py --data_path filtered_chembl/chembl_less_64_instances.csv --dataset_type classification --features_path fingerprint_features/rdkit_features/rdkit_features.npz --num_folds 10 --epochs 50
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'data_path': 'filtered_chembl/chembl_less_64_instances.csv',
 'dataset_type': 'classification',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['fingerprint_features/rdkit_features/rdkit_features.npz'],
 'features_size': 200,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'minimize_score': False,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 8,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': '/tmp/2239259.2.gpu.q/tmph_fg6dyv/fold_9',
 'save_smiles_splits': False,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['CHEMBL1024480',
                'CHEMBL1243971',
                'CHEMBL1614070',
                'CHEMBL1614338',
                'CHEMBL1614405',
                'CHEMBL1820680',
                'CHEMBL2303649',
                'CHEMBL806152'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 274,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
0it [00:00, ?it/s]343it [00:00, 101106.63it/s]
  0%|          | 0/343 [00:00<?, ?it/s]100%|██████████| 343/343 [00:00<00:00, 105728.40it/s]
  0%|          | 0/343 [00:00<?, ?it/s] 94%|█████████▎| 321/343 [00:00<00:00, 3208.59it/s]100%|██████████| 343/343 [00:00<00:00, 3188.74it/s]
Number of tasks = 8
Splitting data with seed 9
Class sizes
CHEMBL1024480 0: 89.58%, 1: 10.42%
CHEMBL1243971 0: 48.89%, 1: 51.11%
CHEMBL1614070 0: 18.75%, 1: 81.25%
CHEMBL1614338 0: 15.00%, 1: 85.00%
CHEMBL1614405 0: 50.94%, 1: 49.06%
CHEMBL1820680 0: 46.81%, 1: 53.19%
CHEMBL2303649 0: 68.09%, 1: 31.91%
CHEMBL806152 0: 48.08%, 1: 51.92%
Total size = 343 | train size = 274 | val size = 34 | test size = 35
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=8, bias=True)
  )
)
Number of parameters = 417,008
Moving model to cuda
  0%|          | 0/50 [00:00<?, ?it/s]Epoch 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.82it/s][A100%|██████████| 6/6 [00:00<00:00, 38.22it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 63.15it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.350000
  2%|▏         | 1/50 [00:00<00:11,  4.30it/s]Epoch 1

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.42it/s][ALoss = 1.1449e-02, PNorm = 35.2678, GNorm = 1.6872, lr_0 = 9.8099e-04
Loss = 1.9237e-02, PNorm = 35.2724, GNorm = 2.1842, lr_0 = 9.7163e-04
100%|██████████| 6/6 [00:00<00:00, 41.10it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.35it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
  4%|▍         | 2/50 [00:00<00:10,  4.71it/s]Epoch 2

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 45.26it/s][A100%|██████████| 6/6 [00:00<00:00, 48.83it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 99.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
  6%|▌         | 3/50 [00:00<00:08,  5.24it/s]Epoch 3

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.2858e-03, PNorm = 35.3194, GNorm = 0.6177, lr_0 = 8.8274e-04

 83%|████████▎ | 5/6 [00:00<00:00, 44.97it/s][A100%|██████████| 6/6 [00:00<00:00, 48.43it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 100.12it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.233333
  8%|▊         | 4/50 [00:00<00:08,  5.68it/s]Epoch 4

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 46.58it/s][A100%|██████████| 6/6 [00:00<00:00, 50.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 100.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 10%|█         | 5/50 [00:00<00:07,  6.10it/s]Epoch 5

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.5941e-03, PNorm = 35.3821, GNorm = 0.5409, lr_0 = 7.9433e-04

 83%|████████▎ | 5/6 [00:00<00:00, 43.73it/s][A100%|██████████| 6/6 [00:00<00:00, 47.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 96.54it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 12%|█▏        | 6/50 [00:00<00:06,  6.33it/s]Epoch 6

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 46.74it/s][A100%|██████████| 6/6 [00:00<00:00, 49.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 97.85it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 14%|█▍        | 7/50 [00:01<00:06,  6.59it/s]Epoch 7

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 3.7883e-03, PNorm = 35.4441, GNorm = 0.4518, lr_0 = 7.1477e-04

 83%|████████▎ | 5/6 [00:00<00:00, 46.23it/s][A100%|██████████| 6/6 [00:00<00:00, 49.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 102.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 16%|█▌        | 8/50 [00:01<00:06,  6.78it/s]Epoch 8

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 46.10it/s][A100%|██████████| 6/6 [00:00<00:00, 49.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 99.33it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 18%|█▊        | 9/50 [00:01<00:05,  6.92it/s]Epoch 9

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 2.8499e-03, PNorm = 35.5000, GNorm = 0.3692, lr_0 = 6.4318e-04

 83%|████████▎ | 5/6 [00:00<00:00, 46.23it/s][A100%|██████████| 6/6 [00:00<00:00, 49.89it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 101.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 20%|██        | 10/50 [00:01<00:05,  7.03it/s]Epoch 10

  0%|          | 0/6 [00:00<?, ?it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 45.86it/s][ALoss = 3.1797e-03, PNorm = 35.5559, GNorm = 0.6882, lr_0 = 5.7876e-04
100%|██████████| 6/6 [00:00<00:00, 48.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 100.03it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 22%|██▏       | 11/50 [00:01<00:05,  7.02it/s]Epoch 11

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.95it/s][A100%|██████████| 6/6 [00:00<00:00, 27.75it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.79it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 24%|██▍       | 12/50 [00:01<00:06,  5.82it/s]Epoch 12

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.69it/s][ALoss = 2.3429e-03, PNorm = 35.6117, GNorm = 0.3118, lr_0 = 5.2079e-04

100%|██████████| 6/6 [00:00<00:00, 22.02it/s][A100%|██████████| 6/6 [00:00<00:00, 21.33it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 70.39it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.216667
 26%|██▌       | 13/50 [00:02<00:07,  4.73it/s]Epoch 13

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.65it/s][A100%|██████████| 6/6 [00:00<00:00, 33.02it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 75.98it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.283333
 28%|██▊       | 14/50 [00:02<00:07,  4.78it/s]Epoch 14

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.67it/s][ALoss = 1.9545e-03, PNorm = 35.6658, GNorm = 0.3106, lr_0 = 4.6863e-04
100%|██████████| 6/6 [00:00<00:00, 31.76it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.46it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 30%|███       | 15/50 [00:02<00:07,  4.76it/s]Epoch 15

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 30.43it/s][A100%|██████████| 6/6 [00:00<00:00, 32.21it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.01it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 32%|███▏      | 16/50 [00:02<00:07,  4.79it/s]Epoch 16

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7649e-03, PNorm = 35.7173, GNorm = 0.2156, lr_0 = 4.2170e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.55it/s][A100%|██████████| 6/6 [00:00<00:00, 38.64it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.21it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 34%|███▍      | 17/50 [00:02<00:06,  5.05it/s]Epoch 17

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 28.29it/s][A
100%|██████████| 6/6 [00:00<00:00, 28.17it/s][A100%|██████████| 6/6 [00:00<00:00, 28.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 64.13it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 36%|███▌      | 18/50 [00:03<00:06,  4.76it/s]Epoch 18

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.7578e-03, PNorm = 35.7646, GNorm = 0.2661, lr_0 = 3.7946e-04

 50%|█████     | 3/6 [00:00<00:00, 27.68it/s][A100%|██████████| 6/6 [00:00<00:00, 30.20it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 64.40it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.283333
 38%|███▊      | 19/50 [00:03<00:06,  4.67it/s]Epoch 19

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.05it/s][A100%|██████████| 6/6 [00:00<00:00, 31.70it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.61it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 40%|████      | 20/50 [00:03<00:06,  4.68it/s]Epoch 20

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.3209e-03, PNorm = 35.8072, GNorm = 0.2130, lr_0 = 3.4145e-04

 50%|█████     | 3/6 [00:00<00:00, 29.11it/s][A100%|██████████| 6/6 [00:00<00:00, 31.53it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 69.16it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 42%|████▏     | 21/50 [00:03<00:06,  4.68it/s]Epoch 21

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.14it/s][ALoss = 1.2926e-03, PNorm = 35.8429, GNorm = 0.2488, lr_0 = 3.1022e-04
Loss = 3.2119e-03, PNorm = 35.8463, GNorm = 0.4429, lr_0 = 3.0726e-04
100%|██████████| 6/6 [00:00<00:00, 32.49it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.67it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 44%|████▍     | 22/50 [00:04<00:05,  4.73it/s]Epoch 22

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.02it/s][A100%|██████████| 6/6 [00:00<00:00, 33.26it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.97it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 46%|████▌     | 23/50 [00:04<00:05,  4.79it/s]Epoch 23

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.66it/s][ALoss = 1.2238e-03, PNorm = 35.8776, GNorm = 0.2720, lr_0 = 2.7915e-04
100%|██████████| 6/6 [00:00<00:00, 32.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 74.07it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 48%|████▊     | 24/50 [00:04<00:05,  4.80it/s]Epoch 24

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 29.09it/s][A100%|██████████| 6/6 [00:00<00:00, 31.63it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 68.02it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 50%|█████     | 25/50 [00:04<00:05,  4.77it/s]Epoch 25

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.1949e-03, PNorm = 35.9082, GNorm = 0.1898, lr_0 = 2.5119e-04

 50%|█████     | 3/6 [00:00<00:00, 29.10it/s][A100%|██████████| 6/6 [00:00<00:00, 32.35it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.78it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 52%|█████▏    | 26/50 [00:04<00:05,  4.79it/s]Epoch 26

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 32.35it/s][A
 83%|████████▎ | 5/6 [00:00<00:00, 17.60it/s][A100%|██████████| 6/6 [00:00<00:00, 23.28it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 82.48it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.283333
 54%|█████▍    | 27/50 [00:05<00:05,  4.36it/s]Epoch 27

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 1.0381e-03, PNorm = 35.9382, GNorm = 0.2617, lr_0 = 2.2387e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.17it/s][A100%|██████████| 6/6 [00:00<00:00, 36.23it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.43it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 56%|█████▌    | 28/50 [00:05<00:04,  4.63it/s]Epoch 28

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.77it/s][A100%|██████████| 6/6 [00:00<00:00, 38.91it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.38it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 58%|█████▊    | 29/50 [00:05<00:04,  4.88it/s]Epoch 29

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.1472e-04, PNorm = 35.9631, GNorm = 0.2084, lr_0 = 2.0145e-04

 50%|█████     | 3/6 [00:00<00:00, 24.69it/s][A100%|██████████| 6/6 [00:00<00:00, 29.06it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 71.92it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.283333
 60%|██████    | 30/50 [00:05<00:04,  4.71it/s]Epoch 30

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.75it/s][A100%|██████████| 6/6 [00:00<00:00, 33.62it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 72.28it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 62%|██████▏   | 31/50 [00:05<00:03,  4.79it/s]Epoch 31

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0700e-04, PNorm = 35.9855, GNorm = 0.1519, lr_0 = 1.8127e-04

 67%|██████▋   | 4/6 [00:00<00:00, 30.79it/s][A100%|██████████| 6/6 [00:00<00:00, 32.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 73.31it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 64%|██████▍   | 32/50 [00:06<00:03,  4.82it/s]Epoch 32

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 31.30it/s][ALoss = 8.6749e-04, PNorm = 36.0030, GNorm = 0.1616, lr_0 = 1.6469e-04
Loss = 2.4727e-03, PNorm = 36.0049, GNorm = 0.3821, lr_0 = 1.6312e-04
100%|██████████| 6/6 [00:00<00:00, 33.52it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 78.17it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.283333
 66%|██████▌   | 33/50 [00:06<00:03,  4.87it/s]Epoch 33

  0%|          | 0/6 [00:00<?, ?it/s][A
 50%|█████     | 3/6 [00:00<00:00, 24.62it/s][A100%|██████████| 6/6 [00:00<00:00, 28.88it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.53it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 68%|██████▊   | 34/50 [00:06<00:03,  4.72it/s]Epoch 34

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.2303e-04, PNorm = 36.0231, GNorm = 0.1974, lr_0 = 1.4819e-04

 67%|██████▋   | 4/6 [00:00<00:00, 36.28it/s][A100%|██████████| 6/6 [00:00<00:00, 38.95it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 84.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.316667
 70%|███████   | 35/50 [00:06<00:03,  5.00it/s]Epoch 35

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.06it/s][A100%|██████████| 6/6 [00:00<00:00, 38.08it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 81.00it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 72%|███████▏  | 36/50 [00:06<00:02,  5.16it/s]Epoch 36

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.5369e-04, PNorm = 36.0380, GNorm = 0.1679, lr_0 = 1.3335e-04

 67%|██████▋   | 4/6 [00:00<00:00, 33.64it/s][A100%|██████████| 6/6 [00:00<00:00, 37.29it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.42it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 74%|███████▍  | 37/50 [00:07<00:02,  5.28it/s]Epoch 37

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 36.24it/s][A100%|██████████| 6/6 [00:00<00:00, 39.04it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 85.12it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 76%|███████▌  | 38/50 [00:07<00:02,  5.43it/s]Epoch 38

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.7906e-04, PNorm = 36.0538, GNorm = 0.1750, lr_0 = 1.2000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.76it/s][A100%|██████████| 6/6 [00:00<00:00, 37.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 90.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.300000
 78%|███████▊  | 39/50 [00:07<00:02,  5.50it/s]Epoch 39

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 20.94it/s][A100%|██████████| 6/6 [00:00<00:00, 25.61it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 92.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 80%|████████  | 40/50 [00:07<00:02,  4.93it/s]Epoch 40

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 8.5155e-04, PNorm = 36.0671, GNorm = 0.2020, lr_0 = 1.0798e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.37it/s][A100%|██████████| 6/6 [00:00<00:00, 38.67it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.10it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 82%|████████▏ | 41/50 [00:07<00:01,  5.16it/s]Epoch 41

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.18it/s][ALoss = 8.1687e-04, PNorm = 36.0785, GNorm = 0.2063, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 37.74it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 87.69it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 84%|████████▍ | 42/50 [00:08<00:01,  5.29it/s]Epoch 42

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 39.23it/s][A100%|██████████| 6/6 [00:00<00:00, 42.01it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.84it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 86%|████████▌ | 43/50 [00:08<00:01,  5.53it/s]Epoch 43

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.49it/s][ALoss = 7.4132e-04, PNorm = 36.0899, GNorm = 0.2577, lr_0 = 1.0000e-04
100%|██████████| 6/6 [00:00<00:00, 38.34it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.23it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 88%|████████▊ | 44/50 [00:08<00:01,  5.59it/s]Epoch 44

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 35.70it/s][A100%|██████████| 6/6 [00:00<00:00, 38.87it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 89.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 90%|█████████ | 45/50 [00:08<00:00,  5.65it/s]Epoch 45

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 7.0526e-04, PNorm = 36.1017, GNorm = 0.1455, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 34.43it/s][A100%|██████████| 6/6 [00:00<00:00, 36.96it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 79.66it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 92%|█████████▏| 46/50 [00:08<00:00,  5.59it/s]Epoch 46

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 37.45it/s][A100%|██████████| 6/6 [00:00<00:00, 40.82it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 86.62it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 94%|█████████▍| 47/50 [00:08<00:00,  5.72it/s]Epoch 47

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 6.8536e-04, PNorm = 36.1126, GNorm = 0.1258, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 35.83it/s][A100%|██████████| 6/6 [00:00<00:00, 39.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.14it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 96%|█████████▌| 48/50 [00:09<00:00,  5.78it/s]Epoch 48

  0%|          | 0/6 [00:00<?, ?it/s][A
 67%|██████▋   | 4/6 [00:00<00:00, 38.66it/s][A100%|██████████| 6/6 [00:00<00:00, 41.56it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 93.87it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
 98%|█████████▊| 49/50 [00:09<00:00,  5.89it/s]Epoch 49

  0%|          | 0/6 [00:00<?, ?it/s][ALoss = 5.8732e-04, PNorm = 36.1244, GNorm = 0.1524, lr_0 = 1.0000e-04

 67%|██████▋   | 4/6 [00:00<00:00, 37.23it/s][A100%|██████████| 6/6 [00:00<00:00, 40.68it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [00:00<00:00, 91.58it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Validation auc = 0.340000
100%|██████████| 50/50 [00:09<00:00,  5.93it/s]100%|██████████| 50/50 [00:09<00:00,  5.29it/s]
Model 0 best validation auc = 0.350000 on epoch 0
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 47.65it/s]
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.641667
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = 0.641667
10-fold cross validation
Seed 0 ==> test auc = 0.353333
Seed 1 ==> test auc = 0.676667
Seed 2 ==> test auc = 0.341270
Seed 3 ==> test auc = 0.458333
Seed 4 ==> test auc = 0.394444
Seed 5 ==> test auc = 0.426667
Seed 6 ==> test auc = 0.277778
Seed 7 ==> test auc = 0.648148
Seed 8 ==> test auc = 0.502381
Seed 9 ==> test auc = 0.641667
Overall test auc = 0.472069 +/- 0.134081
